!function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/build/",e(e.s=0)}([function(t,e,i){"use strict";var r=i(1),n=i(3);new r(function(t){var e=[],i=["kick","snare","clap","hat","cymbal","tom1","tom2","tom3"],r=void 0,o=void 0,s=void 0,a=void 0,h=!1,l=120,u=0,p=!1,c=new n.Freeverb({roomSize:.3,dampening:3e3,wet:.15}).toMaster(),f=new n.MultiPlayer({urls:{kick:"./samples/kick.mp3",snare:"./samples/snare.mp3",clap:"./samples/clap.mp3",hat:"./samples/hat.mp3",cymbal:"./samples/cymbal.mp3",tom1:"./samples/tom1.mp3",tom2:"./samples/tom2.mp3",tom3:"./samples/tom3.mp3"},volume:-10,fadeOut:.1}).connect(c),d=new n.Sequence(function(t,r){u=r;for(var n=e[r],o=n.length-1;o>=0;o--)n[o]>0&&f.start(i[o],t,0,"16n",0,n[o])},[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"16n");n.Transport.bpm.value=l,n.Transport.start(),t.setup=function(){t.createCanvas(801,700);r=t.color("#090707"),o=t.color("#30A9DE"),s=t.color("#E53A40"),a=t.color("#EFDC05"),t.initGrid()},t.draw=function(){p&&t.updateTempo(),t.background(r),t.drawPlayBar(),t.drawCells(),t.drawPlayButton(),t.drawNumber(2,"bpm",l,p),t.drawInfo()},t.mousePressed=function(){p=t.mouseX>100&&t.mouseX<200&&t.mouseY>400&&t.mouseY<500},t.mouseReleased=function(){if(!p&&t.mouseX>0&&t.mouseX<800&&t.mouseY>0){if(t.mouseY<400)return void t.toggleGrid(t.mouseX,t.mouseY);t.mouseX<100&&t.mouseY<500?t.startStop():t.mouseX>200&&t.mouseX<600&&t.mouseY<500&&t.updateScale()}p=!1},t.startStop=function(){h=!h,h?d.start():d.stop()},t.updateTempo=function(){l=t.constrain(t.map(t.mouseY,0,t.height,240,40),40,240).toFixed(0),n.Transport.bpm.value=l},t.drawPlayBar=function(){h&&(t.noStroke(),t.fill(a),t.rect(50*u,0,50,400))},t.drawPlayButton=function(){t.push(),t.translate(0,400),t.noFill(),t.stroke(o),t.rect(0,0,100,100),t.fill(o),h?t.rect(5,5,90,90):t.triangle(5,5,95,50,5,95),t.pop()},t.drawCells=function(){t.push();for(var i=e.length-1;i>=0;i--)for(var r=e[i].length-1;r>=0;r--)if(t.stroke(o),t.noFill(),t.rect(50*i,50*r,50,50),e[i][r]){var n=50*(1-e[i][r]);t.noStroke(),t.fill(s),t.rect(50*i,50*r+n,50,50-n)}t.pop()},t.drawNumber=function(e,i,r,n){t.push(),t.translate(50*e,400),t.noFill(),t.stroke(o),t.rect(0,0,100,100),t.noStroke(),n?t.fill(s):t.fill(o),t.textSize(12),t.textAlign(t.left),t.text(i+":",10,t.textAscent()+10),t.textSize(48),t.textAlign(t.RIGHT),t.text(r,90,90),t.pop()},t.drawInfo=function(){t.push(),t.translate(t.width-10,500),t.textAlign(t.RIGHT,t.BOTTOM);t.noStroke(),t.textSize(72),t.fill(o),t.text("//process-p",0,0);var e=t.textWidth("p");t.textSize(12),t.text("a drum computer by stephen ball, august 2017",-e,0),t.pop()},t.initGrid=function(){for(var t=15;t>=0;t--){e[t]=[];for(var i=7;i>=0;i--)e[t][i]=0}},t.toggleGrid=function(t,i){var r=Math.floor(t/50),n=Math.floor(i/50),o=1-(i/50-n);e[r][n]?e[r][n]=0:e[r][n]=o}},"process-container")},function(t,e,i){(function(e){var i,i;/*! p5.js v0.5.12 August 11, 2017 */
!function(e){t.exports=e()}(function(){var t;return function t(e,r,n){function o(a,h){if(!r[a]){if(!e[a]){var l="function"==typeof i&&i;if(!h&&l)return i(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var p=r[a]={exports:{}};e[a][0].call(p.exports,function(t){var i=e[a][1][t];return o(i||t)},p,p.exports,t,e,r,n)}return r[a].exports}for(var s="function"==typeof i&&i,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,i){!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===o||e===u?62:e===s||e===p?63:e<a?-1:e<a+10?e-a+26+26:e<l+26?e-l:e<h+26?e-h+26:void 0}function i(t){function i(t){l[p++]=t}var r,o,s,a,h,l;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var u=t.length;h="="===t.charAt(u-2)?2:"="===t.charAt(u-1)?1:0,l=new n(3*t.length/4-h),s=h>0?t.length-4:t.length;var p=0;for(r=0,o=0;r<s;r+=4,o+=3)a=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),i((16711680&a)>>16),i((65280&a)>>8),i(255&a);return 2===h?(a=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,i(255&a)):1===h&&(a=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,i(a>>8&255),i(255&a)),l}function r(t){function e(t){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t)}var i,r,n,o=t.length%3,s="";for(i=0,n=t.length-o;i<n;i+=3)r=(t[i]<<16)+(t[i+1]<<8)+t[i+2],s+=function(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}(r);switch(o){case 1:r=t[t.length-1],s+=e(r>>2),s+=e(r<<4&63),s+="==";break;case 2:r=(t[t.length-2]<<8)+t[t.length-1],s+=e(r>>10),s+=e(r>>4&63),s+=e(r<<2&63),s+="="}return s}var n="undefined"!=typeof Uint8Array?Uint8Array:Array,o="+".charCodeAt(0),s="/".charCodeAt(0),a="0".charCodeAt(0),h="a".charCodeAt(0),l="A".charCodeAt(0),u="-".charCodeAt(0),p="_".charCodeAt(0);t.toByteArray=i,t.fromByteArray=r}(void 0===i?this.base64js={}:i)},{}],2:[function(t,e,i){},{}],3:[function(t,i,r){(function(e){/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
"use strict";function i(){return n.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function n(t){return this instanceof n?(n.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?o(this,t):"string"==typeof t?s(this,t,arguments.length>1?arguments[1]:"utf8"):a(this,t)):arguments.length>1?new n(t,arguments[1]):new n(t)}function o(t,e){if(t=d(t,e<0?0:0|y(e)),!n.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;i++)t[i]=0;return t}function s(t,e,i){return"string"==typeof i&&""!==i||(i="utf8"),t=d(t,0|g(e,i)),t.write(e,i),t}function a(t,e){if(n.isBuffer(e))return h(t,e);if(Z(e))return l(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(e.buffer instanceof ArrayBuffer)return u(t,e);if(e instanceof ArrayBuffer)return p(t,e)}return e.length?c(t,e):f(t,e)}function h(t,e){var i=0|y(e.length);return t=d(t,i),e.copy(t,0,0,i),t}function l(t,e){var i=0|y(e.length);t=d(t,i);for(var r=0;r<i;r+=1)t[r]=255&e[r];return t}function u(t,e){var i=0|y(e.length);t=d(t,i);for(var r=0;r<i;r+=1)t[r]=255&e[r];return t}function p(t,e){return n.TYPED_ARRAY_SUPPORT?(e.byteLength,t=n._augment(new Uint8Array(e))):t=u(t,new Uint8Array(e)),t}function c(t,e){var i=0|y(e.length);t=d(t,i);for(var r=0;r<i;r+=1)t[r]=255&e[r];return t}function f(t,e){var i,r=0;"Buffer"===e.type&&Z(e.data)&&(i=e.data,r=0|y(i.length)),t=d(t,r);for(var n=0;n<r;n+=1)t[n]=255&i[n];return t}function d(t,e){return n.TYPED_ARRAY_SUPPORT?(t=n._augment(new Uint8Array(e)),t.__proto__=n.prototype):(t.length=e,t._isBuffer=!0),0!==e&&e<=n.poolSize>>>1&&(t.parent=Q),t}function y(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function m(t,e){if(!(this instanceof m))return new m(t,e);var i=new n(t,e);return delete i.parent,i}function g(t,e){"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var r=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return i;case"utf8":case"utf-8":return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return H(t).length;default:if(r)return j(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,i){var r=!1;if(e|=0,i=void 0===i||i===1/0?this.length:0|i,t||(t="utf8"),e<0&&(e=0),i>this.length&&(i=this.length),i<=e)return"";for(;;)switch(t){case"hex":return R(this,e,i);case"utf8":case"utf-8":return P(this,e,i);case"ascii":return M(this,e,i);case"binary":return A(this,e,i);case"base64":return E(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,i);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function _(t,e,i,r){i=Number(i)||0;var n=t.length-i;r?(r=Number(r))>n&&(r=n):r=n;var o=e.length;if(o%2!=0)throw new Error("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[i+s]=a}return s}function b(t,e,i,r){return W(j(e,t.length-i),t,i,r)}function w(t,e,i,r){return W(V(e),t,i,r)}function x(t,e,i,r){return w(t,e,i,r)}function S(t,e,i,r){return W(H(e),t,i,r)}function T(t,e,i,r){return W(z(e,t.length-i),t,i,r)}function E(t,e,i){return 0===e&&i===t.length?X.fromByteArray(t):X.fromByteArray(t.slice(e,i))}function P(t,e,i){i=Math.min(t.length,i);for(var r=[],n=e;n<i;){var o=t[n],s=null,a=o>239?4:o>223?3:o>191?2:1;if(n+a<=i){var h,l,u,p;switch(a){case 1:o<128&&(s=o);break;case 2:h=t[n+1],128==(192&h)&&(p=(31&o)<<6|63&h)>127&&(s=p);break;case 3:h=t[n+1],l=t[n+2],128==(192&h)&&128==(192&l)&&(p=(15&o)<<12|(63&h)<<6|63&l)>2047&&(p<55296||p>57343)&&(s=p);break;case 4:h=t[n+1],l=t[n+2],u=t[n+3],128==(192&h)&&128==(192&l)&&128==(192&u)&&(p=(15&o)<<18|(63&h)<<12|(63&l)<<6|63&u)>65535&&p<1114112&&(s=p)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),n+=a}return O(r)}function O(t){var e=t.length;if(e<=J)return String.fromCharCode.apply(String,t);for(var i="",r=0;r<e;)i+=String.fromCharCode.apply(String,t.slice(r,r+=J));return i}function M(t,e,i){var r="";i=Math.min(t.length,i);for(var n=e;n<i;n++)r+=String.fromCharCode(127&t[n]);return r}function A(t,e,i){var r="";i=Math.min(t.length,i);for(var n=e;n<i;n++)r+=String.fromCharCode(t[n]);return r}function R(t,e,i){var r=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>r)&&(i=r);for(var n="",o=e;o<i;o++)n+=G(t[o]);return n}function C(t,e,i){for(var r=t.slice(e,i),n="",o=0;o<r.length;o+=2)n+=String.fromCharCode(r[o]+256*r[o+1]);return n}function k(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,i,r,o,s){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||e<s)throw new RangeError("value is out of bounds");if(i+r>t.length)throw new RangeError("index out of range")}function L(t,e,i,r){e<0&&(e=65535+e+1);for(var n=0,o=Math.min(t.length-i,2);n<o;n++)t[i+n]=(e&255<<8*(r?n:1-n))>>>8*(r?n:1-n)}function I(t,e,i,r){e<0&&(e=4294967295+e+1);for(var n=0,o=Math.min(t.length-i,4);n<o;n++)t[i+n]=e>>>8*(r?n:3-n)&255}function D(t,e,i,r,n,o){if(e>n||e<o)throw new RangeError("value is out of bounds");if(i+r>t.length)throw new RangeError("index out of range");if(i<0)throw new RangeError("index out of range")}function U(t,e,i,r,n){return n||D(t,e,i,4,3.4028234663852886e38,-3.4028234663852886e38),Y.write(t,e,i,r,23,4),i+4}function B(t,e,i,r,n){return n||D(t,e,i,8,1.7976931348623157e308,-1.7976931348623157e308),Y.write(t,e,i,r,52,8),i+8}function N(t){if(t=q(t).replace(K,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function q(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function G(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){e=e||1/0;for(var i,r=t.length,n=null,o=[],s=0;s<r;s++){if((i=t.charCodeAt(s))>55295&&i<57344){if(!n){if(i>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}n=i;continue}if(i<56320){(e-=3)>-1&&o.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,i<128){if((e-=1)<0)break;o.push(i)}else if(i<2048){if((e-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function V(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e}function z(t,e){for(var i,r,n,o=[],s=0;s<t.length&&!((e-=2)<0);s++)i=t.charCodeAt(s),r=i>>8,n=i%256,o.push(n),o.push(r);return o}function H(t){return X.toByteArray(N(t))}function W(t,e,i,r){for(var n=0;n<r&&!(n+i>=e.length||n>=t.length);n++)e[n+i]=t[n];return n}var X=t("base64-js"),Y=t("ieee754"),Z=t("isarray");r.Buffer=n,r.SlowBuffer=m,r.INSPECT_MAX_BYTES=50,n.poolSize=8192;var Q={};n.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){function t(){}try{var e=new Uint8Array(1);return e.foo=function(){return 42},e.constructor=t,42===e.foo()&&e.constructor===t&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),n.TYPED_ARRAY_SUPPORT?(n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array):(n.prototype.length=void 0,n.prototype.parent=void 0),n.isBuffer=function(t){return!(null==t||!t._isBuffer)},n.compare=function(t,e){if(!n.isBuffer(t)||!n.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,r=e.length,o=0,s=Math.min(i,r);o<s&&t[o]===e[o];)++o;return o!==s&&(i=t[o],r=e[o]),i<r?-1:r<i?1:0},n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(t,e){if(!Z(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new n(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;i++)e+=t[i].length;var r=new n(e),o=0;for(i=0;i<t.length;i++){var s=t[i];s.copy(r,o),o+=s.length}return r},n.byteLength=g,n.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):v.apply(this,arguments)},n.prototype.equals=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===n.compare(this,t)},n.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},n.prototype.compare=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:n.compare(this,t)},n.prototype.indexOf=function(t,e){function i(t,e,i){for(var r=-1,n=0;i+n<t.length;n++)if(t[i+n]===e[-1===r?0:n-r]){if(-1===r&&(r=n),n-r+1===e.length)return i+r}else r=-1;return-1}if(e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(e<0&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(n.isBuffer(t))return i(this,t,e);if("number"==typeof t)return n.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):i(this,[t],e);throw new TypeError("val must be string, number or Buffer")},n.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},n.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},n.prototype.write=function(t,e,i,r){if(void 0===e)r="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)r=e,i=this.length,e=0;else if(isFinite(e))e|=0,isFinite(i)?(i|=0,void 0===r&&(r="utf8")):(r=i,i=void 0);else{var n=r;r=e,e=0|i,i=n}var o=this.length-e;if((void 0===i||i>o)&&(i=o),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");r||(r="utf8");for(var s=!1;;)switch(r){case"hex":return _(this,t,e,i);case"utf8":case"utf-8":return b(this,t,e,i);case"ascii":return w(this,t,e,i);case"binary":return x(this,t,e,i);case"base64":return S(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,i);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var J=4096;n.prototype.slice=function(t,e){var i=this.length;t=~~t,e=void 0===e?i:~~e,t<0?(t+=i)<0&&(t=0):t>i&&(t=i),e<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t);var r;if(n.TYPED_ARRAY_SUPPORT)r=n._augment(this.subarray(t,e));else{var o=e-t;r=new n(o,void 0);for(var s=0;s<o;s++)r[s]=this[s+t]}return r.length&&(r.parent=this.parent||this),r},n.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||k(t,e,this.length);for(var r=this[t],n=1,o=0;++o<e&&(n*=256);)r+=this[t+o]*n;return r},n.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||k(t,e,this.length);for(var r=this[t+--e],n=1;e>0&&(n*=256);)r+=this[t+--e]*n;return r},n.prototype.readUInt8=function(t,e){return e||k(t,1,this.length),this[t]},n.prototype.readUInt16LE=function(t,e){return e||k(t,2,this.length),this[t]|this[t+1]<<8},n.prototype.readUInt16BE=function(t,e){return e||k(t,2,this.length),this[t]<<8|this[t+1]},n.prototype.readUInt32LE=function(t,e){return e||k(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},n.prototype.readUInt32BE=function(t,e){return e||k(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},n.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||k(t,e,this.length);for(var r=this[t],n=1,o=0;++o<e&&(n*=256);)r+=this[t+o]*n;return n*=128,r>=n&&(r-=Math.pow(2,8*e)),r},n.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||k(t,e,this.length);for(var r=e,n=1,o=this[t+--r];r>0&&(n*=256);)o+=this[t+--r]*n;return n*=128,o>=n&&(o-=Math.pow(2,8*e)),o},n.prototype.readInt8=function(t,e){return e||k(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},n.prototype.readInt16LE=function(t,e){e||k(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},n.prototype.readInt16BE=function(t,e){e||k(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},n.prototype.readInt32LE=function(t,e){return e||k(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},n.prototype.readInt32BE=function(t,e){return e||k(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},n.prototype.readFloatLE=function(t,e){return e||k(t,4,this.length),Y.read(this,t,!0,23,4)},n.prototype.readFloatBE=function(t,e){return e||k(t,4,this.length),Y.read(this,t,!1,23,4)},n.prototype.readDoubleLE=function(t,e){return e||k(t,8,this.length),Y.read(this,t,!0,52,8)},n.prototype.readDoubleBE=function(t,e){return e||k(t,8,this.length),Y.read(this,t,!1,52,8)},n.prototype.writeUIntLE=function(t,e,i,r){t=+t,e|=0,i|=0,r||F(this,t,e,i,Math.pow(2,8*i),0);var n=1,o=0;for(this[e]=255&t;++o<i&&(n*=256);)this[e+o]=t/n&255;return e+i},n.prototype.writeUIntBE=function(t,e,i,r){t=+t,e|=0,i|=0,r||F(this,t,e,i,Math.pow(2,8*i),0);var n=i-1,o=1;for(this[e+n]=255&t;--n>=0&&(o*=256);)this[e+n]=t/o&255;return e+i},n.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,1,255,0),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},n.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},n.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},n.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):I(this,t,e,!0),e+4},n.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},n.prototype.writeIntLE=function(t,e,i,r){if(t=+t,e|=0,!r){var n=Math.pow(2,8*i-1);F(this,t,e,i,n-1,-n)}var o=0,s=1,a=t<0?1:0;for(this[e]=255&t;++o<i&&(s*=256);)this[e+o]=(t/s>>0)-a&255;return e+i},n.prototype.writeIntBE=function(t,e,i,r){if(t=+t,e|=0,!r){var n=Math.pow(2,8*i-1);F(this,t,e,i,n-1,-n)}var o=i-1,s=1,a=t<0?1:0;for(this[e+o]=255&t;--o>=0&&(s*=256);)this[e+o]=(t/s>>0)-a&255;return e+i},n.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,1,127,-128),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},n.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):L(this,t,e,!0),e+2},n.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):L(this,t,e,!1),e+2},n.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,4,2147483647,-2147483648),n.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):I(this,t,e,!0),e+4},n.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):I(this,t,e,!1),e+4},n.prototype.writeFloatLE=function(t,e,i){return U(this,t,e,!0,i)},n.prototype.writeFloatBE=function(t,e,i){return U(this,t,e,!1,i)},n.prototype.writeDoubleLE=function(t,e,i){return B(this,t,e,!0,i)},n.prototype.writeDoubleBE=function(t,e,i){return B(this,t,e,!1,i)},n.prototype.copy=function(t,e,i,r){if(i||(i=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<i&&(r=i),r===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-i&&(r=t.length-e+i);var o,s=r-i;if(this===t&&i<e&&e<r)for(o=s-1;o>=0;o--)t[o+e]=this[o+i];else if(s<1e3||!n.TYPED_ARRAY_SUPPORT)for(o=0;o<s;o++)t[o+e]=this[o+i];else t._set(this.subarray(i,i+s),e);return s},n.prototype.fill=function(t,e,i){if(t||(t=0),e||(e=0),i||(i=this.length),i<e)throw new RangeError("end < start");if(i!==e&&0!==this.length){if(e<0||e>=this.length)throw new RangeError("start out of bounds");if(i<0||i>this.length)throw new RangeError("end out of bounds");var r;if("number"==typeof t)for(r=e;r<i;r++)this[r]=t;else{var n=j(t.toString()),o=n.length;for(r=e;r<i;r++)this[r]=n[r%o]}return this}},n.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(n.TYPED_ARRAY_SUPPORT)return new n(this).buffer;for(var t=new Uint8Array(this.length),e=0,i=t.length;e<i;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var $=n.prototype;n._augment=function(t){return t.constructor=n,t._isBuffer=!0,t._set=t.set,t.get=$.get,t.set=$.set,t.write=$.write,t.toString=$.toString,t.toLocaleString=$.toString,t.toJSON=$.toJSON,t.equals=$.equals,t.compare=$.compare,t.indexOf=$.indexOf,t.copy=$.copy,t.slice=$.slice,t.readUIntLE=$.readUIntLE,t.readUIntBE=$.readUIntBE,t.readUInt8=$.readUInt8,t.readUInt16LE=$.readUInt16LE,t.readUInt16BE=$.readUInt16BE,t.readUInt32LE=$.readUInt32LE,t.readUInt32BE=$.readUInt32BE,t.readIntLE=$.readIntLE,t.readIntBE=$.readIntBE,t.readInt8=$.readInt8,t.readInt16LE=$.readInt16LE,t.readInt16BE=$.readInt16BE,t.readInt32LE=$.readInt32LE,t.readInt32BE=$.readInt32BE,t.readFloatLE=$.readFloatLE,t.readFloatBE=$.readFloatBE,t.readDoubleLE=$.readDoubleLE,t.readDoubleBE=$.readDoubleBE,t.writeUInt8=$.writeUInt8,t.writeUIntLE=$.writeUIntLE,t.writeUIntBE=$.writeUIntBE,t.writeUInt16LE=$.writeUInt16LE,t.writeUInt16BE=$.writeUInt16BE,t.writeUInt32LE=$.writeUInt32LE,t.writeUInt32BE=$.writeUInt32BE,t.writeIntLE=$.writeIntLE,t.writeIntBE=$.writeIntBE,t.writeInt8=$.writeInt8,t.writeInt16LE=$.writeInt16LE,t.writeInt16BE=$.writeInt16BE,t.writeInt32LE=$.writeInt32LE,t.writeInt32BE=$.writeInt32BE,t.writeFloatLE=$.writeFloatLE,t.writeFloatBE=$.writeFloatBE,t.writeDoubleLE=$.writeDoubleLE,t.writeDoubleBE=$.writeDoubleBE,t.fill=$.fill,t.inspect=$.inspect,t.toArrayBuffer=$.toArrayBuffer,t};var K=/[^+\/0-9A-Za-z-_]/g}).call(this,void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:6,isarray:7}],4:[function(i,r,n){(function(e,o){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.0.5
 */
!function(e,i){"object"==typeof n&&void 0!==r?r.exports=i():"function"==typeof t&&t.amd?t(i):e.ES6Promise=i()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function r(t){return"function"==typeof t}function n(t){H=t}function s(t){W=t}function a(){return void 0!==z?function(){z(l)}:h()}function h(){var t=setTimeout;return function(){return t(l,1)}}function l(){for(var t=0;t<V;t+=2){(0,$[t])($[t+1]),$[t]=void 0,$[t+1]=void 0}V=0}function u(t,e){var i=arguments,r=this,n=new this.constructor(c);void 0===n[tt]&&C(n);var o=r._state;return o?function(){var t=i[o-1];W(function(){return M(o,n,t,r._result)})}():T(r,n,t,e),n}function p(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var i=new e(c);return b(i,t),i}function c(){}function f(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(t){return nt.error=t,nt}}function m(t,e,i,r){try{t.call(e,i,r)}catch(t){return t}}function g(t,e,i){W(function(t){var r=!1,n=m(i,e,function(i){r||(r=!0,e!==i?b(t,i):x(t,i))},function(e){r||(r=!0,S(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&n&&(r=!0,S(t,n))},t)}function v(t,e){e._state===it?x(t,e._result):e._state===rt?S(t,e._result):T(e,void 0,function(e){return b(t,e)},function(e){return S(t,e)})}function _(t,e,i){e.constructor===t.constructor&&i===u&&e.constructor.resolve===p?v(t,e):i===nt?S(t,nt.error):void 0===i?x(t,e):r(i)?g(t,e,i):x(t,e)}function b(e,i){e===i?S(e,f()):t(i)?_(e,i,y(i)):x(e,i)}function w(t){t._onerror&&t._onerror(t._result),E(t)}function x(t,e){t._state===et&&(t._result=e,t._state=it,0!==t._subscribers.length&&W(E,t))}function S(t,e){t._state===et&&(t._state=rt,t._result=e,W(w,t))}function T(t,e,i,r){var n=t._subscribers,o=n.length;t._onerror=null,n[o]=e,n[o+it]=i,n[o+rt]=r,0===o&&t._state&&W(E,t)}function E(t){var e=t._subscribers,i=t._state;if(0!==e.length){for(var r=void 0,n=void 0,o=t._result,s=0;s<e.length;s+=3)r=e[s],n=e[s+i],r?M(i,r,n,o):n(o);t._subscribers.length=0}}function P(){this.error=null}function O(t,e){try{return t(e)}catch(t){return ot.error=t,ot}}function M(t,e,i,n){var o=r(i),s=void 0,a=void 0,h=void 0,l=void 0;if(o){if(s=O(i,n),s===ot?(l=!0,a=s.error,s=null):h=!0,e===s)return void S(e,d())}else s=n,h=!0;e._state!==et||(o&&h?b(e,s):l?S(e,a):t===it?x(e,s):t===rt&&S(e,s))}function A(t,e){try{e(function(e){b(t,e)},function(e){S(t,e)})}catch(e){S(t,e)}}function R(){return st++}function C(t){t[tt]=st++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(t,e){this._instanceConstructor=t,this.promise=new t(c),this.promise[tt]||C(this.promise),j(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?x(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&x(this.promise,this._result))):S(this.promise,F())}function F(){return new Error("Array Methods must be provided an Array")}function L(t){return new k(this,t).promise}function I(t){var e=this;return new e(j(t)?function(i,r){for(var n=t.length,o=0;o<n;o++)e.resolve(t[o]).then(i,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,i=new e(c);return S(i,t),i}function U(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function B(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function N(t){this[tt]=R(),this._result=this._state=void 0,this._subscribers=[],c!==t&&("function"!=typeof t&&U(),this instanceof N?A(this,t):B())}function q(){var t=void 0;if(void 0!==o)t=o;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=N}var G=void 0;G=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var j=G,V=0,z=void 0,H=void 0,W=function(t,e){$[V]=t,$[V+1]=e,2===(V+=2)&&(H?H(l):K())},X="undefined"!=typeof window?window:void 0,Y=X||{},Z=Y.MutationObserver||Y.WebKitMutationObserver,Q="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),J="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,$=new Array(1e3),K=void 0;K=Q?function(){return function(){return e.nextTick(l)}}():Z?function(){var t=0,e=new Z(l),i=document.createTextNode("");return e.observe(i,{characterData:!0}),function(){i.data=t=++t%2}}():J?function(){var t=new MessageChannel;return t.port1.onmessage=l,function(){return t.port2.postMessage(0)}}():void 0===X&&"function"==typeof i?function(){try{var t=i,e=t("vertx");return z=e.runOnLoop||e.runOnContext,a()}catch(t){return h()}}():h();var tt=Math.random().toString(36).substring(16),et=void 0,it=1,rt=2,nt=new P,ot=new P,st=0;return k.prototype._enumerate=function(){for(var t=this.length,e=this._input,i=0;this._state===et&&i<t;i++)this._eachEntry(e[i],i)},k.prototype._eachEntry=function(t,e){var i=this._instanceConstructor,r=i.resolve;if(r===p){var n=y(t);if(n===u&&t._state!==et)this._settledAt(t._state,e,t._result);else if("function"!=typeof n)this._remaining--,this._result[e]=t;else if(i===N){var o=new i(c);_(o,t,n),this._willSettleAt(o,e)}else this._willSettleAt(new i(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},k.prototype._settledAt=function(t,e,i){var r=this.promise;r._state===et&&(this._remaining--,t===rt?S(r,i):this._result[e]=i),0===this._remaining&&x(r,this._result)},k.prototype._willSettleAt=function(t,e){var i=this;T(t,void 0,function(t){return i._settledAt(it,e,t)},function(t){return i._settledAt(rt,e,t)})},N.all=L,N.race=I,N.resolve=p,N.reject=D,N._setScheduler=n,N._setAsap=s,N._asap=W,N.prototype={constructor:N,then:u,catch:function(t){return this.then(null,t)}},N.polyfill=q,N.Promise=N,N})}).call(this,i("_process"),void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:42}],5:[function(e,i,r){!function(e,n){if("function"==typeof t&&t.amd)t(["exports","module"],n);else if(void 0!==r&&void 0!==i)n(r,i);else{var o={exports:{}};n(o.exports,o),e.fetchJsonp=o.exports}}(this,function(t,e){"use strict";function i(){return"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random())}function r(t){try{delete window[t]}catch(e){window[t]=void 0}}function n(t){var e=document.getElementById(t);document.getElementsByTagName("head")[0].removeChild(e)}function o(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=t,a=e.timeout||s.timeout,h=e.jsonpCallback||s.jsonpCallback,l=void 0;return new Promise(function(s,u){var p=e.jsonpCallbackFunction||i(),c=h+"_"+p;window[p]=function(t){s({ok:!0,json:function(){return Promise.resolve(t)}}),l&&clearTimeout(l),n(c),r(p)},o+=-1===o.indexOf("?")?"?":"&";var f=document.createElement("script");f.setAttribute("src",""+o+h+"="+p),f.id=c,document.getElementsByTagName("head")[0].appendChild(f),l=setTimeout(function(){u(new Error("JSONP request to "+t+" timed out")),r(p),n(c)},a)})}var s={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};e.exports=o})},{}],6:[function(t,e,i){i.read=function(t,e,i,r,n){var o,s,a=8*n-r-1,h=(1<<a)-1,l=h>>1,u=-7,p=i?n-1:0,c=i?-1:1,f=t[e+p];for(p+=c,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+t[e+p],p+=c,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+t[e+p],p+=c,u-=8);if(0===o)o=1-l;else{if(o===h)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=l}return(f?-1:1)*s*Math.pow(2,o-r)},i.write=function(t,e,i,r,n,o){var s,a,h,l=8*o-n-1,u=(1<<l)-1,p=u>>1,c=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),e+=s+p>=1?c/h:c*Math.pow(2,1-p),e*h>=2&&(s++,h/=2),s+p>=u?(a=0,s=u):s+p>=1?(a=(e*h-1)*Math.pow(2,n),s+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,n),s=0));n>=8;t[i+f]=255&a,f+=d,a/=256,n-=8);for(s=s<<n|a,l+=n;l>0;t[i+f]=255&s,f+=d,s/=256,l-=8);t[i+f-d]|=128*y}},{}],7:[function(t,e,i){var r={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},{}],8:[function(t,e,i){"use strict";function r(t,e,i,r,n){return Math.pow(1-n,3)*t+3*Math.pow(1-n,2)*n*e+3*(1-n)*Math.pow(n,2)*i+Math.pow(n,3)*r}function n(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}n.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},n.prototype.addPoint=function(t,e){"number"==typeof t&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=t,this.x2=t),t<this.x1&&(this.x1=t),t>this.x2&&(this.x2=t)),"number"==typeof e&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=e,this.y2=e),e<this.y1&&(this.y1=e),e>this.y2&&(this.y2=e))},n.prototype.addX=function(t){this.addPoint(t,null)},n.prototype.addY=function(t){this.addPoint(null,t)},n.prototype.addBezier=function(t,e,i,n,o,s,a,h){var l=[t,e],u=[i,n],p=[o,s],c=[a,h];this.addPoint(t,e),this.addPoint(a,h);for(var f=0;f<=1;f++){var d=6*l[f]-12*u[f]+6*p[f],y=-3*l[f]+9*u[f]-9*p[f]+3*c[f],m=3*u[f]-3*l[f];if(0!==y){var g=Math.pow(d,2)-4*m*y;if(!(g<0)){var v=(-d+Math.sqrt(g))/(2*y);0<v&&v<1&&(0===f&&this.addX(r(l[f],u[f],p[f],c[f],v)),1===f&&this.addY(r(l[f],u[f],p[f],c[f],v)));var _=(-d-Math.sqrt(g))/(2*y);0<_&&_<1&&(0===f&&this.addX(r(l[f],u[f],p[f],c[f],_)),1===f&&this.addY(r(l[f],u[f],p[f],c[f],_)))}}else{if(0===d)continue;var b=-m/d;0<b&&b<1&&(0===f&&this.addX(r(l[f],u[f],p[f],c[f],b)),1===f&&this.addY(r(l[f],u[f],p[f],c[f],b)))}}},n.prototype.addQuad=function(t,e,i,r,n,o){var s=t+2/3*(i-t),a=e+2/3*(r-e),h=s+1/3*(n-t),l=a+1/3*(o-e);this.addBezier(t,e,s,a,h,l,n,o)},i.BoundingBox=n},{}],9:[function(t,e,i){"use strict";i.fail=function(t){throw new Error(t)},i.argument=function(t,e){t||i.fail(e)},i.assert=i.argument},{}],10:[function(t,e,i){"use strict";function r(t,e,i,r,n){t.beginPath(),t.moveTo(e,i),t.lineTo(r,n),t.stroke()}i.line=r},{}],11:[function(t,e,i){"use strict";function r(t){this.font=t}function n(t){this.cmap=t}function o(t,e){this.encoding=t,this.charset=e}function s(t){var e;switch(t.version){case 1:this.names=i.standardNames.slice();break;case 2:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<i.standardNames.length?this.names[e]=i.standardNames[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-i.standardNames.length];break;case 2.5:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)this.names[e]=i.standardNames[e+t.glyphNameIndex[e]];break;case 3:this.names=[]}}function a(t){for(var e,i=t.tables.cmap.glyphIndexMap,r=Object.keys(i),n=0;n<r.length;n+=1){var o=r[n],s=i[o];e=t.glyphs.get(s),e.addUnicode(parseInt(o))}for(n=0;n<t.glyphs.length;n+=1)e=t.glyphs.get(n),t.cffEncoding?t.isCIDFont?e.name="gid"+n:e.name=t.cffEncoding.charset[n]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(n))}var h=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],u=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],p=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];r.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),i=this.font.glyphs;if(!i)return null;for(var r=0;r<i.length;r+=1)for(var n=i.get(r),o=0;o<n.unicodes.length;o+=1)if(n.unicodes[o]===e)return r},n.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.charCodeAt(0)]||0},o.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),i=this.encoding[e];return this.charset.indexOf(i)},s.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},s.prototype.glyphIndexToName=function(t){return this.names[t]},i.cffStandardStrings=h,i.cffStandardEncoding=l,i.cffExpertEncoding=u,i.standardNames=p,i.DefaultEncoding=r,i.CmapEncoding=n,i.CffEncoding=o,i.GlyphNames=s,i.addGlyphNames=a},{}],12:[function(t,e,i){"use strict";function r(t){t=t||{},t.empty||(l.checkArgument(t.familyName,"When creating a new Font object, familyName is required."),l.checkArgument(t.styleName,"When creating a new Font object, styleName is required."),l.checkArgument(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),l.checkArgument(t.ascender,"When creating a new Font object, ascender is required."),l.checkArgument(t.descender,"When creating a new Font object, descender is required."),l.checkArgument(t.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||t.familyName+t.styleName},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables={os2:{usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new a.GlyphSet(this,t.glyphs||[]),this.encoding=new s.DefaultEncoding(this),this.substitution=new h(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new u(this):void 0}})}var n=t("./path"),o=t("./tables/sfnt"),s=t("./encoding"),a=t("./glyphset"),h=t("./substitution"),l=t("./util"),u=t("./hintingtt");r.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},r.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},r.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),i=this.glyphs.get(e);return i||(i=this.glyphs.get(0)),i},r.prototype.stringToGlyphs=function(t,e){e=e||this.defaultRenderOptions;var i,r=[];for(i=0;i<t.length;i+=1){var n=t[i];r.push(this.charToGlyphIndex(n))}var o=r.length;if(e.features){var s=e.script||this.substitution.getDefaultScriptName(),a=[];for(e.features.liga&&(a=a.concat(this.substitution.getFeature("liga",s,e.language))),e.features.rlig&&(a=a.concat(this.substitution.getFeature("rlig",s,e.language))),i=0;i<o;i+=1)for(var h=0;h<a.length;h++){for(var l=a[h],u=l.sub,p=u.length,c=0;c<p&&u[c]===r[i+c];)c++;c===p&&(r.splice(i,p,l.by),o=o-p+1)}}var f=new Array(o),d=this.glyphs.get(0);for(i=0;i<o;i+=1)f[i]=this.glyphs.get(r[i])||d;return f},r.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},r.prototype.nameToGlyph=function(t){var e=this.nameToGlyphIndex(t),i=this.glyphs.get(e);return i||(i=this.glyphs.get(0)),i},r.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},r.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var i=this.getGposKerningValue;return i?i(t,e):this.kerningPairs[t+","+e]||0},r.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},r.prototype.forEachGlyph=function(t,e,i,r,n,o){e=void 0!==e?e:0,i=void 0!==i?i:0,r=void 0!==r?r:72,n=n||this.defaultRenderOptions;for(var s=1/this.unitsPerEm*r,a=this.stringToGlyphs(t,n),h=0;h<a.length;h+=1){var l=a[h];if(o.call(this,l,e,i,r,n),l.advanceWidth&&(e+=l.advanceWidth*s),n.kerning&&h<a.length-1){e+=this.getKerningValue(l,a[h+1])*s}n.letterSpacing?e+=n.letterSpacing*r:n.tracking&&(e+=n.tracking/1e3*r)}return e},r.prototype.getPath=function(t,e,i,r,o){var s=new n.Path;return this.forEachGlyph(t,e,i,r,o,function(t,e,i,r){var n=t.getPath(e,i,r,o,this);s.extend(n)}),s},r.prototype.getPaths=function(t,e,i,r,n){var o=[];return this.forEachGlyph(t,e,i,r,n,function(t,e,i,r){var n=t.getPath(e,i,r);o.push(n)}),o},r.prototype.getAdvanceWidth=function(t,e,i){return this.forEachGlyph(t,0,0,e,i,function(){})},r.prototype.draw=function(t,e,i,r,n,o){this.getPath(e,i,r,n,o).draw(t)},r.prototype.drawPoints=function(t,e,i,r,n,o){this.forEachGlyph(e,i,r,n,o,function(e,i,r,n){e.drawPoints(t,i,r,n)})},r.prototype.drawMetrics=function(t,e,i,r,n,o){this.forEachGlyph(e,i,r,n,o,function(e,i,r,n){e.drawMetrics(t,i,r,n)})},r.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en},r.prototype.validate=function(){function t(t,e){t||i.push(e)}function e(e){var i=r.getEnglishName(e);t(i&&i.trim().length>0,"No English "+e+" specified.")}var i=[],r=this;e("fontFamily"),e("weightName"),e("manufacturer"),e("copyright"),e("version"),t(this.unitsPerEm>0,"No unitsPerEm specified.")},r.prototype.toTables=function(){return o.fontToTable(this)},r.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},r.prototype.toArrayBuffer=function(){for(var t=this.toTables(),e=t.encode(),i=new ArrayBuffer(e.length),r=new Uint8Array(i),n=0;n<e.length;n++)r[n]=e[n];return i},r.prototype.download=function(e){var i=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");e=e||i.replace(/\s/g,"")+"-"+r+".otf";var n=this.toArrayBuffer();if(l.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,n.byteLength,function(t){t.root.getFile(e,{create:!0},function(t){t.createWriter(function(e){var i=new DataView(n),r=new Blob([i],{type:"font/opentype"});e.write(r),e.addEventListener("writeend",function(){location.href=t.toURL()},!1)})})},function(t){throw new Error(t.name+": "+t.message)});else{var o=t("fs"),s=l.arrayBufferToNodeBuffer(n);o.writeFileSync(e,s)}},r.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},r.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},r.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},i.Font=r},{"./encoding":11,"./glyphset":14,"./hintingtt":15,"./path":19,"./substitution":20,"./tables/sfnt":39,"./util":41,fs:2}],13:[function(t,e,i){"use strict";function r(t,e){var i=e||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof i&&(i=i()),i},set:function(t){i=t}}}function n(t){this.bindConstructorValues(t)}var o=t("./check"),s=t("./draw"),a=t("./path"),h=t("./tables/glyf");n.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],t.xMin&&(this.xMin=t.xMin),t.yMin&&(this.yMin=t.yMin),t.xMax&&(this.xMax=t.xMax),t.yMax&&(this.yMax=t.yMax),t.advanceWidth&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",r(this,t.path))},n.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},n.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},n.prototype.getPath=function(t,e,i,r,n){t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:72;var o,s;r||(r={});var l=r.xScale,u=r.yScale;if(r.hinting&&n&&n.hinting&&(s=this.path&&n.hinting.exec(this,i)),s)o=h.getPath(s).commands,t=Math.round(t),e=Math.round(e),l=u=1;else{o=this.path.commands;var p=1/this.path.unitsPerEm*i;void 0===l&&(l=p),void 0===u&&(u=p)}for(var c=new a.Path,f=0;f<o.length;f+=1){var d=o[f];"M"===d.type?c.moveTo(t+d.x*l,e+-d.y*u):"L"===d.type?c.lineTo(t+d.x*l,e+-d.y*u):"Q"===d.type?c.quadraticCurveTo(t+d.x1*l,e+-d.y1*u,t+d.x*l,e+-d.y*u):"C"===d.type?c.curveTo(t+d.x1*l,e+-d.y1*u,t+d.x2*l,e+-d.y2*u,t+d.x*l,e+-d.y*u):"Z"===d.type&&c.closePath()}return c},n.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],i=0;i<this.points.length;i+=1){var r=this.points[i];e.push(r),r.lastPointOfContour&&(t.push(e),e=[])}return o.argument(0===e.length,"There are still points left in the current contour."),t},n.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],i=[],r=0;r<t.length;r+=1){var n=t[r];"Z"!==n.type&&(e.push(n.x),i.push(n.y)),"Q"!==n.type&&"C"!==n.type||(e.push(n.x1),i.push(n.y1)),"C"===n.type&&(e.push(n.x2),i.push(n.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,i),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},n.prototype.draw=function(t,e,i,r,n){this.getPath(e,i,r,n).draw(t)},n.prototype.drawPoints=function(t,e,i,r){function n(e,i,r,n){var o=2*Math.PI;t.beginPath();for(var s=0;s<e.length;s+=1)t.moveTo(i+e[s].x*n,r+e[s].y*n),t.arc(i+e[s].x*n,r+e[s].y*n,2,0,o,!1);t.closePath(),t.fill()}e=void 0!==e?e:0,i=void 0!==i?i:0,r=void 0!==r?r:24;for(var o=1/this.path.unitsPerEm*r,s=[],a=[],h=this.path,l=0;l<h.commands.length;l+=1){var u=h.commands[l];void 0!==u.x&&s.push({x:u.x,y:-u.y}),void 0!==u.x1&&a.push({x:u.x1,y:-u.y1}),void 0!==u.x2&&a.push({x:u.x2,y:-u.y2})}t.fillStyle="blue",n(s,e,i,o),t.fillStyle="red",n(a,e,i,o)},n.prototype.drawMetrics=function(t,e,i,r){var n;e=void 0!==e?e:0,i=void 0!==i?i:0,r=void 0!==r?r:24,n=1/this.path.unitsPerEm*r,t.lineWidth=1,t.strokeStyle="black",s.line(t,e,-1e4,e,1e4),s.line(t,-1e4,i,1e4,i);var o=this.xMin||0,a=this.yMin||0,h=this.xMax||0,l=this.yMax||0,u=this.advanceWidth||0;t.strokeStyle="blue",s.line(t,e+o*n,-1e4,e+o*n,1e4),s.line(t,e+h*n,-1e4,e+h*n,1e4),s.line(t,-1e4,i+-a*n,1e4,i+-a*n),s.line(t,-1e4,i+-l*n,1e4,i+-l*n),t.strokeStyle="green",s.line(t,e+u*n,-1e4,e+u*n,1e4)},i.Glyph=n},{"./check":9,"./draw":10,"./path":19,"./tables/glyf":25}],14:[function(t,e,i){"use strict";function r(t,e,i){Object.defineProperty(t,e,{get:function(){return t.path,t[i]},set:function(e){t[i]=e},enumerable:!0,configurable:!0})}function n(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var i=0;i<e.length;i++)this.glyphs[i]=e[i];this.length=e&&e.length||0}function o(t,e){return new h.Glyph({index:e,font:t})}function s(t,e,i,n,o,s){return function(){var a=new h.Glyph({index:e,font:t});return a.path=function(){i(a,n,o);var e=s(t.glyphs,a);return e.unitsPerEm=t.unitsPerEm,e},r(a,"xMin","_xMin"),r(a,"xMax","_xMax"),r(a,"yMin","_yMin"),r(a,"yMax","_yMax"),a}}function a(t,e,i,r){return function(){var n=new h.Glyph({index:e,font:t});return n.path=function(){var e=i(t,n,r);return e.unitsPerEm=t.unitsPerEm,e},n}}var h=t("./glyph");n.prototype.get=function(t){return"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]()),this.glyphs[t]},n.prototype.push=function(t,e){this.glyphs[t]=e,this.length++},i.GlyphSet=n,i.glyphLoader=o,i.ttfGlyphLoader=s,i.cffGlyphLoader=a},{"./glyph":13}],15:[function(t,e,i){"use strict";function r(t){this.font=t,this._fpgmState=this._prepState=void 0,this._errorState=0}function n(t){return t}function o(t){return Math.sign(t)*Math.round(Math.abs(t))}function s(t){return Math.sign(t)*Math.round(Math.abs(2*t))/2}function a(t){return Math.sign(t)*(Math.round(Math.abs(t)+.5)-.5)}function h(t){return Math.sign(t)*Math.ceil(Math.abs(t))}function l(t){return Math.sign(t)*Math.floor(Math.abs(t))}function u(t,e){this.x=t,this.y=e,this.axis=void 0,this.slope=e/t,this.normalSlope=-t/e,Object.freeze(this)}function p(t,e){var i=Math.sqrt(t*t+e*e);return t/=i,e/=i,1===t&&0===e?fe:0===t&&1===e?de:new u(t,e)}function c(t,e,i,r){this.x=this.xo=Math.round(64*t)/64,this.y=this.yo=Math.round(64*e)/64,this.lastPointOfContour=i,this.onCurve=r,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}function f(t,e){switch(this.env=t,this.stack=[],this.prog=e,t){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=fe,this.round=o}}function d(t,e){var i,r,n,o=e.ppem/e.font.unitsPerEm,s=o,a=t.components;if(f.prototype=e,a){var h=e.font;r=[],i=[];for(var l=0;l<a.length;l++){var u=a[l],p=h.glyphs.get(u.glyphIndex);n=new f("glyf",p.instructions),pe&&(console.log("---EXEC COMP "+l+"---"),n.step=-1),y(p,n,o,s);for(var d=Math.round(u.dx*o),g=Math.round(u.dy*s),v=n.gZone,_=n.contours,b=0;b<v.length;b++){var w=v[b];w.xTouched=w.yTouched=!1,w.xo=w.x=w.x+d,w.yo=w.y=w.y+g}var x=r.length;r.push.apply(r,v);for(var S=0;S<_.length;S++)i.push(_[S]+x)}t.instructions&&!n.inhibitGridFit&&(n=new f("glyf",t.instructions),n.gZone=n.z0=n.z1=n.z2=r,n.contours=i,r.push(new c(0,0),new c(Math.round(t.advanceWidth*o),0)),pe&&(console.log("---EXEC COMPOSITE---"),n.step=-1),m(n),r.length-=2)}else n=new f("glyf",t.instructions),pe&&(console.log("---EXEC GLYPH---"),n.step=-1),y(t,n,o,s),r=n.gZone;return r}function y(t,e,i,r){var n,o,s=t.points||[],a=s.length,h=e.gZone=e.z0=e.z1=e.z2=[],l=e.contours=[];for(n=0;n<a;n++)o=s[n],h[n]=new c(o.x*i,o.y*r,o.lastPointOfContour,o.onCurve);var u,p;for(n=0;n<a;n++)o=h[n],u||(u=o,l.push(n)),o.lastPointOfContour?(o.nextPointOnContour=u,u.prevPointOnContour=o,u=void 0):(p=h[n+1],o.nextPointOnContour=p,p.prevPointOnContour=o);if(!e.inhibitGridFit&&(h.push(new c(0,0),new c(Math.round(t.advanceWidth*i),0)),m(e),h.length-=2,pe))for(console.log("FINISHED GLYPH",e.stack),n=0;n<a;n++)console.log(n,h[n].x,h[n].y)}function m(t){var e=t.prog;if(e){var i,r=e.length;for(t.ip=0;t.ip<r;t.ip++){if(pe&&t.step++,!(i=ue[e[t.ip]]))throw new Error("unknown instruction: 0x"+Number(e[t.ip]).toString(16));i(t)}}}function g(t){for(var e=t.tZone=new Array(t.gZone.length),i=0;i<e.length;i++)e[i]=new c(0,0)}function v(t,e){var i,r=t.prog,n=t.ip,o=1;do{if(88===(i=r[++n]))o++;else if(89===i)o--;else if(64===i)n+=r[n+1]+1;else if(65===i)n+=2*r[n+1]+1;else if(i>=176&&i<=183)n+=i-176+1;else if(i>=184&&i<=191)n+=2*(i-184+1);else if(e&&1===o&&27===i)break}while(o>0);t.ip=n}function _(t,e){pe&&console.log(e.step,"SVTCA["+t.axis+"]"),e.fv=e.pv=e.dpv=t}function b(t,e){pe&&console.log(e.step,"SPVTCA["+t.axis+"]"),e.pv=e.dpv=t}function w(t,e){pe&&console.log(e.step,"SFVTCA["+t.axis+"]"),e.fv=t}function x(t,e){var i=e.stack,r=i.pop(),n=i.pop(),o=e.z2[r],s=e.z1[n];pe&&console.log("SPVTL["+t+"]",r,n);var a,h;t?(a=o.y-s.y,h=s.x-o.x):(a=s.x-o.x,h=s.y-o.y),e.pv=e.dpv=p(a,h)}function S(t,e){var i=e.stack,r=i.pop(),n=i.pop(),o=e.z2[r],s=e.z1[n];pe&&console.log("SFVTL["+t+"]",r,n);var a,h;t?(a=o.y-s.y,h=s.x-o.x):(a=s.x-o.x,h=s.y-o.y),e.fv=p(a,h)}function T(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"SPVFS[]",i,r),t.pv=t.dpv=p(r,i)}function E(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"SPVFS[]",i,r),t.fv=p(r,i)}function P(t){var e=t.stack,i=t.pv;pe&&console.log(t.step,"GPV[]"),e.push(16384*i.x),e.push(16384*i.y)}function O(t){var e=t.stack,i=t.fv;pe&&console.log(t.step,"GFV[]"),e.push(16384*i.x),e.push(16384*i.y)}function M(t){t.fv=t.pv,pe&&console.log(t.step,"SFVTPV[]")}function A(t){var e=t.stack,i=e.pop(),r=e.pop(),n=e.pop(),o=e.pop(),s=e.pop(),a=t.z0,h=t.z1,l=a[i],u=a[r],p=h[n],c=h[o],f=t.z2[s];pe&&console.log("ISECT[], ",i,r,n,o,s);var d=l.x,y=l.y,m=u.x,g=u.y,v=p.x,_=p.y,b=c.x,w=c.y,x=(d-m)*(_-w)-(y-g)*(v-b),S=d*g-y*m,T=v*w-_*b;f.x=(S*(v-b)-T*(d-m))/x,f.y=(S*(_-w)-T*(y-g))/x}function R(t){t.rp0=t.stack.pop(),pe&&console.log(t.step,"SRP0[]",t.rp0)}function C(t){t.rp1=t.stack.pop(),pe&&console.log(t.step,"SRP1[]",t.rp1)}function k(t){t.rp2=t.stack.pop(),pe&&console.log(t.step,"SRP2[]",t.rp2)}function F(t){var e=t.stack.pop();switch(pe&&console.log(t.step,"SZP0[]",e),t.zp0=e,e){case 0:t.tZone||g(t),t.z0=t.tZone;break;case 1:t.z0=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function L(t){var e=t.stack.pop();switch(pe&&console.log(t.step,"SZP1[]",e),t.zp1=e,e){case 0:t.tZone||g(t),t.z1=t.tZone;break;case 1:t.z1=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function I(t){var e=t.stack.pop();switch(pe&&console.log(t.step,"SZP2[]",e),t.zp2=e,e){case 0:t.tZone||g(t),t.z2=t.tZone;break;case 1:t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function D(t){var e=t.stack.pop();switch(pe&&console.log(t.step,"SZPS[]",e),t.zp0=t.zp1=t.zp2=e,e){case 0:t.tZone||g(t),t.z0=t.z1=t.z2=t.tZone;break;case 1:t.z0=t.z1=t.z2=t.gZone;break;default:throw new Error("Invalid zone pointer")}}function U(t){t.loop=t.stack.pop(),pe&&console.log(t.step,"SLOOP[]",t.loop)}function B(t){pe&&console.log(t.step,"RTG[]"),t.round=o}function N(t){pe&&console.log(t.step,"RTHG[]"),t.round=a}function q(t){var e=t.stack.pop();pe&&console.log(t.step,"SMD[]",e),t.minDis=e/64}function G(t){pe&&console.log(t.step,"ELSE[]"),v(t,!1)}function j(t){var e=t.stack.pop();pe&&console.log(t.step,"JMPR[]",e),t.ip+=e-1}function V(t){var e=t.stack.pop();pe&&console.log(t.step,"SCVTCI[]",e),t.cvCutIn=e/64}function z(t){var e=t.stack;pe&&console.log(t.step,"DUP[]"),e.push(e[e.length-1])}function H(t){pe&&console.log(t.step,"POP[]"),t.stack.pop()}function W(t){pe&&console.log(t.step,"CLEAR[]"),t.stack.length=0}function X(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"SWAP[]"),e.push(i),e.push(r)}function Y(t){var e=t.stack;pe&&console.log(t.step,"DEPTH[]"),e.push(e.length)}function Z(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"LOOPCALL[]",i,r);var n=t.ip,o=t.prog;t.prog=t.funcs[i];for(var s=0;s<r;s++)m(t),pe&&console.log(++t.step,s+1<r?"next loopcall":"done loopcall",s);t.ip=n,t.prog=o}function Q(t){var e=t.stack.pop();pe&&console.log(t.step,"CALL[]",e);var i=t.ip,r=t.prog;t.prog=t.funcs[e],m(t),t.ip=i,t.prog=r,pe&&console.log(++t.step,"returning from",e)}function J(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"CINDEX[]",i),e.push(e[e.length-i])}function $(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"MINDEX[]",i),e.push(e.splice(e.length-i,1)[0])}function K(t){if("fpgm"!==t.env)throw new Error("FDEF not allowed here");var e=t.stack,i=t.prog,r=t.ip,n=e.pop(),o=r;for(pe&&console.log(t.step,"FDEF[]",n);45!==i[++r];);t.ip=r,t.funcs[n]=i.slice(o+1,r)}function tt(t,e){var i=e.stack.pop(),r=e.z0[i],n=e.fv,o=e.pv;pe&&console.log(e.step,"MDAP["+t+"]",i);var s=o.distance(r,ye);t&&(s=e.round(s)),n.setRelative(r,ye,s,o),n.touch(r),e.rp0=e.rp1=i}function et(t,e){var i,r,n,o=e.z2,s=o.length-2;pe&&console.log(e.step,"IUP["+t.axis+"]");for(var a=0;a<s;a++)i=o[a],t.touched(i)||(r=i.prevTouched(t))!==i&&(n=i.nextTouched(t),r===n&&t.setRelative(i,i,t.distance(r,r,!1,!0),t,!0),t.interpolate(i,r,n,t))}function it(t,e){for(var i=e.stack,r=t?e.rp1:e.rp2,n=(t?e.z0:e.z1)[r],o=e.fv,s=e.pv,a=e.loop,h=e.z2;a--;){var l=i.pop(),u=h[l],p=s.distance(n,n,!1,!0);o.setRelative(u,u,p,s),o.touch(u),pe&&console.log(e.step,(e.loop>1?"loop "+(e.loop-a)+": ":"")+"SHP["+(t?"rp1":"rp2")+"]",l)}e.loop=1}function rt(t,e){var i=e.stack,r=t?e.rp1:e.rp2,n=(t?e.z0:e.z1)[r],o=e.fv,s=e.pv,a=i.pop(),h=e.z2[e.contours[a]],l=h;pe&&console.log(e.step,"SHC["+t+"]",a);var u=s.distance(n,n,!1,!0);do{l!==n&&o.setRelative(l,l,u,s),l=l.nextPointOnContour}while(l!==h)}function nt(t,e){var i=e.stack,r=t?e.rp1:e.rp2,n=(t?e.z0:e.z1)[r],o=e.fv,s=e.pv,a=i.pop();pe&&console.log(e.step,"SHZ["+t+"]",a);var h;switch(a){case 0:h=e.tZone;break;case 1:h=e.gZone;break;default:throw new Error("Invalid zone")}for(var l,u=s.distance(n,n,!1,!0),p=h.length-2,c=0;c<p;c++)(l=h[c])!==n&&o.setRelative(l,l,u,s)}function ot(t){for(var e=t.stack,i=t.loop,r=t.fv,n=e.pop()/64,o=t.z2;i--;){var s=e.pop(),a=o[s];pe&&console.log(t.step,(t.loop>1?"loop "+(t.loop-i)+": ":"")+"SHPIX[]",s,n),r.setRelative(a,a,n),r.touch(a)}t.loop=1}function st(t){for(var e=t.stack,i=t.rp1,r=t.rp2,n=t.loop,o=t.z0[i],s=t.z1[r],a=t.fv,h=t.dpv,l=t.z2;n--;){var u=e.pop(),p=l[u];pe&&console.log(t.step,(t.loop>1?"loop "+(t.loop-n)+": ":"")+"IP[]",u,i,"<->",r),a.interpolate(p,o,s,h),a.touch(p)}t.loop=1}function at(t,e){var i=e.stack,r=i.pop()/64,n=i.pop(),o=e.z1[n],s=e.z0[e.rp0],a=e.fv,h=e.pv;a.setRelative(o,s,r,h),a.touch(o),pe&&console.log(e.step,"MSIRP["+t+"]",r,n),e.rp1=e.rp0,e.rp2=n,t&&(e.rp0=n)}function ht(t){for(var e=t.stack,i=t.rp0,r=t.z0[i],n=t.loop,o=t.fv,s=t.pv,a=t.z1;n--;){var h=e.pop(),l=a[h];pe&&console.log(t.step,(t.loop>1?"loop "+(t.loop-n)+": ":"")+"ALIGNRP[]",h),o.setRelative(l,r,0,s),o.touch(l)}t.loop=1}function lt(t){pe&&console.log(t.step,"RTDG[]"),t.round=s}function ut(t,e){var i=e.stack,r=i.pop(),n=i.pop(),o=e.z0[n],s=e.fv,a=e.pv,h=e.cvt[r];t&&(h=e.round(h)),pe&&console.log(e.step,"MIAP["+t+"]",r,"(",h,")",n),s.setRelative(o,ye,h,a),0===e.zp0&&(o.xo=o.x,o.yo=o.y),s.touch(o),e.rp0=e.rp1=n}function pt(t){var e=t.prog,i=t.ip,r=t.stack,n=e[++i];pe&&console.log(t.step,"NPUSHB[]",n);for(var o=0;o<n;o++)r.push(e[++i]);t.ip=i}function ct(t){var e=t.ip,i=t.prog,r=t.stack,n=i[++e];pe&&console.log(t.step,"NPUSHW[]",n);for(var o=0;o<n;o++){var s=i[++e]<<8|i[++e];32768&s&&(s=-(1+(65535^s))),r.push(s)}t.ip=e}function ft(t){var e=t.stack,i=t.store;i||(i=t.store=[]);var r=e.pop(),n=e.pop();pe&&console.log(t.step,"WS",r,n),i[n]=r}function dt(t){var e=t.stack,i=t.store,r=e.pop();pe&&console.log(t.step,"RS",r);var n=i&&i[r]||0;e.push(n)}function yt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"WCVTP",i,r),t.cvt[r]=i/64}function mt(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"RCVT",i),e.push(64*t.cvt[i])}function gt(t,e){var i=e.stack,r=i.pop(),n=e.z2[r];pe&&console.log(e.step,"GC["+t+"]",r),i.push(64*e.dpv.distance(n,ye,t,!1))}function vt(t,e){var i=e.stack,r=i.pop(),n=i.pop(),o=e.z1[r],s=e.z0[n],a=e.dpv.distance(s,o,t,t);pe&&console.log(e.step,"MD["+t+"]",r,n,"->",a),e.stack.push(Math.round(64*a))}function _t(t){pe&&console.log(t.step,"MPPEM[]"),t.stack.push(t.ppem)}function bt(t){pe&&console.log(t.step,"FLIPON[]"),t.autoFlip=!0}function wt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"LT[]",i,r),e.push(r<i?1:0)}function xt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"LTEQ[]",i,r),e.push(r<=i?1:0)}function St(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"GT[]",i,r),e.push(r>i?1:0)}function Tt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"GTEQ[]",i,r),e.push(r>=i?1:0)}function Et(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"EQ[]",i,r),e.push(i===r?1:0)}function Pt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"NEQ[]",i,r),e.push(i!==r?1:0)}function Ot(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"ODD[]",i),e.push(Math.trunc(i)%2?1:0)}function Mt(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"EVEN[]",i),e.push(Math.trunc(i)%2?0:1)}function At(t){var e=t.stack.pop();pe&&console.log(t.step,"IF[]",e),e||(v(t,!0),pe&&console.log(t.step,"EIF[]"))}function Rt(t){pe&&console.log(t.step,"EIF[]")}function Ct(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"AND[]",i,r),e.push(i&&r?1:0)}function kt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"OR[]",i,r),e.push(i||r?1:0)}function Ft(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"NOT[]",i),e.push(i?0:1)}function Lt(t,e){var i=e.stack,r=i.pop(),n=e.fv,o=e.pv,s=e.ppem,a=e.deltaBase+16*(t-1),h=e.deltaShift,l=e.z0;pe&&console.log(e.step,"DELTAP["+t+"]",r,i);for(var u=0;u<r;u++){var p=i.pop(),c=i.pop();if(a+((240&c)>>4)===s){var f=(15&c)-8;f>=0&&f++,pe&&console.log(e.step,"DELTAPFIX",p,"by",f*h);var d=l[p];n.setRelative(d,d,f*h,o)}}}function It(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"SDB[]",i),t.deltaBase=i}function Dt(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"SDS[]",i),t.deltaShift=Math.pow(.5,i)}function Ut(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"ADD[]",i,r),e.push(r+i)}function Bt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"SUB[]",i,r),e.push(r-i)}function Nt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"DIV[]",i,r),e.push(64*r/i)}function qt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"MUL[]",i,r),e.push(r*i/64)}function Gt(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"ABS[]",i),e.push(Math.abs(i))}function jt(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"NEG[]",i),e.push(-i)}function Vt(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"FLOOR[]",i),e.push(64*Math.floor(i/64))}function zt(t){var e=t.stack,i=e.pop();pe&&console.log(t.step,"CEILING[]",i),e.push(64*Math.ceil(i/64))}function Ht(t,e){var i=e.stack,r=i.pop();pe&&console.log(e.step,"ROUND[]"),i.push(64*e.round(r/64))}function Wt(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"WCVTF[]",i,r),t.cvt[r]=i*t.ppem/t.font.unitsPerEm}function Xt(t,e){var i=e.stack,r=i.pop(),n=e.ppem,o=e.deltaBase+16*(t-1),s=e.deltaShift;pe&&console.log(e.step,"DELTAC["+t+"]",r,i);for(var a=0;a<r;a++){var h=i.pop(),l=i.pop();if(o+((240&l)>>4)===n){var u=(15&l)-8;u>=0&&u++;var p=u*s;pe&&console.log(e.step,"DELTACFIX",h,"by",p),e.cvt[h]+=p}}}function Yt(t){var e=t.stack.pop();pe&&console.log(t.step,"SROUND[]",e),t.round=ce;var i;switch(192&e){case 0:i=.5;break;case 64:i=1;break;case 128:i=2;break;default:throw new Error("invalid SROUND value")}switch(t.srPeriod=i,48&e){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*i;break;case 32:t.srPhase=.5*i;break;case 48:t.srPhase=.75*i;break;default:throw new Error("invalid SROUND value")}e&=15,t.srThreshold=0===e?0:(e/8-.5)*i}function Zt(t){var e=t.stack.pop();pe&&console.log(t.step,"S45ROUND[]",e),t.round=ce;var i;switch(192&e){case 0:i=Math.sqrt(2)/2;break;case 64:i=Math.sqrt(2);break;case 128:i=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(t.srPeriod=i,48&e){case 0:t.srPhase=0;break;case 16:t.srPhase=.25*i;break;case 32:t.srPhase=.5*i;break;case 48:t.srPhase=.75*i;break;default:throw new Error("invalid S45ROUND value")}e&=15,t.srThreshold=0===e?0:(e/8-.5)*i}function Qt(t){pe&&console.log(t.step,"ROFF[]"),t.round=n}function Jt(t){pe&&console.log(t.step,"RUTG[]"),t.round=h}function $t(t){pe&&console.log(t.step,"RDTG[]"),t.round=l}function Kt(t){var e=t.stack.pop();pe&&console.log(t.step,"SCANCTRL[]",e)}function te(t,e){var i=e.stack,r=i.pop(),n=i.pop(),o=e.z2[r],s=e.z1[n];pe&&console.log("SDPVTL["+t+"]",r,n);var a,h;t?(a=o.y-s.y,h=s.x-o.x):(a=s.x-o.x,h=s.y-o.y),e.dpv=p(a,h)}function ee(t){var e=t.stack,i=e.pop(),r=0;pe&&console.log(t.step,"GETINFO[]",i),1&i&&(r=35),32&i&&(r|=4096),e.push(r)}function ie(t){var e=t.stack,i=e.pop(),r=e.pop(),n=e.pop();pe&&console.log(t.step,"ROLL[]"),e.push(r),e.push(i),e.push(n)}function re(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"MAX[]",i,r),e.push(Math.max(r,i))}function ne(t){var e=t.stack,i=e.pop(),r=e.pop();pe&&console.log(t.step,"MIN[]",i,r),e.push(Math.min(r,i))}function oe(t){var e=t.stack.pop();pe&&console.log(t.step,"SCANTYPE[]",e)}function se(t){var e=t.stack.pop(),i=t.stack.pop();switch(pe&&console.log(t.step,"INSTCTRL[]",e,i),e){case 1:return void(t.inhibitGridFit=!!i);case 2:return void(t.ignoreCvt=!!i);default:throw new Error("invalid INSTCTRL[] selector")}}function ae(t,e){var i=e.stack,r=e.prog,n=e.ip;pe&&console.log(e.step,"PUSHB["+t+"]");for(var o=0;o<t;o++)i.push(r[++n]);e.ip=n}function he(t,e){var i=e.ip,r=e.prog,n=e.stack;pe&&console.log(e.ip,"PUSHW["+t+"]");for(var o=0;o<t;o++){var s=r[++i]<<8|r[++i];32768&s&&(s=-(1+(65535^s))),n.push(s)}e.ip=i}function le(t,e,i,r,n,o){var s,a,h,l,u=o.stack,p=t&&u.pop(),c=u.pop(),f=o.rp0,d=o.z0[f],y=o.z1[c],m=o.minDis,g=o.fv,v=o.dpv;a=s=v.distance(y,d,!0,!0),h=a>=0?1:-1,a=Math.abs(a),t&&(l=o.cvt[p],r&&Math.abs(a-l)<o.cvCutIn&&(a=l)),i&&a<m&&(a=m),r&&(a=o.round(a)),g.setRelative(y,d,h*a,v),g.touch(y),pe&&console.log(o.step,(t?"MIRP[":"MDRP[")+(e?"M":"m")+(i?">":"_")+(r?"R":"_")+(0===n?"Gr":1===n?"Bl":2===n?"Wh":"")+"]",t?p+"("+o.cvt[p]+","+l+")":"",c,"(d =",s,"->",h*a,")"),o.rp1=o.rp0,o.rp2=c,e&&(o.rp0=c)}var ue,m,y,d,pe=!1,ce=function(t){var e=this.srPeriod,i=this.srPhase,r=this.srThreshold,n=1;return t<0&&(t=-t,n=-1),t+=r-i,t=Math.trunc(t/e)*e,t+=i,n>0&&t<0?i:n<0&&t>0?-i:t*n},fe={x:1,y:0,axis:"x",distance:function(t,e,i,r){return(i?t.xo:t.x)-(r?e.xo:e.x)},interpolate:function(t,e,i,r){var n,o,s,a,h,l,u;return r&&r!==this?(n=r.distance(t,e,!0,!0),o=r.distance(t,i,!0,!0),h=r.distance(e,e,!1,!0),l=r.distance(i,i,!1,!0),s=Math.abs(n),a=Math.abs(o),0===(u=s+a)?void fe.setRelative(t,t,(h+l)/2,r,!0):void fe.setRelative(t,t,(h*a+l*s)/u,r,!0)):(n=t.xo-e.xo,o=t.xo-i.xo,h=e.x-e.xo,l=i.x-i.xo,s=Math.abs(n),a=Math.abs(o),0===(u=s+a)?void(t.x=t.xo+(h+l)/2):void(t.x=t.xo+(h*a+l*s)/u))},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(t,e,i,r,n){if(!r||r===this)return void(t.x=(n?e.xo:e.x)+i);var o=n?e.xo:e.x,s=n?e.yo:e.y,a=o+i*r.x,h=s+i*r.y;t.x=a+(t.y-h)/r.normalSlope},slope:0,touch:function(t){t.xTouched=!0},touched:function(t){return t.xTouched},untouch:function(t){t.xTouched=!1}},de={x:0,y:1,axis:"y",distance:function(t,e,i,r){return(i?t.yo:t.y)-(r?e.yo:e.y)},interpolate:function(t,e,i,r){var n,o,s,a,h,l,u;return r&&r!==this?(n=r.distance(t,e,!0,!0),o=r.distance(t,i,!0,!0),h=r.distance(e,e,!1,!0),l=r.distance(i,i,!1,!0),s=Math.abs(n),a=Math.abs(o),0===(u=s+a)?void de.setRelative(t,t,(h+l)/2,r,!0):void de.setRelative(t,t,(h*a+l*s)/u,r,!0)):(n=t.yo-e.yo,o=t.yo-i.yo,h=e.y-e.yo,l=i.y-i.yo,s=Math.abs(n),a=Math.abs(o),0===(u=s+a)?void(t.y=t.yo+(h+l)/2):void(t.y=t.yo+(h*a+l*s)/u))},normalSlope:0,setRelative:function(t,e,i,r,n){if(!r||r===this)return void(t.y=(n?e.yo:e.y)+i);var o=n?e.xo:e.x,s=n?e.yo:e.y,a=o+i*r.x,h=s+i*r.y;t.y=h+r.normalSlope*(t.x-a)},slope:Number.POSITIVE_INFINITY,touch:function(t){t.yTouched=!0},touched:function(t){return t.yTouched},untouch:function(t){t.yTouched=!1}};Object.freeze(fe),Object.freeze(de),u.prototype.distance=function(t,e,i,r){return this.x*fe.distance(t,e,i,r)+this.y*de.distance(t,e,i,r)},u.prototype.interpolate=function(t,e,i,r){var n,o,s,a,h,l,u;if(s=r.distance(t,e,!0,!0),a=r.distance(t,i,!0,!0),n=r.distance(e,e,!1,!0),o=r.distance(i,i,!1,!0),h=Math.abs(s),l=Math.abs(a),0===(u=h+l))return void this.setRelative(t,t,(n+o)/2,r,!0);this.setRelative(t,t,(n*l+o*h)/u,r,!0)},u.prototype.setRelative=function(t,e,i,r,n){r=r||this;var o=n?e.xo:e.x,s=n?e.yo:e.y,a=o+i*r.x,h=s+i*r.y,l=r.normalSlope,u=this.slope,p=t.x,c=t.y;t.x=(u*p-l*a+h-c)/(u-l),t.y=u*(t.x-p)+c},u.prototype.touch=function(t){t.xTouched=!0,t.yTouched=!0},c.prototype.nextTouched=function(t){for(var e=this.nextPointOnContour;!t.touched(e)&&e!==this;)e=e.nextPointOnContour;return e},c.prototype.prevTouched=function(t){for(var e=this.prevPointOnContour;!t.touched(e)&&e!==this;)e=e.prevPointOnContour;return e};var ye=Object.freeze(new c(0,0)),me={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};r.prototype.exec=function(t,e){if("number"!=typeof e)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var i=this.font,r=this._prepState;if(!r||r.ppem!==e){var n=this._fpgmState;if(!n){f.prototype=me,n=this._fpgmState=new f("fpgm",i.tables.fpgm),n.funcs=[],n.font=i,pe&&(console.log("---EXEC FPGM---"),n.step=-1);try{m(n)}catch(t){return console.log("Hinting error in FPGM:"+t),void(this._errorState=3)}}f.prototype=n,r=this._prepState=new f("prep",i.tables.prep),r.ppem=e;var o=i.tables.cvt;if(o)for(var s=r.cvt=new Array(o.length),a=e/i.unitsPerEm,h=0;h<o.length;h++)s[h]=o[h]*a;else r.cvt=[];pe&&(console.log("---EXEC PREP---"),r.step=-1);try{m(r)}catch(t){this._errorState<2&&console.log("Hinting error in PREP:"+t),this._errorState=2}}if(!(this._errorState>1))try{return d(t,r)}catch(t){return this._errorState<1&&(console.log("Hinting error:"+t),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},ue=[_.bind(void 0,de),_.bind(void 0,fe),b.bind(void 0,de),b.bind(void 0,fe),w.bind(void 0,de),w.bind(void 0,fe),x.bind(void 0,0),x.bind(void 0,1),S.bind(void 0,0),S.bind(void 0,1),T,E,P,O,M,A,R,C,k,F,L,I,D,U,B,N,q,G,j,V,void 0,void 0,z,H,W,X,Y,J,$,void 0,void 0,void 0,Z,Q,K,void 0,tt.bind(void 0,0),tt.bind(void 0,1),et.bind(void 0,de),et.bind(void 0,fe),it.bind(void 0,0),it.bind(void 0,1),rt.bind(void 0,0),rt.bind(void 0,1),nt.bind(void 0,0),nt.bind(void 0,1),ot,st,at.bind(void 0,0),at.bind(void 0,1),ht,lt,ut.bind(void 0,0),ut.bind(void 0,1),pt,ct,ft,dt,yt,mt,gt.bind(void 0,0),gt.bind(void 0,1),void 0,vt.bind(void 0,0),vt.bind(void 0,1),_t,void 0,bt,void 0,void 0,wt,xt,St,Tt,Et,Pt,Ot,Mt,At,Rt,Ct,kt,Ft,Lt.bind(void 0,1),It,Dt,Ut,Bt,Nt,qt,Gt,jt,Vt,zt,Ht.bind(void 0,0),Ht.bind(void 0,1),Ht.bind(void 0,2),Ht.bind(void 0,3),void 0,void 0,void 0,void 0,Wt,Lt.bind(void 0,2),Lt.bind(void 0,3),Xt.bind(void 0,1),Xt.bind(void 0,2),Xt.bind(void 0,3),Yt,Zt,void 0,void 0,Qt,void 0,Jt,$t,H,H,void 0,void 0,void 0,void 0,void 0,Kt,te.bind(void 0,0),te.bind(void 0,1),ee,void 0,ie,re,ne,oe,se,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ae.bind(void 0,1),ae.bind(void 0,2),ae.bind(void 0,3),ae.bind(void 0,4),ae.bind(void 0,5),ae.bind(void 0,6),ae.bind(void 0,7),ae.bind(void 0,8),he.bind(void 0,1),he.bind(void 0,2),he.bind(void 0,3),he.bind(void 0,4),he.bind(void 0,5),he.bind(void 0,6),he.bind(void 0,7),he.bind(void 0,8),le.bind(void 0,0,0,0,0,0),le.bind(void 0,0,0,0,0,1),le.bind(void 0,0,0,0,0,2),le.bind(void 0,0,0,0,0,3),le.bind(void 0,0,0,0,1,0),le.bind(void 0,0,0,0,1,1),le.bind(void 0,0,0,0,1,2),le.bind(void 0,0,0,0,1,3),le.bind(void 0,0,0,1,0,0),le.bind(void 0,0,0,1,0,1),le.bind(void 0,0,0,1,0,2),le.bind(void 0,0,0,1,0,3),le.bind(void 0,0,0,1,1,0),le.bind(void 0,0,0,1,1,1),le.bind(void 0,0,0,1,1,2),le.bind(void 0,0,0,1,1,3),le.bind(void 0,0,1,0,0,0),le.bind(void 0,0,1,0,0,1),le.bind(void 0,0,1,0,0,2),le.bind(void 0,0,1,0,0,3),le.bind(void 0,0,1,0,1,0),le.bind(void 0,0,1,0,1,1),le.bind(void 0,0,1,0,1,2),le.bind(void 0,0,1,0,1,3),le.bind(void 0,0,1,1,0,0),le.bind(void 0,0,1,1,0,1),le.bind(void 0,0,1,1,0,2),le.bind(void 0,0,1,1,0,3),le.bind(void 0,0,1,1,1,0),le.bind(void 0,0,1,1,1,1),le.bind(void 0,0,1,1,1,2),le.bind(void 0,0,1,1,1,3),le.bind(void 0,1,0,0,0,0),le.bind(void 0,1,0,0,0,1),le.bind(void 0,1,0,0,0,2),le.bind(void 0,1,0,0,0,3),le.bind(void 0,1,0,0,1,0),le.bind(void 0,1,0,0,1,1),le.bind(void 0,1,0,0,1,2),le.bind(void 0,1,0,0,1,3),le.bind(void 0,1,0,1,0,0),le.bind(void 0,1,0,1,0,1),le.bind(void 0,1,0,1,0,2),le.bind(void 0,1,0,1,0,3),le.bind(void 0,1,0,1,1,0),le.bind(void 0,1,0,1,1,1),le.bind(void 0,1,0,1,1,2),le.bind(void 0,1,0,1,1,3),le.bind(void 0,1,1,0,0,0),le.bind(void 0,1,1,0,0,1),le.bind(void 0,1,1,0,0,2),le.bind(void 0,1,1,0,0,3),le.bind(void 0,1,1,0,1,0),le.bind(void 0,1,1,0,1,1),le.bind(void 0,1,1,0,1,2),le.bind(void 0,1,1,0,1,3),le.bind(void 0,1,1,1,0,0),le.bind(void 0,1,1,1,0,1),le.bind(void 0,1,1,1,0,2),le.bind(void 0,1,1,1,0,3),le.bind(void 0,1,1,1,1,0),le.bind(void 0,1,1,1,1,1),le.bind(void 0,1,1,1,1,2),le.bind(void 0,1,1,1,1,3)],e.exports=r},{}],16:[function(t,e,i){"use strict";function r(t,e){for(var i=0,r=t.length-1;i<=r;){var n=i+r>>>1,o=t[n].tag;if(o===e)return n;o<e?i=n+1:r=n-1}return-i-1}function n(t,e){for(var i=0,r=t.length-1;i<=r;){var n=i+r>>>1,o=t[n];if(o===e)return n;o<e?i=n+1:r=n-1}return-i-1}function o(t,e){this.font=t,this.tableName=e}var s=t("./check");o.prototype={searchTag:r,binSearch:n,getTable:function(t){var e=this.font.tables[this.tableName];return!e&&t&&(e=this.font.tables[this.tableName]=this.createDefaultTable()),e},getScriptNames:function(){var t=this.getTable();return t?t.scripts.map(function(t){return t.tag}):[]},getDefaultScriptName:function(){var t=this.getTable();if(t){for(var e=!1,i=0;i<t.scripts.length;i++){var r=t.scripts[i].tag;if("DFLT"===r)return r;"latn"===r&&(e=!0)}return e?"latn":void 0}},getScriptTable:function(t,e){var i=this.getTable(e);if(i){t=t||"DFLT";var n=i.scripts,o=r(i.scripts,t);if(o>=0)return n[o].script;if(e){var s={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return n.splice(-1-o,0,s),s.script}}},getLangSysTable:function(t,e,i){var n=this.getScriptTable(t,i);if(n){if(!e||"dflt"===e||"DFLT"===e)return n.defaultLangSys;var o=r(n.langSysRecords,e);if(o>=0)return n.langSysRecords[o].langSys;if(i){var s={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return n.langSysRecords.splice(-1-o,0,s),s.langSys}}},getFeatureTable:function(t,e,i,r){var n=this.getLangSysTable(t,e,r);if(n){for(var o,a=n.featureIndexes,h=this.font.tables[this.tableName].features,l=0;l<a.length;l++)if(o=h[a[l]],o.tag===i)return o.feature;if(r){var u=h.length;return s.assert(0===u||i>=h[u-1].tag,"Features must be added in alphabetical order."),o={tag:i,feature:{params:0,lookupListIndexes:[]}},h.push(o),a.push(u),o.feature}}},getLookupTables:function(t,e,i,r,n){var o=this.getFeatureTable(t,e,i,n),s=[];if(o){for(var a,h=o.lookupListIndexes,l=this.font.tables[this.tableName].lookups,u=0;u<h.length;u++)a=l[h[u]],a.lookupType===r&&s.push(a);if(0===s.length&&n){a={lookupType:r,lookupFlag:0,subtables:[],markFilteringSet:void 0};var p=l.length;return l.push(a),h.push(p),[a]}}return s},expandCoverage:function(t){if(1===t.format)return t.glyphs;for(var e=[],i=t.ranges,r=0;r<i.length;r++)for(var n=i[r],o=n.start,s=n.end,a=o;a<=s;a++)e.push(a);return e}},e.exports=o},{"./check":9}],17:[function(t,e,i){"use strict";function r(e,i){t("fs").readFile(e,function(t,e){if(t)return i(t.message);i(null,v.nodeBufferToArrayBuffer(e))})}function n(t,e){var i=new XMLHttpRequest;i.open("get",t,!0),i.responseType="arraybuffer",i.onload=function(){return 200!==i.status?e("Font could not be loaded: "+i.statusText):e(null,i.response)},i.onerror=function(){e("Font could not be loaded")},i.send()}function o(t,e){for(var i=[],r=12,n=0;n<e;n+=1){var o=y.getTag(t,r),s=y.getULong(t,r+4),a=y.getULong(t,r+8),h=y.getULong(t,r+12);i.push({tag:o,checksum:s,offset:a,length:h,compression:!1}),r+=16}return i}function s(t,e){for(var i=[],r=44,n=0;n<e;n+=1){var o,s=y.getTag(t,r),a=y.getULong(t,r+4),h=y.getULong(t,r+8),l=y.getULong(t,r+12);o=h<l&&"WOFF",i.push({tag:s,offset:a,compression:o,compressedLength:h,originalLength:l}),r+=20}return i}function a(t,e){if("WOFF"===e.compression){var i=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),r=new Uint8Array(e.originalLength);if(p(i,r),r.byteLength!==e.originalLength)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}return{data:t,offset:e.offset}}function h(t){var e,i,r,n=new f.Font({empty:!0}),h=new DataView(t,0),l=[],u=y.getTag(h,0);if(u===String.fromCharCode(0,1,0,0)||"true"===u||"typ1"===u)n.outlinesFormat="truetype",r=y.getUShort(h,4),l=o(h,r);else if("OTTO"===u)n.outlinesFormat="cff",r=y.getUShort(h,4),l=o(h,r);else{if("wOFF"!==u)throw new Error("Unsupported OpenType signature "+u);var p=y.getTag(h,4);if(p===String.fromCharCode(0,1,0,0))n.outlinesFormat="truetype";else{if("OTTO"!==p)throw new Error("Unsupported OpenType flavor "+u);n.outlinesFormat="cff"}r=y.getUShort(h,12),l=s(h,r)}for(var d,m,g,v,D,U,B,N,q,G,j,V=0;V<r;V+=1){var z,H=l[V];switch(H.tag){case"cmap":z=a(h,H),n.tables.cmap=_.parse(z.data,z.offset),n.encoding=new c.CmapEncoding(n.tables.cmap);break;case"cvt ":z=a(h,H),j=new y.Parser(z.data,z.offset),n.tables.cvt=j.parseShortList(H.length/2);break;case"fvar":m=H;break;case"fpgm":z=a(h,H),j=new y.Parser(z.data,z.offset),n.tables.fpgm=j.parseByteList(H.length);break;case"head":z=a(h,H),n.tables.head=E.parse(z.data,z.offset),n.unitsPerEm=n.tables.head.unitsPerEm,e=n.tables.head.indexToLocFormat;break;case"hhea":z=a(h,H),n.tables.hhea=P.parse(z.data,z.offset),n.ascender=n.tables.hhea.ascender,n.descender=n.tables.hhea.descender,n.numberOfHMetrics=n.tables.hhea.numberOfHMetrics;break;case"hmtx":U=H;break;case"ltag":z=a(h,H),i=A.parse(z.data,z.offset);break;case"maxp":z=a(h,H),n.tables.maxp=C.parse(z.data,z.offset),n.numGlyphs=n.tables.maxp.numGlyphs;break;case"name":q=H;break;case"OS/2":z=a(h,H),n.tables.os2=F.parse(z.data,z.offset);break;case"post":z=a(h,H),n.tables.post=L.parse(z.data,z.offset),n.glyphNames=new c.GlyphNames(n.tables.post);break;case"prep":z=a(h,H),j=new y.Parser(z.data,z.offset),n.tables.prep=j.parseByteList(H.length);break;case"glyf":g=H;break;case"loca":N=H;break;case"CFF ":d=H;break;case"kern":B=H;break;case"GPOS":v=H;break;case"GSUB":D=H;break;case"meta":G=H}}var W=a(h,q);if(n.tables.name=k.parse(W.data,W.offset,i),n.names=n.tables.name,g&&N){var X=0===e,Y=a(h,N),Z=R.parse(Y.data,Y.offset,n.numGlyphs,X),Q=a(h,g);n.glyphs=x.parse(Q.data,Q.offset,Z,n)}else{if(!d)throw new Error("Font doesn't contain TrueType or CFF outlines.");var J=a(h,d);b.parse(J.data,J.offset,n)}var $=a(h,U);if(O.parse($.data,$.offset,n.numberOfHMetrics,n.numGlyphs,n.glyphs),c.addGlyphNames(n),B){var K=a(h,B);n.kerningPairs=M.parse(K.data,K.offset)}else n.kerningPairs={};if(v){var tt=a(h,v);S.parse(tt.data,tt.offset,n)}if(D){var et=a(h,D);n.tables.gsub=T.parse(et.data,et.offset)}if(m){var it=a(h,m);n.tables.fvar=w.parse(it.data,it.offset,n.names)}if(G){var rt=a(h,G);n.tables.meta=I.parse(rt.data,rt.offset),n.metas=n.tables.meta}return n}function l(t,e){("undefined"==typeof window?r:n)(t,function(t,i){if(t)return e(t);var r;try{r=h(i)}catch(t){return e(t,null)}return e(null,r)})}function u(e){var i=t("fs"),r=i.readFileSync(e);return h(v.nodeBufferToArrayBuffer(r))}var p=t("tiny-inflate"),c=t("./encoding"),f=t("./font"),d=t("./glyph"),y=t("./parse"),m=t("./bbox"),g=t("./path"),v=t("./util"),_=t("./tables/cmap"),b=t("./tables/cff"),w=t("./tables/fvar"),x=t("./tables/glyf"),S=t("./tables/gpos"),T=t("./tables/gsub"),E=t("./tables/head"),P=t("./tables/hhea"),O=t("./tables/hmtx"),M=t("./tables/kern"),A=t("./tables/ltag"),R=t("./tables/loca"),C=t("./tables/maxp"),k=t("./tables/name"),F=t("./tables/os2"),L=t("./tables/post"),I=t("./tables/meta");i._parse=y,i.Font=f.Font,i.Glyph=d.Glyph,i.Path=g.Path,i.BoundingBox=m.BoundingBox,i.parse=h,i.load=l,i.loadSync=u},{"./bbox":8,"./encoding":11,"./font":12,"./glyph":13,"./parse":18,"./path":19,"./tables/cff":22,"./tables/cmap":23,"./tables/fvar":24,"./tables/glyf":25,"./tables/gpos":26,"./tables/gsub":27,"./tables/head":28,"./tables/hhea":29,"./tables/hmtx":30,"./tables/kern":31,"./tables/loca":32,"./tables/ltag":33,"./tables/maxp":34,"./tables/meta":35,"./tables/name":36,"./tables/os2":37,"./tables/post":38,"./util":41,fs:2,"tiny-inflate":43}],18:[function(t,e,i){"use strict";function r(t,e){return t.getUint16(e,!1)}function n(t,e){this.data=t,this.offset=e,this.relativeOffset=0}var o=t("./check");i.getByte=function(t,e){return t.getUint8(e)},i.getCard8=i.getByte,i.getUShort=i.getCard16=r,i.getShort=function(t,e){return t.getInt16(e,!1)},i.getULong=function(t,e){return t.getUint32(e,!1)},i.getFixed=function(t,e){return t.getInt16(e,!1)+t.getUint16(e+2,!1)/65535},i.getTag=function(t,e){for(var i="",r=e;r<e+4;r+=1)i+=String.fromCharCode(t.getInt8(r));return i},i.getOffset=function(t,e,i){for(var r=0,n=0;n<i;n+=1)r<<=8,r+=t.getUint8(e+n);return r},i.getBytes=function(t,e,i){for(var r=[],n=e;n<i;n+=1)r.push(t.getUint8(n));return r},i.bytesToString=function(t){for(var e="",i=0;i<t.length;i+=1)e+=String.fromCharCode(t[i]);return e};var s={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};n.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},n.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},n.prototype.parseCard8=n.prototype.parseByte,n.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},n.prototype.parseCard16=n.prototype.parseUShort,n.prototype.parseSID=n.prototype.parseUShort,n.prototype.parseOffset16=n.prototype.parseUShort,n.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},n.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},n.prototype.parseULong=function(){var t=i.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},n.prototype.parseFixed=function(){var t=i.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},n.prototype.parseString=function(t){var e=this.data,i=this.offset+this.relativeOffset,r="";this.relativeOffset+=t;for(var n=0;n<t;n++)r+=String.fromCharCode(e.getUint8(i+n));return r},n.prototype.parseTag=function(){return this.parseString(4)},n.prototype.parseLongDateTime=function(){var t=i.getULong(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},n.prototype.parseVersion=function(){var t=r(this.data,this.offset+this.relativeOffset),e=r(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+e/4096/10},n.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=s[t]*e},n.prototype.parseOffset16List=n.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());for(var e=new Array(t),i=this.data,r=this.offset+this.relativeOffset,n=0;n<t;n++)e[n]=i.getUint16(r),r+=2;return this.relativeOffset+=2*t,e},n.prototype.parseShortList=function(t){for(var e=new Array(t),i=this.data,r=this.offset+this.relativeOffset,n=0;n<t;n++)e[n]=i.getInt16(r),r+=2;return this.relativeOffset+=2*t,e},n.prototype.parseByteList=function(t){for(var e=new Array(t),i=this.data,r=this.offset+this.relativeOffset,n=0;n<t;n++)e[n]=i.getUint8(r++);return this.relativeOffset+=t,e},n.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());for(var i=new Array(t),r=0;r<t;r++)i[r]=e.call(this);return i},n.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());for(var i=new Array(t),r=Object.keys(e),n=0;n<t;n++){for(var o={},s=0;s<r.length;s++){var a=r[s],h=e[a];o[a]=h.call(this)}i[n]=o}return i},n.prototype.parseStruct=function(t){if("function"==typeof t)return t.call(this);for(var e=Object.keys(t),i={},r=0;r<e.length;r++){var n=e[r],o=t[n];i[n]=o.call(this)}return i},n.prototype.parsePointer=function(t){var e=this.parseOffset16();if(e>0)return new n(this.data,this.offset+e).parseStruct(t)},n.prototype.parseListOfLists=function(t){for(var e=this.parseOffset16List(),i=e.length,r=this.relativeOffset,n=new Array(i),o=0;o<i;o++){var s=e[o];if(0!==s)if(this.relativeOffset=s,t){for(var a=this.parseOffset16List(),h=new Array(a.length),l=0;l<a.length;l++)this.relativeOffset=s+a[l],h[l]=t.call(this);n[o]=h}else n[o]=this.parseUShortList();else n[o]=void 0}return this.relativeOffset=r,n},n.prototype.parseCoverage=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort(),i=this.parseUShort();if(1===e)return{format:1,glyphs:this.parseUShortList(i)};if(2===e){for(var r=new Array(i),n=0;n<i;n++)r[n]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:r}}o.assert(!1,"0x"+t.toString(16)+": Coverage format must be 1 or 2.")},n.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===e?{format:2,ranges:this.parseRecordList({start:n.uShort,end:n.uShort,classId:n.uShort})}:void o.assert(!1,"0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},n.list=function(t,e){return function(){return this.parseList(t,e)}},n.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},n.pointer=function(t){return function(){return this.parsePointer(t)}},n.tag=n.prototype.parseTag,n.byte=n.prototype.parseByte,n.uShort=n.offset16=n.prototype.parseUShort,n.uShortList=n.prototype.parseUShortList,n.struct=n.prototype.parseStruct,n.coverage=n.prototype.parseCoverage,n.classDef=n.prototype.parseClassDef;var a={reserved:n.uShort,reqFeatureIndex:n.uShort,featureIndexes:n.uShortList};n.prototype.parseScriptList=function(){return this.parsePointer(n.recordList({tag:n.tag,script:n.pointer({defaultLangSys:n.pointer(a),langSysRecords:n.recordList({tag:n.tag,langSys:n.pointer(a)})})}))},n.prototype.parseFeatureList=function(){return this.parsePointer(n.recordList({tag:n.tag,feature:n.pointer({featureParams:n.offset16,lookupListIndexes:n.uShortList})}))},n.prototype.parseLookupList=function(t){return this.parsePointer(n.list(n.pointer(function(){var e=this.parseUShort();o.argument(1<=e&&e<=8,"GSUB lookup type "+e+" unknown.");var i=this.parseUShort(),r=16&i;return{lookupType:e,lookupFlag:i,subtables:this.parseList(n.pointer(t[e])),markFilteringSet:r?this.parseUShort():void 0}})))},i.Parser=n},{"./check":9}],19:[function(t,e,i){"use strict";function r(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}var n=t("./bbox");r.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},r.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},r.prototype.curveTo=r.prototype.bezierCurveTo=function(t,e,i,r,n,o){this.commands.push({type:"C",x1:t,y1:e,x2:i,y2:r,x:n,y:o})},r.prototype.quadTo=r.prototype.quadraticCurveTo=function(t,e,i,r){this.commands.push({type:"Q",x1:t,y1:e,x:i,y:r})},r.prototype.close=r.prototype.closePath=function(){this.commands.push({type:"Z"})},r.prototype.extend=function(t){if(t.commands)t=t.commands;else if(t instanceof n.BoundingBox){var e=t;return this.moveTo(e.x1,e.y1),this.lineTo(e.x2,e.y1),this.lineTo(e.x2,e.y2),this.lineTo(e.x1,e.y2),void this.close()}Array.prototype.push.apply(this.commands,t)},r.prototype.getBoundingBox=function(){for(var t=new n.BoundingBox,e=0,i=0,r=0,o=0,s=0;s<this.commands.length;s++){var a=this.commands[s];switch(a.type){case"M":t.addPoint(a.x,a.y),e=r=a.x,i=o=a.y;break;case"L":t.addPoint(a.x,a.y),r=a.x,o=a.y;break;case"Q":t.addQuad(r,o,a.x1,a.y1,a.x,a.y),r=a.x,o=a.y;break;case"C":t.addBezier(r,o,a.x1,a.y1,a.x2,a.y2,a.x,a.y),r=a.x,o=a.y;break;case"Z":r=e,o=i;break;default:throw new Error("Unexpected path commmand "+a.type)}}return t.isEmpty()&&t.addPoint(0,0),t},r.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var i=this.commands[e];"M"===i.type?t.moveTo(i.x,i.y):"L"===i.type?t.lineTo(i.x,i.y):"C"===i.type?t.bezierCurveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):"Q"===i.type?t.quadraticCurveTo(i.x1,i.y1,i.x,i.y):"Z"===i.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},r.prototype.toPathData=function(t){function e(e){return Math.round(e)===e?""+Math.round(e):e.toFixed(t)}function i(){for(var t="",i=0;i<arguments.length;i+=1){var r=arguments[i];r>=0&&i>0&&(t+=" "),t+=e(r)}return t}t=void 0!==t?t:2;for(var r="",n=0;n<this.commands.length;n+=1){var o=this.commands[n];"M"===o.type?r+="M"+i(o.x,o.y):"L"===o.type?r+="L"+i(o.x,o.y):"C"===o.type?r+="C"+i(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?r+="Q"+i(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(r+="Z")}return r},r.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},r.prototype.toDOMElement=function(t){var e=this.toPathData(t),i=document.createElementNS("http://www.w3.org/2000/svg","path");return i.setAttribute("d",e),i},i.Path=r},{"./bbox":8}],20:[function(t,e,i){"use strict";function r(t,e){var i=t.length;if(i!==e.length)return!1;for(var r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0}function n(t,e,i){for(var r=t.subtables,n=0;n<r.length;n++){var o=r[n];if(o.substFormat===e)return o}if(i)return r.push(i),i}var o=t("./check"),s=t("./layout"),a=function(t){s.call(this,t,"gsub")};a.prototype=s.prototype,a.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},a.prototype.getSingle=function(t,e,i){for(var r=[],n=this.getLookupTables(e,i,t,1),o=0;o<n.length;o++)for(var s=n[o].subtables,a=0;a<s.length;a++){var h,l=s[a],u=this.expandCoverage(l.coverage);if(1===l.substFormat){var p=l.deltaGlyphId;for(h=0;h<u.length;h++){var c=u[h];r.push({sub:c,by:c+p})}}else{var f=l.substitute;for(h=0;h<u.length;h++)r.push({sub:u[h],by:f[h]})}}return r},a.prototype.getAlternates=function(t,e,i){for(var r=[],n=this.getLookupTables(e,i,t,3),o=0;o<n.length;o++)for(var s=n[o].subtables,a=0;a<s.length;a++)for(var h=s[a],l=this.expandCoverage(h.coverage),u=h.alternateSets,p=0;p<l.length;p++)r.push({sub:l[p],by:u[p]});return r},a.prototype.getLigatures=function(t,e,i){for(var r=[],n=this.getLookupTables(e,i,t,4),o=0;o<n.length;o++)for(var s=n[o].subtables,a=0;a<s.length;a++)for(var h=s[a],l=this.expandCoverage(h.coverage),u=h.ligatureSets,p=0;p<l.length;p++)for(var c=l[p],f=u[p],d=0;d<f.length;d++){var y=f[d];r.push({sub:[c].concat(y.components),by:y.ligGlyph})}return r},a.prototype.addSingle=function(t,e,i,r){var s=this.getLookupTables(i,r,t,1,!0)[0],a=n(s,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});o.assert(1===a.coverage.format,"Ligature: unable to modify coverage table format "+a.coverage.format);var h=e.sub,l=this.binSearch(a.coverage.glyphs,h);l<0&&(l=-1-l,a.coverage.glyphs.splice(l,0,h),a.substitute.splice(l,0,0)),a.substitute[l]=e.by},a.prototype.addAlternate=function(t,e,i,r){var s=this.getLookupTables(i,r,t,3,!0)[0],a=n(s,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});o.assert(1===a.coverage.format,"Ligature: unable to modify coverage table format "+a.coverage.format);var h=e.sub,l=this.binSearch(a.coverage.glyphs,h);l<0&&(l=-1-l,a.coverage.glyphs.splice(l,0,h),a.alternateSets.splice(l,0,0)),a.alternateSets[l]=e.by},a.prototype.addLigature=function(t,e,i,n){var s=this.getLookupTables(i,n,t,4,!0)[0],a=s.subtables[0];a||(a={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},s.subtables[0]=a),o.assert(1===a.coverage.format,"Ligature: unable to modify coverage table format "+a.coverage.format);var h=e.sub[0],l=e.sub.slice(1),u={ligGlyph:e.by,components:l},p=this.binSearch(a.coverage.glyphs,h);if(p>=0){for(var c=a.ligatureSets[p],f=0;f<c.length;f++)if(r(c[f].components,l))return;c.push(u)}else p=-1-p,a.coverage.glyphs.splice(p,0,h),a.ligatureSets.splice(p,0,[u])},a.prototype.getFeature=function(t,e,i){if(/ss\d\d/.test(t))return this.getSingle(t,e,i);switch(t){case"aalt":case"salt":return this.getSingle(t,e,i).concat(this.getAlternates(t,e,i));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,i)}},a.prototype.add=function(t,e,i,r){if(/ss\d\d/.test(t))return this.addSingle(t,e,i,r);switch(t){case"aalt":case"salt":return"number"==typeof e.by?this.addSingle(t,e,i,r):this.addAlternate(t,e,i,r);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,i,r)}},e.exports=a},{"./check":9,"./layout":16}],21:[function(t,e,i){"use strict";function r(t,e,i){var r;for(r=0;r<e.length;r+=1){var n=e[r];this[n.name]=n.value}if(this.tableName=t,this.fields=e,i){var o=Object.keys(i);for(r=0;r<o.length;r+=1){var s=o[r],a=i[s];void 0!==this[s]&&(this[s]=a)}}}function n(t,e,i){void 0===i&&(i=e.length);var r=new Array(e.length+1);r[0]={name:t+"Count",type:"USHORT",value:i};for(var n=0;n<e.length;n++)r[n+1]={name:t+n,type:"USHORT",value:e[n]};return r}function o(t,e,i){var r=e.length,n=new Array(r+1);n[0]={name:t+"Count",type:"USHORT",value:r};for(var o=0;o<r;o++)n[o+1]={name:t+o,type:"TABLE",value:i(e[o],o)};return n}function s(t,e,i){var r=e.length,n=[];n[0]={name:t+"Count",type:"USHORT",value:r};for(var o=0;o<r;o++)n=n.concat(i(e[o],o));return n}function a(t){1===t.format?r.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(n("glyph",t.glyphs))):p.assert(!1,"Can't create coverage table format 2 yet.")}function h(t){r.call(this,"scriptListTable",s("scriptRecord",t,function(t,e){var i=t.script,o=i.defaultLangSys;return p.assert(!!o,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new r("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new r("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:o.reqFeatureIndex}].concat(n("featureIndex",o.featureIndexes)))}].concat(s("langSys",i.langSysRecords,function(t,e){var i=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new r("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(n("featureIndex",i.featureIndexes)))}]})))}]}))}function l(t){r.call(this,"featureListTable",s("featureRecord",t,function(t,e){var i=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new r("featureTable",[{name:"featureParams",type:"USHORT",value:i.featureParams}].concat(n("lookupListIndex",i.lookupListIndexes)))}]}))}function u(t,e){r.call(this,"lookupListTable",o("lookup",t,function(t){var i=e[t.lookupType];return p.assert(!!i,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new r("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(o("subtable",t.subtables,i)))}))}var p=t("./check"),c=t("./types").encode,f=t("./types").sizeOf;r.prototype.encode=function(){return c.TABLE(this)},r.prototype.sizeOf=function(){return f.TABLE(this)},a.prototype=Object.create(r.prototype),a.prototype.constructor=a,h.prototype=Object.create(r.prototype),h.prototype.constructor=h,l.prototype=Object.create(r.prototype),l.prototype.constructor=l,u.prototype=Object.create(r.prototype),u.prototype.constructor=u,i.Record=i.Table=r,i.Coverage=a,i.ScriptList=h,i.FeatureList=l,i.LookupList=u,i.ushortList=n,i.tableList=o,i.recordList=s},{"./check":9,"./types":40}],22:[function(t,e,i){"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i+=1)if(!r(t[i],e[i]))return!1;return!0}return!1}function n(t){return t.length<1240?107:t.length<33900?1131:32768}function o(t,e,i){var r,n,o,s=[],a=[],h=D.getCard16(t,e);if(0!==h){var l=D.getByte(t,e+2);n=e+(h+1)*l+2;var u=e+3;for(r=0;r<h+1;r+=1)s.push(D.getOffset(t,u,l)),u+=l;o=n+s[h]}else o=e+2;for(r=0;r<s.length-1;r+=1){var p=D.getBytes(t,n+s[r],n+s[r+1]);i&&(p=i(p)),a.push(p)}return{objects:a,startOffset:e,endOffset:o}}function s(t){for(var e="",i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var r=t.parseByte(),n=r>>4,o=15&r;if(15===n)break;if(e+=i[n],15===o)break;e+=i[o]}return parseFloat(e)}function a(t,e){var i,r,n,o;if(28===e)return i=t.parseByte(),r=t.parseByte(),i<<8|r;if(29===e)return i=t.parseByte(),r=t.parseByte(),n=t.parseByte(),o=t.parseByte(),i<<24|r<<16|n<<8|o;if(30===e)return s(t);if(e>=32&&e<=246)return e-139;if(e>=247&&e<=250)return i=t.parseByte(),256*(e-247)+i+108;if(e>=251&&e<=254)return i=t.parseByte(),256*-(e-251)-i-108;throw new Error("Invalid b0 "+e)}function h(t){for(var e={},i=0;i<t.length;i+=1){var r,n=t[i][0],o=t[i][1];if(r=1===o.length?o[0]:o,e.hasOwnProperty(n))throw new Error("Object "+e+" already has key "+n);e[n]=r}return e}function l(t,e,i){e=void 0!==e?e:0;var r=new D.Parser(t,e),n=[],o=[];for(i=void 0!==i?i:t.length;r.relativeOffset<i;){var s=r.parseByte();s<=21?(12===s&&(s=1200+r.parseByte()),n.push([s,o]),o=[]):o.push(a(r,s))}return h(n)}function u(t,e){return e=e<=390?L.cffStandardStrings[e]:t[e-391]}function p(t,e,i){for(var r,n={},o=0;o<e.length;o+=1){var s=e[o];if(Array.isArray(s.type)){var a=[];a.length=s.type.length;for(var h=0;h<s.type.length;h++)r=void 0!==t[s.op]?t[s.op][h]:void 0,void 0===r&&(r=void 0!==s.value&&void 0!==s.value[h]?s.value[h]:null),"SID"===s.type[h]&&(r=u(i,r)),a[h]=r;n[s.name]=a}else r=t[s.op],void 0===r&&(r=void 0!==s.value?s.value:null),"SID"===s.type&&(r=u(i,r)),n[s.name]=r}return n}function c(t,e){var i={};return i.formatMajor=D.getCard8(t,e),i.formatMinor=D.getCard8(t,e+1),i.size=D.getCard8(t,e+2),i.offsetSize=D.getCard8(t,e+3),i.startOffset=e,i.endOffset=e+4,i}function f(t,e){return p(l(t,0,t.byteLength),N,e)}function d(t,e,i,r){return p(l(t,e,i),q,r)}function y(t,e,i,r){for(var s=[],a=0;a<i.length;a+=1){var h=new DataView(new Uint8Array(i[a]).buffer),l=f(h,r);l._subrs=[],l._subrsBias=0;var u=l.private[0],p=l.private[1];if(0!==u&&0!==p){var c=d(t,p+e,u,r);if(l._defaultWidthX=c.defaultWidthX,l._nominalWidthX=c.nominalWidthX,0!==c.subrs){var y=p+c.subrs,m=o(t,y+e);l._subrs=m.objects,l._subrsBias=n(l._subrs)}l._privateDict=c}s.push(l)}return s}function m(t,e,i,r){var n,o,s,a=new D.Parser(t,e);i-=1;var h=[".notdef"],l=a.parseCard8();if(0===l)for(n=0;n<i;n+=1)o=a.parseSID(),h.push(u(r,o));else if(1===l)for(;h.length<=i;)for(o=a.parseSID(),s=a.parseCard8(),n=0;n<=s;n+=1)h.push(u(r,o)),o+=1;else{if(2!==l)throw new Error("Unknown charset format "+l);for(;h.length<=i;)for(o=a.parseSID(),s=a.parseCard16(),n=0;n<=s;n+=1)h.push(u(r,o)),o+=1}return h}function g(t,e,i){var r,n,o={},s=new D.Parser(t,e),a=s.parseCard8();if(0===a){var h=s.parseCard8();for(r=0;r<h;r+=1)n=s.parseCard8(),o[n]=r}else{if(1!==a)throw new Error("Unknown encoding format "+a);var l=s.parseCard8();for(n=1,r=0;r<l;r+=1)for(var u=s.parseCard8(),p=s.parseCard8(),c=u;c<=u+p;c+=1)o[c]=n,n+=1}return new L.CffEncoding(o,i)}function v(t,e,i){function r(t,e){v&&d.closePath(),d.moveTo(t,e),v=!0}function n(){var t;t=y.length%2!=0,t&&!g&&(S=y.shift()+f),m+=y.length>>1,y.length=0,g=!0}function o(i){for(var c,w,x,T,E,P,O,M,A,R,C,k,F=0;F<i.length;){var L=i[F];switch(F+=1,L){case 1:case 3:n();break;case 4:y.length>1&&!g&&(S=y.shift()+f,g=!0),b+=y.pop(),r(_,b);break;case 5:for(;y.length>0;)_+=y.shift(),b+=y.shift(),d.lineTo(_,b);break;case 6:for(;y.length>0&&(_+=y.shift(),d.lineTo(_,b),0!==y.length);)b+=y.shift(),d.lineTo(_,b);break;case 7:for(;y.length>0&&(b+=y.shift(),d.lineTo(_,b),0!==y.length);)_+=y.shift(),d.lineTo(_,b);break;case 8:for(;y.length>0;)s=_+y.shift(),a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),_=h+y.shift(),b=l+y.shift(),d.curveTo(s,a,h,l,_,b);break;case 10:E=y.pop()+p,P=u[E],P&&o(P);break;case 11:return;case 12:switch(L=i[F],F+=1,L){case 35:s=_+y.shift(),a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),O=h+y.shift(),M=l+y.shift(),A=O+y.shift(),R=M+y.shift(),C=A+y.shift(),k=R+y.shift(),_=C+y.shift(),b=k+y.shift(),y.shift(),d.curveTo(s,a,h,l,O,M),d.curveTo(A,R,C,k,_,b);break;case 34:s=_+y.shift(),a=b,h=s+y.shift(),l=a+y.shift(),O=h+y.shift(),M=l,A=O+y.shift(),R=l,C=A+y.shift(),k=b,_=C+y.shift(),d.curveTo(s,a,h,l,O,M),d.curveTo(A,R,C,k,_,b);break;case 36:s=_+y.shift(),a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),O=h+y.shift(),M=l,A=O+y.shift(),R=l,C=A+y.shift(),k=R+y.shift(),_=C+y.shift(),d.curveTo(s,a,h,l,O,M),d.curveTo(A,R,C,k,_,b);break;case 37:s=_+y.shift(),a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),O=h+y.shift(),M=l+y.shift(),A=O+y.shift(),R=M+y.shift(),C=A+y.shift(),k=R+y.shift(),Math.abs(C-_)>Math.abs(k-b)?_=C+y.shift():b=k+y.shift(),d.curveTo(s,a,h,l,O,M),d.curveTo(A,R,C,k,_,b);break;default:console.log("Glyph "+e.index+": unknown operator 1200"+L),y.length=0}break;case 14:y.length>0&&!g&&(S=y.shift()+f,g=!0),v&&(d.closePath(),v=!1);break;case 18:n();break;case 19:case 20:n(),F+=m+7>>3;break;case 21:y.length>2&&!g&&(S=y.shift()+f,g=!0),b+=y.pop(),_+=y.pop(),r(_,b);break;case 22:y.length>1&&!g&&(S=y.shift()+f,g=!0),_+=y.pop(),r(_,b);break;case 23:n();break;case 24:for(;y.length>2;)s=_+y.shift(),a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),_=h+y.shift(),b=l+y.shift(),d.curveTo(s,a,h,l,_,b);_+=y.shift(),b+=y.shift(),d.lineTo(_,b);break;case 25:for(;y.length>6;)_+=y.shift(),b+=y.shift(),d.lineTo(_,b);s=_+y.shift(),a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),_=h+y.shift(),b=l+y.shift(),d.curveTo(s,a,h,l,_,b);break;case 26:for(y.length%2&&(_+=y.shift());y.length>0;)s=_,a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),_=h,b=l+y.shift(),d.curveTo(s,a,h,l,_,b);break;case 27:for(y.length%2&&(b+=y.shift());y.length>0;)s=_+y.shift(),a=b,h=s+y.shift(),l=a+y.shift(),_=h+y.shift(),b=l,d.curveTo(s,a,h,l,_,b);break;case 28:c=i[F],w=i[F+1],y.push((c<<24|w<<16)>>16),F+=2;break;case 29:E=y.pop()+t.gsubrsBias,P=t.gsubrs[E],P&&o(P);break;case 30:for(;y.length>0&&(s=_,a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),_=h+y.shift(),b=l+(1===y.length?y.shift():0),d.curveTo(s,a,h,l,_,b),0!==y.length);)s=_+y.shift(),a=b,h=s+y.shift(),l=a+y.shift(),b=l+y.shift(),_=h+(1===y.length?y.shift():0),d.curveTo(s,a,h,l,_,b);break;case 31:for(;y.length>0&&(s=_+y.shift(),a=b,h=s+y.shift(),l=a+y.shift(),b=l+y.shift(),_=h+(1===y.length?y.shift():0),d.curveTo(s,a,h,l,_,b),0!==y.length);)s=_,a=b+y.shift(),h=s+y.shift(),l=a+y.shift(),_=h+y.shift(),b=l+(1===y.length?y.shift():0),d.curveTo(s,a,h,l,_,b);break;default:L<32?console.log("Glyph "+e.index+": unknown operator "+L):L<247?y.push(L-139):L<251?(c=i[F],F+=1,y.push(256*(L-247)+c+108)):L<255?(c=i[F],F+=1,y.push(256*-(L-251)-c-108)):(c=i[F],w=i[F+1],x=i[F+2],T=i[F+3],F+=4,y.push((c<<24|w<<16|x<<8|T)/65536))}}}var s,a,h,l,u,p,c,f,d=new U.Path,y=[],m=0,g=!1,v=!1,_=0,b=0;if(t.isCIDFont){var w=t.tables.cff.topDict._fdSelect[e.index],x=t.tables.cff.topDict._fdArray[w];u=x._subrs,p=x._subrsBias,c=x._defaultWidthX,f=x._nominalWidthX}else u=t.tables.cff.topDict._subrs,p=t.tables.cff.topDict._subrsBias,c=t.tables.cff.topDict._defaultWidthX,f=t.tables.cff.topDict._nominalWidthX;var S=c;return o(i),e.advanceWidth=S,d}function _(t,e,i,r){var n,o=[],s=new D.Parser(t,e),a=s.parseCard8();if(0===a)for(var h=0;h<i;h++){if((n=s.parseCard8())>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+n+" (FD count "+r+")");o.push(n)}else{if(3!==a)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+a);var l=s.parseCard16(),u=s.parseCard16();if(0!==u)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+u);for(var p,c=0;c<l;c++){if(n=s.parseCard8(),p=s.parseCard16(),n>=r)throw new Error("CFF table CID Font FDSelect has bad FD index value "+n+" (FD count "+r+")");if(p>i)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+p);for(;u<p;u++)o.push(n);u=p}if(p!==i)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+p)}return o}function b(t,e,i){i.tables.cff={};var r=c(t,e),s=o(t,r.endOffset,D.bytesToString),a=o(t,s.endOffset),h=o(t,a.endOffset,D.bytesToString),l=o(t,h.endOffset);i.gsubrs=l.objects,i.gsubrsBias=n(i.gsubrs);var u=y(t,e,a.objects,h.objects);if(1!==u.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+u.length);var p=u[0];if(i.tables.cff.topDict=p,p._privateDict&&(i.defaultWidthX=p._privateDict.defaultWidthX,i.nominalWidthX=p._privateDict.nominalWidthX),void 0!==p.ros[0]&&void 0!==p.ros[1]&&(i.isCIDFont=!0),i.isCIDFont){var f=p.fdArray,b=p.fdSelect;if(0===f||0===b)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");f+=e;var w=o(t,f),x=y(t,e,w.objects,h.objects);p._fdArray=x,b+=e,p._fdSelect=_(t,b,i.numGlyphs,x.length)}var S=e+p.private[1],T=d(t,S,p.private[0],h.objects);if(i.defaultWidthX=T.defaultWidthX,i.nominalWidthX=T.nominalWidthX,0!==T.subrs){var E=S+T.subrs,P=o(t,E);i.subrs=P.objects,i.subrsBias=n(i.subrs)}else i.subrs=[],i.subrsBias=0;var O=o(t,e+p.charStrings);i.nGlyphs=O.objects.length;var M=m(t,e+p.charset,i.nGlyphs,h.objects);0===p.encoding?i.cffEncoding=new L.CffEncoding(L.cffStandardEncoding,M):1===p.encoding?i.cffEncoding=new L.CffEncoding(L.cffExpertEncoding,M):i.cffEncoding=g(t,e+p.encoding,M),i.encoding=i.encoding||i.cffEncoding,i.glyphs=new I.GlyphSet(i);for(var A=0;A<i.nGlyphs;A+=1){var R=O.objects[A];i.glyphs.push(A,I.cffGlyphLoader(i,A,v,R))}}function w(t,e){var i,r=L.cffStandardStrings.indexOf(t);return r>=0&&(i=r),r=e.indexOf(t),r>=0?i=r+L.cffStandardStrings.length:(i=L.cffStandardStrings.length+e.length,e.push(t)),i}function x(){return new B.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}])}function S(t){var e=new B.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var i=0;i<t.length;i+=1)e.names.push({name:"name_"+i,type:"NAME",value:t[i]});return e}function T(t,e,i){for(var n={},o=0;o<t.length;o+=1){var s=t[o],a=e[s.name];void 0===a||r(a,s.value)||("SID"===s.type&&(a=w(a,i)),n[s.op]={name:s.name,type:s.type,value:a})}return n}function E(t,e){var i=new B.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=T(N,t,e),i}function P(t){var e=new B.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function O(t){var e=new B.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var i=0;i<t.length;i+=1)e.strings.push({name:"string_"+i,type:"STRING",value:t[i]});return e}function M(){return new B.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}])}function A(t,e){for(var i=new B.Record("Charsets",[{name:"format",type:"Card8",value:0}]),r=0;r<t.length;r+=1){var n=t[r],o=w(n,e);i.fields.push({name:"glyph_"+r,type:"SID",value:o})}return i}function R(t){var e=[],i=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var r=0,n=0,o=0;o<i.commands.length;o+=1){var s,a,h=i.commands[o];if("Q"===h.type){h={type:"C",x:h.x,y:h.y,x1:1/3*r+2/3*h.x1,y1:1/3*n+2/3*h.y1,x2:1/3*h.x+2/3*h.x1,y2:1/3*h.y+2/3*h.y1}}if("M"===h.type)s=Math.round(h.x-r),a=Math.round(h.y-n),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),r=Math.round(h.x),n=Math.round(h.y);else if("L"===h.type)s=Math.round(h.x-r),a=Math.round(h.y-n),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),r=Math.round(h.x),n=Math.round(h.y);else if("C"===h.type){var l=Math.round(h.x1-r),u=Math.round(h.y1-n),p=Math.round(h.x2-h.x1),c=Math.round(h.y2-h.y1);s=Math.round(h.x-h.x2),a=Math.round(h.y-h.y2),e.push({name:"dx1",type:"NUMBER",value:l}),e.push({name:"dy1",type:"NUMBER",value:u}),e.push({name:"dx2",type:"NUMBER",value:p}),e.push({name:"dy2",type:"NUMBER",value:c}),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),r=Math.round(h.x),n=Math.round(h.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}function C(t){for(var e=new B.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),i=0;i<t.length;i+=1){var r=t.get(i),n=R(r);e.charStrings.push({name:r.name,type:"CHARSTRING",value:n})}return e}function k(t,e){var i=new B.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return i.dict=T(q,t,e),i}function F(t,e){for(var i,r=new B.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),n=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[n,0,0,n,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},s={},a=[],h=1;h<t.length;h+=1)i=t.get(h),a.push(i.name);var l=[];r.header=x(),r.nameIndex=S([e.postScriptName]);var u=E(o,l);r.topDictIndex=P(u),r.globalSubrIndex=M(),r.charsets=A(a,l),r.charStringsIndex=C(t),r.privateDict=k(s,l),r.stringIndex=O(l);var p=r.header.sizeOf()+r.nameIndex.sizeOf()+r.topDictIndex.sizeOf()+r.stringIndex.sizeOf()+r.globalSubrIndex.sizeOf();return o.charset=p,o.encoding=0,o.charStrings=o.charset+r.charsets.sizeOf(),o.private[1]=o.charStrings+r.charStringsIndex.sizeOf(),u=E(o,l),r.topDictIndex=P(u),r}var L=t("../encoding"),I=t("../glyphset"),D=t("../parse"),U=t("../path"),B=t("../table"),N=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],q=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];i.parse=b,i.make=F},{"../encoding":11,"../glyphset":14,"../parse":18,"../path":19,"../table":21}],23:[function(t,e,i){"use strict";function r(t,e){var i;e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong();var r;for(t.groupCount=r=e.parseULong(),t.glyphIndexMap={},i=0;i<r;i+=1)for(var n=e.parseULong(),o=e.parseULong(),s=e.parseULong(),a=n;a<=o;a+=1)t.glyphIndexMap[a]=s,s++}function n(t,e,i,r,n){var o;t.length=e.parseUShort(),t.language=e.parseUShort();var s;t.segCount=s=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};var a=new u.Parser(i,r+n+14),h=new u.Parser(i,r+n+16+2*s),l=new u.Parser(i,r+n+16+4*s),p=new u.Parser(i,r+n+16+6*s),c=r+n+16+8*s;for(o=0;o<s-1;o+=1)for(var f,d=a.parseUShort(),y=h.parseUShort(),m=l.parseShort(),g=p.parseUShort(),v=y;v<=d;v+=1)0!==g?(c=p.offset+p.relativeOffset-2,c+=g,c+=2*(v-y),0!==(f=u.getUShort(i,c))&&(f=f+m&65535)):f=v+m&65535,t.glyphIndexMap[v]=f}function o(t,e){var i,o={};o.version=u.getUShort(t,e),l.argument(0===o.version,"cmap table version should be 0."),o.numTables=u.getUShort(t,e+2);var s=-1;for(i=o.numTables-1;i>=0;i-=1){var a=u.getUShort(t,e+4+8*i),h=u.getUShort(t,e+4+8*i+2);if(3===a&&(0===h||1===h||10===h)){s=u.getULong(t,e+4+8*i+4);break}}if(-1===s)throw new Error("No valid cmap sub-tables found.");var p=new u.Parser(t,e+s);if(o.format=p.parseUShort(),12===o.format)r(o,p);else{if(4!==o.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+o.format+").");n(o,p,t,e,s)}return o}function s(t,e,i){t.segments.push({end:e,start:e,delta:-(e-i),offset:0})}function a(t){t.segments.push({end:65535,start:65535,delta:1,offset:0})}function h(t){var e,i=new p.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(i.segments=[],e=0;e<t.length;e+=1){for(var r=t.get(e),n=0;n<r.unicodes.length;n+=1)s(i,r.unicodes[n],e);i.segments=i.segments.sort(function(t,e){return t.start-e.start})}a(i);var o;o=i.segments.length,i.segCountX2=2*o,i.searchRange=2*Math.pow(2,Math.floor(Math.log(o)/Math.log(2))),i.entrySelector=Math.log(i.searchRange/2)/Math.log(2),i.rangeShift=i.segCountX2-i.searchRange;var h=[],l=[],u=[],c=[],f=[];for(e=0;e<o;e+=1){var d=i.segments[e];h=h.concat({name:"end_"+e,type:"USHORT",value:d.end}),l=l.concat({name:"start_"+e,type:"USHORT",value:d.start}),u=u.concat({name:"idDelta_"+e,type:"SHORT",value:d.delta}),c=c.concat({name:"idRangeOffset_"+e,type:"USHORT",value:d.offset}),void 0!==d.glyphId&&(f=f.concat({name:"glyph_"+e,type:"USHORT",value:d.glyphId}))}return i.fields=i.fields.concat(h),i.fields.push({name:"reservedPad",type:"USHORT",value:0}),i.fields=i.fields.concat(l),i.fields=i.fields.concat(u),i.fields=i.fields.concat(c),i.fields=i.fields.concat(f),i.length=14+2*h.length+2+2*l.length+2*u.length+2*c.length+2*f.length,i}var l=t("../check"),u=t("../parse"),p=t("../table");i.parse=o,i.make=h},{"../check":9,"../parse":18,"../table":21}],24:[function(t,e,i){"use strict";function r(t,e){var i=JSON.stringify(t),r=256;for(var n in e){var o=parseInt(n);if(o&&!(o<256)){if(JSON.stringify(e[n])===i)return o;r<=o&&(r=o+1)}}return e[r]=t,r}function n(t,e,i){var n=r(e.name,i);return[{name:"tag_"+t,type:"TAG",value:e.tag},{name:"minValue_"+t,type:"FIXED",value:e.minValue<<16},{name:"defaultValue_"+t,type:"FIXED",value:e.defaultValue<<16},{name:"maxValue_"+t,type:"FIXED",value:e.maxValue<<16},{name:"flags_"+t,type:"USHORT",value:0},{name:"nameID_"+t,type:"USHORT",value:n}]}function o(t,e,i){var r={},n=new p.Parser(t,e);return r.tag=n.parseTag(),r.minValue=n.parseFixed(),r.defaultValue=n.parseFixed(),r.maxValue=n.parseFixed(),n.skip("uShort",1),r.name=i[n.parseUShort()]||{},r}function s(t,e,i,n){for(var o=r(e.name,n),s=[{name:"nameID_"+t,type:"USHORT",value:o},{name:"flags_"+t,type:"USHORT",value:0}],a=0;a<i.length;++a){var h=i[a].tag;s.push({name:"axis_"+t+" "+h,type:"FIXED",value:e.coordinates[h]<<16})}return s}function a(t,e,i,r){var n={},o=new p.Parser(t,e);n.name=r[o.parseUShort()]||{},o.skip("uShort",1),n.coordinates={};for(var s=0;s<i.length;++s)n.coordinates[i[s].tag]=o.parseFixed();return n}function h(t,e){var i=new c.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);i.offsetToData=i.sizeOf();for(var r=0;r<t.axes.length;r++)i.fields=i.fields.concat(n(r,t.axes[r],e));for(var o=0;o<t.instances.length;o++)i.fields=i.fields.concat(s(o,t.instances[o],t.axes,e));return i}function l(t,e,i){var r=new p.Parser(t,e),n=r.parseULong();u.argument(65536===n,"Unsupported fvar table version.");var s=r.parseOffset16();r.skip("uShort",1);for(var h=r.parseUShort(),l=r.parseUShort(),c=r.parseUShort(),f=r.parseUShort(),d=[],y=0;y<h;y++)d.push(o(t,e+s+y*l,i));for(var m=[],g=e+s+h*l,v=0;v<c;v++)m.push(a(t,g+v*f,d,i));return{axes:d,instances:m}}var u=t("../check"),p=t("../parse"),c=t("../table");i.make=h,i.parse=l},{"../check":9,"../parse":18,"../table":21}],25:[function(t,e,i){"use strict";function r(t,e,i,r,n){var o;return(e&r)>0?(o=t.parseByte(),0==(e&n)&&(o=-o),o=i+o):o=(e&n)>0?i:i+t.parseShort(),o}function n(t,e,i){var n=new c.Parser(e,i);t.numberOfContours=n.parseShort(),t._xMin=n.parseShort(),t._yMin=n.parseShort(),t._xMax=n.parseShort(),t._yMax=n.parseShort();var o,s,a;if(t.numberOfContours>0){var h=t.endPointIndices=[];for(a=0;a<t.numberOfContours;a+=1)h.push(n.parseUShort());for(t.instructionLength=n.parseUShort(),t.instructions=[],a=0;a<t.instructionLength;a+=1)t.instructions.push(n.parseByte());var l=h[h.length-1]+1;for(o=[],a=0;a<l;a+=1)if(s=n.parseByte(),o.push(s),(8&s)>0)for(var p=n.parseByte(),f=0;f<p;f+=1)o.push(s),a+=1;if(u.argument(o.length===l,"Bad flags."),h.length>0){var d,y=[];if(l>0){for(a=0;a<l;a+=1)s=o[a],d={},d.onCurve=!!(1&s),d.lastPointOfContour=h.indexOf(a)>=0,y.push(d);var m=0;for(a=0;a<l;a+=1)s=o[a],d=y[a],d.x=r(n,s,m,2,16),m=d.x;var g=0;for(a=0;a<l;a+=1)s=o[a],d=y[a],d.y=r(n,s,g,4,32),g=d.y}t.points=y}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var v=!0;v;){o=n.parseUShort();var _={glyphIndex:n.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&o)>0?(2&o)>0?(_.dx=n.parseShort(),_.dy=n.parseShort()):_.matchedPoints=[n.parseUShort(),n.parseUShort()]:(2&o)>0?(_.dx=n.parseChar(),_.dy=n.parseChar()):_.matchedPoints=[n.parseByte(),n.parseByte()],(8&o)>0?_.xScale=_.yScale=n.parseF2Dot14():(64&o)>0?(_.xScale=n.parseF2Dot14(),_.yScale=n.parseF2Dot14()):(128&o)>0&&(_.xScale=n.parseF2Dot14(),_.scale01=n.parseF2Dot14(),_.scale10=n.parseF2Dot14(),_.yScale=n.parseF2Dot14()),t.components.push(_),v=!!(32&o)}if(256&o)for(t.instructionLength=n.parseUShort(),t.instructions=[],a=0;a<t.instructionLength;a+=1)t.instructions.push(n.parseByte())}}function o(t,e){for(var i=[],r=0;r<t.length;r+=1){var n=t[r],o={x:e.xScale*n.x+e.scale01*n.y+e.dx,y:e.scale10*n.x+e.yScale*n.y+e.dy,onCurve:n.onCurve,lastPointOfContour:n.lastPointOfContour};i.push(o)}return i}function s(t){for(var e=[],i=[],r=0;r<t.length;r+=1){var n=t[r];i.push(n),n.lastPointOfContour&&(e.push(i),i=[])}return u.argument(0===i.length,"There are still points left in the current contour."),e}function a(t){var e=new f.Path;if(!t)return e;for(var i=s(t),r=0;r<i.length;++r){var n=i[r],o=null,a=n[n.length-1],h=n[0];if(a.onCurve)e.moveTo(a.x,a.y);else if(h.onCurve)e.moveTo(h.x,h.y);else{var l={x:.5*(a.x+h.x),y:.5*(a.y+h.y)};e.moveTo(l.x,l.y)}for(var u=0;u<n.length;++u)if(o=a,a=h,h=n[(u+1)%n.length],a.onCurve)e.lineTo(a.x,a.y);else{var p=o,c=h;o.onCurve||(p={x:.5*(a.x+o.x),y:.5*(a.y+o.y)},e.lineTo(p.x,p.y)),h.onCurve||(c={x:.5*(a.x+h.x),y:.5*(a.y+h.y)}),e.lineTo(p.x,p.y),e.quadraticCurveTo(a.x,a.y,c.x,c.y)}}return e.closePath(),e}function h(t,e){if(e.isComposite)for(var i=0;i<e.components.length;i+=1){var r=e.components[i],n=t.get(r.glyphIndex);if(n.getPath(),n.points){var s;if(void 0===r.matchedPoints)s=o(n.points,r);else{if(r.matchedPoints[0]>e.points.length-1||r.matchedPoints[1]>n.points.length-1)throw Error("Matched points out of range in "+e.name);var h=e.points[r.matchedPoints[0]],l=n.points[r.matchedPoints[1]],u={xScale:r.xScale,scale01:r.scale01,scale10:r.scale10,yScale:r.yScale,dx:0,dy:0};l=o([l],u)[0],u.dx=h.x-l.x,u.dy=h.y-l.y,s=o(n.points,u)}e.points=e.points.concat(s)}}return a(e.points)}function l(t,e,i,r){var o,s=new p.GlyphSet(r);for(o=0;o<i.length-1;o+=1){var a=i[o];a!==i[o+1]?s.push(o,p.ttfGlyphLoader(r,o,n,t,e+a,h)):s.push(o,p.glyphLoader(r,o))}return s}var u=t("../check"),p=t("../glyphset"),c=t("../parse"),f=t("../path");i.getPath=a,i.parse=l},{"../check":9,"../glyphset":14,"../parse":18,"../path":19}],26:[function(t,e,i){"use strict";function r(t,e){for(var i=new u.Parser(t,e),r=i.parseUShort(),n=[],o=0;o<r;o++)n[i.parseTag()]={offset:i.parseUShort()};return n}function n(t,e){var i=new u.Parser(t,e),r=i.parseUShort(),n=i.parseUShort();if(1===r)return i.parseUShortList(n);if(2===r){for(var o=[];n--;)for(var s=i.parseUShort(),a=i.parseUShort(),h=i.parseUShort(),l=s;l<=a;l++)o[h++]=l;return o}}function o(t,e){var i=new u.Parser(t,e),r=i.parseUShort();if(1===r){var n=i.parseUShort(),o=i.parseUShort(),s=i.parseUShortList(o);return function(t){return s[t-n]||0}}if(2===r){for(var a=i.parseUShort(),h=[],l=[],p=[],c=0;c<a;c++)h[c]=i.parseUShort(),l[c]=i.parseUShort(),p[c]=i.parseUShort();return function(t){for(var e=0,i=h.length-1;e<i;){var r=e+i+1>>1;t<h[r]?i=r-1:e=r}return h[e]<=t&&t<=l[e]?p[e]||0:0}}}function s(t,e){var i,r=new u.Parser(t,e),s=r.parseUShort(),a=r.parseUShort(),h=n(t,e+a),l=r.parseUShort(),p=r.parseUShort();if(4===l&&0===p){var c={};if(1===s){for(var f=r.parseUShort(),d=[],y=r.parseOffset16List(f),m=0;m<f;m++){var g=y[m],v=c[g];if(!v){v={},r.relativeOffset=g;for(var _=r.parseUShort();_--;){var b=r.parseUShort();l&&(i=r.parseShort()),p&&r.parseShort(),v[b]=i}}d[h[m]]=v}return function(t,e){var i=d[t];if(i)return i[e]}}if(2===s){for(var w=r.parseUShort(),x=r.parseUShort(),S=r.parseUShort(),T=r.parseUShort(),E=o(t,e+w),P=o(t,e+x),O=[],M=0;M<S;M++)for(var A=O[M]=[],R=0;R<T;R++)l&&(i=r.parseShort()),p&&r.parseShort(),A[R]=i;var C={};for(M=0;M<h.length;M++)C[h[M]]=1;return function(t,e){if(C[t]){var i=E(t),r=P(e),n=O[i];return n?n[r]:void 0}}}}}function a(t,e){var i=new u.Parser(t,e),r=i.parseUShort(),n=i.parseUShort(),o=16&n,a=i.parseUShort(),h=i.parseOffset16List(a),l={lookupType:r,lookupFlag:n,markFilteringSet:o?i.parseUShort():-1};if(2===r){for(var p=[],c=0;c<a;c++){var f=s(t,e+h[c]);f&&p.push(f)}l.getKerningValue=function(t,e){for(var i=p.length;i--;){var r=p[i](t,e);if(void 0!==r)return r}return 0}}return l}function h(t,e,i){var n=new u.Parser(t,e),o=n.parseFixed();l.argument(1===o,"Unsupported GPOS table version."),r(t,e+n.parseUShort()),r(t,e+n.parseUShort());var s=n.parseUShort();n.relativeOffset=s;for(var h=n.parseUShort(),p=n.parseOffset16List(h),c=e+s,f=0;f<h;f++){var d=a(t,c+p[f]);2!==d.lookupType||i.getGposKerningValue||(i.getGposKerningValue=d.getKerningValue)}}var l=t("../check"),u=t("../parse");i.parse=h},{"../check":9,"../parse":18}],27:[function(t,e,i){"use strict";function r(t,e){e=e||0;var i=new s(t,e),r=i.parseVersion();return o.argument(1===r,"Unsupported GSUB table version."),{version:r,scripts:i.parseScriptList(),features:i.parseFeatureList(),lookups:i.parseLookupList(a)}}function n(t){return new h.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new h.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new h.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new h.LookupList(t.lookups,u)}])}var o=t("../check"),s=t("../parse").Parser,a=new Array(9),h=t("../table");a[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(s.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(s.coverage),substitute:this.parseOffset16List()}:void o.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},a[2]=function(){var t=this.parseUShort();return o.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(s.coverage),sequences:this.parseListOfLists()}},a[3]=function(){var t=this.parseUShort();return o.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(s.coverage),alternateSets:this.parseListOfLists()}},a[4]=function(){var t=this.parseUShort();return o.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(s.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var l={sequenceIndex:s.uShort,lookupListIndex:s.uShort};a[5]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(s.coverage),ruleSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,l)}})};if(2===e)return{substFormat:e,coverage:this.parsePointer(s.coverage),classDef:this.parsePointer(s.classDef),classSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,l)}})};if(3===e){var i=this.parseUShort(),r=this.parseUShort();return{substFormat:e,coverages:this.parseList(i,s.pointer(s.coverage)),lookupRecords:this.parseRecordList(r,l)}}o.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},a[6]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(s.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(l)}})}:2===e?{substFormat:2,coverage:this.parsePointer(s.coverage),backtrackClassDef:this.parsePointer(s.classDef),inputClassDef:this.parsePointer(s.classDef),lookaheadClassDef:this.parsePointer(s.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(l)}})}:3===e?{substFormat:3,backtrackCoverage:this.parseList(s.pointer(s.coverage)),inputCoverage:this.parseList(s.pointer(s.coverage)),lookaheadCoverage:this.parseList(s.pointer(s.coverage)),lookupRecords:this.parseRecordList(l)}:void o.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},a[7]=function(){var t=this.parseUShort();o.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");var e=this.parseUShort(),i=new s(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:a[e].call(i)}},a[8]=function(){var t=this.parseUShort();return o.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(s.coverage),backtrackCoverage:this.parseList(s.pointer(s.coverage)),lookaheadCoverage:this.parseList(s.pointer(s.coverage)),substitutes:this.parseUShortList()}};var u=new Array(9);u[1]=function(t){return 1===t.substFormat?new h.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new h.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new h.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new h.Coverage(t.coverage)}].concat(h.ushortList("substitute",t.substitute)))},u[3]=function(t){return o.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new h.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new h.Coverage(t.coverage)}].concat(h.tableList("altSet",t.alternateSets,function(t){return new h.Table("alternateSetTable",h.ushortList("alternate",t))})))},u[4]=function(t){return o.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new h.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new h.Coverage(t.coverage)}].concat(h.tableList("ligSet",t.ligatureSets,function(t){return new h.Table("ligatureSetTable",h.tableList("ligature",t,function(t){return new h.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat(h.ushortList("component",t.components,t.components.length+1)))}))})))},i.parse=r,i.make=n},{"../check":9,"../parse":18,"../table":21}],28:[function(t,e,i){"use strict";function r(t,e){var i={},r=new s.Parser(t,e);return i.version=r.parseVersion(),i.fontRevision=Math.round(1e3*r.parseFixed())/1e3,i.checkSumAdjustment=r.parseULong(),i.magicNumber=r.parseULong(),o.argument(1594834165===i.magicNumber,"Font header has wrong magic number."),i.flags=r.parseUShort(),i.unitsPerEm=r.parseUShort(),i.created=r.parseLongDateTime(),i.modified=r.parseLongDateTime(),i.xMin=r.parseShort(),i.yMin=r.parseShort(),i.xMax=r.parseShort(),i.yMax=r.parseShort(),i.macStyle=r.parseUShort(),i.lowestRecPPEM=r.parseUShort(),i.fontDirectionHint=r.parseShort(),i.indexToLocFormat=r.parseShort(),i.glyphDataFormat=r.parseShort(),i}function n(t){var e=Math.round((new Date).getTime()/1e3)+2082844800,i=e;return t.createdTimestamp&&(i=t.createdTimestamp+2082844800),new a.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:i},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}var o=t("../check"),s=t("../parse"),a=t("../table");i.parse=r,i.make=n},{"../check":9,"../parse":18,"../table":21}],29:[function(t,e,i){"use strict";function r(t,e){var i={},r=new o.Parser(t,e);return i.version=r.parseVersion(),i.ascender=r.parseShort(),i.descender=r.parseShort(),i.lineGap=r.parseShort(),i.advanceWidthMax=r.parseUShort(),i.minLeftSideBearing=r.parseShort(),i.minRightSideBearing=r.parseShort(),i.xMaxExtent=r.parseShort(),i.caretSlopeRise=r.parseShort(),i.caretSlopeRun=r.parseShort(),i.caretOffset=r.parseShort(),r.relativeOffset+=8,i.metricDataFormat=r.parseShort(),i.numberOfHMetrics=r.parseUShort(),i}function n(t){return new s.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}var o=t("../parse"),s=t("../table");i.parse=r,i.make=n},{"../parse":18,"../table":21}],30:[function(t,e,i){"use strict";function r(t,e,i,r,n){for(var s,a,h=new o.Parser(t,e),l=0;l<r;l+=1){l<i&&(s=h.parseUShort(),a=h.parseShort());var u=n.get(l);u.advanceWidth=s,u.leftSideBearing=a}}function n(t){for(var e=new s.Table("hmtx",[]),i=0;i<t.length;i+=1){var r=t.get(i),n=r.advanceWidth||0,o=r.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+i,type:"USHORT",value:n}),e.fields.push({name:"leftSideBearing_"+i,type:"SHORT",value:o})}return e}var o=t("../parse"),s=t("../table");i.parse=r,i.make=n},{"../parse":18,"../table":21}],31:[function(t,e,i){"use strict";function r(t){var e={};t.skip("uShort");var i=t.parseUShort();s.argument(0===i,"Unsupported kern sub-table version."),t.skip("uShort",2);var r=t.parseUShort();t.skip("uShort",3);for(var n=0;n<r;n+=1){var o=t.parseUShort(),a=t.parseUShort(),h=t.parseShort();e[o+","+a]=h}return e}function n(t){var e={};t.skip("uShort"),t.parseULong()>1&&console.warn("Only the first kern subtable is supported."),t.skip("uLong");var i=t.parseUShort(),r=255&i;if(t.skip("uShort"),0===r){var n=t.parseUShort();t.skip("uShort",3);for(var o=0;o<n;o+=1){var s=t.parseUShort(),a=t.parseUShort(),h=t.parseShort();e[s+","+a]=h}}return e}function o(t,e){var i=new a.Parser(t,e),o=i.parseUShort();if(0===o)return r(i);if(1===o)return n(i);throw new Error("Unsupported kern table version ("+o+").")}var s=t("../check"),a=t("../parse");i.parse=o},{"../check":9,"../parse":18}],32:[function(t,e,i){"use strict";function r(t,e,i,r){for(var o=new n.Parser(t,e),s=r?o.parseUShort:o.parseULong,a=[],h=0;h<i+1;h+=1){var l=s.call(o);r&&(l*=2),a.push(l)}return a}var n=t("../parse");i.parse=r},{"../parse":18}],33:[function(t,e,i){"use strict";function r(t){for(var e=new a.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),i="",r=12+4*t.length,n=0;n<t.length;++n){var o=i.indexOf(t[n]);o<0&&(o=i.length,i+=t[n]),e.fields.push({name:"offset "+n,type:"USHORT",value:r+o}),e.fields.push({name:"length "+n,type:"USHORT",value:t[n].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:i}),e}function n(t,e){var i=new s.Parser(t,e),r=i.parseULong();o.argument(1===r,"Unsupported ltag table version."),i.skip("uLong",1);for(var n=i.parseULong(),a=[],h=0;h<n;h++){for(var l="",u=e+i.parseUShort(),p=i.parseUShort(),c=u;c<u+p;++c)l+=String.fromCharCode(t.getInt8(c));a.push(l)}return a}var o=t("../check"),s=t("../parse"),a=t("../table");i.make=r,i.parse=n},{"../check":9,"../parse":18,"../table":21}],34:[function(t,e,i){"use strict";function r(t,e){var i={},r=new o.Parser(t,e);return i.version=r.parseVersion(),i.numGlyphs=r.parseUShort(),1===i.version&&(i.maxPoints=r.parseUShort(),i.maxContours=r.parseUShort(),i.maxCompositePoints=r.parseUShort(),i.maxCompositeContours=r.parseUShort(),i.maxZones=r.parseUShort(),i.maxTwilightPoints=r.parseUShort(),i.maxStorage=r.parseUShort(),i.maxFunctionDefs=r.parseUShort(),i.maxInstructionDefs=r.parseUShort(),i.maxStackElements=r.parseUShort(),i.maxSizeOfInstructions=r.parseUShort(),i.maxComponentElements=r.parseUShort(),i.maxComponentDepth=r.parseUShort()),i}function n(t){return new s.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}var o=t("../parse"),s=t("../table");i.parse=r,i.make=n},{"../parse":18,"../table":21}],35:[function(t,e,i){"use strict";function r(t,e){var i=new h.Parser(t,e),r=i.parseULong();a.argument(1===r,"Unsupported META table version."),i.parseULong(),i.parseULong();for(var n=i.parseULong(),o={},l=0;l<n;l++){var u=i.parseTag(),p=i.parseULong(),c=i.parseULong(),f=s.UTF8(t,e+p,c);o[u]=f}return o}function n(t){var e=Object.keys(t).length,i="",r=16+12*e,n=new l.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:r},{name:"numTags",type:"ULONG",value:e}]);for(var o in t){var s=i.length;i+=t[o],n.fields.push({name:"tag "+o,type:"TAG",value:o}),n.fields.push({name:"offset "+o,type:"ULONG",value:r+s}),n.fields.push({name:"length "+o,type:"ULONG",value:t[o].length})}return n.fields.push({name:"stringPool",type:"CHARARRAY",value:i}),n}var o=t("../types"),s=o.decode,a=t("../check"),h=t("../parse"),l=t("../table");i.parse=r,i.make=n},{"../check":9,"../parse":18,"../table":21,"../types":40}],36:[function(t,e,i){"use strict";function r(t,e,i){switch(t){case 0:if(65535===e)return"und";if(i)return i[e];break;case 1:return g[e];case 3:return _[e]}}function n(t,e,i){switch(t){case 0:return b;case 1:return x[i]||w[e];case 3:if(1===e||10===e)return b}}function o(t,e,i){for(var o={},s=new d.Parser(t,e),a=s.parseUShort(),h=s.parseUShort(),l=s.offset+s.parseUShort(),u=0;u<h;u++){var p=s.parseUShort(),f=s.parseUShort(),y=s.parseUShort(),g=s.parseUShort(),v=m[g]||g,_=s.parseUShort(),w=s.parseUShort(),x=r(p,y,i),S=n(p,f,y);if(void 0!==S&&void 0!==x){var T;if(T=S===b?c.UTF16(t,l+w,_):c.MACSTRING(t,l+w,_,S)){var E=o[v];void 0===E&&(E=o[v]={}),E[x]=T}}}return 1===a&&s.parseUShort(),o}function s(t){var e={};for(var i in t)e[t[i]]=parseInt(i);return e}function a(t,e,i,r,n,o){return new y.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:i},{name:"nameID",type:"USHORT",value:r},{name:"length",type:"USHORT",value:n},{name:"offset",type:"USHORT",value:o}])}function h(t,e){var i=t.length,r=e.length-i+1;t:for(var n=0;n<r;n++)for(;n<r;n++){for(var o=0;o<i;o++)if(e[n+o]!==t[o])continue t;return n}return-1}function l(t,e){var i=h(t,e);if(i<0){i=e.length;for(var r=0,n=t.length;r<n;++r)e.push(t[r])}return i}function u(t,e){var i,r=[],o={},h=s(m);for(var u in t){var p=h[u];if(void 0===p&&(p=u),i=parseInt(p),isNaN(i))throw new Error('Name table entry "'+u+'" does not exist, see nameTableNames for complete list.');o[i]=t[u],r.push(i)}for(var c=s(g),d=s(_),b=[],w=[],x=0;x<r.length;x++){i=r[x];var S=o[i];for(var T in S){var E=S[T],P=1,O=c[T],M=v[O],A=n(P,M,O),R=f.MACSTRING(E,A);void 0===R&&(P=0,O=e.indexOf(T),O<0&&(O=e.length,e.push(T)),M=4,R=f.UTF16(E));var C=l(R,w);b.push(a(P,M,O,i,R.length,C));var k=d[T];if(void 0!==k){var F=f.UTF16(E),L=l(F,w);b.push(a(3,1,k,i,F.length,L))}}}b.sort(function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID});for(var I=new y.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:b.length},{name:"stringOffset",type:"USHORT",value:6+12*b.length}]),D=0;D<b.length;D++)I.fields.push({name:"record_"+D,type:"RECORD",value:b[D]});return I.fields.push({name:"strings",type:"LITERAL",value:w}),I}var p=t("../types"),c=p.decode,f=p.encode,d=t("../parse"),y=t("../table"),m=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],g={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},v={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},_={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},b="utf-16",w={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},x={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};i.parse=o,i.make=u},{"../parse":18,"../table":21,"../types":40}],37:[function(t,e,i){"use strict";function r(t){for(var e=0;e<h.length;e+=1){var i=h[e];if(t>=i.begin&&t<i.end)return e}return-1}function n(t,e){var i={},r=new s.Parser(t,e);i.version=r.parseUShort(),i.xAvgCharWidth=r.parseShort(),i.usWeightClass=r.parseUShort(),i.usWidthClass=r.parseUShort(),i.fsType=r.parseUShort(),i.ySubscriptXSize=r.parseShort(),i.ySubscriptYSize=r.parseShort(),i.ySubscriptXOffset=r.parseShort(),i.ySubscriptYOffset=r.parseShort(),i.ySuperscriptXSize=r.parseShort(),i.ySuperscriptYSize=r.parseShort(),i.ySuperscriptXOffset=r.parseShort(),i.ySuperscriptYOffset=r.parseShort(),i.yStrikeoutSize=r.parseShort(),i.yStrikeoutPosition=r.parseShort(),i.sFamilyClass=r.parseShort(),i.panose=[];for(var n=0;n<10;n++)i.panose[n]=r.parseByte();return i.ulUnicodeRange1=r.parseULong(),i.ulUnicodeRange2=r.parseULong(),i.ulUnicodeRange3=r.parseULong(),i.ulUnicodeRange4=r.parseULong(),i.achVendID=String.fromCharCode(r.parseByte(),r.parseByte(),r.parseByte(),r.parseByte()),i.fsSelection=r.parseUShort(),i.usFirstCharIndex=r.parseUShort(),i.usLastCharIndex=r.parseUShort(),i.sTypoAscender=r.parseShort(),i.sTypoDescender=r.parseShort(),i.sTypoLineGap=r.parseShort(),i.usWinAscent=r.parseUShort(),i.usWinDescent=r.parseUShort(),i.version>=1&&(i.ulCodePageRange1=r.parseULong(),i.ulCodePageRange2=r.parseULong()),i.version>=2&&(i.sxHeight=r.parseShort(),i.sCapHeight=r.parseShort(),i.usDefaultChar=r.parseUShort(),i.usBreakChar=r.parseUShort(),i.usMaxContent=r.parseUShort()),i}function o(t){return new a.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)}var s=t("../parse"),a=t("../table"),h=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];i.unicodeRanges=h,i.getUnicodeRange=r,i.parse=n,i.make=o},{"../parse":18,"../table":21}],38:[function(t,e,i){"use strict";function r(t,e){var i,r={},n=new s.Parser(t,e);switch(r.version=n.parseVersion(),r.italicAngle=n.parseFixed(),r.underlinePosition=n.parseShort(),r.underlineThickness=n.parseShort(),r.isFixedPitch=n.parseULong(),r.minMemType42=n.parseULong(),r.maxMemType42=n.parseULong(),r.minMemType1=n.parseULong(),r.maxMemType1=n.parseULong(),r.version){case 1:r.names=o.standardNames.slice();break;case 2:for(r.numberOfGlyphs=n.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs),i=0;i<r.numberOfGlyphs;i++)r.glyphNameIndex[i]=n.parseUShort();for(r.names=[],i=0;i<r.numberOfGlyphs;i++)if(r.glyphNameIndex[i]>=o.standardNames.length){var a=n.parseChar();r.names.push(n.parseString(a))}break;case 2.5:for(r.numberOfGlyphs=n.parseUShort(),r.offset=new Array(r.numberOfGlyphs),i=0;i<r.numberOfGlyphs;i++)r.offset[i]=n.parseChar()}return r}function n(){return new a.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}var o=t("../encoding"),s=t("../parse"),a=t("../table");i.parse=r,i.make=n},{"../encoding":11,"../parse":18,"../table":21}],39:[function(t,e,i){"use strict";function r(t){return Math.log(t)/Math.log(2)|0}function n(t){for(;t.length%4!=0;)t.push(0);for(var e=0,i=0;i<t.length;i+=4)e+=(t[i]<<24)+(t[i+1]<<16)+(t[i+2]<<8)+t[i+3];return e%=Math.pow(2,32)}function o(t,e,i,r){return new p.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==i?i:0},{name:"length",type:"ULONG",value:void 0!==r?r:0}])}function s(t){var e=new p.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var i=Math.pow(2,r(e.numTables));e.searchRange=16*i,e.entrySelector=r(i),e.rangeShift=16*e.numTables-e.searchRange;for(var s=[],a=[],h=e.sizeOf()+o().sizeOf()*e.numTables;h%4!=0;)h+=1,a.push({name:"padding",type:"BYTE",value:0});for(var l=0;l<t.length;l+=1){var c=t[l];u.argument(4===c.tableName.length,"Table name"+c.tableName+" is invalid.");var f=c.sizeOf(),d=o(c.tableName,n(c.encode()),h,f);for(s.push({name:d.tag+" Table Record",type:"RECORD",value:d}),a.push({name:c.tableName+" table",type:"RECORD",value:c}),h+=f,u.argument(!isNaN(h),"Something went wrong calculating the offset.");h%4!=0;)h+=1,a.push({name:"padding",type:"BYTE",value:0})}return s.sort(function(t,e){return t.value.tag>e.value.tag?1:-1}),e.fields=e.fields.concat(s),e.fields=e.fields.concat(a),e}function a(t,e,i){for(var r=0;r<e.length;r+=1){var n=t.charToGlyphIndex(e[r]);if(n>0){return t.glyphs.get(n).getMetrics()}}return i}function h(t){for(var e=0,i=0;i<t.length;i+=1)e+=t[i];return e/t.length}function l(t){for(var e,i=[],r=[],o=[],l=[],u=[],p=[],T=[],E=0,P=0,O=0,M=0,A=0,R=0;R<t.glyphs.length;R+=1){var C=t.glyphs.get(R),k=0|C.unicode;if(isNaN(C.advanceWidth))throw new Error("Glyph "+C.name+" ("+R+"): advanceWidth is not a number.");(e>k||void 0===e)&&k>0&&(e=k),E<k&&(E=k);var F=b.getUnicodeRange(k);if(F<32)P|=1<<F;else if(F<64)O|=1<<F-32;else if(F<96)M|=1<<F-64;else{if(!(F<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");A|=1<<F-96}if(".notdef"!==C.name){var L=C.getMetrics();i.push(L.xMin),r.push(L.yMin),o.push(L.xMax),l.push(L.yMax),p.push(L.leftSideBearing),T.push(L.rightSideBearing),u.push(C.advanceWidth)}}var I={xMin:Math.min.apply(null,i),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,o),yMax:Math.max.apply(null,l),advanceWidthMax:Math.max.apply(null,u),advanceWidthAvg:h(u),minLeftSideBearing:Math.min.apply(null,p),maxLeftSideBearing:Math.max.apply(null,p),minRightSideBearing:Math.min.apply(null,T)};I.ascender=t.ascender,I.descender=t.descender;var D=d.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:I.xMin,yMin:I.yMin,xMax:I.xMax,yMax:I.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),U=y.make({ascender:I.ascender,descender:I.descender,advanceWidthMax:I.advanceWidthMax,minLeftSideBearing:I.minLeftSideBearing,minRightSideBearing:I.minRightSideBearing,xMaxExtent:I.maxLeftSideBearing+(I.xMax-I.xMin),numberOfHMetrics:t.glyphs.length}),B=v.make(t.glyphs.length),N=b.make({xAvgCharWidth:Math.round(I.advanceWidthAvg),usWeightClass:t.tables.os2.usWeightClass,usWidthClass:t.tables.os2.usWidthClass,usFirstCharIndex:e,usLastCharIndex:E,ulUnicodeRange1:P,ulUnicodeRange2:O,ulUnicodeRange3:M,ulUnicodeRange4:A,fsSelection:t.tables.os2.fsSelection,sTypoAscender:I.ascender,sTypoDescender:I.descender,sTypoLineGap:0,usWinAscent:I.yMax,usWinDescent:Math.abs(I.yMin),ulCodePageRange1:1,sxHeight:a(t,"xyvw",{yMax:Math.round(I.ascender/2)}).yMax,sCapHeight:a(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",I).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0}),q=m.make(t.glyphs),G=c.make(t.glyphs),j=t.getEnglishName("fontFamily"),V=t.getEnglishName("fontSubfamily"),z=j+" "+V,H=t.getEnglishName("postScriptName");H||(H=j.replace(/\s/g,"")+"-"+V);var W={};for(var X in t.names)W[X]=t.names[X];W.uniqueID||(W.uniqueID={en:t.getEnglishName("manufacturer")+":"+z}),W.postScriptName||(W.postScriptName={en:H}),W.preferredFamily||(W.preferredFamily=t.names.fontFamily),W.preferredSubfamily||(W.preferredSubfamily=t.names.fontSubfamily);var Y=[],Z=_.make(W,Y),Q=Y.length>0?g.make(Y):void 0,J=w.make(),$=f.make(t.glyphs,{version:t.getEnglishName("version"),fullName:z,familyName:j,weightName:V,postScriptName:H,unitsPerEm:t.unitsPerEm,fontBBox:[0,I.yMin,I.ascender,I.advanceWidthMax]}),K=t.metas&&Object.keys(t.metas).length>0?S.make(t.metas):void 0,tt=[D,U,B,N,Z,G,J,$,q];Q&&tt.push(Q),t.tables.gsub&&tt.push(x.make(t.tables.gsub)),K&&tt.push(K);var et=s(tt),it=et.encode(),rt=n(it),nt=et.fields,ot=!1;for(R=0;R<nt.length;R+=1)if("head table"===nt[R].name){nt[R].value.checkSumAdjustment=2981146554-rt,ot=!0;break}if(!ot)throw new Error("Could not find head table with checkSum to adjust.");return et}var u=t("../check"),p=t("../table"),c=t("./cmap"),f=t("./cff"),d=t("./head"),y=t("./hhea"),m=t("./hmtx"),g=t("./ltag"),v=t("./maxp"),_=t("./name"),b=t("./os2"),w=t("./post"),x=t("./gsub"),S=t("./meta");i.computeCheckSum=n,i.make=s,i.fontToTable=l},{"../check":9,"../table":21,"./cff":22,"./cmap":23,"./gsub":27,"./head":28,"./hhea":29,"./hmtx":30,"./ltag":33,"./maxp":34,"./meta":35,"./name":36,"./os2":37,"./post":38}],40:[function(t,e,i){"use strict";function r(t){return function(){return t}}function n(t){return t>=-128&&t<=127}function o(t,e,i){for(var r=0,n=t.length;e<n&&r<64&&0===t[e];)++e,++r;return i.push(128|r-1),e}function s(t,e,i){for(var r=0,o=t.length,s=e;s<o&&r<64;){var a=t[s];if(!n(a))break;if(0===a&&s+1<o&&0===t[s+1])break;++s,++r}i.push(r-1);for(var h=e;h<s;++h)i.push(t[h]+256&255);return s}function a(t,e,i){for(var r=0,o=t.length,s=e;s<o&&r<64;){var a=t[s];if(0===a)break;if(n(a)&&s+1<o&&n(t[s+1]))break;++s,++r}i.push(64|r-1);for(var h=e;h<s;++h){var l=t[h];i.push(l+65536>>8&255,l+256&255)}return s}var h=t("./check"),l={},u={},p={};u.BYTE=function(t){return h.argument(t>=0&&t<=255,"Byte value should be between 0 and 255."),[t]},p.BYTE=r(1),u.CHAR=function(t){return[t.charCodeAt(0)]},p.CHAR=r(1),u.CHARARRAY=function(t){for(var e=[],i=0;i<t.length;i+=1)e[i]=t.charCodeAt(i);return e},p.CHARARRAY=function(t){return t.length},u.USHORT=function(t){return[t>>8&255,255&t]},p.USHORT=r(2),u.SHORT=function(t){return t>=32768&&(t=-(65536-t)),[t>>8&255,255&t]},p.SHORT=r(2),u.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},p.UINT24=r(3),u.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},p.ULONG=r(4),u.LONG=function(t){return t>=2147483648&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},p.LONG=r(4),u.FIXED=u.ULONG,p.FIXED=p.ULONG,u.FWORD=u.SHORT,p.FWORD=p.SHORT,u.UFWORD=u.USHORT,p.UFWORD=p.USHORT,u.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},p.LONGDATETIME=r(8),u.TAG=function(t){return h.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},p.TAG=r(4),u.Card8=u.BYTE,p.Card8=p.BYTE,u.Card16=u.USHORT,p.Card16=p.USHORT,u.OffSize=u.BYTE,p.OffSize=p.BYTE,u.SID=u.USHORT,p.SID=p.USHORT,u.NUMBER=function(t){return t>=-107&&t<=107?[t+139]:t>=108&&t<=1131?(t-=108,[247+(t>>8),255&t]):t>=-1131&&t<=-108?(t=-t-108,[251+(t>>8),255&t]):t>=-32768&&t<=32767?u.NUMBER16(t):u.NUMBER32(t)},p.NUMBER=function(t){return u.NUMBER(t).length},u.NUMBER16=function(t){return[28,t>>8&255,255&t]},p.NUMBER16=r(3),u.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},p.NUMBER32=r(5),u.REAL=function(t){var e=t.toString(),i=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(i){var r=parseFloat("1e"+((i[2]?+i[2]:0)+i[1].length));e=(Math.round(t*r)/r).toString()}var n,o,s="";for(n=0,o=e.length;n<o;n+=1){var a=e[n];s+="e"===a?"-"===e[++n]?"c":"b":"."===a?"a":"-"===a?"e":a}s+=1&s.length?"f":"ff";var h=[30];for(n=0,o=s.length;n<o;n+=2)h.push(parseInt(s.substr(n,2),16));return h},p.REAL=function(t){return u.REAL(t).length},u.NAME=u.CHARARRAY,p.NAME=p.CHARARRAY,u.STRING=u.CHARARRAY,p.STRING=p.CHARARRAY,l.UTF8=function(t,e,i){for(var r=[],n=i,o=0;o<n;o++,e+=1)r[o]=t.getUint8(e);return String.fromCharCode.apply(null,r)},l.UTF16=function(t,e,i){for(var r=[],n=i/2,o=0;o<n;o++,e+=2)r[o]=t.getUint16(e);return String.fromCharCode.apply(null,r)},u.UTF16=function(t){for(var e=[],i=0;i<t.length;i+=1){var r=t.charCodeAt(i);e[e.length]=r>>8&255,e[e.length]=255&r}return e},p.UTF16=function(t){return 2*t.length};var c={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};l.MACSTRING=function(t,e,i,r){var n=c[r];if(void 0!==n){for(var o="",s=0;s<i;s++){var a=t.getUint8(e+s);o+=a<=127?String.fromCharCode(a):n[127&a]}return o}};var f,d="function"==typeof WeakMap&&new WeakMap,y=function(t){if(!f){f={};for(var e in c)f[e]=new String(e)}var i=f[t];if(void 0!==i){if(d){var r=d.get(i);if(void 0!==r)return r}var n=c[t];if(void 0!==n){for(var o={},s=0;s<n.length;s++)o[n.charCodeAt(s)]=s+128;return d&&d.set(i,o),o}}};u.MACSTRING=function(t,e){var i=y(e);if(void 0!==i){for(var r=[],n=0;n<t.length;n++){var o=t.charCodeAt(n);if(o>=128&&void 0===(o=i[o]))return;r[n]=o}return r}},p.MACSTRING=function(t,e){var i=u.MACSTRING(t,e);return void 0!==i?i.length:0},u.VARDELTAS=function(t){for(var e=0,i=[];e<t.length;){var r=t[e];e=0===r?o(t,e,i):r>=-128&&r<=127?s(t,e,i):a(t,e,i)}return i},u.INDEX=function(t){var e,i=1,r=[i],n=[];for(e=0;e<t.length;e+=1){var o=u.OBJECT(t[e]);Array.prototype.push.apply(n,o),i+=o.length,r.push(i)}if(0===n.length)return[0,0];var s=[],a=1+Math.floor(Math.log(i)/Math.log(2))/8|0,h=[void 0,u.BYTE,u.USHORT,u.UINT24,u.ULONG][a];for(e=0;e<r.length;e+=1){var l=h(r[e]);Array.prototype.push.apply(s,l)}return Array.prototype.concat(u.Card16(t.length),u.OffSize(a),s,n)},p.INDEX=function(t){return u.INDEX(t).length},u.DICT=function(t){for(var e=[],i=Object.keys(t),r=i.length,n=0;n<r;n+=1){var o=parseInt(i[n],0),s=t[o];e=e.concat(u.OPERAND(s.value,s.type)),e=e.concat(u.OPERATOR(o))}return e},p.DICT=function(t){return u.DICT(t).length},u.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},u.OPERAND=function(t,e){var i=[];if(Array.isArray(e))for(var r=0;r<e.length;r+=1)h.argument(t.length===e.length,"Not enough arguments given for type"+e),i=i.concat(u.OPERAND(t[r],e[r]));else if("SID"===e)i=i.concat(u.NUMBER(t));else if("offset"===e)i=i.concat(u.NUMBER32(t));else if("number"===e)i=i.concat(u.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);i=i.concat(u.REAL(t))}return i},u.OP=u.BYTE,p.OP=p.BYTE;var m="function"==typeof WeakMap&&new WeakMap;u.CHARSTRING=function(t){if(m){var e=m.get(t);if(void 0!==e)return e}for(var i=[],r=t.length,n=0;n<r;n+=1){var o=t[n];i=i.concat(u[o.type](o.value))}return m&&m.set(t,i),i},p.CHARSTRING=function(t){return u.CHARSTRING(t).length},u.OBJECT=function(t){var e=u[t.type];return h.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},p.OBJECT=function(t){var e=p[t.type];return h.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},u.TABLE=function(t){var e,i=[],r=t.fields.length,n=[],o=[];for(e=0;e<r;e+=1){var s=t.fields[e],a=u[s.type];h.argument(void 0!==a,"No encoding function for field type "+s.type+" ("+s.name+")");var l=t[s.name];void 0===l&&(l=s.value);var p=a(l);"TABLE"===s.type?(o.push(i.length),i=i.concat([0,0]),n.push(p)):i=i.concat(p)}for(e=0;e<n.length;e+=1){var c=o[e],f=i.length;h.argument(f<65536,"Table "+t.tableName+" too big."),i[c]=f>>8,i[c+1]=255&f,i=i.concat(n[e])}return i},p.TABLE=function(t){for(var e=0,i=t.fields.length,r=0;r<i;r+=1){var n=t.fields[r],o=p[n.type];h.argument(void 0!==o,"No sizeOf function for field type "+n.type+" ("+n.name+")");var s=t[n.name];void 0===s&&(s=n.value),e+=o(s),"TABLE"===n.type&&(e+=2)}return e},u.RECORD=u.TABLE,p.RECORD=p.TABLE,u.LITERAL=function(t){return t},p.LITERAL=function(t){return t.length},i.decode=l,i.encode=u,i.sizeOf=p},{"./check":9}],41:[function(t,e,i){(function(t){"use strict";i.isBrowser=function(){return"undefined"!=typeof window},i.isNode=function(){return"undefined"==typeof window},i.nodeBufferToArrayBuffer=function(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),r=0;r<t.length;++r)i[r]=t[r];return e},i.arrayBufferToNodeBuffer=function(e){for(var i=new t(e.byteLength),r=new Uint8Array(e),n=0;n<i.length;++n)i[n]=r[n];return i},i.checkArgument=function(t,e){if(!t)throw e}}).call(this,t("buffer").Buffer)},{buffer:3}],42:[function(t,e,i){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(p===setTimeout)return setTimeout(t,0);if((p===r||!p)&&setTimeout)return p=setTimeout,setTimeout(t,0);try{return p(t,0)}catch(e){try{return p.call(null,t,0)}catch(e){return p.call(this,t,0)}}}function s(t){if(c===clearTimeout)return clearTimeout(t);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(t);try{return c(t)}catch(e){try{return c.call(null,t)}catch(e){return c.call(this,t)}}}function a(){m&&d&&(m=!1,d.length?y=d.concat(y):g=-1,y.length&&h())}function h(){if(!m){var t=o(a);m=!0;for(var e=y.length;e;){for(d=y,y=[];++g<e;)d&&d[g].run();g=-1,e=y.length}d=null,m=!1,s(t)}}function l(t,e){this.fun=t,this.array=e}function u(){}var p,c,f=e.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:r}catch(t){p=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(t){c=n}}();var d,y=[],m=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];y.push(new l(t,e)),1!==y.length||m||o(h)},l.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],43:[function(t,e,i){function r(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function n(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new r,this.dtree=new r}function o(t,e,i,r){var n,o;for(n=0;n<i;++n)t[n]=0;for(n=0;n<30-i;++n)t[n+i]=n/i|0;for(o=r,n=0;n<30;++n)e[n]=o,o+=1<<t[n]}function s(t,e,i,r){var n,o;for(n=0;n<16;++n)t.table[n]=0;for(n=0;n<r;++n)t.table[e[i+n]]++;for(t.table[0]=0,o=0,n=0;n<16;++n)E[n]=o,o+=t.table[n];for(n=0;n<r;++n)e[i+n]&&(t.trans[E[e[i+n]]++]=n)}function a(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function h(t,e,i){if(!e)return i;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var r=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,r+i}function l(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var i=0,r=0,n=0,o=t.tag;do{r=2*r+(1&o),o>>>=1,++n,i+=e.table[n],r-=e.table[n]}while(r>=0);return t.tag=o,t.bitcount-=n,e.trans[i+r]}function u(t,e,i){var r,n,o,a,u,p;for(r=h(t,5,257),n=h(t,5,1),o=h(t,4,4),a=0;a<19;++a)T[a]=0;for(a=0;a<o;++a){var c=h(t,3,0);T[x[a]]=c}for(s(S,T,0,19),u=0;u<r+n;){var f=l(t,S);switch(f){case 16:var d=T[u-1];for(p=h(t,2,3);p;--p)T[u++]=d;break;case 17:for(p=h(t,3,3);p;--p)T[u++]=0;break;case 18:for(p=h(t,7,11);p;--p)T[u++]=0;break;default:T[u++]=f}}s(e,T,0,r),s(i,T,r,n)}function p(t,e,i){for(;;){var r=l(t,e);if(256===r)return d;if(r<256)t.dest[t.destLen++]=r;else{var n,o,s,a;for(r-=257,n=h(t,v[r],_[r]),o=l(t,i),s=t.destLen-h(t,b[o],w[o]),a=s;a<s+n;++a)t.dest[t.destLen++]=t.dest[a]}}}function c(t){for(var e,i,r;t.bitcount>8;)t.sourceIndex--,t.bitcount-=8;if(e=t.source[t.sourceIndex+1],e=256*e+t.source[t.sourceIndex],i=t.source[t.sourceIndex+3],i=256*i+t.source[t.sourceIndex+2],e!==(65535&~i))return y;for(t.sourceIndex+=4,r=e;r;--r)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,d}function f(t,e){var i,r,o=new n(t,e);do{switch(i=a(o),h(o,2,0)){case 0:r=c(o);break;case 1:r=p(o,m,g);break;case 2:u(o,o.ltree,o.dtree),r=p(o,o.ltree,o.dtree);break;default:r=y}if(r!==d)throw new Error("Data error")}while(!i);return o.destLen<o.dest.length?"function"==typeof o.dest.slice?o.dest.slice(0,o.destLen):o.dest.subarray(0,o.destLen):o.dest}var d=0,y=-3,m=new r,g=new r,v=new Uint8Array(30),_=new Uint16Array(30),b=new Uint8Array(30),w=new Uint16Array(30),x=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),S=new r,T=new Uint8Array(320),E=new Uint16Array(16);!function(t,e){var i;for(i=0;i<7;++i)t.table[i]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,i=0;i<24;++i)t.trans[i]=256+i;for(i=0;i<144;++i)t.trans[24+i]=i;for(i=0;i<8;++i)t.trans[168+i]=280+i;for(i=0;i<112;++i)t.trans[176+i]=144+i;for(i=0;i<5;++i)e.table[i]=0;for(e.table[5]=32,i=0;i<32;++i)e.trans[i]=i}(m,g),o(v,_,4,3),o(b,w,2,1),v[28]=0,_[28]=258,e.exports=f},{}],44:[function(t,e,i){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function i(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return g.iterable&&(e[Symbol.iterator]=function(){return e}),e}function n(t){this.map={},t instanceof n?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function s(t){return new Promise(function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}})}function a(t){var e=new FileReader,i=s(e);return e.readAsArrayBuffer(t),i}function h(t){var e=new FileReader,i=s(e);return e.readAsText(t),i}function l(t){for(var e=new Uint8Array(t),i=new Array(e.length),r=0;r<e.length;r++)i[r]=String.fromCharCode(e[r]);return i.join("")}function u(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function p(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(g.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(g.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(g.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(g.arrayBuffer&&g.blob&&_(t))this._bodyArrayBuffer=u(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!g.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!b(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=u(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return h(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(l(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function c(t){var e=t.toUpperCase();return w.indexOf(e)>-1?e:t}function f(t,e){e=e||{};var i=e.body;if(t instanceof f){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new n(t.headers)),this.method=t.method,this.mode=t.mode,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new n(e.headers)),this.method=c(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function d(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var i=t.split("="),r=i.shift().replace(/\+/g," "),n=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(n))}}),e}function y(t){var e=new n;return t.split(/\r?\n/).forEach(function(t){var i=t.split(":"),r=i.shift().trim();if(r){var n=i.join(":").trim();e.append(r,n)}}),e}function m(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new n(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var g={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(g.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=function(t){return t&&DataView.prototype.isPrototypeOf(t)},b=ArrayBuffer.isView||function(t){return t&&v.indexOf(Object.prototype.toString.call(t))>-1};n.prototype.append=function(t,r){t=e(t),r=i(r);var n=this.map[t];this.map[t]=n?n+","+r:r},n.prototype.delete=function(t){delete this.map[e(t)]},n.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},n.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},n.prototype.set=function(t,r){this.map[e(t)]=i(r)},n.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},n.prototype.keys=function(){var t=[];return this.forEach(function(e,i){t.push(i)}),r(t)},n.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},n.prototype.entries=function(){var t=[];return this.forEach(function(e,i){t.push([i,e])}),r(t)},g.iterable&&(n.prototype[Symbol.iterator]=n.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];f.prototype.clone=function(){return new f(this,{body:this._bodyInit})},p.call(f.prototype),p.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},m.error=function(){var t=new m(null,{status:0,statusText:""});return t.type="error",t};var x=[301,302,303,307,308];m.redirect=function(t,e){if(-1===x.indexOf(e))throw new RangeError("Invalid status code");return new m(null,{status:e,headers:{location:t}})},t.Headers=n,t.Request=f,t.Response=m,t.fetch=function(t,e){return new Promise(function(i,r){var n=new f(t,e),o=new XMLHttpRequest;o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:y(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;i(new m(e,t))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(n.method,n.url,!0),"include"===n.credentials&&(o.withCredentials=!0),"responseType"in o&&g.blob&&(o.responseType="blob"),n.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===n._bodyInit?null:n._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}],45:[function(t,e,i){"use strict";var r=t("./core/core");t("./color/p5.Color"),t("./core/p5.Element"),t("./typography/p5.Font"),t("./core/p5.Graphics"),t("./core/p5.Renderer2D"),t("./image/p5.Image"),t("./math/p5.Vector"),t("./io/p5.TableRow"),t("./io/p5.Table"),t("./io/p5.XML"),t("./color/creating_reading"),t("./color/setting"),t("./core/constants"),t("./utilities/conversion"),t("./utilities/array_functions"),t("./utilities/string_functions"),t("./core/environment"),t("./image/image"),t("./image/loading_displaying"),t("./image/pixels"),t("./io/files"),t("./events/keyboard"),t("./events/acceleration"),t("./events/mouse"),t("./utilities/time_date"),t("./events/touch"),t("./math/math"),t("./math/calculation"),t("./math/random"),t("./math/noise"),t("./math/trigonometry"),t("./core/rendering"),t("./core/2d_primitives"),t("./core/attributes"),t("./core/curves"),t("./core/vertex"),t("./core/structure"),t("./core/transform"),t("./typography/attributes"),t("./typography/loading_displaying"),t("./data/p5.TypedDict"),t("./webgl/p5.RendererGL"),t("./webgl/p5.Geometry"),t("./webgl/p5.RendererGL.Retained"),t("./webgl/p5.RendererGL.Immediate"),t("./webgl/primitives"),t("./webgl/loading"),t("./webgl/p5.Matrix"),t("./webgl/material"),t("./webgl/light"),t("./webgl/shader"),t("./webgl/camera"),t("./webgl/interaction"),t("./core/init.js"),e.exports=r},{"./color/creating_reading":47,"./color/p5.Color":48,"./color/setting":49,"./core/2d_primitives":50,"./core/attributes":51,"./core/constants":53,"./core/core":54,"./core/curves":55,"./core/environment":56,"./core/init.js":58,"./core/p5.Element":59,"./core/p5.Graphics":60,"./core/p5.Renderer2D":62,"./core/rendering":63,"./core/structure":65,"./core/transform":66,"./core/vertex":67,"./data/p5.TypedDict":68,"./events/acceleration":69,"./events/keyboard":70,"./events/mouse":71,"./events/touch":72,"./image/image":74,"./image/loading_displaying":75,"./image/p5.Image":76,"./image/pixels":77,"./io/files":78,"./io/p5.Table":79,"./io/p5.TableRow":80,"./io/p5.XML":81,"./math/calculation":82,"./math/math":83,"./math/noise":84,"./math/p5.Vector":85,"./math/random":87,"./math/trigonometry":88,"./typography/attributes":89,"./typography/loading_displaying":90,"./typography/p5.Font":91,"./utilities/array_functions":92,"./utilities/conversion":93,"./utilities/string_functions":94,"./utilities/time_date":95,"./webgl/camera":96,"./webgl/interaction":97,"./webgl/light":98,"./webgl/loading":99,"./webgl/material":100,"./webgl/p5.Geometry":101,"./webgl/p5.Matrix":102,"./webgl/p5.RendererGL":105,"./webgl/p5.RendererGL.Immediate":103,"./webgl/p5.RendererGL.Retained":104,"./webgl/primitives":106,"./webgl/shader":107}],46:[function(t,e,i){"use strict";var r=t("../core/core");r.ColorConversion={},r.ColorConversion._hsbaToHSLA=function(t){var e=t[0],i=t[1],r=t[2],n=(2-i)*r/2;return 0!==n&&(1===n?i=0:n<.5?i/=2-i:i=i*r/(2-2*n)),[e,i,n,t[3]]},r.ColorConversion._hsbaToRGBA=function(t){var e=6*t[0],i=t[1],r=t[2],n=[];if(0===i)n=[r,r,r,t[3]];else{var o,s,a,h=Math.floor(e),l=r*(1-i),u=r*(1-i*(e-h)),p=r*(1-i*(1+h-e));1===h?(o=u,s=r,a=l):2===h?(o=l,s=r,a=p):3===h?(o=l,s=u,a=r):4===h?(o=p,s=l,a=r):5===h?(o=r,s=l,a=u):(o=r,s=p,a=l),n=[o,s,a,t[3]]}return n},r.ColorConversion._hslaToHSBA=function(t){var e,i=t[0],r=t[1],n=t[2];return e=n<.5?(1+r)*n:n+r-n*r,r=2*(e-n)/e,[i,r,e,t[3]]},r.ColorConversion._hslaToRGBA=function(t){var e=6*t[0],i=t[1],r=t[2],n=[];if(0===i)n=[r,r,r,t[3]];else{var o;o=r<.5?(1+i)*r:r+i-r*i;var s=2*r-o,a=function(t,e,i){return t<0?t+=6:t>=6&&(t-=6),t<1?e+(i-e)*t:t<3?i:t<4?e+(i-e)*(4-t):e};n=[a(e+2,s,o),a(e,s,o),a(e-2,s,o),t[3]]}return n},r.ColorConversion._rgbaToHSBA=function(t){var e,i,r=t[0],n=t[1],o=t[2],s=Math.max(r,n,o),a=s-Math.min(r,n,o);return 0===a?(e=0,i=0):(i=a/s,r===s?e=(n-o)/a:n===s?e=2+(o-r)/a:o===s&&(e=4+(r-n)/a),e<0?e+=6:e>=6&&(e-=6)),[e/6,i,s,t[3]]},r.ColorConversion._rgbaToHSLA=function(t){var e,i,r=t[0],n=t[1],o=t[2],s=Math.max(r,n,o),a=Math.min(r,n,o),h=s+a,l=s-a;return 0===l?(e=0,i=0):(i=h<1?l/h:l/(2-h),r===s?e=(n-o)/l:n===s?e=2+(o-r)/l:o===s&&(e=4+(r-n)/l),e<0?e+=6:e>=6&&(e-=6)),[e/6,i,h/2,t[3]]},e.exports=r.ColorConversion},{"../core/core":54}],47:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("../core/constants");t("./p5.Color"),r.prototype.alpha=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getAlpha();throw new Error("Needs p5.Color or pixel array as argument.")},r.prototype.blue=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getBlue();throw new Error("Needs p5.Color or pixel array as argument.")},r.prototype.brightness=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getBrightness();throw new Error("Needs p5.Color or pixel array as argument.")},r.prototype.color=function(){return arguments[0]instanceof r.Color?arguments[0]:arguments[0]instanceof Array?this instanceof r.Renderer?new r.Color(this,arguments[0]):new r.Color(this._renderer,arguments[0]):this instanceof r.Renderer?new r.Color(this,arguments):new r.Color(this._renderer,arguments)},r.prototype.green=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getGreen();throw new Error("Needs p5.Color or pixel array as argument.")},r.prototype.hue=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getHue();throw new Error("Needs p5.Color or pixel array as argument.")},r.prototype.lerpColor=function(t,e,i){var r,o,s,a,h,l,u=this._renderer._colorMode,p=this._renderer._colorMaxes;if(u===n.RGB)h=t.levels.map(function(t){return t/255}),l=e.levels.map(function(t){return t/255});else if(u===n.HSB)t._getBrightness(),e._getBrightness(),h=t.hsba,l=e.hsba;else{if(u!==n.HSL)throw new Error(u+"cannot be used for interpolation.");t._getLightness(),e._getLightness(),h=t.hsla,l=e.hsla}return i=Math.max(Math.min(i,1),0),void 0===this.lerp&&(this.lerp=function(t,e,i){return i*(e-t)+t}),r=this.lerp(h[0],l[0],i),o=this.lerp(h[1],l[1],i),s=this.lerp(h[2],l[2],i),a=this.lerp(h[3],l[3],i),r*=p[u][0],o*=p[u][1],s*=p[u][2],a*=p[u][3],this.color(r,o,s,a)},r.prototype.lightness=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getLightness();throw new Error("Needs p5.Color or pixel array as argument.")},r.prototype.red=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getRed();throw new Error("Needs p5.Color or pixel array as argument.")},r.prototype.saturation=function(t){if(t instanceof r.Color||t instanceof Array)return this.color(t)._getSaturation();throw new Error("Needs p5.Color or pixel array as argument.")},e.exports=r},{"../core/constants":53,"../core/core":54,"./p5.Color":48}],48:[function(t,e,i){var r=t("../core/core"),n=t("../core/constants"),o=t("./color_conversion");r.Color=function(t,e){if(this.mode=t._colorMode,this.maxes=t._colorMaxes,this.mode!==n.RGB&&this.mode!==n.HSL&&this.mode!==n.HSB)throw new Error(this.mode+" is an invalid colorMode.");return this._array=r.Color._parseInputs.apply(t,e),this.levels=this._array.map(function(t){return Math.round(255*t)}),this},r.Color.prototype.toString=function(){var t=this.levels,e=this._array[3];return"rgba("+t[0]+","+t[1]+","+t[2]+","+e+")"},r.Color.prototype._getAlpha=function(){return this._array[3]*this.maxes[this.mode][3]},r.Color.prototype._getBlue=function(){return this._array[2]*this.maxes[n.RGB][2]},r.Color.prototype._getBrightness=function(){return this.hsba||(this.hsba=o._rgbaToHSBA(this._array)),this.hsba[2]*this.maxes[n.HSB][2]},r.Color.prototype._getGreen=function(){return this._array[1]*this.maxes[n.RGB][1]},r.Color.prototype._getHue=function(){return this.mode===n.HSB?(this.hsba||(this.hsba=o._rgbaToHSBA(this._array)),this.hsba[0]*this.maxes[n.HSB][0]):(this.hsla||(this.hsla=o._rgbaToHSLA(this._array)),this.hsla[0]*this.maxes[n.HSL][0])},r.Color.prototype._getLightness=function(){return this.hsla||(this.hsla=o._rgbaToHSLA(this._array)),this.hsla[2]*this.maxes[n.HSL][2]},r.Color.prototype._getRed=function(){return this._array[0]*this.maxes[n.RGB][0]},r.Color.prototype._getSaturation=function(){return this.mode===n.HSB?(this.hsba||(this.hsba=o._rgbaToHSBA(this._array)),this.hsba[1]*this.maxes[n.HSB][1]):(this.hsla||(this.hsla=o._rgbaToHSLA(this._array)),this.hsla[1]*this.maxes[n.HSL][1])};var s={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},a=/\s*/,h=/(\d{1,3})/,l=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/,u=new RegExp(l.source+"%"),p={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX4:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,HEX8:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",h.source,",",h.source,",",h.source,"\\)$"].join(a.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",u.source,",",u.source,",",u.source,"\\)$"].join(a.source),"i"),RGBA:new RegExp(["^rgba\\(",h.source,",",h.source,",",h.source,",",l.source,"\\)$"].join(a.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",u.source,",",u.source,",",u.source,",",l.source,"\\)$"].join(a.source),"i"),HSL:new RegExp(["^hsl\\(",h.source,",",u.source,",",u.source,"\\)$"].join(a.source),"i"),HSLA:new RegExp(["^hsla\\(",h.source,",",u.source,",",u.source,",",l.source,"\\)$"].join(a.source),"i"),HSB:new RegExp(["^hsb\\(",h.source,",",u.source,",",u.source,"\\)$"].join(a.source),"i"),HSBA:new RegExp(["^hsba\\(",h.source,",",u.source,",",u.source,",",l.source,"\\)$"].join(a.source),"i")};r.Color._parseInputs=function(){var t=arguments.length,e=this._colorMode,i=this._colorMaxes,a=[];if(t>=3)return a[0]=arguments[0]/i[e][0],a[1]=arguments[1]/i[e][1],a[2]=arguments[2]/i[e][2],"number"==typeof arguments[3]?a[3]=arguments[3]/i[e][3]:a[3]=1,a=a.map(function(t){return Math.max(Math.min(t,1),0)}),e===n.HSL?o._hslaToRGBA(a):e===n.HSB?o._hsbaToRGBA(a):a;if(1===t&&"string"==typeof arguments[0]){var h=arguments[0].trim().toLowerCase();if(s[h])return r.Color._parseInputs.apply(this,[s[h]]);if(p.HEX3.test(h))return a=p.HEX3.exec(h).slice(1).map(function(t){return parseInt(t+t,16)/255}),a[3]=1,a;if(p.HEX6.test(h))return a=p.HEX6.exec(h).slice(1).map(function(t){return parseInt(t,16)/255}),a[3]=1,a;if(p.HEX4.test(h))return a=p.HEX4.exec(h).slice(1).map(function(t){return parseInt(t+t,16)/255});if(p.HEX8.test(h))return a=p.HEX8.exec(h).slice(1).map(function(t){return parseInt(t,16)/255});if(p.RGB.test(h))return a=p.RGB.exec(h).slice(1).map(function(t){return t/255}),a[3]=1,a;if(p.RGB_PERCENT.test(h))return a=p.RGB_PERCENT.exec(h).slice(1).map(function(t){return parseFloat(t)/100}),a[3]=1,a;if(p.RGBA.test(h))return a=p.RGBA.exec(h).slice(1).map(function(t,e){return 3===e?parseFloat(t):t/255});if(p.RGBA_PERCENT.test(h))return a=p.RGBA_PERCENT.exec(h).slice(1).map(function(t,e){return 3===e?parseFloat(t):parseFloat(t)/100});if(p.HSL.test(h)?(a=p.HSL.exec(h).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:parseInt(t,10)/100}),a[3]=1):p.HSLA.test(h)&&(a=p.HSLA.exec(h).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:3===e?parseFloat(t):parseInt(t,10)/100})),a=a.map(function(t){return Math.max(Math.min(t,1),0)}),a.length)return o._hslaToRGBA(a);if(p.HSB.test(h)?(a=p.HSB.exec(h).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:parseInt(t,10)/100}),a[3]=1):p.HSBA.test(h)&&(a=p.HSBA.exec(h).slice(1).map(function(t,e){return 0===e?parseInt(t,10)/360:3===e?parseFloat(t):parseInt(t,10)/100})),a=a.map(function(t){return Math.max(Math.min(t,1),0)}),a.length)return o._hsbaToRGBA(a);a=[1,1,1,1]}else{if(1!==t&&2!==t||"number"!=typeof arguments[0])throw new Error(arguments+"is not a valid color representation.");a[0]=arguments[0]/i[e][2],a[1]=arguments[0]/i[e][2],a[2]=arguments[0]/i[e][2],"number"==typeof arguments[1]?a[3]=arguments[1]/i[e][3]:a[3]=1,a=a.map(function(t){return Math.max(Math.min(t,1),0)})}return a},e.exports=r.Color},{"../core/constants":53,"../core/core":54,"./color_conversion":46}],49:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("../core/constants");t("./p5.Color"),r.prototype.background=function(){return arguments[0]instanceof r.Image?this.image(arguments[0],0,0,this.width,this.height):this._renderer.background.apply(this._renderer,arguments),this},r.prototype.clear=function(){return this._renderer.clear(),this},r.prototype.colorMode=function(){if(arguments[0]===n.RGB||arguments[0]===n.HSB||arguments[0]===n.HSL){this._renderer._colorMode=arguments[0];var t=this._renderer._colorMaxes[this._renderer._colorMode];2===arguments.length?(t[0]=arguments[1],t[1]=arguments[1],t[2]=arguments[1],t[3]=arguments[1]):4===arguments.length?(t[0]=arguments[1],t[1]=arguments[2],t[2]=arguments[3]):5===arguments.length&&(t[0]=arguments[1],t[1]=arguments[2],t[2]=arguments[3],t[3]=arguments[4])}return this},r.prototype.fill=function(){return this._renderer._setProperty("_fillSet",!0),this._renderer._setProperty("_doFill",!0),this._renderer.fill.apply(this._renderer,arguments),this},r.prototype.noFill=function(){return this._renderer._setProperty("_doFill",!1),this},r.prototype.noStroke=function(){return this._renderer._setProperty("_doStroke",!1),this},r.prototype.stroke=function(){return this._renderer._setProperty("_strokeSet",!0),this._renderer._setProperty("_doStroke",!0),this._renderer.stroke.apply(this._renderer,arguments),this},e.exports=r},{"../core/constants":53,"../core/core":54,"./p5.Color":48}],50:[function(t,e,i){"use strict";var r=t("./core"),n=t("./constants"),o=t("./canvas");t("./error_helpers"),r.prototype.arc=function(t,e,i,r,o,s,a){for(var h=new Array(arguments.length),l=0;l<h.length;++l)h[l]=arguments[l];if(!this._renderer._doStroke&&!this._renderer._doFill)return this;for(this._angleMode===n.DEGREES&&(o=this.radians(o),s=this.radians(s));o<0;)o+=n.TWO_PI;for(;s<0;)s+=n.TWO_PI;return o%=n.TWO_PI,s%=n.TWO_PI,s===o&&(s+=n.TWO_PI),o=o<=n.HALF_PI?Math.atan(i/r*Math.tan(o)):o>n.HALF_PI&&o<=3*n.HALF_PI?Math.atan(i/r*Math.tan(o))+n.PI:Math.atan(i/r*Math.tan(o))+n.TWO_PI,s=s<=n.HALF_PI?Math.atan(i/r*Math.tan(s)):s>n.HALF_PI&&s<=3*n.HALF_PI?Math.atan(i/r*Math.tan(s))+n.PI:Math.atan(i/r*Math.tan(s))+n.TWO_PI,o>s&&(s+=n.TWO_PI),i=Math.abs(i),r=Math.abs(r),this._renderer.arc(t,e,i,r,o,s,a),this},r.prototype.ellipse=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];if(3===t.length&&t.push(t[2]),t[2]<0&&(t[2]=Math.abs(t[2])),t[3]<0&&(t[3]=Math.abs(t[3])),!this._renderer._doStroke&&!this._renderer._doFill)return this;var i=o.modeAdjust(t[0],t[1],t[2],t[3],this._renderer._ellipseMode);return t[0]=i.x,t[1]=i.y,t[2]=i.w,t[3]=i.h,this._renderer.ellipse(t),this},r.prototype.line=function(){if(!this._renderer._doStroke)return this;for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];return this._renderer.isP3D?this._renderer.line(t[0],t[1],t[2],t[3],t[4],t[5]):this._renderer.line(t[0],t[1],t[2],t[3]),this},r.prototype.point=function(){if(!this._renderer._doStroke)return this;for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];return this._renderer.isP3D?this._renderer.point(t[0],t[1],t[2]):this._renderer.point(t[0],t[1]),this},r.prototype.quad=function(){if(!this._renderer._doStroke&&!this._renderer._doFill)return this;for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];return this._renderer.isP3D?this._renderer.quad(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]):this._renderer.quad(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),this},r.prototype.rect=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];if(!this._renderer._doStroke&&!this._renderer._doFill)return this;var i=o.modeAdjust(t[0],t[1],t[2],t[3],this._renderer._rectMode);return t[0]=i.x,t[1]=i.y,t[2]=i.w,t[3]=i.h,this._renderer.rect(t),this},r.prototype.triangle=function(){if(!this._renderer._doStroke&&!this._renderer._doFill)return this;for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];return this._renderer.triangle(t),this},e.exports=r},{"./canvas":52,"./constants":53,"./core":54,"./error_helpers":57}],51:[function(t,e,i){"use strict";var r=t("./core"),n=t("./constants");r.prototype.ellipseMode=function(t){return t!==n.CORNER&&t!==n.CORNERS&&t!==n.RADIUS&&t!==n.CENTER||(this._renderer._ellipseMode=t),this},r.prototype.noSmooth=function(){return this._renderer.noSmooth(),this},r.prototype.rectMode=function(t){return t!==n.CORNER&&t!==n.CORNERS&&t!==n.RADIUS&&t!==n.CENTER||(this._renderer._rectMode=t),this},r.prototype.smooth=function(){return this._renderer.smooth(),this},r.prototype.strokeCap=function(t){return t!==n.ROUND&&t!==n.SQUARE&&t!==n.PROJECT||this._renderer.strokeCap(t),this},r.prototype.strokeJoin=function(t){return t!==n.ROUND&&t!==n.BEVEL&&t!==n.MITER||this._renderer.strokeJoin(t),this},r.prototype.strokeWeight=function(t){return this._renderer.strokeWeight(t),this},e.exports=r},{"./constants":53,"./core":54}],52:[function(t,e,i){var r=t("./constants");e.exports={modeAdjust:function(t,e,i,n,o){return o===r.CORNER?{x:t,y:e,w:i,h:n}:o===r.CORNERS?{x:t,y:e,w:i-t,h:n-e}:o===r.RADIUS?{x:t-i,y:e-n,w:2*i,h:2*n}:o===r.CENTER?{x:t-.5*i,y:e-.5*n,w:i,h:n}:void 0},arcModeAdjust:function(t,e,i,n,o){return o===r.CORNER?{x:t+.5*i,y:e+.5*n,w:i,h:n}:o===r.CORNERS?{x:t,y:e,w:i+t,h:n+e}:o===r.RADIUS?{x:t,y:e,w:2*i,h:2*n}:o===r.CENTER?{x:t,y:e,w:i,h:n}:void 0}}},{"./constants":53}],53:[function(t,e,i){var r=Math.PI;e.exports={P2D:"p2d",WEBGL:"webgl",ARROW:"default",CROSS:"crosshair",HAND:"pointer",MOVE:"move",TEXT:"text",WAIT:"wait",HALF_PI:r/2,PI:r,QUARTER_PI:r/4,TAU:2*r,TWO_PI:2*r,DEGREES:"degrees",RADIANS:"radians",DEG_TO_RAD:r/180,RAD_TO_DEG:180/r,CORNER:"corner",CORNERS:"corners",RADIUS:"radius",RIGHT:"right",LEFT:"left",CENTER:"center",TOP:"top",BOTTOM:"bottom",BASELINE:"alphabetic",POINTS:0,LINES:1,LINE_STRIP:3,LINE_LOOP:2,TRIANGLES:4,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,QUADS:"quads",QUAD_STRIP:"quad_strip",CLOSE:"close",OPEN:"open",CHORD:"chord",PIE:"pie",PROJECT:"square",SQUARE:"butt",ROUND:"round",BEVEL:"bevel",MITER:"miter",RGB:"rgb",HSB:"hsb",HSL:"hsl",AUTO:"auto",ALT:18,BACKSPACE:8,CONTROL:17,DELETE:46,DOWN_ARROW:40,ENTER:13,ESCAPE:27,LEFT_ARROW:37,OPTION:18,RETURN:13,RIGHT_ARROW:39,SHIFT:16,TAB:9,UP_ARROW:38,BLEND:"source-over",ADD:"lighter",DARKEST:"darken",LIGHTEST:"lighten",DIFFERENCE:"difference",EXCLUSION:"exclusion",MULTIPLY:"multiply",SCREEN:"screen",REPLACE:"copy",OVERLAY:"overlay",HARD_LIGHT:"hard-light",SOFT_LIGHT:"soft-light",DODGE:"color-dodge",BURN:"color-burn",THRESHOLD:"threshold",GRAY:"gray",OPAQUE:"opaque",INVERT:"invert",POSTERIZE:"posterize",DILATE:"dilate",ERODE:"erode",BLUR:"blur",NORMAL:"normal",ITALIC:"italic",BOLD:"bold",_DEFAULT_TEXT_FILL:"#000000",_DEFAULT_LEADMULT:1.25,_CTX_MIDDLE:"middle",LINEAR:"linear",QUADRATIC:"quadratic",BEZIER:"bezier",CURVE:"curve",LANDSCAPE:"landscape",PORTRAIT:"portrait",_DEFAULT_STROKE:"#000000",_DEFAULT_FILL:"#FFFFFF"}},{}],54:[function(t,e,i){"use strict";t("./shim");var r=t("./constants"),n=function(t,e,i){2===arguments.length&&"boolean"==typeof e&&(i=e,e=void 0),this._setupDone=!1,this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this._userNode=e,this._curElement=null,this._elements=[],this._requestAnimId=0,this._preloadCount=0,this._isGlobal=!1,this._loop=!0,this._styles=[],this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,dragend:null,dragover:null,click:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},this._events.wheel=null,this._loadingScreenId="p5_loading",window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),this._start=function(){this._userNode&&"string"==typeof this._userNode&&(this._userNode=document.getElementById(this._userNode));var t=this.preload||window.preload;if(t){var e=document.getElementById(this._loadingScreenId);if(!e){e=document.createElement("div"),e.innerHTML="Loading...",e.style.position="absolute",e.id=this._loadingScreenId;(this._userNode||document.body).appendChild(e)}for(var i in this._preloadMethods){this._preloadMethods[i]=this._preloadMethods[i]||n;var r=this._preloadMethods[i];r!==n.prototype&&r!==n||(r=this._isGlobal?window:this),this._registeredPreloadMethods[i]=r[i],r[i]=this._wrapPreload(r,i)}t(),this._runIfPreloadsAreDone()}else this._setup(),this._runFrames(),this._draw()}.bind(this),this._runIfPreloadsAreDone=function(){var t=this._isGlobal?window:this;if(0===t._preloadCount){var e=document.getElementById(t._loadingScreenId);e&&e.parentNode.removeChild(e),t._setup(),t._runFrames(),t._draw()}},this._decrementPreload=function(){var t=this._isGlobal?window:this;"function"==typeof t.preload&&(t._setProperty("_preloadCount",t._preloadCount-1),t._runIfPreloadsAreDone())},this._wrapPreload=function(t,e){return function(){this._incrementPreload();for(var i=new Array(arguments.length),r=0;r<i.length;++r)i[r]=arguments[r];return this._registeredPreloadMethods[e].apply(t,i)}.bind(this)},this._incrementPreload=function(){var t=this._isGlobal?window:this;t._setProperty("_preloadCount",t._preloadCount+1)},this._setup=function(){this.createCanvas(this._defaultCanvasSize.width,this._defaultCanvasSize.height,"p2d",!0);var t=this._isGlobal?window:this;if("function"==typeof t.preload)for(var e in this._preloadMethods)t[e]=this._preloadMethods[e][e],t[e]&&this&&(t[e]=t[e].bind(this));"function"==typeof t.setup&&t.setup();for(var i=document.getElementsByTagName("canvas"),r=0;r<i.length;r++){var n=i[r];"true"===n.dataset.hidden&&(n.style.visibility="",delete n.dataset.hidden)}this._setupDone=!0}.bind(this),this._draw=function(){var t=window.performance.now(),e=t-this._lastFrameTime,i=1e3/this._targetFrameRate;(!this._loop||e>=i-5)&&(this._setProperty("frameCount",this.frameCount+1),this.redraw(),this._frameRate=1e3/(t-this._lastFrameTime),this._lastFrameTime=t,void 0!==this._updateMouseCoords&&this._updateMouseCoords()),this._loop&&(this._requestAnimId=window.requestAnimationFrame(this._draw))}.bind(this),this._runFrames=function(){this._updateInterval&&clearInterval(this._updateInterval)}.bind(this),this._setProperty=function(t,e){this[t]=e,this._isGlobal&&(window[t]=e)}.bind(this),this.remove=function(){if(this._curElement){this._loop=!1,this._requestAnimId&&window.cancelAnimationFrame(this._requestAnimId);for(var t in this._events)window.removeEventListener(t,this._events[t]);for(var e=0;e<this._elements.length;e++){var i=this._elements[e];i.elt.parentNode&&i.elt.parentNode.removeChild(i.elt);for(var r in i._events)i.elt.removeEventListener(r,i._events[r])}var o=this;if(this._registeredMethods.remove.forEach(function(t){void 0!==t&&t.call(o)}),this._isGlobal){for(var s in n.prototype)try{delete window[s]}catch(t){window[s]=void 0}for(var a in this)if(this.hasOwnProperty(a))try{delete window[a]}catch(t){window[a]=void 0}}}}.bind(this),this._registeredMethods.init.forEach(function(t){void 0!==t&&t.call(this)},this);var r=this._createFriendlyGlobalFunctionBinder();if(t)t(this);else{this._isGlobal=!0,n.instance=this;for(var o in n.prototype)if("function"==typeof n.prototype[o]){var s=o.substring(2);this._events.hasOwnProperty(s)||(Math.hasOwnProperty(o)&&Math[o]===n.prototype[o]?r(o,n.prototype[o]):r(o,n.prototype[o].bind(this)))}else r(o,n.prototype[o]);for(var a in this)this.hasOwnProperty(a)&&r(a,this[a])}for(var h in this._events){var l=this["_on"+h];if(l){var u=l.bind(this);window.addEventListener(h,u,{passive:!1}),this._events[h]=u}}var p=function(){this._setProperty("focused",!0)}.bind(this),c=function(){this._setProperty("focused",!1)}.bind(this);window.addEventListener("focus",p),window.addEventListener("blur",c),this.registerMethod("remove",function(){window.removeEventListener("focus",p),window.removeEventListener("blur",c)}),i?this._start():"complete"===document.readyState?this._start():window.addEventListener("load",this._start.bind(this),!1)};n.instance=null,n.disableFriendlyErrors=!1;for(var o in r)n.prototype[o]=r[o];n.prototype._preloadMethods={loadJSON:n.prototype,loadImage:n.prototype,loadStrings:n.prototype,loadXML:n.prototype,loadShape:n.prototype,loadTable:n.prototype,loadFont:n.prototype,loadModel:n.prototype},n.prototype._registeredMethods={init:[],pre:[],post:[],remove:[]},n.prototype._registeredPreloadMethods={},n.prototype.registerPreloadMethod=function(t,e){n.prototype._preloadMethods.hasOwnProperty(t)||(n.prototype._preloadMethods[t]=e)},n.prototype.registerMethod=function(t,e){n.prototype._registeredMethods.hasOwnProperty(t)||(n.prototype._registeredMethods[t]=[]),n.prototype._registeredMethods[t].push(e)},n.prototype._createFriendlyGlobalFunctionBinder=function(t){t=t||{};var e=t.globalObject||window,i=t.log||console.log.bind(console),r={print:!0};return function(t,o){if(n.disableFriendlyErrors||"undefined"!=typeof IS_MINIFIED||"function"!=typeof o||t in n.prototype._preloadMethods)e[t]=o;else try{if(t in e&&!(t in r))throw new Error('global "'+t+'" already exists');Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return o},set:function(r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}),i('You just changed the value of "'+t+"\", which was a p5 function. This could cause problems later if you're not careful.")}})}catch(r){i('p5 had problems creating the global function "'+t+'", possibly because your code is already using that name as a variable. You may want to rename your variable to something else.'),e[t]=o}}},e.exports=n},{"./constants":53,"./shim":64}],55:[function(t,e,i){"use strict";var r=t("./core");t("./error_helpers");var n=20,o=20;r.prototype.bezier=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];return this._renderer._doStroke||this._renderer._doFill?(this._renderer.isP3D?(t.push(n),this._renderer.bezier(t)):this._renderer.bezier(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),this):this},r.prototype.bezierDetail=function(t){return n=t,this},r.prototype.bezierPoint=function(t,e,i,r,n){var o=1-n;return Math.pow(o,3)*t+3*Math.pow(o,2)*n*e+3*o*Math.pow(n,2)*i+Math.pow(n,3)*r},r.prototype.bezierTangent=function(t,e,i,r,n){var o=1-n;return 3*r*Math.pow(n,2)-3*i*Math.pow(n,2)+6*i*o*n-6*e*o*n+3*e*Math.pow(o,2)-3*t*Math.pow(o,2)},r.prototype.curve=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];return this._renderer._doStroke?(this._renderer.isP3D?(t.push(o),this._renderer.curve(t)):this._renderer.curve(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]),this):this},r.prototype.curveDetail=function(t){return o=t,this},r.prototype.curveTightness=function(t){this._renderer._curveTightness=t},r.prototype.curvePoint=function(t,e,i,r,n){var o=n*n*n,s=n*n;return t*(-.5*o+s-.5*n)+e*(1.5*o-2.5*s+1)+i*(-1.5*o+2*s+.5*n)+r*(.5*o-.5*s)},r.prototype.curveTangent=function(t,e,i,r,n){var o=n*n;return t*(-3*o/2+2*n-.5)+e*(9*o/2-5*n)+i*(-9*o/2+4*n+.5)+r*(3*o/2-n)},e.exports=r},{"./core":54,"./error_helpers":57}],56:[function(t,e,i){"use strict";function r(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function n(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}function o(t){if(!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function s(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}var a=t("./core"),h=t("./constants"),l=[h.ARROW,h.CROSS,h.HAND,h.MOVE,h.TEXT,h.WAIT];a.prototype._frameRate=0,a.prototype._lastFrameTime=window.performance.now(),a.prototype._targetFrameRate=60;var u=window.print;window.console&&console.log?a.prototype.print=function(t){try{if(0===arguments.length)u();else if(arguments.length>1)console.log.apply(console,arguments);else{var e=JSON.parse(JSON.stringify(t));"{}"===JSON.stringify(e)?console.log(t):console.log(e)}}catch(e){console.log(t)}}:a.prototype.print=function(){},a.prototype.frameCount=0,a.prototype.focused=document.hasFocus(),a.prototype.cursor=function(t,e,i){var r="auto",n=this._curElement.elt;if(l.indexOf(t)>-1)r=t;else if("string"==typeof t){var o="";e&&i&&"number"==typeof e&&"number"==typeof i&&(o=e+" "+i),r="http://"===t.substring(0,7)||"https://"===t.substring(0,8)?"url("+t+") "+o+", auto":/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(t)?"url("+t+") "+o+", auto":t}n.style.cursor=r},a.prototype.frameRate=function(t){return"number"!=typeof t||t<0?this._frameRate:(this._setProperty("_targetFrameRate",t),this._runFrames(),this)},a.prototype.getFrameRate=function(){return this.frameRate()},a.prototype.setFrameRate=function(t){return this.frameRate(t)},a.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},a.prototype.displayWidth=screen.width,a.prototype.displayHeight=screen.height,a.prototype.windowWidth=r(),a.prototype.windowHeight=n(),a.prototype._onresize=function(t){this._setProperty("windowWidth",r()),this._setProperty("windowHeight",n());var e,i=this._isGlobal?window:this;"function"==typeof i.windowResized&&(void 0===(e=i.windowResized(t))||e||t.preventDefault())},a.prototype.width=0,a.prototype.height=0,a.prototype.fullscreen=function(t){if(void 0===t)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;t?o(document.documentElement):s()},a.prototype.pixelDensity=function(t){if("number"!=typeof t)return this._pixelDensity;this._pixelDensity=t,this.resizeCanvas(this.width,this.height,!0)},a.prototype.displayDensity=function(){return window.devicePixelRatio},a.prototype.getURL=function(){return location.href},a.prototype.getURLPath=function(){return location.pathname.split("/").filter(function(t){return""!==t})},a.prototype.getURLParams=function(){for(var t,e=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,i={};null!=(t=e.exec(location.search));)t.index===e.lastIndex&&e.lastIndex++,i[t[1]]=t[2];return i},e.exports=a},{"./constants":53,"./core":54}],57:[function(t,e,i){"use strict";function r(t,e,i){h&&(n(),h=!1),"undefined"===f(i)?i="#B40033":"number"===f(i)&&(i=d[i])}function n(){console.log("%c    _ \n /\\| |/\\ \n \\ ` ' /  \n / , . \\  \n \\/|_|\\/ \n\n%c> p5.js says: Welcome! This is your friendly debugger. To turn me off switch to using p5.min.js.","background-color:transparent;color:#ED225D;","background-color:#ED225D;color:white;")}function o(){var e={},i=function(t){return Object.getOwnPropertyNames(t).filter(function(t){return"_"!==t[0]&&(!(t in e)&&(e[t]=!0,!0))}).map(function(e){var i;return i="function"==typeof t[e]?"function":e===e.toUpperCase()?"constant":"variable",{name:e,type:i}})};m=[].concat(i(a.prototype),i(t("./constants"))),m.sort(function(t,e){return e.name.length-t.name.length})}function s(t,e){e||(e=console.log.bind(console)),m||o(),m.some(function(i){if(t.message&&null!==t.message.match("\\W?"+i.name+"\\W"))return e("%cDid you just try to use p5.js's "+i.name+("function"===i.type?"() ":" ")+i.type+"? If so, you may want to move it into your sketch's setup() function.\n\nFor more details, see: "+g,"color: #B40033"),!0})}for(var a=t("./core"),h=!1,l={},u=l.toString,p=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],c=0;c<p.length;c++)l["[object "+p[c]+"]"]=p[c].toLowerCase();var f=function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[u.call(t)]||"object":typeof t},d=["#2D7BB6","#EE9900","#4DB200","#C83C00"],y={0:{fileType:"image",method:"loadImage",message:" hosting the image online,"},1:{fileType:"XML file",method:"loadXML"},2:{fileType:"table file",method:"loadTable"},3:{fileType:"text file",method:"loadStrings"},4:{fileType:"font",method:"loadFont",message:" hosting the font online,"}};a._friendlyFileLoadError=function(t,e){var i=y[t];r("It looks like there was a problem loading your "+i.fileType+". Try checking if the file path%c ["+e+"] %cis correct,"+(i.message||"")+" or running a local server.",i.method,3)};var m=null,g="https://github.com/processing/p5.js/wiki/Frequently-Asked-Questions#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup";a.prototype._helpForMisusedAtTopLevelCode=s,"complete"!==document.readyState&&(window.addEventListener("error",s,!1),window.addEventListener("load",function(){window.removeEventListener("error",s,!1)})),e.exports=a},{"./constants":53,"./core":54}],58:[function(t,e,i){var r=t("../core/core"),n=function(){window.PHANTOMJS||window.mocha||(window.setup&&"function"==typeof window.setup||window.draw&&"function"==typeof window.draw)&&!r.instance&&new r};"complete"===document.readyState?n():window.addEventListener("load",n,!1)},{"../core/core":54}],59:[function(t,e,i){function r(t,e,i){var r=e.bind(i);i.elt.addEventListener(t,r,!1),i._events[t]=r}var n=t("./core");n.Element=function(t,e){this.elt=t,this._pInst=e,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight},n.Element.prototype.parent=function(t){return 0===arguments.length?this.elt.parentNode:("string"==typeof t?("#"===t[0]&&(t=t.substring(1)),t=document.getElementById(t)):t instanceof n.Element&&(t=t.elt),t.appendChild(this.elt),this)},n.Element.prototype.id=function(t){return 0===arguments.length?this.elt.id:(this.elt.id=t,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)},n.Element.prototype.class=function(t){return 0===arguments.length?this.elt.className:(this.elt.className=t,this)},n.Element.prototype.mousePressed=function(t){return r("mousedown",t,this),r("touchstart",t,this),this},n.Element.prototype.doubleClicked=function(t){return r("doubleClicked",t,this),this},n.Element.prototype.mouseWheel=function(t){return r("wheel",t,this),this},n.Element.prototype.mouseReleased=function(t){return r("mouseup",t,this),r("touchend",t,this),this},n.Element.prototype.mouseClicked=function(t){return r("click",t,this),this},n.Element.prototype.mouseMoved=function(t){return r("mousemove",t,this),r("touchmove",t,this),this},n.Element.prototype.mouseOver=function(t){return r("mouseover",t,this),this},n.Element.prototype.changed=function(t){return r("change",t,this),this},n.Element.prototype.input=function(t){return r("input",t,this),this},n.Element.prototype.mouseOut=function(t){return r("mouseout",t,this),this},n.Element.prototype.touchStarted=function(t){return r("touchstart",t,this),r("mousedown",t,this),this},n.Element.prototype.touchMoved=function(t){return r("touchmove",t,this),r("mousemove",t,this),this},n.Element.prototype.touchEnded=function(t){return r("touchend",t,this),r("mouseup",t,this),this},n.Element.prototype.dragOver=function(t){return r("dragover",t,this),this},n.Element.prototype.dragLeave=function(t){return r("dragleave",t,this),this},n.Element.prototype.drop=function(t,e){function i(e){var i=new n.File(e);return function(e){i.data=e.target.result,t(i)}}return window.File&&window.FileReader&&window.FileList&&window.Blob?(r("dragover",function(t){t.stopPropagation(),t.preventDefault()},this),r("dragleave",function(t){t.stopPropagation(),t.preventDefault()},this),arguments.length>1&&r("drop",e,this),r("drop",function(t){t.stopPropagation(),t.preventDefault();for(var e=t.dataTransfer.files,r=0;r<e.length;r++){var n=e[r],o=new FileReader;o.onload=i(n),n.type.indexOf("text")>-1?o.readAsText(n):o.readAsDataURL(n)}},this)):console.log("The File APIs are not fully supported in this browser."),this},n.Element.prototype._setProperty=function(t,e){this[t]=e},e.exports=n.Element},{"./core":54}],60:[function(t,e,i){var r=t("./core"),n=t("./constants");r.Graphics=function(t,e,i,o){var s=i||n.P2D;this.canvas=document.createElement("canvas"),(this._userNode||document.body).appendChild(this.canvas),r.Element.call(this,this.canvas,o,!1),this._styles=[],this.width=t,this.height=e,this._pixelDensity=o._pixelDensity,s===n.WEBGL?this._renderer=new r.RendererGL(this.canvas,this,!1):this._renderer=new r.Renderer2D(this.canvas,this,!1),this._renderer.resize(t,e),this._renderer._applyDefaults(),o._elements.push(this);for(var a in r.prototype)this[a]||("function"==typeof r.prototype[a]?this[a]=r.prototype[a].bind(this):this[a]=r.prototype[a]);return this},r.Graphics.prototype=Object.create(r.Element.prototype),r.Graphics.prototype.remove=function(){this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt);for(var t in this._events)this.elt.removeEventListener(t,this._events[t])},e.exports=r.Graphics},{"./constants":53,"./core":54}],61:[function(t,e,i){function r(t){var e=0,i=0;if(t.offsetParent)do{e+=t.offsetLeft,i+=t.offsetTop}while(t=t.offsetParent);else e+=t.offsetLeft,i+=t.offsetTop;return[e,i]}var n=t("./core"),o=t("../core/constants");n.Renderer=function(t,e,i){n.Element.call(this,t,e),this.canvas=t,this._pInst=e,i?(this._isMainCanvas=!0,this._pInst._setProperty("_curElement",this),this._pInst._setProperty("canvas",this.canvas),this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height)):(this.canvas.style.display="none",this._styles=[]),this._textSize=12,this._textLeading=15,this._textFont="sans-serif",this._textStyle=o.NORMAL,this._textAscent=null,this._textDescent=null,this._rectMode=o.CORNER,this._ellipseMode=o.CENTER,this._curveTightness=0,this._imageMode=o.CORNER,this._tint=null,this._doStroke=!0,this._doFill=!0,this._strokeSet=!1,this._fillSet=!1,this._colorMode=o.RGB,this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]}},n.Renderer.prototype=Object.create(n.Element.prototype),n.Renderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.elt.width=t*this._pInst._pixelDensity,this.elt.height=e*this._pInst._pixelDensity,this.elt.style.width=t+"px",this.elt.style.height=e+"px",this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height))},n.Renderer.prototype.textLeading=function(t){return arguments.length&&arguments[0]?(this._setProperty("_textLeading",t),this):this._textLeading},n.Renderer.prototype.textSize=function(t){return arguments.length&&arguments[0]?(this._setProperty("_textSize",t),this._setProperty("_textLeading",t*o._DEFAULT_LEADMULT),this._applyTextProperties()):this._textSize},n.Renderer.prototype.textStyle=function(t){return arguments.length&&arguments[0]?(t!==o.NORMAL&&t!==o.ITALIC&&t!==o.BOLD||this._setProperty("_textStyle",t),this._applyTextProperties()):this._textStyle},n.Renderer.prototype.textAscent=function(){return null===this._textAscent&&this._updateTextMetrics(),this._textAscent},n.Renderer.prototype.textDescent=function(){return null===this._textDescent&&this._updateTextMetrics(),this._textDescent},n.Renderer.prototype._applyDefaults=function(){return this},n.Renderer.prototype._isOpenType=function(t){return"object"==typeof(t=t||this._textFont)&&t.font&&t.font.supported},n.Renderer.prototype._updateTextMetrics=function(){if(this._isOpenType())return this._setProperty("_textAscent",this._textFont._textAscent()),this._setProperty("_textDescent",this._textFont._textDescent()),this;var t=document.createElement("span");t.style.fontFamily=this._textFont,t.style.fontSize=this._textSize+"px",t.innerHTML="ABCjgq|";var e=document.createElement("div");e.style.display="inline-block",e.style.width="1px",e.style.height="0px";var i=document.createElement("div");i.appendChild(t),i.appendChild(e),i.style.height="0px",i.style.overflow="hidden",document.body.appendChild(i),e.style.verticalAlign="baseline";var n=r(e),o=r(t),s=n[1]-o[1];e.style.verticalAlign="bottom",n=r(e),o=r(t);var a=n[1]-o[1],h=a-s;return document.body.removeChild(i),this._setProperty("_textAscent",s),this._setProperty("_textDescent",h),this},e.exports=n.Renderer},{"../core/constants":53,"./core":54}],62:[function(t,e,i){var r=t("./core"),n=t("./canvas"),o=t("./constants"),s=t("../image/filters");t("./p5.Renderer");var a="rgba(0,0,0,0)";r.Renderer2D=function(t,e,i){return r.Renderer.call(this,t,e,i),this.drawingContext=this.canvas.getContext("2d"),this._pInst._setProperty("drawingContext",this.drawingContext),this},r.Renderer2D.prototype=Object.create(r.Renderer.prototype),r.Renderer2D.prototype._applyDefaults=function(){this._setFill(o._DEFAULT_FILL),this._setStroke(o._DEFAULT_STROKE),this.drawingContext.lineCap=o.ROUND,this.drawingContext.font="normal 12px sans-serif"},r.Renderer2D.prototype.resize=function(t,e){r.Renderer.prototype.resize.call(this,t,e),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)},r.Renderer2D.prototype.background=function(){if(this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),arguments[0]instanceof r.Image)this._pInst.image(arguments[0],0,0,this.width,this.height);else{var t=this._getFill(),e=this._pInst.color.apply(this,arguments),i=e.toString();this._setFill(i),this.drawingContext.fillRect(0,0,this.width,this.height),this._setFill(t)}this.drawingContext.restore()},r.Renderer2D.prototype.clear=function(){this.drawingContext.clearRect(0,0,this.width,this.height)},r.Renderer2D.prototype.fill=function(){var t=this._pInst.color.apply(this,arguments);this._setFill(t.toString())},r.Renderer2D.prototype.stroke=function(){var t=this._pInst.color.apply(this,arguments);this._setStroke(t.toString())},r.Renderer2D.prototype.image=function(t,e,i,n,o,s,a,h,l){var u;try{this._tint&&(r.MediaElement&&t instanceof r.MediaElement&&t.loadPixels(),t.canvas&&(u=this._getTintedImageCanvas(t))),u||(u=t.canvas||t.elt),this.drawingContext.drawImage(u,e,i,n,o,s,a,h,l)}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t}},r.Renderer2D.prototype._getTintedImageCanvas=function(t){if(!t.canvas)return t;var e=s._toPixels(t.canvas),i=document.createElement("canvas");i.width=t.canvas.width,i.height=t.canvas.height;for(var r=i.getContext("2d"),n=r.createImageData(t.canvas.width,t.canvas.height),o=n.data,a=0;a<e.length;a+=4){var h=e[a],l=e[a+1],u=e[a+2],p=e[a+3];o[a]=h*this._tint[0]/255,o[a+1]=l*this._tint[1]/255,o[a+2]=u*this._tint[2]/255,o[a+3]=p*this._tint[3]/255}return r.putImageData(n,0,0),i},r.Renderer2D.prototype.blendMode=function(t){this.drawingContext.globalCompositeOperation=t},r.Renderer2D.prototype.blend=function(){var t=this.drawingContext.globalCompositeOperation,e=arguments[arguments.length-1],i=Array.prototype.slice.call(arguments,0,arguments.length-1);this.drawingContext.globalCompositeOperation=e,this._pInst?this._pInst.copy.apply(this._pInst,i):this.copy.apply(this,i),this.drawingContext.globalCompositeOperation=t},r.Renderer2D.prototype.copy=function(){var t,e,i,n,o,s,a,h,l;if(9===arguments.length)t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],o=arguments[4],s=arguments[5],a=arguments[6],h=arguments[7],l=arguments[8];else{if(8!==arguments.length)throw new Error("Signature not supported");t=this._pInst,e=arguments[0],i=arguments[1],n=arguments[2],o=arguments[3],s=arguments[4],a=arguments[5],h=arguments[6],l=arguments[7]}r.Renderer2D._copyHelper(t,e,i,n,o,s,a,h,l)},r.Renderer2D._copyHelper=function(t,e,i,r,n,o,s,a,h){t.loadPixels();var l=t.canvas.width/t.width;this.drawingContext.drawImage(t.canvas,l*e,l*i,l*r,l*n,o,s,a,h)},r.Renderer2D.prototype.get=function(t,e,i,n){if(void 0===t&&void 0===e&&void 0===i&&void 0===n?(t=0,e=0,i=this.width,n=this.height):void 0===i&&void 0===n&&(i=1,n=1),t+i<0||e+n<0||t>this.width||e>this.height)return[0,0,0,255];var o=this._pInst||this;o.loadPixels();var s=o._pixelDensity;t=Math.floor(t),e=Math.floor(e),i=Math.floor(i),n=Math.floor(n);var a=t*s,h=e*s;if(1===i&&1===n){var l=this.drawingContext.getImageData(a,h,1,1).data;return[l[0],l[1],l[2],l[3]]}var u=Math.min(i,o.width),p=Math.min(n,o.height),c=u*s,f=p*s,d=new r.Image(u,p);return d.canvas.getContext("2d").drawImage(this.canvas,a,h,c,f,0,0,u,p),d},r.Renderer2D.prototype.loadPixels=function(){var t=this._pixelDensity||this._pInst._pixelDensity,e=this.width*t,i=this.height*t,r=this.drawingContext.getImageData(0,0,e,i);this._pInst?(this._pInst._setProperty("imageData",r),this._pInst._setProperty("pixels",r.data)):(this._setProperty("imageData",r),this._setProperty("pixels",r.data))},r.Renderer2D.prototype.set=function(t,e,i){if(t=Math.floor(t),e=Math.floor(e),i instanceof r.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),this.drawingContext.drawImage(i.canvas,t,e),this.loadPixels.call(this._pInst),this.drawingContext.restore();else{var n=this._pInst||this,o=0,s=0,a=0,h=0,l=4*(e*n._pixelDensity*(this.width*n._pixelDensity)+t*n._pixelDensity);if(n.imageData||n.loadPixels.call(n),"number"==typeof i)l<n.pixels.length&&(o=i,s=i,a=i,h=255);else if(i instanceof Array){if(i.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");l<n.pixels.length&&(o=i[0],s=i[1],a=i[2],h=i[3])}else i instanceof r.Color&&l<n.pixels.length&&(o=i.levels[0],s=i.levels[1],a=i.levels[2],h=i.levels[3]);for(var u=0;u<n._pixelDensity;u++)for(var p=0;p<n._pixelDensity;p++)l=4*((e*n._pixelDensity+p)*this.width*n._pixelDensity+(t*n._pixelDensity+u)),n.pixels[l]=o,n.pixels[l+1]=s,n.pixels[l+2]=a,n.pixels[l+3]=h}},r.Renderer2D.prototype.updatePixels=function(t,e,i,r){var n=this._pixelDensity||this._pInst._pixelDensity;void 0===t&&void 0===e&&void 0===i&&void 0===r&&(t=0,e=0,i=this.width,r=this.height),i*=n,r*=n,this._pInst?this.drawingContext.putImageData(this._pInst.imageData,t,e,0,0,i,r):this.drawingContext.putImageData(this.imageData,t,e,0,0,i,r)},r.Renderer2D.prototype._acuteArcToBezier=function(t,e){var i=e/2,r=Math.cos(i),n=Math.sin(i),o=1/Math.tan(i),s=t+i,a=Math.cos(s),h=Math.sin(s),l=(4-r)/3,u=n+(r-l)*o;return{ax:Math.cos(t),ay:Math.sin(t),bx:l*a+u*h,by:l*h-u*a,cx:l*a-u*h,cy:l*h+u*a,dx:Math.cos(t+e),dy:Math.sin(t+e)}},r.Renderer2D.prototype.arc=function(t,e,i,r,s,a,h){for(var l=this.drawingContext,u=n.arcModeAdjust(t,e,i,r,this._ellipseMode),p=u.w/2,c=u.h/2,f=0,d=[];a-s>1e-5;)f=Math.min(a-s,o.HALF_PI),d.push(this._acuteArcToBezier(s,f)),s+=f;return this._doFill&&(l.beginPath(),d.forEach(function(t,e){0===e&&l.moveTo(u.x+t.ax*p,u.y+t.ay*c),l.bezierCurveTo(u.x+t.bx*p,u.y+t.by*c,u.x+t.cx*p,u.y+t.cy*c,u.x+t.dx*p,u.y+t.dy*c)}),h!==o.PIE&&null!=h||l.lineTo(u.x,u.y),l.closePath(),l.fill()),this._doStroke&&(l.beginPath(),d.forEach(function(t,e){0===e&&l.moveTo(u.x+t.ax*p,u.y+t.ay*c),l.bezierCurveTo(u.x+t.bx*p,u.y+t.by*c,u.x+t.cx*p,u.y+t.cy*c,u.x+t.dx*p,u.y+t.dy*c)}),h===o.PIE?(l.lineTo(u.x,u.y),l.closePath()):h===o.CHORD&&l.closePath(),l.stroke()),this},r.Renderer2D.prototype.ellipse=function(t){var e=this.drawingContext,i=this._doFill,r=this._doStroke,n=t[0],o=t[1],s=t[2],h=t[3];if(i&&!r){if(this._getFill()===a)return this}else if(!i&&r&&this._getStroke()===a)return this;var l=s/2*.5522847498,u=h/2*.5522847498,p=n+s,c=o+h,f=n+s/2,d=o+h/2;e.beginPath(),e.moveTo(n,d),e.bezierCurveTo(n,d-u,f-l,o,f,o),e.bezierCurveTo(f+l,o,p,d-u,p,d),e.bezierCurveTo(p,d+u,f+l,c,f,c),e.bezierCurveTo(f-l,c,n,d+u,n,d),e.closePath(),i&&e.fill(),r&&e.stroke()},r.Renderer2D.prototype.line=function(t,e,i,r){var n=this.drawingContext;return this._doStroke?this._getStroke()===a?this:(n.lineWidth%2==1&&n.translate(.5,.5),n.beginPath(),n.moveTo(t,e),n.lineTo(i,r),n.stroke(),n.lineWidth%2==1&&n.translate(-.5,-.5),this):this},r.Renderer2D.prototype.point=function(t,e){var i=this.drawingContext;return this._doStroke?this._getStroke()===a?this:(t=Math.round(t),e=Math.round(e),void(i.lineWidth>1?(i.beginPath(),i.arc(t,e,i.lineWidth/2,0,o.TWO_PI,!1),i.fill()):i.fillRect(t,e,1,1))):this},r.Renderer2D.prototype.quad=function(t,e,i,r,n,o,s,h){var l=this.drawingContext,u=this._doFill,p=this._doStroke;if(u&&!p){if(this._getFill()===a)return this}else if(!u&&p&&this._getStroke()===a)return this;return l.beginPath(),l.moveTo(t,e),l.lineTo(i,r),l.lineTo(n,o),l.lineTo(s,h),l.closePath(),u&&l.fill(),p&&l.stroke(),this},r.Renderer2D.prototype.rect=function(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],s=t[5],h=t[6],l=t[7],u=this.drawingContext,p=this._doFill,c=this._doStroke;if(p&&!c){if(this._getFill()===a)return this}else if(!p&&c&&this._getStroke()===a)return this;if(this._doStroke&&u.lineWidth%2==1&&u.translate(.5,.5),u.beginPath(),void 0===o)u.rect(e,i,r,n);else{void 0===s&&(s=o),void 0===h&&(h=s),void 0===l&&(l=h);var f=r/2,d=n/2;r<2*o&&(o=f),n<2*o&&(o=d),r<2*s&&(s=f),n<2*s&&(s=d),r<2*h&&(h=f),n<2*h&&(h=d),r<2*l&&(l=f),n<2*l&&(l=d),u.beginPath(),u.moveTo(e+o,i),u.arcTo(e+r,i,e+r,i+n,s),u.arcTo(e+r,i+n,e,i+n,h),u.arcTo(e,i+n,e,i,l),u.arcTo(e,i,e+r,i,o),u.closePath()}return this._doFill&&u.fill(),this._doStroke&&u.stroke(),this._doStroke&&u.lineWidth%2==1&&u.translate(-.5,-.5),this},r.Renderer2D.prototype.triangle=function(t){var e=this.drawingContext,i=this._doFill,r=this._doStroke,n=t[0],o=t[1],s=t[2],h=t[3],l=t[4],u=t[5];if(i&&!r){if(this._getFill()===a)return this}else if(!i&&r&&this._getStroke()===a)return this;e.beginPath(),e.moveTo(n,o),e.lineTo(s,h),e.lineTo(l,u),e.closePath(),i&&e.fill(),r&&e.stroke()},r.Renderer2D.prototype.endShape=function(t,e,i,r,n,s,a){if(0===e.length)return this;if(!this._doStroke&&!this._doFill)return this;var h,l=t===o.CLOSE;l&&!s&&e.push(e[0]);var u,p,c=e.length;if(!i||a!==o.POLYGON&&null!==a)if(!r||a!==o.POLYGON&&null!==a)if(!n||a!==o.POLYGON&&null!==a)if(a===o.POINTS)for(u=0;u<c;u++)h=e[u],this._doStroke&&this._pInst.stroke(h[6]),this._pInst.point(h[0],h[1]);else if(a===o.LINES)for(u=0;u+1<c;u+=2)h=e[u],this._doStroke&&this._pInst.stroke(e[u+1][6]),this._pInst.line(h[0],h[1],e[u+1][0],e[u+1][1]);else if(a===o.TRIANGLES)for(u=0;u+2<c;u+=3)h=e[u],this.drawingContext.beginPath(),this.drawingContext.moveTo(h[0],h[1]),this.drawingContext.lineTo(e[u+1][0],e[u+1][1]),this.drawingContext.lineTo(e[u+2][0],e[u+2][1]),this.drawingContext.lineTo(h[0],h[1]),this._doFill&&(this._pInst.fill(e[u+2][5]),this.drawingContext.fill()),this._doStroke&&(this._pInst.stroke(e[u+2][6]),this.drawingContext.stroke()),this.drawingContext.closePath();else if(a===o.TRIANGLE_STRIP)for(u=0;u+1<c;u++)h=e[u],this.drawingContext.beginPath(),this.drawingContext.moveTo(e[u+1][0],e[u+1][1]),this.drawingContext.lineTo(h[0],h[1]),this._doStroke&&this._pInst.stroke(e[u+1][6]),this._doFill&&this._pInst.fill(e[u+1][5]),u+2<c&&(this.drawingContext.lineTo(e[u+2][0],e[u+2][1]),this._doStroke&&this._pInst.stroke(e[u+2][6]),this._doFill&&this._pInst.fill(e[u+2][5])),this._doFillStrokeClose();else if(a===o.TRIANGLE_FAN){if(c>2){for(this.drawingContext.beginPath(),u=2;u<c;u++)h=e[u],this.drawingContext.moveTo(e[0][0],e[0][1]),this.drawingContext.lineTo(e[u-1][0],e[u-1][1]),this.drawingContext.lineTo(h[0],h[1]),this.drawingContext.lineTo(e[0][0],e[0][1]),u<c-1&&(this._doFill&&h[5]!==e[u+1][5]||this._doStroke&&h[6]!==e[u+1][6])&&(this._doFill&&(this._pInst.fill(h[5]),this.drawingContext.fill(),this._pInst.fill(e[u+1][5])),this._doStroke&&(this._pInst.stroke(h[6]),this.drawingContext.stroke(),this._pInst.stroke(e[u+1][6])),this.drawingContext.closePath(),this.drawingContext.beginPath());this._doFillStrokeClose()}}else if(a===o.QUADS)for(u=0;u+3<c;u+=4){for(h=e[u],this.drawingContext.beginPath(),this.drawingContext.moveTo(h[0],h[1]),p=1;p<4;p++)this.drawingContext.lineTo(e[u+p][0],e[u+p][1]);this.drawingContext.lineTo(h[0],h[1]),this._doFill&&this._pInst.fill(e[u+3][5]),this._doStroke&&this._pInst.stroke(e[u+3][6]),this._doFillStrokeClose()}else if(a===o.QUAD_STRIP){if(c>3)for(u=0;u+1<c;u+=2)h=e[u],this.drawingContext.beginPath(),u+3<c?(this.drawingContext.moveTo(e[u+2][0],e[u+2][1]),this.drawingContext.lineTo(h[0],h[1]),this.drawingContext.lineTo(e[u+1][0],e[u+1][1]),this.drawingContext.lineTo(e[u+3][0],e[u+3][1]),this._doFill&&this._pInst.fill(e[u+3][5]),this._doStroke&&this._pInst.stroke(e[u+3][6])):(this.drawingContext.moveTo(h[0],h[1]),this.drawingContext.lineTo(e[u+1][0],e[u+1][1])),this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),this.drawingContext.moveTo(e[0][0],e[0][1]),u=1;u<c;u++)h=e[u],h.isVert&&(h.moveTo?this.drawingContext.moveTo(h[0],h[1]):this.drawingContext.lineTo(h[0],h[1]));this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),u=0;u<c;u++)e[u].isVert?e[u].moveTo?this.drawingContext.moveTo([0],e[u][1]):this.drawingContext.lineTo(e[u][0],e[u][1]):this.drawingContext.quadraticCurveTo(e[u][0],e[u][1],e[u][2],e[u][3]);this._doFillStrokeClose()}else{for(this.drawingContext.beginPath(),u=0;u<c;u++)e[u].isVert?e[u].moveTo?this.drawingContext.moveTo(e[u][0],e[u][1]):this.drawingContext.lineTo(e[u][0],e[u][1]):this.drawingContext.bezierCurveTo(e[u][0],e[u][1],e[u][2],e[u][3],e[u][4],e[u][5]);this._doFillStrokeClose()}else if(c>3){var f=[],d=1-this._curveTightness;for(this.drawingContext.beginPath(),this.drawingContext.moveTo(e[1][0],e[1][1]),u=1;u+2<c;u++)h=e[u],f[0]=[h[0],h[1]],f[1]=[h[0]+(d*e[u+1][0]-d*e[u-1][0])/6,h[1]+(d*e[u+1][1]-d*e[u-1][1])/6],f[2]=[e[u+1][0]+(d*e[u][0]-d*e[u+2][0])/6,e[u+1][1]+(d*e[u][1]-d*e[u+2][1])/6],f[3]=[e[u+1][0],e[u+1][1]],this.drawingContext.bezierCurveTo(f[1][0],f[1][1],f[2][0],f[2][1],f[3][0],f[3][1]);l&&this.drawingContext.lineTo(e[u+1][0],e[u+1][1]),this._doFillStrokeClose()}return i=!1,r=!1,n=!1,s=!1,l&&e.pop(),this},r.Renderer2D.prototype.noSmooth=function(){return"imageSmoothingEnabled"in this.drawingContext?this.drawingContext.imageSmoothingEnabled=!1:"mozImageSmoothingEnabled"in this.drawingContext?this.drawingContext.mozImageSmoothingEnabled=!1:"webkitImageSmoothingEnabled"in this.drawingContext?this.drawingContext.webkitImageSmoothingEnabled=!1:"msImageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.msImageSmoothingEnabled=!1),this},r.Renderer2D.prototype.smooth=function(){return"imageSmoothingEnabled"in this.drawingContext?this.drawingContext.imageSmoothingEnabled=!0:"mozImageSmoothingEnabled"in this.drawingContext?this.drawingContext.mozImageSmoothingEnabled=!0:"webkitImageSmoothingEnabled"in this.drawingContext?this.drawingContext.webkitImageSmoothingEnabled=!0:"msImageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.msImageSmoothingEnabled=!0),this},r.Renderer2D.prototype.strokeCap=function(t){return t!==o.ROUND&&t!==o.SQUARE&&t!==o.PROJECT||(this.drawingContext.lineCap=t),this},r.Renderer2D.prototype.strokeJoin=function(t){return t!==o.ROUND&&t!==o.BEVEL&&t!==o.MITER||(this.drawingContext.lineJoin=t),this},r.Renderer2D.prototype.strokeWeight=function(t){return this.drawingContext.lineWidth=void 0===t||0===t?1e-4:t,this},r.Renderer2D.prototype._getFill=function(){return this._cachedFillStyle},r.Renderer2D.prototype._setFill=function(t){t!==this._cachedFillStyle&&(this.drawingContext.fillStyle=t,this._cachedFillStyle=t)},r.Renderer2D.prototype._getStroke=function(){return this._cachedStrokeStyle},r.Renderer2D.prototype._setStroke=function(t){t!==this._cachedStrokeStyle&&(this.drawingContext.strokeStyle=t,this._cachedStrokeStyle=t)},r.Renderer2D.prototype.bezier=function(t,e,i,r,n,o,s,a){return this._pInst.beginShape(),this._pInst.vertex(t,e),this._pInst.bezierVertex(i,r,n,o,s,a),this._pInst.endShape(),this},r.Renderer2D.prototype.curve=function(t,e,i,r,n,o,s,a){return this._pInst.beginShape(),this._pInst.curveVertex(t,e),this._pInst.curveVertex(i,r),this._pInst.curveVertex(n,o),this._pInst.curveVertex(s,a),this._pInst.endShape(),this},r.Renderer2D.prototype._doFillStrokeClose=function(){this._doFill&&this.drawingContext.fill(),this._doStroke&&this.drawingContext.stroke(),this.drawingContext.closePath()},r.Renderer2D.prototype.applyMatrix=function(t,e,i,r,n,o){this.drawingContext.transform(t,e,i,r,n,o)},r.Renderer2D.prototype.resetMatrix=function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),this},r.Renderer2D.prototype.rotate=function(t){this.drawingContext.rotate(t)},r.Renderer2D.prototype.scale=function(t,e){return this.drawingContext.scale(t,e),this},r.Renderer2D.prototype.shearX=function(t){return this._pInst._angleMode===o.DEGREES&&(t=this._pInst.degrees(t)),this.drawingContext.transform(1,0,this._pInst.tan(t),1,0,0),this},r.Renderer2D.prototype.shearY=function(t){return this._pInst._angleMode===o.DEGREES&&(t=this._pInst.degrees(t)),this.drawingContext.transform(1,this._pInst.tan(t),0,1,0,0),this},r.Renderer2D.prototype.translate=function(t,e){return this.drawingContext.translate(t,e),this},r.Renderer2D.prototype.text=function(t,e,i,r,n){var s,a,h,l,u,p,c,f,d,y,m=this._pInst,g=Number.MAX_VALUE;if(this._doFill||this._doStroke){if("string"!=typeof t&&(t=t.toString()),t=t.replace(/(\t)/g,"  "),s=t.split("\n"),void 0!==r){for(d=0,h=0;h<s.length;h++)for(u="",f=s[h].split(" "),a=0;a<f.length;a++)p=u+f[a]+" ",c=this.textWidth(p),c>r?(u=f[a]+" ",d+=m.textLeading()):u=p;switch(this._rectMode===o.CENTER&&(e-=r/2,i-=n/2),this.drawingContext.textAlign){case o.CENTER:e+=r/2;break;case o.RIGHT:e+=r}if(void 0!==n){switch(this.drawingContext.textBaseline){case o.BOTTOM:i+=n-d;break;case o._CTX_MIDDLE:i+=(n-d)/2;break;case o.BASELINE:y=!0,this.drawingContext.textBaseline=o.TOP}g=i+n-m.textAscent()}for(h=0;h<s.length;h++){for(u="",f=s[h].split(" "),a=0;a<f.length;a++)p=u+f[a]+" ",c=this.textWidth(p),c>r&&u.length>0?(this._renderText(m,u,e,i,g),u=f[a]+" ",i+=m.textLeading()):u=p;this._renderText(m,u,e,i,g),i+=m.textLeading()}}else{var v=0,_=m.textAlign().vertical;for(_===o.CENTER?v=(s.length-1)*m.textLeading()/2:_===o.BOTTOM&&(v=(s.length-1)*m.textLeading()),l=0;l<s.length;l++)this._renderText(m,s[l],e,i-v,g),i+=m.textLeading()}return y&&(this.drawingContext.textBaseline=o.BASELINE),m}},r.Renderer2D.prototype._renderText=function(t,e,i,r,n){if(!(r>=n))return t.push(),this._isOpenType()?this._textFont._renderPath(e,i,r,{renderer:this}):(this._doStroke&&this._strokeSet&&this.drawingContext.strokeText(e,i,r),this._doFill&&(this._fillSet||this._setFill(o._DEFAULT_TEXT_FILL),this.drawingContext.fillText(e,i,r))),t.pop(),t},r.Renderer2D.prototype.textWidth=function(t){return this._isOpenType()?this._textFont._textWidth(t,this._textSize):this.drawingContext.measureText(t).width},r.Renderer2D.prototype.textAlign=function(t,e){if(arguments.length)return t!==o.LEFT&&t!==o.RIGHT&&t!==o.CENTER||(this.drawingContext.textAlign=t),e!==o.TOP&&e!==o.BOTTOM&&e!==o.CENTER&&e!==o.BASELINE||(e===o.CENTER?this.drawingContext.textBaseline=o._CTX_MIDDLE:this.drawingContext.textBaseline=e),this._pInst;var i=this.drawingContext.textBaseline;return i===o._CTX_MIDDLE&&(i=o.CENTER),{horizontal:this.drawingContext.textAlign,vertical:i}},r.Renderer2D.prototype._applyTextProperties=function(){var t,e=this._pInst;return this._setProperty("_textAscent",null),this._setProperty("_textDescent",null),t=this._textFont,this._isOpenType()&&(t=this._textFont.font.familyName,this._setProperty("_textStyle",this._textFont.font.styleName)),this.drawingContext.font=(this._textStyle||"normal")+" "+(this._textSize||12)+"px "+(t||"sans-serif"),e},r.Renderer2D.prototype.push=function(){this.drawingContext.save()},r.Renderer2D.prototype.pop=function(){this.drawingContext.restore(),this._cachedFillStyle=this.drawingContext.fillStyle,this._cachedStrokeStyle=this.drawingContext.strokeStyle},e.exports=r.Renderer2D},{"../image/filters":73,"./canvas":52,"./constants":53,"./core":54,"./p5.Renderer":61}],63:[function(t,e,i){var r=t("./core"),n=t("./constants");t("./p5.Graphics"),t("./p5.Renderer2D"),t("../webgl/p5.RendererGL");var o="defaultCanvas0";r.prototype.createCanvas=function(t,e,i){var s,a,h=i||n.P2D;if(arguments[3]&&(s="boolean"==typeof arguments[3]&&arguments[3]),h===n.WEBGL)a=document.getElementById(o),a&&a.parentNode.removeChild(a),a=document.createElement("canvas"),a.id=o;else if(s){a=document.createElement("canvas");for(var l=0;document.getElementById("defaultCanvas"+l);)l++;o="defaultCanvas"+l,a.id=o}else a=this.canvas;return this._setupDone||(a.dataset.hidden=!0,a.style.visibility="hidden"),this._userNode?this._userNode.appendChild(a):document.body.appendChild(a),h===n.WEBGL?(this._setProperty("_renderer",new r.RendererGL(a,this,!0)),this._isdefaultGraphics=!0):this._isdefaultGraphics||(this._setProperty("_renderer",new r.Renderer2D(a,this,!0)),this._isdefaultGraphics=!0),this._renderer.resize(t,e),this._renderer._applyDefaults(),s&&this._elements.push(this._renderer),this._renderer},r.prototype.resizeCanvas=function(t,e,i){if(this._renderer){var r={};for(var n in this.drawingContext){var o=this.drawingContext[n];"object"!=typeof o&&"function"!=typeof o&&(r[n]=o)}this._renderer.resize(t,e);for(var s in r)this.drawingContext[s]=r[s];i||this.redraw()}},r.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},r.prototype.createGraphics=function(t,e,i){return new r.Graphics(t,e,i,this)},r.prototype.blendMode=function(t){if(t!==n.BLEND&&t!==n.DARKEST&&t!==n.LIGHTEST&&t!==n.DIFFERENCE&&t!==n.MULTIPLY&&t!==n.EXCLUSION&&t!==n.SCREEN&&t!==n.REPLACE&&t!==n.OVERLAY&&t!==n.HARD_LIGHT&&t!==n.SOFT_LIGHT&&t!==n.DODGE&&t!==n.BURN&&t!==n.ADD&&t!==n.NORMAL)throw new Error("Mode "+t+" not recognized.");this._renderer.blendMode(t)},e.exports=r},{"../webgl/p5.RendererGL":105,"./constants":53,"./core":54,"./p5.Graphics":60,"./p5.Renderer2D":62}],64:[function(t,e,i){window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),window.performance=window.performance||{},window.performance.now=function(){var t=Date.now();return window.performance.now||window.performance.mozNow||window.performance.msNow||window.performance.oNow||window.performance.webkitNow||function(){return Date.now()-t}}(),function(){"use strict";"undefined"==typeof Uint8ClampedArray||Uint8ClampedArray.prototype.slice||Object.defineProperty(Uint8ClampedArray.prototype,"slice",{value:Array.prototype.slice,writable:!0,configurable:!0,enumerable:!1})}()},{}],65:[function(t,e,i){"use strict";var r=t("./core");r.prototype.exit=function(){throw"exit() not implemented, see remove()"},r.prototype.noLoop=function(){this._loop=!1},r.prototype.loop=function(){this._loop=!0,this._draw()},r.prototype.push=function(){this._renderer.push(),this._styles.push({_doStroke:this._renderer._doStroke,_strokeSet:this._renderer._strokeSet,_doFill:this._renderer._doFill,_fillSet:this._renderer._fillSet,_tint:this._renderer._tint,_imageMode:this._renderer._imageMode,_rectMode:this._renderer._rectMode,_ellipseMode:this._renderer._ellipseMode,_colorMode:this._renderer._colorMode,_textFont:this._renderer._textFont,_textLeading:this._renderer._textLeading,_textSize:this._renderer._textSize,_textStyle:this._renderer._textStyle})},r.prototype.pop=function(){this._renderer.pop();var t=this._styles.pop();for(var e in t)this._renderer[e]=t[e]},r.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},r.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},r.prototype.redraw=function(){this.resetMatrix(),this._renderer.isP3D&&this._renderer._update();var t=1;if(1===arguments.length)try{parseInt(arguments[0])>1&&(t=parseInt(arguments[0]))}catch(t){}var e=this.setup||window.setup,i=this.draw||window.draw;if("function"==typeof i){void 0===e&&this.scale(this._pixelDensity,this._pixelDensity);for(var r=this,n=function(t){t.call(r)},o=0;o<t;o++)this._registeredMethods.pre.forEach(n),i(),this._registeredMethods.post.forEach(n)}},r.prototype.size=function(){var t="size() is not a valid p5 function, to set the size of the ";throw t+="drawing canvas, please use createCanvas() instead"},e.exports=r},{"./core":54}],66:[function(t,e,i){"use strict";var r=t("./core"),n=t("./constants");r.prototype.applyMatrix=function(t,e,i,r,n,o){return this._renderer.applyMatrix(t,e,i,r,n,o),this},r.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},r.prototype.printMatrix=function(){throw new Error("printMatrix() not implemented")},r.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")},r.prototype.resetMatrix=function(){return this._renderer.resetMatrix(),this},r.prototype.rotate=function(t,e){for(var i,r=new Array(arguments.length),o=0;o<r.length;++o)r[o]=arguments[o];return this._angleMode===n.DEGREES?i=this.radians(r[0]):this._angleMode===n.RADIANS&&(i=r[0]),r.length>1?this._renderer.rotate(i,r[1]):this._renderer.rotate(i),this},r.prototype.rotateX=function(t){if(!this._renderer.isP3D)throw"not supported in p2d. Please use webgl mode";return this._renderer.rotateX(t),this},r.prototype.rotateY=function(t){if(!this._renderer.isP3D)throw"not supported in p2d. Please use webgl mode";return this._renderer.rotateY(t),this},r.prototype.rotateZ=function(t){if(!this._renderer.isP3D)throw"not supported in p2d. Please use webgl mode";return this._renderer.rotateZ(t),this},r.prototype.scale=function(){for(var t,e,i,n=new Array(arguments.length),o=0;o<n.length;o++)n[o]=arguments[o];return void 0!==r.Vector&&n[0]instanceof r.Vector?(t=n[0].x,e=n[0].y,i=n[0].z):n[0]instanceof Array?(t=n[0][0],e=n[0][1],i=n[0][2]||1):1===n.length?t=e=i=n[0]:(t=n[0],e=n[1],i=n[2]||1),this._renderer.isP3D?this._renderer.scale.call(this._renderer,t,e,i):this._renderer.scale.call(this._renderer,t,e),this},r.prototype.shearX=function(t){return this._angleMode===n.DEGREES&&(t=this.radians(t)),this._renderer.shearX(t),this},r.prototype.shearY=function(t){return this._angleMode===n.DEGREES&&(t=this.radians(t)),this._renderer.shearY(t),this},r.prototype.translate=function(t,e,i){return this._renderer.isP3D?this._renderer.translate(t,e,i):this._renderer.translate(t,e),this},e.exports=r},{"./constants":53,"./core":54}],67:[function(t,e,i){"use strict";var r=t("./core"),n=t("./constants"),o=null,s=[],a=[],h=!1,l=!1,u=!1,p=!1,c=!0;r.prototype.beginContour=function(){return a=[],p=!0,this},r.prototype.beginShape=function(t){return o=t===n.POINTS||t===n.LINES||t===n.TRIANGLES||t===n.TRIANGLE_FAN||t===n.TRIANGLE_STRIP||t===n.QUADS||t===n.QUAD_STRIP?t:null,this._renderer.isP3D?this._renderer.beginShape(t):(s=[],a=[]),this},r.prototype.bezierVertex=function(t,e,i,r,n,o){if(0===s.length)throw"vertex() must be used once before calling bezierVertex()";h=!0;for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return l.isVert=!1,p?a.push(l):s.push(l),this},r.prototype.curveVertex=function(t,e){return l=!0,this.vertex(t,e),this},r.prototype.endContour=function(){var t=a[0].slice();t.isVert=a[0].isVert,t.moveTo=!1,a.push(t),c&&(s.push(s[0]),c=!1);for(var e=0;e<a.length;e++)s.push(a[e]);return this},r.prototype.endShape=function(t){if(this._renderer.isP3D)this._renderer.endShape(t,l,h,u,p,o);else{if(0===s.length)return this;if(!this._renderer._doStroke&&!this._renderer._doFill)return this;var e=t===n.CLOSE;e&&!p&&s.push(s[0]),this._renderer.endShape(t,s,l,h,u,p,o),l=!1,h=!1,u=!1,p=!1,c=!0,e&&s.pop()}return this},r.prototype.quadraticVertex=function(t,e,i,r){if(this._contourInited){var o={};return o.x=t,o.y=e,o.x3=i,o.y3=r,o.type=n.QUADRATIC,this._contourVertices.push(o),this}if(!(s.length>0))throw"vertex() must be used once before calling quadraticVertex()";u=!0;for(var h=[],l=0;l<arguments.length;l++)h[l]=arguments[l];return h.isVert=!1,p?a.push(h):s.push(h),this},r.prototype.vertex=function(t,e,i){if(this._renderer.isP3D)this._renderer.vertex(t,e,i);else{var r=[];r.isVert=!0,r[0]=t,r[1]=e,r[2]=0,r[3]=0,r[4]=0,r[5]=this._renderer._getFill(),r[6]=this._renderer._getStroke(),i&&(r.moveTo=i),p?(0===a.length&&(r.moveTo=!0),a.push(r)):s.push(r)}return this},e.exports=r},{"./constants":53,"./core":54}],68:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.createStringDict=function(){return new r.StringDict(arguments[0],arguments[1])},r.prototype.createNumberDict=function(){return new r.NumberDict(arguments[0],arguments[1])},r.TypedDict=function(){return this.data={},arguments[0][0]instanceof Object?this.data=arguments[0][0]:this.data[arguments[0][0]]=arguments[0][1],this},r.TypedDict.prototype.size=function(){return Object.keys(this.data).length},r.TypedDict.prototype.hasKey=function(t){return this.data.hasOwnProperty(t)},r.TypedDict.prototype.get=function(t){if(this.data.hasOwnProperty(t))return this.data[t];console.log(t+" does not exist in this Dictionary")},r.TypedDict.prototype.set=function(t,e){2===arguments.length&&(this.data.hasOwnProperty(t)?this.data[t]=e:this.create(t,e))},r.TypedDict.prototype._addObj=function(t){for(var e in t)this._validate(t[e])?this.data[e]=t[e]:console.log("Those values dont work for this dictionary type.")},r.TypedDict.prototype.create=function(){if(1===arguments.length&&arguments[0]instanceof Object)this._addObj(arguments[0]);else if(2===arguments.length){var t={};t[arguments[0]]=arguments[1],this._addObj(t)}else console.log("In order to create a new Dictionary entry you must pass an object or a key, value pair")},r.TypedDict.prototype.clear=function(){this.data={}},r.TypedDict.prototype.remove=function(t){if(!this.data.hasOwnProperty(t))throw t+" does not exist in this Dictionary";delete this.data[t]},r.TypedDict.prototype.print=function(){for(var t in this.data)console.log("key:"+t+" value:"+this.data[t])},r.TypedDict.prototype.saveTable=function(){var t="";for(var e in this.data)t+=e+","+this.data[e]+"\n";var i=arguments[0]||"mycsv",n=new Blob([t],{type:"text/csv"}),o=window.URL.createObjectURL(n);r.prototype.downloadFile(o,i,"csv")},r.TypedDict.prototype.saveJSON=function(t,e){r.prototype.saveJSON(this.data,t,e)},r.TypedDict.prototype._validate=function(t,e){return!0},r.StringDict=function(){r.TypedDict.call(this,arguments)},r.StringDict.prototype=Object.create(r.TypedDict.prototype),r.StringDict.prototype._validate=function(t){return"string"==typeof t},r.NumberDict=function(){r.TypedDict.call(this,arguments)},r.NumberDict.prototype=Object.create(r.TypedDict.prototype),r.NumberDict.prototype._validate=function(t){return"number"==typeof t},r.NumberDict.prototype.add=function(t,e){this.data.hasOwnProperty(t)?this.data[t]+=e:console.log("The key - "+t+" does not exist in this dictionary.")},r.NumberDict.prototype.sub=function(t,e){this.add(t,-e)},r.NumberDict.prototype.mult=function(t,e){this.data.hasOwnProperty(t)?this.data[t]*=e:console.log("The key - "+t+" does not exist in this dictionary.")},r.NumberDict.prototype.div=function(t,e){this.data.hasOwnProperty(t)?this.data[t]/=e:console.log("The key - "+t+" does not exist in this dictionary.")},r.NumberDict.prototype._valueTest=function(t){if(0===Object.keys(this.data).length)throw"Unable to search for a minimum or maximum value on an empty NumberDict";if(1===Object.keys(this.data).length)return this.data[Object.keys(this.data)[0]];var e=this.data[Object.keys(this.data)[0]];for(var i in this.data)this.data[i]*t<e*t&&(e=this.data[i]);return e},r.NumberDict.prototype.minValue=function(){return this._valueTest(1)},r.NumberDict.prototype.maxValue=function(){return this._valueTest(-1)},r.NumberDict.prototype._keyTest=function(t){if(0===Object.keys(this.data).length)throw"Unable to use minValue on an empty NumberDict";if(1===Object.keys(this.data).length)return Object.keys(this.data)[0];for(var e=Object.keys(this.data)[0],i=1;i<Object.keys(this.data).length;i++)Object.keys(this.data)[i]*t<e*t&&(e=Object.keys(this.data)[i]);return e},r.NumberDict.prototype.minKey=function(){return this._keyTest(1)},r.NumberDict.prototype.maxKey=function(){return this._keyTest(-1)},e.exports=r.TypedDict},{"../core/core":54}],69:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.deviceOrientation=void 0,r.prototype.accelerationX=0,r.prototype.accelerationY=0,r.prototype.accelerationZ=0,r.prototype.pAccelerationX=0,r.prototype.pAccelerationY=0,r.prototype.pAccelerationZ=0,r.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX),this._setProperty("pAccelerationY",this.accelerationY),this._setProperty("pAccelerationZ",this.accelerationZ)},r.prototype.rotationX=0,r.prototype.rotationY=0,r.prototype.rotationZ=0,r.prototype.pRotationX=0,r.prototype.pRotationY=0,r.prototype.pRotationZ=0;var n,o,s,a=0,h=0,l=0,u="clockwise",p="clockwise",c="clockwise";r.prototype._updatePRotations=function(){this._setProperty("pRotationX",this.rotationX),this._setProperty("pRotationY",this.rotationY),this._setProperty("pRotationZ",this.rotationZ)},r.prototype.turnAxis=void 0;var f=.5,d=30;r.prototype.setMoveThreshold=function(t){"number"==typeof t&&(f=t)},r.prototype.setShakeThreshold=function(t){"number"==typeof t&&(d=t)},r.prototype._ondeviceorientation=function(t){this._updatePRotations(),this._setProperty("rotationX",t.beta),this._setProperty("rotationY",t.gamma),this._setProperty("rotationZ",t.alpha),this._handleMotion()},r.prototype._ondevicemotion=function(t){this._updatePAccelerations(),this._setProperty("accelerationX",2*t.acceleration.x),this._setProperty("accelerationY",2*t.acceleration.y),this._setProperty("accelerationZ",2*t.acceleration.z),this._handleMotion()},r.prototype._handleMotion=function(){90===window.orientation||-90===window.orientation?this._setProperty("deviceOrientation","landscape"):0===window.orientation?this._setProperty("deviceOrientation","portrait"):void 0===window.orientation&&this._setProperty("deviceOrientation","undefined");var t=this.deviceMoved||window.deviceMoved;"function"==typeof t&&(Math.abs(this.accelerationX-this.pAccelerationX)>f||Math.abs(this.accelerationY-this.pAccelerationY)>f||Math.abs(this.accelerationZ-this.pAccelerationZ)>f)&&t();var e=this.deviceTurned||window.deviceTurned;if("function"==typeof e){var i=this.rotationX+180,r=this.pRotationX+180,y=a+180;i-r>0&&i-r<270||i-r<-270?u="clockwise":(i-r<0||i-r>270)&&(u="counter-clockwise"),u!==n&&(y=i),Math.abs(i-y)>90&&Math.abs(i-y)<270&&(y=i,this._setProperty("turnAxis","X"),e()),n=u,a=y-180;var m=this.rotationY+180,g=this.pRotationY+180,v=h+180;m-g>0&&m-g<270||m-g<-270?p="clockwise":(m-g<0||m-this.pRotationY>270)&&(p="counter-clockwise"),p!==o&&(v=m),Math.abs(m-v)>90&&Math.abs(m-v)<270&&(v=m,this._setProperty("turnAxis","Y"),e()),o=p,h=v-180,this.rotationZ-this.pRotationZ>0&&this.rotationZ-this.pRotationZ<270||this.rotationZ-this.pRotationZ<-270?c="clockwise":(this.rotationZ-this.pRotationZ<0||this.rotationZ-this.pRotationZ>270)&&(c="counter-clockwise"),c!==s&&(l=this.rotationZ),Math.abs(this.rotationZ-l)>90&&Math.abs(this.rotationZ-l)<270&&(l=this.rotationZ,this._setProperty("turnAxis","Z"),e()),s=c,this._setProperty("turnAxis",void 0)}var _=this.deviceShaken||window.deviceShaken;if("function"==typeof _){var b,w;null!==this.pAccelerationX&&(b=Math.abs(this.accelerationX-this.pAccelerationX),w=Math.abs(this.accelerationY-this.pAccelerationY)),b+w>d&&_()}},e.exports=r},{"../core/core":54}],70:[function(t,e,i){"use strict";function r(){for(var t in o)if(o.hasOwnProperty(t)&&!0===o[t])return!0;return!1}var n=t("../core/core"),o={};n.prototype.isKeyPressed=!1,n.prototype.keyIsPressed=!1,n.prototype.key="",n.prototype.keyCode=0,n.prototype._onkeydown=function(t){if(!o[t.which]){this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",t.which),o[t.which]=!0;var e=String.fromCharCode(t.which);e||(e=t.which),this._setProperty("key",e);var i=this.keyPressed||window.keyPressed;if("function"==typeof i&&!t.charCode){!1===i(t)&&t.preventDefault()}}},n.prototype._onkeyup=function(t){var e=this.keyReleased||window.keyReleased;o[t.which]=!1,r()||(this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1)),this._setProperty("_lastKeyCodeTyped",null);var i=String.fromCharCode(t.which);if(i||(i=t.which),this._setProperty("key",i),this._setProperty("keyCode",t.which),"function"==typeof e){!1===e(t)&&t.preventDefault()}},n.prototype._onkeypress=function(t){if(t.which!==this._lastKeyCodeTyped){this._setProperty("keyCode",t.which),this._setProperty("_lastKeyCodeTyped",t.which),this._setProperty("key",String.fromCharCode(t.which));var e=this.keyTyped||window.keyTyped;if("function"==typeof e){!1===e(t)&&t.preventDefault()}}},n.prototype._onblur=function(t){o={}},n.prototype.keyIsDown=function(t){return o[t]},e.exports=n},{"../core/core":54}],71:[function(t,e,i){"use strict";function r(t,e,i,r){r&&!r.clientX&&(r.touches?r=r.touches[0]:r.changedTouches&&(r=r.changedTouches[0]));var n=t.getBoundingClientRect(),o=t.scrollWidth/e,s=t.scrollHeight/i;return{x:(r.clientX-n.left)/o,y:(r.clientY-n.top)/s,winX:r.clientX,winY:r.clientY,id:r.identifier}}var n=t("../core/core"),o=t("../core/constants");n.prototype._hasMouseInteracted=!1,n.prototype.mouseX=0,n.prototype.mouseY=0,n.prototype.pmouseX=0,n.prototype.pmouseY=0,n.prototype.winMouseX=0,n.prototype.winMouseY=0,n.prototype.pwinMouseX=0,n.prototype.pwinMouseY=0,n.prototype.mouseButton=0,n.prototype.mouseIsPressed=!1,n.prototype._updateNextMouseCoords=function(t){if(null!==this._curElement&&(!t.touches||t.touches.length>0)){var e=r(this._curElement.elt,this.width,this.height,t);this._setProperty("mouseX",e.x),this._setProperty("mouseY",e.y),this._setProperty("winMouseX",e.winX),this._setProperty("winMouseY",e.winY)}this._hasMouseInteracted||(this._updateMouseCoords(),this._setProperty("_hasMouseInteracted",!0))},n.prototype._updateMouseCoords=function(){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY)},n.prototype._setMouseButton=function(t){1===t.button?this._setProperty("mouseButton",o.CENTER):2===t.button?this._setProperty("mouseButton",o.RIGHT):this._setProperty("mouseButton",o.LEFT)},n.prototype._onmousemove=function(t){var e=this._isGlobal?window:this;this._updateNextMouseCoords(t),this.mouseIsPressed?"function"==typeof e.mouseDragged?!1===e.mouseDragged(t)&&t.preventDefault():"function"==typeof e.touchMoved&&!1===e.touchMoved(t)&&t.preventDefault():"function"==typeof e.mouseMoved&&!1===e.mouseMoved(t)&&t.preventDefault()},n.prototype._onmousedown=function(t){var e=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._setMouseButton(t),this._updateNextMouseCoords(t),"function"==typeof e.mousePressed?!1===e.mousePressed(t)&&t.preventDefault():"function"==typeof e.touchStarted&&!1===e.touchStarted(t)&&t.preventDefault()},n.prototype._onmouseup=function(t){var e=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!1),"function"==typeof e.mouseReleased?!1===e.mouseReleased(t)&&t.preventDefault():"function"==typeof e.touchEnded&&!1===e.touchEnded(t)&&t.preventDefault()},n.prototype._ondragend=n.prototype._onmouseup,n.prototype._ondragover=n.prototype._onmousemove,n.prototype._onclick=function(t){var e=this._isGlobal?window:this;if("function"==typeof e.mouseClicked){!1===e.mouseClicked(t)&&t.preventDefault()}},n.prototype._doubleClicked=function(t){var e=this._isGlobal?window:this;if("function"==typeof e.doubleClicked){!1===e.ondblclick(t)&&t.preventDefault()}},n.prototype._onwheel=function(t){var e=this._isGlobal?window:this;if("function"==typeof e.mouseWheel){t.delta=t.deltaY;!1===e.mouseWheel(t)&&t.preventDefault()}},e.exports=n},{"../core/constants":53,"../core/core":54}],72:[function(t,e,i){"use strict";function r(t,e,i,r,n){n=n||0;var o=t.getBoundingClientRect(),s=t.scrollWidth/e,a=t.scrollHeight/i,h=r.touches[n]||r.changedTouches[n];return{x:(h.clientX-o.left)/s,y:(h.clientY-o.top)/a,winX:h.clientX,winY:h.clientY,id:h.identifier}}var n=t("../core/core");n.prototype.touches=[],n.prototype._updateTouchCoords=function(t){if(null!==this._curElement){for(var e=[],i=0;i<t.touches.length;i++)e[i]=r(this._curElement.elt,this.width,this.height,t,i);this._setProperty("touches",e)}},n.prototype._ontouchstart=function(t){var e=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._updateTouchCoords(t),this._updateNextMouseCoords(t),"function"==typeof e.touchStarted?!1===e.touchStarted(t)&&t.preventDefault():"function"==typeof e.mousePressed&&!1===e.mousePressed(t)&&t.preventDefault()},n.prototype._ontouchmove=function(t){var e=this._isGlobal?window:this;this._updateTouchCoords(t),this._updateNextMouseCoords(t),"function"==typeof e.touchMoved?!1===e.touchMoved(t)&&t.preventDefault():"function"==typeof e.mouseDragged&&!1===e.mouseDragged(t)&&t.preventDefault()},n.prototype._ontouchend=function(t){this._setProperty("mouseIsPressed",!1),this._updateTouchCoords(t),this._updateNextMouseCoords(t);var e=this._isGlobal?window:this;"function"==typeof e.touchEnded?!1===e.touchEnded(t)&&t.preventDefault():"function"==typeof e.mouseReleased&&!1===e.mouseReleased(t)&&t.preventDefault()},e.exports=n},{"../core/core":54}],73:[function(t,e,i){"use strict";function r(t){var e=3.5*t|0;if(e=e<1?1:e<248?e:248,s!==e){s=e,a=1+s<<1,h=new Int32Array(a),l=new Array(a);for(var i=0;i<a;i++)l[i]=new Int32Array(256);for(var r,n,o,u,p=1,c=e-1;p<e;p++){h[e+p]=h[c]=n=c*c,o=l[e+p],u=l[c--];for(var f=0;f<256;f++)o[f]=u[f]=n*f}r=h[e]=e*e,o=l[e];for(var d=0;d<256;d++)o[d]=r*d}}function n(t,e){for(var i=o._toPixels(t),n=t.width,u=t.height,p=n*u,c=new Int32Array(p),f=0;f<p;f++)c[f]=o._getARGB(i,f);var d,y,m,g,v,_,b,w,x,S,T=new Int32Array(p),E=new Int32Array(p),P=new Int32Array(p),O=new Int32Array(p),M=0;r(e);var A,R,C,k;for(R=0;R<u;R++){for(A=0;A<n;A++){if(g=m=y=v=d=0,(_=A-s)<0)S=-_,_=0;else{if(_>=n)break;S=0}for(C=S;C<a&&!(_>=n);C++){var F=c[_+M];k=l[C],v+=k[(-16777216&F)>>>24],y+=k[(16711680&F)>>16],m+=k[(65280&F)>>8],g+=k[255&F],d+=h[C],_++}b=M+A,T[b]=v/d,E[b]=y/d,P[b]=m/d,O[b]=g/d}M+=n}for(M=0,w=-s,x=w*n,R=0;R<u;R++){for(A=0;A<n;A++){if(g=m=y=v=d=0,w<0)S=b=-w,_=A;else{if(w>=u)break;S=0,b=w,_=A+x}for(C=S;C<a&&!(b>=u);C++)k=l[C],v+=k[T[_]],y+=k[E[_]],m+=k[P[_]],g+=k[O[_]],d+=h[C],b++,_+=n;c[A+M]=v/d<<24|y/d<<16|m/d<<8|g/d}M+=n,x+=n,w++}o._setPixels(i,c)}var o={};o._toPixels=function(t){return t instanceof ImageData?t.data:t.getContext("2d").getImageData(0,0,t.width,t.height).data},o._getARGB=function(t,e){var i=4*e;return t[i+3]<<24&4278190080|t[i]<<16&16711680|t[i+1]<<8&65280|255&t[i+2]},o._setPixels=function(t,e){for(var i=0,r=0,n=t.length;r<n;r++)i=4*r,t[i+0]=(16711680&e[r])>>>16,t[i+1]=(65280&e[r])>>>8,t[i+2]=255&e[r],t[i+3]=(4278190080&e[r])>>>24},o._toImageData=function(t){return t instanceof ImageData?t:t.getContext("2d").getImageData(0,0,t.width,t.height)},o._createImageData=function(t,e){return o._tmpCanvas=document.createElement("canvas"),o._tmpCtx=o._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(t,e)},o.apply=function(t,e,i){var r=t.getContext("2d"),n=r.getImageData(0,0,t.width,t.height),o=e(n,i);o instanceof ImageData?r.putImageData(o,0,0,0,0,t.width,t.height):r.putImageData(n,0,0,0,0,t.width,t.height)},o.threshold=function(t,e){var i=o._toPixels(t);void 0===e&&(e=.5);for(var r=Math.floor(255*e),n=0;n<i.length;n+=4){var s,a=i[n],h=i[n+1],l=i[n+2],u=.2126*a+.7152*h+.0722*l;s=u>=r?255:0,i[n]=i[n+1]=i[n+2]=s}},o.gray=function(t){for(var e=o._toPixels(t),i=0;i<e.length;i+=4){var r=e[i],n=e[i+1],s=e[i+2],a=.2126*r+.7152*n+.0722*s;e[i]=e[i+1]=e[i+2]=a}},o.opaque=function(t){for(var e=o._toPixels(t),i=0;i<e.length;i+=4)e[i+3]=255;return e},o.invert=function(t){for(var e=o._toPixels(t),i=0;i<e.length;i+=4)e[i]=255-e[i],e[i+1]=255-e[i+1],e[i+2]=255-e[i+2]},o.posterize=function(t,e){var i=o._toPixels(t);if(e<2||e>255)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var r=e-1,n=0;n<i.length;n+=4){var s=i[n],a=i[n+1],h=i[n+2];i[n]=255*(s*e>>8)/r,i[n+1]=255*(a*e>>8)/r,i[n+2]=255*(h*e>>8)/r}},o.dilate=function(t){for(var e,i,r,n,s,a,h,l,u,p,c,f,d,y,m,g,v,_=o._toPixels(t),b=0,w=_.length?_.length/4:0,x=new Int32Array(w);b<w;)for(e=b,i=b+t.width;b<i;)r=n=o._getARGB(_,b),h=b-1,a=b+1,l=b-t.width,u=b+t.width,h<e&&(h=b),a>=i&&(a=b),l<0&&(l=0),u>=w&&(u=b),f=o._getARGB(_,l),c=o._getARGB(_,h),d=o._getARGB(_,u),p=o._getARGB(_,a),s=77*(r>>16&255)+151*(r>>8&255)+28*(255&r),m=77*(c>>16&255)+151*(c>>8&255)+28*(255&c),y=77*(p>>16&255)+151*(p>>8&255)+28*(255&p),g=77*(f>>16&255)+151*(f>>8&255)+28*(255&f),v=77*(d>>16&255)+151*(d>>8&255)+28*(255&d),m>s&&(n=c,s=m),y>s&&(n=p,s=y),g>s&&(n=f,s=g),v>s&&(n=d,s=v),x[b++]=n;o._setPixels(_,x)},o.erode=function(t){for(var e,i,r,n,s,a,h,l,u,p,c,f,d,y,m,g,v,_=o._toPixels(t),b=0,w=_.length?_.length/4:0,x=new Int32Array(w);b<w;)for(e=b,i=b+t.width;b<i;)r=n=o._getARGB(_,b),h=b-1,a=b+1,l=b-t.width,u=b+t.width,h<e&&(h=b),a>=i&&(a=b),l<0&&(l=0),u>=w&&(u=b),f=o._getARGB(_,l),c=o._getARGB(_,h),d=o._getARGB(_,u),p=o._getARGB(_,a),s=77*(r>>16&255)+151*(r>>8&255)+28*(255&r),m=77*(c>>16&255)+151*(c>>8&255)+28*(255&c),y=77*(p>>16&255)+151*(p>>8&255)+28*(255&p),g=77*(f>>16&255)+151*(f>>8&255)+28*(255&f),v=77*(d>>16&255)+151*(d>>8&255)+28*(255&d),m<s&&(n=c,s=m),y<s&&(n=p,s=y),g<s&&(n=f,s=g),v<s&&(n=d,s=v),x[b++]=n;o._setPixels(_,x)};var s,a,h,l;o.blur=function(t,e){n(t,e)},e.exports=o},{}],74:[function(t,e,i){"use strict";var r=t("../core/core"),n=[];r.prototype.createImage=function(t,e){return new r.Image(t,e)},r.prototype.saveCanvas=function(){var t,e,i;if(3===arguments.length?(t=arguments[0],e=arguments[1],i=arguments[2]):2===arguments.length?"object"==typeof arguments[0]?(t=arguments[0],e=arguments[1]):(e=arguments[0],i=arguments[1]):1===arguments.length&&("object"==typeof arguments[0]?t=arguments[0]:e=arguments[0]),t instanceof r.Element&&(t=t.elt),t instanceof HTMLCanvasElement||(t=null),i||""===(i=r.prototype._checkFileExtension(e,i)[1])&&(i="png"),t||this._curElement&&this._curElement.elt&&(t=this._curElement.elt),r.prototype._isSafari()){var n="Hello, Safari user!\n";n+="Now capturing a screenshot...\n",n+="To save this image,\n",n+="go to File --\x3e Save As.\n",alert(n),window.location.href=t.toDataURL()}else{var o;if(void 0===i)i="png",o="image/png";else switch(i){case"png":o="image/png";break;case"jpeg":case"jpg":o="image/jpeg";break;default:o="image/png"}var s=t.toDataURL(o);s=s.replace(o,"image/octet-stream"),r.prototype.downloadFile(s,e,i)}},r.prototype.saveFrames=function(t,e,i,o,s){var a=i||3;a=r.prototype.constrain(a,0,15),a*=1e3;var h=o||15;h=r.prototype.constrain(h,0,22);var l=0,u=r.prototype._makeFrame,p=this._curElement.elt,c=setInterval(function(){u(t+l,e,p),l++},1e3/h);setTimeout(function(){if(clearInterval(c),s)s(n);else for(var t=0;t<n.length;t++){var e=n[t];r.prototype.downloadFile(e.imageData,e.filename,e.ext)}n=[]},a+.01)},r.prototype._makeFrame=function(t,e,i){var r;r=this?this._curElement.elt:i;var o;if(e)switch(e.toLowerCase()){case"png":o="image/png";break;case"jpeg":case"jpg":o="image/jpeg";break;default:o="image/png"}else e="png",o="image/png";var s=r.toDataURL(o);s=s.replace(o,"image/octet-stream");var a={};a.imageData=s,a.filename=t,a.ext=e,n.push(a)},e.exports=r},{"../core/core":54}],75:[function(t,e,i){"use strict";function r(t,e){return t>0&&t<e?t:e}var n=t("../core/core"),o=t("./filters"),s=t("../core/canvas"),a=t("../core/constants");t("../core/error_helpers"),n.prototype.loadImage=function(t,e,i){var r=new Image,o=new n.Image(1,1,this),s=this;return r.onload=function(){o.width=o.canvas.width=r.width,o.height=o.canvas.height=r.height,o.drawingContext.drawImage(r,0,0),"function"==typeof e&&e(o),s._decrementPreload()},r.onerror=function(t){n._friendlyFileLoadError(0,r.src),"function"==typeof i&&i(t)},0!==t.indexOf("data:image/")&&(r.crossOrigin="Anonymous"),r.src=t,o},n.prototype.image=function(t,e,i,n,o,a,h,l,u){var p=t.width,c=t.height;t.elt&&t.elt.videoWidth&&!t.canvas&&(p=t.elt.videoWidth,c=t.elt.videoHeight);var f=e,d=i,y=n||p,m=o||c,g=a||0,v=h||0,_=l||p,b=u||c;_=r(_,p),b=r(b,c);var w=1;t.elt&&!t.canvas&&t.elt.style.width&&(w=t.elt.videoWidth&&!n?t.elt.videoWidth:t.elt.width,w/=parseInt(t.elt.style.width,10)),g*=w,v*=w,b*=w,_*=w;var x=s.modeAdjust(f,d,y,m,this._renderer._imageMode);this._renderer.image(t,g,v,_,b,x.x,x.y,x.w,x.h)},n.prototype.tint=function(){var t=this.color.apply(this,arguments);this._renderer._tint=t.levels},n.prototype.noTint=function(){this._renderer._tint=null},n.prototype._getTintedImageCanvas=function(t){if(!t.canvas)return t;var e=o._toPixels(t.canvas),i=document.createElement("canvas");i.width=t.canvas.width,i.height=t.canvas.height;for(var r=i.getContext("2d"),n=r.createImageData(t.canvas.width,t.canvas.height),s=n.data,a=0;a<e.length;a+=4){var h=e[a],l=e[a+1],u=e[a+2],p=e[a+3];s[a]=h*this._renderer._tint[0]/255,s[a+1]=l*this._renderer._tint[1]/255,s[a+2]=u*this._renderer._tint[2]/255,s[a+3]=p*this._renderer._tint[3]/255}return r.putImageData(n,0,0),i},n.prototype.imageMode=function(t){t!==a.CORNER&&t!==a.CORNERS&&t!==a.CENTER||(this._renderer._imageMode=t)},e.exports=n},{"../core/canvas":52,"../core/constants":53,"../core/core":54,"../core/error_helpers":57,"./filters":73}],76:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("./filters");r.Image=function(t,e){this.width=t,this.height=e,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),this._pixelDensity=1,this.isTexture=!1,this.pixels=[]},r.Image.prototype._setProperty=function(t,e){this[t]=e},r.Image.prototype.loadPixels=function(){r.Renderer2D.prototype.loadPixels.call(this)},r.Image.prototype.updatePixels=function(t,e,i,n){r.Renderer2D.prototype.updatePixels.call(this,t,e,i,n)},r.Image.prototype.get=function(t,e,i,n){return r.Renderer2D.prototype.get.call(this,t,e,i,n)},r.Image.prototype.set=function(t,e,i){r.Renderer2D.prototype.set.call(this,t,e,i)},r.Image.prototype.resize=function(t,e){0===t&&0===e?(t=this.canvas.width,e=this.canvas.height):0===t?t=this.canvas.width*e/this.canvas.height:0===e&&(e=this.canvas.height*t/this.canvas.width),t=Math.floor(t),e=Math.floor(e);var i=document.createElement("canvas");i.width=t,i.height=e,i.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,i.width,i.height),this.canvas.width=this.width=t,this.canvas.height=this.height=e,this.drawingContext.drawImage(i,0,0,t,e,0,0,t,e),this.pixels.length>0&&this.loadPixels()},r.Image.prototype.copy=function(){r.prototype.copy.apply(this,arguments)},r.Image.prototype.mask=function(t){void 0===t&&(t=this);var e=this.drawingContext.globalCompositeOperation,i=1;t instanceof r.Renderer&&(i=t._pInst._pixelDensity);var n=[t,0,0,i*t.width,i*t.height,0,0,this.width,this.height];this.drawingContext.globalCompositeOperation="destination-in",r.Image.prototype.copy.apply(this,n),this.drawingContext.globalCompositeOperation=e},r.Image.prototype.filter=function(t,e){n.apply(this.canvas,n[t.toLowerCase()],e)},r.Image.prototype.blend=function(){r.prototype.blend.apply(this,arguments)},r.Image.prototype.save=function(t,e){var i;if(e)switch(e.toLowerCase()){case"png":i="image/png";break;case"jpeg":case"jpg":i="image/jpeg";break;default:i="image/png"}else e="png",i="image/png";var n=this.canvas.toDataURL(i);n=n.replace(i,"image/octet-stream"),r.prototype.downloadFile(n,t,e)},e.exports=r.Image},{"../core/core":54,"./filters":73}],77:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("./filters");t("../color/p5.Color"),r.prototype.pixels=[],r.prototype.blend=function(){this._renderer?this._renderer.blend.apply(this._renderer,arguments):r.Renderer2D.prototype.blend.apply(this,arguments)},r.prototype.copy=function(){r.Renderer2D._copyHelper.apply(this,arguments)},r.prototype.filter=function(t,e){void 0!==this.canvas?n.apply(this.canvas,n[t.toLowerCase()],e):n.apply(this.elt,n[t.toLowerCase()],e)},r.prototype.get=function(t,e,i,r){return this._renderer.get(t,e,i,r)},r.prototype.loadPixels=function(){this._renderer.loadPixels()},r.prototype.set=function(t,e,i){this._renderer.set(t,e,i)},r.prototype.updatePixels=function(t,e,i,r){0!==this.pixels.length&&this._renderer.updatePixels(t,e,i,r)},e.exports=r},{"../color/p5.Color":48,"../core/core":54,"./filters":73}],78:[function(t,e,i){"use strict";function r(t,e){var i={};if(void 0===(e=e||[]))for(var r=0;r<t.length;r++)e[r.toString()]=r;for(var n=0;n<e.length;n++){var o=e[n],s=t[n];i[o]=s}return i}function n(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function o(t,e){e&&!0!==e&&"true"!==e||(e=""),t||(t="untitled");var i="";return t&&t.indexOf(".")>-1&&(i=t.split(".").pop()),e&&i!==e&&(i=e,t=t+"."+i),[t,i]}function s(t){document.body.removeChild(t.target)}var a=t("../core/core");t("whatwg-fetch"),t("es6-promise").polyfill();var h=t("fetch-jsonp");t("../core/error_helpers"),a.prototype.loadJSON=function(){for(var t,e,i,r=arguments[0],n={},o="json",s=1;s<arguments.length;s++){var h=arguments[s];"string"==typeof h?"jsonp"!==h&&"json"!==h||(o=h):"function"==typeof h?t?e=h:t=h:"object"==typeof h&&h.hasOwnProperty("jsonpCallback")&&(o="jsonp",i=h)}var l=this;return a.prototype.httpDo(r,"GET",i,o,function(e){for(var i in e)n[i]=e[i];void 0!==t&&t(e),l._decrementPreload()},e),n},a.prototype.loadStrings=function(){for(var t,e,i=[],r=1;r<arguments.length;r++){var n=arguments[r];"function"==typeof n&&(void 0===t?t=n:void 0===e&&(e=n))}var o=this;return a.prototype.httpDo.call(this,arguments[0],"GET","text",function(e){var r=e.match(/[^\r\n]+/g);for(var n in r)i[n]=r[n];void 0!==t&&t(i),o._decrementPreload()},e),i},a.prototype.loadTable=function(t){var e,i,n=[],o=!1,s=t.substring(t.lastIndexOf(".")+1,t.length),h=",",l=!1;"tsv"===s&&(h="\t");for(var u=1;u<arguments.length;u++)if("function"==typeof arguments[u])void 0===e?e=arguments[u]:void 0===i&&(i=arguments[u]);else if("string"==typeof arguments[u])if(n.push(arguments[u]),"header"===arguments[u]&&(o=!0),"csv"===arguments[u]){if(l)throw new Error("Cannot set multiple separator types.");h=",",l=!0}else if("tsv"===arguments[u]){if(l)throw new Error("Cannot set multiple separator types.");h="\t",l=!0}var p=new a.Table,c=this;return a.prototype.httpDo(t,"GET","text",function(t){for(var i,n={},s=[],l=0,f=null,d=function(){n.currentState=0,n.token=""},y=function(){f.push(n.token),d()},m=function(){n.currentState=4,s.push(f),f=null};;){if(null==(i=t[l++])){if(n.escaped)throw new Error("Unclosed quote in file.");if(f){y(),m();break}}if(null===f&&function(){n.escaped=!1,f=[],d()}(),0===n.currentState){if('"'===i){n.escaped=!0,n.currentState=1;continue}n.currentState=1}1===n.currentState&&n.escaped?'"'===i?'"'===t[l]?(n.token+='"',l++):(n.escaped=!1,n.currentState=2):n.token+=i:"\r"===i?("\n"===t[l]&&l++,y(),m()):"\n"===i?(y(),m()):i===h?y():1===n.currentState&&(n.token+=i)}if(o)p.columns=s.shift();else for(u=0;u<s[0].length;u++)p.columns[u]="null";var g;for(u=0;u<s.length;u++)(1!==s[u].length||"undefined"!==s[u][0]&&""!==s[u][0])&&(g=new a.TableRow,g.arr=s[u],g.obj=r(s[u],p.columns),p.addRow(g));"function"==typeof e&&e(p),c._decrementPreload()},function(e){if(a._friendlyFileLoadError(2,t),!i)throw e;i(e)}),p},a.prototype.parseXML=function(t){var e,i=new a.XML;if(t.children.length){for(e=0;e<t.children.length;e++){var r=parseXML(t.children[e]);i.addChild(r)}i.setName(t.nodeName),i._setCont(t.textContent),i._setAttributes(t);for(var n=0;n<i.children.length;n++)i.children[n].parent=i;return i}return i.setName(t.nodeName),i._setCont(t.textContent),i._setAttributes(t),i},a.prototype.loadXML=function(){for(var t,e,i={},r=1;r<arguments.length;r++){var n=arguments[r];"function"==typeof n&&(void 0===t?t=n:void 0===e&&(e=n))}var o=this;return a.prototype.httpDo(arguments[0],"GET","xml",function(e){for(var r in e)i[r]=e[r];void 0!==t&&t(i),o._decrementPreload()},e),i},a.prototype.httpGet=function(){var t=Array.prototype.slice.call(arguments);t.splice(1,0,"GET"),a.prototype.httpDo.apply(this,t)},a.prototype.httpPost=function(){var t=Array.prototype.slice.call(arguments);t.splice(1,0,"POST"),a.prototype.httpDo.apply(this,t)},a.prototype.httpDo=function(){for(var t,e,i,r="",n={},o=0,s="text/plain",a=arguments.length-1;a>0&&"function"==typeof arguments[a];a--)o++;if(2==arguments.length-o&&"string"==typeof arguments[0]&&"object"==typeof arguments[1])i=new Request(arguments[0],arguments[1]),t=arguments[2],e=arguments[3],""===r&&(r=-1!==i.url.indexOf("json")?"json":-1!==i.url.indexOf("xml")?"xml":"text");else{for(var l,u=arguments[0],p="GET",c=1;c<arguments.length;c++){var f=arguments[c];if("string"==typeof f)"GET"===f||"POST"===f||"PUT"===f||"DELETE"===f?p=f:"json"===f||"jsonp"===f||"xml"===f||"text"===f?r=f:l=f;else if("number"==typeof f)l=f.toString();else if("object"==typeof f)if(f.hasOwnProperty("jsonpCallback"))for(var d in f)n[d]=f[d];else l=JSON.stringify(f),s="application/json";else"function"==typeof f&&(t?e=f:t=f)}""===r&&(r=-1!==u.indexOf("json")?"json":-1!==u.indexOf("xml")?"xml":"text"),i=new Request(u,{method:p,mode:"cors",body:l,headers:new Headers({"Content-Type":s})})}"jsonp"===r?h(arguments[0],n).then(function(t){if(t.ok)return t.json();throw t}).then(function(e){t(e)}).catch(function(t){if(!e)throw t;e(t)}):fetch(i).then(function(t){if(t.ok)return"json"===r?t.json():t.text();throw t}).then(function(e){if("xml"===r){e=(new DOMParser).parseFromString(e,"text/xml"),e=parseXML(e.documentElement)}t(e)}).catch(function(t,i){if(!e)throw t;e(t)})},window.URL=window.URL||window.webkitURL,a.prototype._pWriters=[],a.prototype.createWriter=function(t,e){var i;for(var r in a.prototype._pWriters)if(a.prototype._pWriters[r].name===t)return i=new a.PrintWriter(t+window.millis(),e),a.prototype._pWriters.push(i),i;return i=new a.PrintWriter(t,e),a.prototype._pWriters.push(i),i},a.PrintWriter=function(t,e){var i=this;this.name=t,this.content="",this.write=function(t){this.content+=t},this.print=function(t){this.content+=t+"\n"},this.flush=function(){this.content=""},this.close=function(){var r=[];r.push(this.content),a.prototype.writeFile(r,t,e);for(var n in a.prototype._pWriters)a.prototype._pWriters[n].name===this.name&&a.prototype._pWriters.splice(n,1);i.flush(),i={}}},a.prototype.save=function(t,e,i){var r=arguments,n=this._curElement.elt;if(0===r.length)return void a.prototype.saveCanvas(n);if(r[0]instanceof a.Renderer||r[0]instanceof a.Graphics)return void a.prototype.saveCanvas(r[0].elt,r[1],r[2]);if(1===r.length&&"string"==typeof r[0])a.prototype.saveCanvas(n,r[0]);else{switch(o(r[1],r[2])[1]){case"json":return void a.prototype.saveJSON(r[0],r[1],r[2]);case"txt":return void a.prototype.saveStrings(r[0],r[1],r[2]);default:r[0]instanceof Array?a.prototype.saveStrings(r[0],r[1],r[2]):r[0]instanceof a.Table?a.prototype.saveTable(r[0],r[1],r[2],r[3]):r[0]instanceof a.Image?a.prototype.saveCanvas(r[0].canvas,r[1]):r[0]instanceof a.SoundFile&&a.prototype.saveSound(r[0],r[1],r[2],r[3])}}},a.prototype.saveJSON=function(t,e,i){var r;r=i?JSON.stringify(t):JSON.stringify(t,void 0,2),this.saveStrings(r.split("\n"),e,"json")},a.prototype.saveJSONObject=a.prototype.saveJSON,a.prototype.saveJSONArray=a.prototype.saveJSON,a.prototype.saveStrings=function(t,e,i){for(var r=i||"txt",n=this.createWriter(e,r),o=0;o<t.length;o++)t.length,n.print(t[o]);n.close(),n.flush()},a.prototype.saveTable=function(t,e,i){var r;r=void 0===i?e.substring(e.lastIndexOf(".")+1,e.length):i;var o=this.createWriter(e,r),s=t.columns,a=",";if("tsv"===r&&(a="\t"),"html"!==r){if("0"!==s[0]){for(var h=0;h<s.length;h++)h<s.length-1?o.write(s[h]+a):o.write(s[h]);o.write("\n")}for(var l=0;l<t.rows.length;l++){var u;for(u=0;u<t.rows[l].arr.length;u++)u<t.rows[l].arr.length-1?o.write(t.rows[l].arr[u]+a):(t.rows.length,o.write(t.rows[l].arr[u]));o.write("\n")}}else{o.print("<html>"),o.print("<head>");var p='  <meta http-equiv="content-type" content';if(p+='="text/html;charset=utf-8" />',o.print(p),o.print("</head>"),o.print("<body>"),o.print("  <table>"),"0"!==s[0]){o.print("    <tr>");for(var c=0;c<s.length;c++){var f=n(s[c]);o.print("      <td>"+f),o.print("      </td>")}o.print("    </tr>")}for(var d=0;d<t.rows.length;d++){o.print("    <tr>");for(var y=0;y<t.columns.length;y++){var m=t.rows[d].getString(y),g=n(m);o.print("      <td>"+g),o.print("      </td>")}o.print("    </tr>")}o.print("  </table>"),o.print("</body>"),o.print("</html>")}o.close(),o.flush()},a.prototype.writeFile=function(t,e,i){var r="application/octet-stream";a.prototype._isSafari()&&(r="text/plain");var n=new Blob(t,{type:r}),o=window.URL.createObjectURL(n);a.prototype.downloadFile(o,e,i)},a.prototype.downloadFile=function(t,e,i){var r=o(e,i),n=r[0],h=r[1],l=document.createElement("a");if(l.href=t,l.download=n,l.onclick=function(t){s(t),t.stopPropagation()},l.style.display="none",document.body.appendChild(l),a.prototype._isSafari()){var u="Hello, Safari user! To download this file...\n";u+="1. Go to File --\x3e Save As.\n",u+='2. Choose "Page Source" as the Format.\n',u+='3. Name it with this extension: ."'+h+'"',alert(u)}l.click(),t=null},a.prototype._checkFileExtension=o,a.prototype._isSafari=function(){return Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0},e.exports=a},{"../core/core":54,"../core/error_helpers":57,"es6-promise":4,"fetch-jsonp":5,"whatwg-fetch":44}],79:[function(t,e,i){"use strict";var r=t("../core/core");r.Table=function(t){this.columns=[],this.rows=[]},r.Table.prototype.addRow=function(t){var e=t||new r.TableRow;if(void 0===e.arr||void 0===e.obj)throw"invalid TableRow: "+e;return e.table=this,this.rows.push(e),e},r.Table.prototype.removeRow=function(t){this.rows[t].table=null;var e=this.rows.splice(t+1,this.rows.length);this.rows.pop(),this.rows=this.rows.concat(e)},r.Table.prototype.getRow=function(t){return this.rows[t]},r.Table.prototype.getRows=function(){return this.rows},r.Table.prototype.findRow=function(t,e){if("string"==typeof e){for(var i=0;i<this.rows.length;i++)if(this.rows[i].obj[e]===t)return this.rows[i]}else for(var r=0;r<this.rows.length;r++)if(this.rows[r].arr[e]===t)return this.rows[r];return null},r.Table.prototype.findRows=function(t,e){var i=[];if("string"==typeof e)for(var r=0;r<this.rows.length;r++)this.rows[r].obj[e]===t&&i.push(this.rows[r]);else for(var n=0;n<this.rows.length;n++)this.rows[n].arr[e]===t&&i.push(this.rows[n]);return i},r.Table.prototype.matchRow=function(t,e){if("number"==typeof e){for(var i=0;i<this.rows.length;i++)if(this.rows[i].arr[e].match(t))return this.rows[i]}else for(var r=0;r<this.rows.length;r++)if(this.rows[r].obj[e].match(t))return this.rows[r];return null},r.Table.prototype.matchRows=function(t,e){var i=[];if("number"==typeof e)for(var r=0;r<this.rows.length;r++)this.rows[r].arr[e].match(t)&&i.push(this.rows[r]);else for(var n=0;n<this.rows.length;n++)this.rows[n].obj[e].match(t)&&i.push(this.rows[n]);return i},r.Table.prototype.getColumn=function(t){var e=[];if("string"==typeof t)for(var i=0;i<this.rows.length;i++)e.push(this.rows[i].obj[t]);else for(var r=0;r<this.rows.length;r++)e.push(this.rows[r].arr[t]);return e},r.Table.prototype.clearRows=function(){delete this.rows,this.rows=[]},r.Table.prototype.addColumn=function(t){var e=t||null;this.columns.push(e)},r.Table.prototype.getColumnCount=function(){return this.columns.length},r.Table.prototype.getRowCount=function(){return this.rows.length},r.Table.prototype.removeTokens=function(t,e){for(var i=[],r=0;r<t.length;r++)i.push(function(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(t.charAt(r)));var n=new RegExp(i.join("|"),"g");if(void 0===e)for(var o=0;o<this.columns.length;o++)for(var s=0;s<this.rows.length;s++){var a=this.rows[s].arr[o];a=a.replace(n,""),this.rows[s].arr[o]=a,this.rows[s].obj[this.columns[o]]=a}else if("string"==typeof e)for(var h=0;h<this.rows.length;h++){var l=this.rows[h].obj[e];l=l.replace(n,""),this.rows[h].obj[e]=l;var u=this.columns.indexOf(e);this.rows[h].arr[u]=l}else for(var p=0;p<this.rows.length;p++){var c=this.rows[p].arr[e];c=c.replace(n,""),this.rows[p].arr[e]=c,this.rows[p].obj[this.columns[e]]=c}},r.Table.prototype.trim=function(t){var e=new RegExp(" ","g");if(void 0===t)for(var i=0;i<this.columns.length;i++)for(var r=0;r<this.rows.length;r++){var n=this.rows[r].arr[i];n=n.replace(e,""),this.rows[r].arr[i]=n,this.rows[r].obj[this.columns[i]]=n}else if("string"==typeof t)for(var o=0;o<this.rows.length;o++){var s=this.rows[o].obj[t];s=s.replace(e,""),this.rows[o].obj[t]=s;var a=this.columns.indexOf(t);this.rows[o].arr[a]=s}else for(var h=0;h<this.rows.length;h++){var l=this.rows[h].arr[t];l=l.replace(e,""),this.rows[h].arr[t]=l,this.rows[h].obj[this.columns[t]]=l}},r.Table.prototype.removeColumn=function(t){var e,i;"string"==typeof t?(e=t,i=this.columns.indexOf(t),console.log("string")):(i=t,e=this.columns[t]);var r=this.columns.splice(i+1,this.columns.length);this.columns.pop(),this.columns=this.columns.concat(r);for(var n=0;n<this.rows.length;n++){var o=this.rows[n].arr,s=o.splice(i+1,o.length);o.pop(),this.rows[n].arr=o.concat(s),delete this.rows[n].obj[e]}},r.Table.prototype.set=function(t,e,i){this.rows[t].set(e,i)},r.Table.prototype.setNum=function(t,e,i){this.rows[t].setNum(e,i)},r.Table.prototype.setString=function(t,e,i){this.rows[t].setString(e,i)},r.Table.prototype.get=function(t,e){return this.rows[t].get(e)},r.Table.prototype.getNum=function(t,e){return this.rows[t].getNum(e)},r.Table.prototype.getString=function(t,e){return this.rows[t].getString(e)},r.Table.prototype.getObject=function(t){for(var e,i,r={},n=0;n<this.rows.length;n++)if(e=this.rows[n].obj,"string"==typeof t){if(!(this.columns.indexOf(t)>=0))throw'This table has no column named "'+t+'"';i=e[t],r[i]=e}else r[n]=this.rows[n].obj;return r},r.Table.prototype.getArray=function(){for(var t=[],e=0;e<this.rows.length;e++)t.push(this.rows[e].arr);return t},e.exports=r},{"../core/core":54}],80:[function(t,e,i){"use strict";var r=t("../core/core");r.TableRow=function(t,e){var i=[],r={};t&&(e=e||",",i=t.split(e));for(var n=0;n<i.length;n++){var o=n,s=i[n];r[o]=s}this.arr=i,this.obj=r,this.table=null},r.TableRow.prototype.set=function(t,e){if("string"==typeof t){var i=this.table.columns.indexOf(t);if(!(i>=0))throw'This table has no column named "'+t+'"';this.obj[t]=e,this.arr[i]=e}else{if(!(t<this.table.columns.length))throw"Column #"+t+" is out of the range of this table";this.arr[t]=e;var r=this.table.columns[t];this.obj[r]=e}},r.TableRow.prototype.setNum=function(t,e){var i=parseFloat(e);this.set(t,i)},r.TableRow.prototype.setString=function(t,e){var i=e.toString();this.set(t,i)},r.TableRow.prototype.get=function(t){return"string"==typeof t?this.obj[t]:this.arr[t]},r.TableRow.prototype.getNum=function(t){var e;if(e="string"==typeof t?parseFloat(this.obj[t]):parseFloat(this.arr[t]),"NaN"===e.toString())throw"Error: "+this.obj[t]+" is NaN (Not a Number)";return e},r.TableRow.prototype.getString=function(t){return"string"==typeof t?this.obj[t].toString():this.arr[t].toString()},e.exports=r},{"../core/core":54}],81:[function(t,e,i){"use strict";var r=t("../core/core");r.XML=function(){this.name=null,this.attributes={},this.children=[],this.parent=null,this.content=null},r.XML.prototype.getParent=function(){return this.parent},r.XML.prototype.getName=function(){return this.name},r.XML.prototype.setName=function(t){this.name=t},r.XML.prototype.hasChildren=function(){return this.children.length>0},r.XML.prototype.listChildren=function(){return this.children.map(function(t){return t.name})},r.XML.prototype.getChildren=function(t){return t?this.children.filter(function(e){return e.name===t}):this.children},r.XML.prototype.getChild=function(t){return"string"==typeof t?this.children.find(function(e){return e.name===t}):this.children[t]},r.XML.prototype.addChild=function(t){t instanceof r.XML&&this.children.push(t)},r.XML.prototype.removeChild=function(t){var e=-1;if("string"==typeof t){for(var i=0;i<this.children.length;i++)if(this.children[i].name===t){e=i;break}}else e=t;-1!==e&&this.children.splice(e,1)},r.XML.prototype.getAttributeCount=function(){return Object.keys(this.attributes).length},r.XML.prototype.listAttributes=function(){return Object.keys(this.attributes)},r.XML.prototype.hasAttribute=function(t){return!!this.attributes[t]},r.XML.prototype.getNum=function(t,e){return Number(this.attributes[t])||e||0},r.XML.prototype.getString=function(t,e){return String(this.attributes[t])||e||null},r.XML.prototype.setAttribute=function(t,e){this.attributes[t]&&(this.attributes[t]=e)},r.XML.prototype.getContent=function(t){return this.content||t||null},r.XML.prototype.setContent=function(t){this.children.length||(this.content=t)},r.XML.prototype._setCont=function(t){var e;e=t,e=e.replace(/\s\s+/g,","),this.content=e},r.XML.prototype._setAttributes=function(t){var e,i={};for(e=0;e<t.attributes.length;e++)i[t.attributes[e].nodeName]=t.attributes[e].nodeValue;this.attributes=i},e.exports=r},{"../core/core":54}],82:[function(t,e,i){"use strict";function r(t,e,i){if("function"==typeof Math.hypot)return Math.hypot.apply(null,arguments);for(var r=arguments.length,n=[],o=0,s=0;s<r;s++){var a=arguments[s];if((a=+a)===1/0||a===-1/0)return 1/0;a=Math.abs(a),a>o&&(o=a),n[s]=a}0===o&&(o=1);for(var h=0,l=0,u=0;u<r;u++){var p=n[u]/o,c=p*p-l,f=h+c;l=f-h-c,h=f}return Math.sqrt(h)*o}var n=t("../core/core");n.prototype.abs=Math.abs,n.prototype.ceil=Math.ceil,n.prototype.constrain=function(t,e,i){return Math.max(Math.min(t,i),e)},n.prototype.dist=function(t,e,i,n,o,s){return 4===arguments.length?r(i-t,n-e):6===arguments.length?r(n-t,o-e,s-i):void 0},n.prototype.exp=Math.exp,n.prototype.floor=Math.floor,n.prototype.lerp=function(t,e,i){return i*(e-t)+t},n.prototype.log=Math.log,n.prototype.mag=function(t,e){return r(t,e)},n.prototype.map=function(t,e,i,r,n){return(t-e)/(i-e)*(n-r)+r},n.prototype.max=function(){return arguments[0]instanceof Array?Math.max.apply(null,arguments[0]):Math.max.apply(null,arguments)},n.prototype.min=function(){return arguments[0]instanceof Array?Math.min.apply(null,arguments[0]):Math.min.apply(null,arguments)},n.prototype.norm=function(t,e,i){return this.map(t,e,i,0,1)},n.prototype.pow=Math.pow,n.prototype.round=Math.round,n.prototype.sq=function(t){return t*t},n.prototype.sqrt=Math.sqrt,e.exports=n},{"../core/core":54}],83:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.createVector=function(t,e,i){return this instanceof r?new r.Vector(this,arguments):new r.Vector(t,e,i)},e.exports=r},{"../core/core":54}],84:[function(t,e,i){"use strict";var r,n=t("../core/core"),o=4,s=.5,a=function(t){return.5*(1-Math.cos(t*Math.PI))};n.prototype.noise=function(t,e,i){if(e=e||0,i=i||0,null==r){r=new Array(4096);for(var n=0;n<4096;n++)r[n]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),i<0&&(i=-i);for(var h,l,u,p,c,f=Math.floor(t),d=Math.floor(e),y=Math.floor(i),m=t-f,g=e-d,v=i-y,_=0,b=.5,w=0;w<o;w++){var x=f+(d<<4)+(y<<8);h=a(m),l=a(g),u=r[4095&x],u+=h*(r[x+1&4095]-u),p=r[x+16&4095],p+=h*(r[x+16+1&4095]-p),u+=l*(p-u),x+=256,p=r[4095&x],p+=h*(r[x+1&4095]-p),c=r[x+16&4095],c+=h*(r[x+16+1&4095]-c),p+=l*(c-p),u+=a(v)*(p-u),_+=u*b,b*=s,f<<=1,m*=2,d<<=1,g*=2,y<<=1,v*=2,m>=1&&(f++,m--),g>=1&&(d++,g--),v>=1&&(y++,v--)}return _},n.prototype.noiseDetail=function(t,e){t>0&&(o=t),e>0&&(s=e)},n.prototype.noiseSeed=function(t){var e=function(){var t,e,i=4294967296;return{setSeed:function(r){e=t=(null==r?Math.random()*i:r)>>>0},getSeed:function(){return t},rand:function(){return(e=(1664525*e+1013904223)%i)/i}}}();e.setSeed(t),r=new Array(4096);for(var i=0;i<4096;i++)r[i]=e.rand()},e.exports=n},{"../core/core":54}],85:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("./polargeometry"),o=t("../core/constants");r.Vector=function(){var t,e,i;arguments[0]instanceof r?(this.p5=arguments[0],t=arguments[1][0]||0,e=arguments[1][1]||0,i=arguments[1][2]||0):(t=arguments[0]||0,e=arguments[1]||0,i=arguments[2]||0),this.x=t,this.y=e,this.z=i},r.Vector.prototype.toString=function(){return"p5.Vector Object : ["+this.x+", "+this.y+", "+this.z+"]"},r.Vector.prototype.set=function(t,e,i){return t instanceof r.Vector?(this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this):t instanceof Array?(this.x=t[0]||0,this.y=t[1]||0,this.z=t[2]||0,this):(this.x=t||0,this.y=e||0,this.z=i||0,this)},r.Vector.prototype.copy=function(){return this.p5?new r.Vector(this.p5,[this.x,this.y,this.z]):new r.Vector(this.x,this.y,this.z)},r.Vector.prototype.add=function(t,e,i){return t instanceof r.Vector?(this.x+=t.x||0,this.y+=t.y||0,this.z+=t.z||0,this):t instanceof Array?(this.x+=t[0]||0,this.y+=t[1]||0,this.z+=t[2]||0,this):(this.x+=t||0,this.y+=e||0,this.z+=i||0,this)},r.Vector.prototype.sub=function(t,e,i){return t instanceof r.Vector?(this.x-=t.x||0,this.y-=t.y||0,this.z-=t.z||0,this):t instanceof Array?(this.x-=t[0]||0,this.y-=t[1]||0,this.z-=t[2]||0,this):(this.x-=t||0,this.y-=e||0,this.z-=i||0,this)},r.Vector.prototype.mult=function(t){return this.x*=t||0,this.y*=t||0,this.z*=t||0,this},r.Vector.prototype.div=function(t){return this.x/=t,this.y/=t,this.z/=t,this},r.Vector.prototype.mag=function(){return Math.sqrt(this.magSq())},r.Vector.prototype.magSq=function(){var t=this.x,e=this.y,i=this.z;return t*t+e*e+i*i},r.Vector.prototype.dot=function(t,e,i){return t instanceof r.Vector?this.dot(t.x,t.y,t.z):this.x*(t||0)+this.y*(e||0)+this.z*(i||0)},r.Vector.prototype.cross=function(t){var e=this.y*t.z-this.z*t.y,i=this.z*t.x-this.x*t.z,n=this.x*t.y-this.y*t.x;return this.p5?new r.Vector(this.p5,[e,i,n]):new r.Vector(e,i,n)},r.Vector.prototype.dist=function(t){return t.copy().sub(this).mag()},r.Vector.prototype.normalize=function(){return 0===this.mag()?this:this.div(this.mag())},r.Vector.prototype.limit=function(t){var e=this.magSq();return e>t*t&&(this.div(Math.sqrt(e)),this.mult(t)),this},r.Vector.prototype.setMag=function(t){return this.normalize().mult(t)},r.Vector.prototype.heading=function(){var t=Math.atan2(this.y,this.x);return this.p5?this.p5._angleMode===o.RADIANS?t:n.radiansToDegrees(t):t},r.Vector.prototype.rotate=function(t){var e=this.heading()+t;this.p5&&this.p5._angleMode===o.DEGREES&&(e=n.degreesToRadians(e));var i=this.mag();return this.x=Math.cos(e)*i,this.y=Math.sin(e)*i,this},r.Vector.prototype.angleBetween=function(t){var e=Math.acos(this.dot(t)/(this.mag()*t.mag()));return this.p5&&this.p5._angleMode===o.DEGREES&&(e=n.radiansToDegrees(e)),e},r.Vector.prototype.lerp=function(t,e,i,n){return t instanceof r.Vector?this.lerp(t.x,t.y,t.z,e):(this.x+=(t-this.x)*n||0,this.y+=(e-this.y)*n||0,this.z+=(i-this.z)*n||0,this)},r.Vector.prototype.array=function(){return[this.x||0,this.y||0,this.z||0]},r.Vector.prototype.equals=function(t,e,i){var n,o,s;return t instanceof r.Vector?(n=t.x||0,o=t.y||0,s=t.z||0):t instanceof Array?(n=t[0]||0,o=t[1]||0,s=t[2]||0):(n=t||0,o=e||0,s=i||0),this.x===n&&this.y===o&&this.z===s},r.Vector.fromAngle=function(t){return this.p5&&this.p5._angleMode===o.DEGREES&&(t=n.degreesToRadians(t)),this.p5?new r.Vector(this.p5,[Math.cos(t),Math.sin(t),0]):new r.Vector(Math.cos(t),Math.sin(t),0)},r.Vector.random2D=function(){var t;return t=this.p5?this.p5._angleMode===o.DEGREES?this.p5.random(360):this.p5.random(o.TWO_PI):Math.random()*Math.PI*2,this.fromAngle(t)},r.Vector.random3D=function(){var t,e;this.p5?(t=this.p5.random(0,o.TWO_PI),e=this.p5.random(-1,1)):(t=Math.random()*Math.PI*2,e=2*Math.random()-1);var i=Math.sqrt(1-e*e)*Math.cos(t),n=Math.sqrt(1-e*e)*Math.sin(t);return this.p5?new r.Vector(this.p5,[i,n,e]):new r.Vector(i,n,e)},r.Vector.add=function(t,e,i){return i?i.set(t):i=t.copy(),i.add(e),i},r.Vector.sub=function(t,e,i){return i?i.set(t):i=t.copy(),i.sub(e),i},r.Vector.mult=function(t,e,i){return i?i.set(t):i=t.copy(),i.mult(e),i},r.Vector.div=function(t,e,i){return i?i.set(t):i=t.copy(),i.div(e),i},r.Vector.dot=function(t,e){return t.dot(e)},r.Vector.cross=function(t,e){return t.cross(e)},r.Vector.dist=function(t,e){return t.dist(e)},r.Vector.lerp=function(t,e,i,r){return r?r.set(t):r=t.copy(),r.lerp(e,i),r},r.Vector.mag=function(t){var e=t.x,i=t.y,r=t.z,n=e*e+i*i+r*r;return Math.sqrt(n)},e.exports=r.Vector},{"../core/constants":53,"../core/core":54,"./polargeometry":86}],86:[function(t,e,i){e.exports={degreesToRadians:function(t){return 2*Math.PI*t/360},radiansToDegrees:function(t){return 360*t/(2*Math.PI)}}},{}],87:[function(t,e,i){"use strict";var r=t("../core/core"),n=!1,o=!1,s=0,a=function(){var t,e,i=4294967296;return{setSeed:function(r){e=t=(null==r?Math.random()*i:r)>>>0},getSeed:function(){return t},rand:function(){return(e=(1664525*e+1013904223)%i)/i}}}();r.prototype.randomSeed=function(t){a.setSeed(t),n=!0,o=!1},r.prototype.random=function(t,e){var i;if(i=n?a.rand():Math.random(),void 0===t)return i;if(void 0===e)return t instanceof Array?t[Math.floor(i*t.length)]:i*t;if(t>e){var r=t;t=e,e=r}return i*(e-t)+t},r.prototype.randomGaussian=function(t,e){var i,r,n,a;if(o)i=s,o=!1;else{do{r=this.random(2)-1,n=this.random(2)-1,a=r*r+n*n}while(a>=1);a=Math.sqrt(-2*Math.log(a)/a),i=r*a,s=n*a,o=!0}var h=t||0;return i*(e||1)+h},e.exports=r},{"../core/core":54}],88:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("./polargeometry"),o=t("../core/constants");r.prototype._angleMode=o.RADIANS,r.prototype.acos=function(t){return this._angleMode===o.RADIANS?Math.acos(t):n.radiansToDegrees(Math.acos(t))},r.prototype.asin=function(t){return this._angleMode===o.RADIANS?Math.asin(t):n.radiansToDegrees(Math.asin(t))},r.prototype.atan=function(t){return this._angleMode===o.RADIANS?Math.atan(t):n.radiansToDegrees(Math.atan(t))},r.prototype.atan2=function(t,e){return this._angleMode===o.RADIANS?Math.atan2(t,e):n.radiansToDegrees(Math.atan2(t,e))},r.prototype.cos=function(t){return this._angleMode===o.RADIANS?Math.cos(t):Math.cos(this.radians(t))},r.prototype.sin=function(t){return this._angleMode===o.RADIANS?Math.sin(t):Math.sin(this.radians(t))},r.prototype.tan=function(t){return this._angleMode===o.RADIANS?Math.tan(t):Math.tan(this.radians(t))},r.prototype.degrees=function(t){return n.radiansToDegrees(t)},r.prototype.radians=function(t){return n.degreesToRadians(t)},r.prototype.angleMode=function(t){t!==o.DEGREES&&t!==o.RADIANS||(this._angleMode=t)},e.exports=r},{"../core/constants":53,"../core/core":54,"./polargeometry":86}],89:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.textAlign=function(t,e){return this._renderer.textAlign.apply(this._renderer,arguments)},r.prototype.textLeading=function(t){return this._renderer.textLeading.apply(this._renderer,arguments)},r.prototype.textSize=function(t){return this._renderer.textSize.apply(this._renderer,arguments)},r.prototype.textStyle=function(t){return this._renderer.textStyle.apply(this._renderer,arguments)},r.prototype.textWidth=function(t){return 0===t.length?0:this._renderer.textWidth.apply(this._renderer,arguments)},r.prototype.textAscent=function(){return this._renderer.textAscent()},r.prototype.textDescent=function(){return this._renderer.textDescent()},r.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()},e.exports=r},{"../core/core":54}],90:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("../core/constants"),o=t("opentype.js");t("../core/error_helpers"),r.prototype.loadFont=function(t,e,i){var n=new r.Font(this),s=this;return o.load(t,function(o,a){if(o)return void 0!==i?i(o):(r._friendlyFileLoadError(4,t),void console.error(o,t));n.font=a,void 0!==e&&e(n),s._decrementPreload();var h,l,u=["ttf","otf","woff","woff2"],p=t.split("\\").pop().split("/").pop(),c=p.lastIndexOf("."),f=c<1?null:p.substr(c+1);u.indexOf(f)>-1&&(h=p.substr(0,c),l=document.createElement("style"),l.appendChild(document.createTextNode("\n@font-face {\nfont-family: "+h+";\nsrc: url("+t+");\n}\n")),document.head.appendChild(l))}),n},r.prototype.text=function(t,e,i,r,n){return this._renderer._doFill||this._renderer._doStroke?this._renderer.text.apply(this._renderer,arguments):this},r.prototype.textFont=function(t,e){if(arguments.length){if(!t)throw Error("null font passed to textFont");return this._renderer._setProperty("_textFont",t),e&&(this._renderer._setProperty("_textSize",e),this._renderer._setProperty("_textLeading",e*n._DEFAULT_LEADMULT)),this._renderer._applyTextProperties()}return this._renderer._textFont},e.exports=r},{"../core/constants":53,"../core/core":54,"../core/error_helpers":57,"opentype.js":17}],91:[function(t,e,i){"use strict";function r(t,e){for(var i=a(e,{sampleFactor:.1,simplifyThreshold:0}),r=f(t,0,1),o=r/(r*i.sampleFactor),s=[],h=0;h<r;h+=o)s.push(f(t,h));return i.simplifyThreshold&&n(s,i.simplifyThreshold),s}function n(t,e){e=void 0===e?0:e;for(var i=0,r=t.length-1;t.length>3&&r>=0;--r)l(h(t,r-1),h(t,r),h(t,r+1),e)&&(t.splice(r%t.length,1),i++);return i}function o(t){for(var e,i=[],r=0;r<t.length;r++)"M"===t[r].type&&(e&&i.push(e),e=[]),e.push(s(t[r]));return i.push(e),i}function s(t){var e=[t.type];return"M"===t.type||"L"===t.type?e.push(t.x,t.y):"C"===t.type?e.push(t.x1,t.y1,t.x2,t.y2,t.x,t.y):"Q"===t.type&&e.push(t.x1,t.y1,t.x,t.y),e}function a(t,e){if("object"!=typeof t)t=e;else for(var i in e)void 0===t[i]&&(t[i]=e[i]);return t}function h(t,e){var i=t.length;return t[e<0?e%i+i:e%i]}function l(t,e,i,r){if(!r)return 0===u(t,e,i);void 0===l.tmpPoint1&&(l.tmpPoint1=[],l.tmpPoint2=[]);var n=l.tmpPoint1,o=l.tmpPoint2;n.x=e.x-t.x,n.y=e.y-t.y,o.x=i.x-e.x,o.y=i.y-e.y;var s=n.x*o.x+n.y*o.y,a=Math.sqrt(n.x*n.x+n.y*n.y),h=Math.sqrt(o.x*o.x+o.y*o.y);return Math.acos(s/(a*h))<r}function u(t,e,i){return(e[0]-t[0])*(i[1]-t[1])-(i[0]-t[0])*(e[1]-t[1])}function p(t,e,i,r,n,o,s,a,h){var l=1-h,u=Math.pow(l,3),p=Math.pow(l,2),c=h*h,f=c*h,d=u*t+3*p*h*i+3*l*h*h*n+f*s,y=u*e+3*p*h*r+3*l*h*h*o+f*a,m=t+2*h*(i-t)+c*(n-2*i+t),g=e+2*h*(r-e)+c*(o-2*r+e),v=i+2*h*(n-i)+c*(s-2*n+i),_=r+2*h*(o-r)+c*(a-2*o+r),b=l*t+h*i,w=l*e+h*r,x=l*n+h*s,S=l*o+h*a,T=90-180*Math.atan2(m-v,g-_)/Math.PI;return(m>v||g<_)&&(T+=180),{x:d,y:y,m:{x:m,y:g},n:{x:v,y:_},start:{x:b,y:w},end:{x:x,y:S},alpha:T}}function c(t,e,i,r,n,o,s,a,h){return null==h?b(t,e,i,r,n,o,s,a):p(t,e,i,r,n,o,s,a,w(t,e,i,r,n,o,s,a,h))}function f(t,e,i){t=y(t);for(var r,n,o,s,a,h="",l={},u=0,f=0,d=t.length;f<d;f++){if(o=t[f],"M"===o[0])r=+o[1],n=+o[2];else{if(s=c(r,n,o[1],o[2],o[3],o[4],o[5],o[6]),u+s>e&&!i)return a=c(r,n,o[1],o[2],o[3],o[4],o[5],o[6],e-u),{x:a.x,y:a.y,alpha:a.alpha};u+=s,r=+o[5],n=+o[6]}h+=o.shift()+o}return l.end=h,a=i?u:p(r,n,o[0],o[1],o[2],o[3],o[4],o[5],1),a.alpha&&(a={x:a.x,y:a.y,alpha:a.alpha}),a}function d(t){var e=[],i=0,r=0,n=0,o=0,s=0;if(!t)return e;"M"===t[0][0]&&(i=+t[0][1],r=+t[0][2],n=i,o=r,s++,e[0]=["M",i,r]);for(var a,h,l,u=3===t.length&&"M"===t[0][0]&&"R"===t[1][0].toUpperCase()&&"Z"===t[2][0].toUpperCase(),p=s,c=t.length;p<c;p++){if(e.push(h=[]),l=t[p],l[0]!==String.prototype.toUpperCase.call(l[0]))switch(h[0]=String.prototype.toUpperCase.call(l[0]),h[0]){case"A":h[1]=l[1],h[2]=l[2],h[3]=l[3],h[4]=l[4],h[5]=l[5],h[6]=+(l[6]+i),h[7]=+(l[7]+r);break;case"V":h[1]=+l[1]+r;break;case"H":h[1]=+l[1]+i;break;case"R":a=[i,r].concat(l.slice(1));for(var f=2,d=a.length;f<d;f++)a[f]=+a[f]+i,a[++f]=+a[f]+r;e.pop(),e=e.concat(g(a,u));break;case"M":n=+l[1]+i,o=+l[2]+r;break;default:for(f=1,d=l.length;f<d;f++)h[f]=+l[f]+(f%2?i:r)}else if("R"===l[0])a=[i,r].concat(l.slice(1)),e.pop(),e=e.concat(g(a,u)),h=["R"].concat(l.slice(-2));else for(var y=0,m=l.length;y<m;y++)h[y]=l[y];switch(h[0]){case"Z":i=n,r=o;break;case"H":i=h[1];break;case"V":r=h[1];break;case"M":n=h[h.length-2],o=h[h.length-1];break;default:i=h[h.length-2],r=h[h.length-1]}}return e}function y(t,e){for(var i=d(t),r=e&&d(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=(function(t,e,i){var r,n,o={T:1,Q:1};if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(t[0]in o||(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(m.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"===i||"S"===i?(r=2*e.x-e.bx,n=2*e.y-e.by):(r=e.x,n=e.y),t=["C",r,n].concat(t.slice(1));break;case"T":"Q"===i||"T"===i?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(_(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(_(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(v(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(v(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(v(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(v(e.x,e.y,e.X,e.Y))}return t}),a=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)l[e]="A",r&&(u[e]="A"),t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),y=Math.max(i.length,r&&r.length||0)}},h=function(t,e,n,o,s){t&&e&&"M"===t[s][0]&&"M"!==e[s][0]&&(e.splice(s,0,["M",o.x,o.y]),n.bx=0,n.by=0,n.x=t[s][1],n.y=t[s][2],y=Math.max(i.length,r&&r.length||0))},l=[],u=[],p="",c="",f=0,y=Math.max(i.length,r&&r.length||0);f<y;f++){i[f]&&(p=i[f][0]),"C"!==p&&(l[f]=p,f&&(c=l[f-1])),i[f]=s(i[f],n,c),"A"!==l[f]&&"C"===p&&(l[f]="C"),a(i,f),r&&(r[f]&&(p=r[f][0]),"C"!==p&&(u[f]=p,f&&(c=u[f-1])),r[f]=s(r[f],o,c),"A"!==u[f]&&"C"===p&&(u[f]="C"),a(r,f)),h(i,r,n,o,f),h(r,i,o,n,f);var g=i[f],b=r&&r[f],w=g.length,x=r&&b.length;n.x=g[w-2],n.y=g[w-1],n.bx=parseFloat(g[w-4])||n.x,n.by=parseFloat(g[w-3])||n.y,o.bx=r&&(parseFloat(b[x-4])||o.x),o.by=r&&(parseFloat(b[x-3])||o.y),o.x=r&&b[x-2],o.y=r&&b[x-1]}return r?[i,r]:i}function m(t,e,i,r,n,o,s,a,h,l){var u,p,c,f,d,y=Math.PI,g=120*y/180,v=y/180*(+n||0),_=[],b=function(t,e,i){return{x:t*Math.cos(i)-e*Math.sin(i),y:t*Math.sin(i)+e*Math.cos(i)}};if(l)u=l[0],p=l[1],c=l[2],f=l[3];else{d=b(t,e,-v),t=d.x,e=d.y,d=b(a,h,-v),a=d.x,h=d.y;var w=(t-a)/2,x=(e-h)/2,S=w*w/(i*i)+x*x/(r*r);S>1&&(S=Math.sqrt(S),i*=S,r*=S);var T=i*i,E=r*r,P=(o===s?-1:1)*Math.sqrt(Math.abs((T*E-T*x*x-E*w*w)/(T*x*x+E*w*w)));c=P*i*x/r+(t+a)/2,f=P*-r*w/i+(e+h)/2,u=Math.asin(((e-f)/r).toFixed(9)),p=Math.asin(((h-f)/r).toFixed(9)),u=t<c?y-u:u,p=a<c?y-p:p,u<0&&(u=2*y+u),p<0&&(p=2*y+p),s&&u>p&&(u-=2*y),!s&&p>u&&(p-=2*y)}var O=p-u;if(Math.abs(O)>g){var M=p,A=a,R=h;p=u+g*(s&&p>u?1:-1),a=c+i*Math.cos(p),h=f+r*Math.sin(p),_=m(a,h,i,r,n,0,s,A,R,[p,M,c,f])}O=p-u;var C=Math.cos(u),k=Math.sin(u),F=Math.cos(p),L=Math.sin(p),I=Math.tan(O/4),D=4/3*i*I,U=4/3*r*I,B=[t,e],N=[t+D*k,e-U*C],q=[a+D*L,h-U*F],G=[a,h];if(N[0]=2*B[0]-N[0],N[1]=2*B[1]-N[1],l)return[N,q,G].concat(_);_=[N,q,G].concat(_).join().split(",");for(var j=[],V=0,z=_.length;V<z;V++)j[V]=V%2?b(_[V-1],_[V],v).y:b(_[V],_[V+1],v).x;return j}function g(t,e){for(var i=[],r=0,n=t.length;n-2*!e>r;r+=2){var o=[{x:+t[r-2],y:+t[r-1]},{x:+t[r],y:+t[r+1]},{x:+t[r+2],y:+t[r+3]},{x:+t[r+4],y:+t[r+5]}];e?r?n-4===r?o[3]={x:+t[0],y:+t[1]}:n-2===r&&(o[2]={x:+t[0],y:+t[1]},o[3]={x:+t[2],y:+t[3]}):o[0]={x:+t[n-2],y:+t[n-1]}:n-4===r?o[3]=o[2]:r||(o[0]={x:+t[r],y:+t[r+1]}),i.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return i}function v(t,e,i,r){return[t,e,i,r,i,r]}function _(t,e,i,r,n,o){return[1/3*t+2/3*i,1/3*e+2/3*r,1/3*n+2/3*i,1/3*o+2/3*r,n,o]}function b(t,e,i,r,n,o,s,a,h){null==h&&(h=1),h=h>1?1:h<0?0:h;for(var l=h/2,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=0,c=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],f=0;f<12;f++){var d=l*u[f]+l,y=x(d,t,i,n,s),m=x(d,e,r,o,a),g=y*y+m*m;p+=c[f]*Math.sqrt(g)}return l*p}function w(t,e,i,r,n,o,s,a,h){if(!(h<0||b(t,e,i,r,n,o,s,a)<h)){var l,u=.5,p=1-u;for(l=b(t,e,i,r,n,o,s,a,p);Math.abs(l-h)>.01;)u/=2,p+=(l<h?1:-1)*u,l=b(t,e,i,r,n,o,s,a,p);return p}}function x(t,e,i,r,n){return t*(t*(-3*e+9*i-9*r+3*n)+6*e-12*i+6*r)-3*e+3*i}function S(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];e=t.length;for(var i="";e--;)i+=t[e]===Object(t[e])?JSON.stringify(t[e]):t[e];return i}var T=t("../core/core"),E=t("../core/constants");T.Font=function(t){this.parent=t,this.cache={},this.font=void 0},T.Font.prototype.list=function(){throw"not yet implemented"},T.Font.prototype.textBounds=function(t,e,i,r,n){e=void 0!==e?e:0,i=void 0!==i?i:0,r=r||this.parent._renderer._textSize;var o=n&&n.renderer&&n.renderer._pInst||this.parent,s=o._renderer.drawingContext,a=s.textAlign||E.LEFT,h=s.textBaseline||E.BASELINE,l=S("textBounds",t,e,i,r,a,h),u=this.cache[l];if(!u){var p,c,f,d,y,m=[],g=[],v=this._scale(r);this.font.forEachGlyph(t,e,i,r,n,function(t,e,i,r){var n=t.getMetrics();m.push(e+n.xMin*v),m.push(e+n.xMax*v),g.push(i+-n.yMin*v),g.push(i+-n.yMax*v)}),p=Math.min.apply(null,m),c=Math.min.apply(null,g),f=Math.max.apply(null,m),d=Math.max.apply(null,g),u={x:p,y:c,h:d-c,w:f-p,advance:p-e},y=this._handleAlignment(o,s,t,u.x,u.y,u.w+u.advance),u.x=y.x,u.y=y.y,this.cache[S("textBounds",t,e,i,r,a,h)]=u}return u},T.Font.prototype.textToPoints=function(t,e,i,n,s){var a=0,h=[],l=this._getGlyphs(t);n=n||this.parent._renderer._textSize;for(var u=0;u<l.length;u++){if(!function(e){return l[e].name&&"space"===l[e].name||t.length===l.length&&" "===t[e]||l[e].index&&3===l[e].index}(u))for(var p=l[u].getPath(e,i,n),c=o(p.commands),f=0;f<c.length;f++)for(var d=r(c[f],s),y=0;y<d.length;y++)d[y].x+=a,h.push(d[y]);a+=l[u].advanceWidth*this._scale(n)}return h},T.Font.prototype._getGlyphs=function(t){return this.font.stringToGlyphs(t)},T.Font.prototype._getPath=function(t,e,i,r){var n=r&&r.renderer&&r.renderer._pInst||this.parent,o=n._renderer.drawingContext,s=this._handleAlignment(n,o,t,e,i);return this.font.getPath(t,s.x,s.y,n._renderer._textSize,r)},T.Font.prototype._getPathData=function(t,e,i,r){var n=3;return"string"==typeof t&&arguments.length>2?t=this._getPath(t,e,i,r):"object"==typeof e&&(r=e),r&&"number"==typeof r.decimals&&(n=r.decimals),t.toPathData(n)},T.Font.prototype._getSVG=function(t,e,i,r){var n=3;return"string"==typeof t&&arguments.length>2?t=this._getPath(t,e,i,r):"object"==typeof e&&(r=e),r&&("number"==typeof r.decimals&&(n=r.decimals),"number"==typeof r.strokeWidth&&(t.strokeWidth=r.strokeWidth),void 0!==r.fill&&(t.fill=r.fill),void 0!==r.stroke&&(t.stroke=r.stroke)),t.toSVG(n)},T.Font.prototype._renderPath=function(t,e,i,r){var n,o=r&&r.renderer||this.parent._renderer,s=o.drawingContext;n="object"==typeof t&&t.commands?t.commands:this._getPath(t,e,i,r).commands,s.beginPath();for(var a=0;a<n.length;a+=1){var h=n[a];"M"===h.type?s.moveTo(h.x,h.y):"L"===h.type?s.lineTo(h.x,h.y):"C"===h.type?s.bezierCurveTo(h.x1,h.y1,h.x2,h.y2,h.x,h.y):"Q"===h.type?s.quadraticCurveTo(h.x1,h.y1,h.x,h.y):"Z"===h.type&&s.closePath()}return o._doStroke&&o._strokeSet&&s.stroke(),o._doFill&&(o._fillSet||o._setFill(E._DEFAULT_TEXT_FILL),s.fill()),this},T.Font.prototype._textWidth=function(t,e){return this.font.getAdvanceWidth(t,e)},T.Font.prototype._textAscent=function(t){return this.font.ascender*this._scale(t)},T.Font.prototype._textDescent=function(t){return-this.font.descender*this._scale(t)},T.Font.prototype._scale=function(t){return 1/this.font.unitsPerEm*(t||this.parent._renderer._textSize)},T.Font.prototype._handleAlignment=function(t,e,i,r,n,o){var s=t._renderer._textSize,a=this._textAscent(s),h=this._textDescent(s);return o=void 0!==o?o:this._textWidth(i,s),e.textAlign===E.CENTER?r-=o/2:e.textAlign===E.RIGHT&&(r-=o),e.textBaseline===E.TOP?n+=a:e.textBaseline===E._CTX_MIDDLE?n+=a/2:e.textBaseline===E.BOTTOM&&(n-=h),{x:r,y:n}},e.exports=T},{"../core/constants":53,"../core/core":54}],92:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.append=function(t,e){return t.push(e),t},r.prototype.arrayCopy=function(t,e,i,r,n){var o,s;void 0!==n?(s=Math.min(n,t.length),o=r,t=t.slice(e,s+e)):(void 0!==i?(s=i,s=Math.min(s,t.length)):s=t.length,o=0,i=e,t=t.slice(0,s)),Array.prototype.splice.apply(i,[o,s].concat(t))},r.prototype.concat=function(t,e){return t.concat(e)},r.prototype.reverse=function(t){return t.reverse()},r.prototype.shorten=function(t){return t.pop(),t},r.prototype.shuffle=function(t,e){var i=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(t);t=e||i?t:t.slice();for(var r,n,o=t.length;o>1;)r=Math.random()*o|0,n=t[--o],t[o]=t[r],t[r]=n;return t},r.prototype.sort=function(t,e){var i=e?t.slice(0,Math.min(e,t.length)):t,r=e?t.slice(Math.min(e,t.length)):[];return i="string"==typeof i[0]?i.sort():i.sort(function(t,e){return t-e}),i.concat(r)},r.prototype.splice=function(t,e,i){return Array.prototype.splice.apply(t,[i,0].concat(e)),t},r.prototype.subset=function(t,e,i){return void 0!==i?t.slice(e,e+i):t.slice(e,t.length)},e.exports=r},{"../core/core":54}],93:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.float=function(t){return t instanceof Array?t.map(parseFloat):parseFloat(t)},r.prototype.int=function(t,e){return e=e||10,"string"==typeof t?parseInt(t,e):"number"==typeof t?0|t:"boolean"==typeof t?t?1:0:t instanceof Array?t.map(function(t){return r.prototype.int(t,e)}):void 0},r.prototype.str=function(t){return t instanceof Array?t.map(r.prototype.str):String(t)},r.prototype.boolean=function(t){return"number"==typeof t?0!==t:"string"==typeof t?"true"===t.toLowerCase():"boolean"==typeof t?t:t instanceof Array?t.map(r.prototype.boolean):void 0},r.prototype.byte=function(t){var e=r.prototype.int(t,10);return"number"==typeof e?(e+128)%256-128:e instanceof Array?e.map(r.prototype.byte):void 0},r.prototype.char=function(t){return"number"!=typeof t||isNaN(t)?t instanceof Array?t.map(r.prototype.char):"string"==typeof t?r.prototype.char(parseInt(t,10)):void 0:String.fromCharCode(t)},r.prototype.unchar=function(t){return"string"==typeof t&&1===t.length?t.charCodeAt(0):t instanceof Array?t.map(r.prototype.unchar):void 0},r.prototype.hex=function(t,e){if(e=void 0===e||null===e?e=8:e,t instanceof Array)return t.map(function(t){return r.prototype.hex(t,e)});if("number"==typeof t){t<0&&(t=4294967295+t+1);for(var i=Number(t).toString(16).toUpperCase();i.length<e;)i="0"+i;return i.length>=e&&(i=i.substring(i.length-e,i.length)),i}},r.prototype.unhex=function(t){return t instanceof Array?t.map(r.prototype.unhex):parseInt("0x"+t,16)},e.exports=r},{"../core/core":54}],94:[function(t,e,i){"use strict";function r(){var t=arguments[0],e=t<0,i=e?t.toString().substring(1):t.toString(),r=i.indexOf("."),n=-1!==r?i.substring(0,r):i,o=-1!==r?i.substring(r+1):"",s=e?"-":"";if(3===arguments.length){var a="";(-1!==r||arguments[2]-o.length>0)&&(a="."),o.length>arguments[2]&&(o=o.substring(0,arguments[2]));for(var h=0;h<arguments[1]-n.length;h++)s+="0";s+=n,s+=a,s+=o;for(var l=0;l<arguments[2]-o.length;l++)s+="0";return s}for(var u=0;u<Math.max(arguments[1]-n.length,0);u++)s+="0";return s+=i}function n(){var t=arguments[0].toString(),e=t.indexOf("."),i=-1!==e?t.substring(e):"",r=-1!==e?t.substring(0,e):t;if(r=r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),0===arguments[1])i="";else if(void 0!==arguments[1])if(arguments[1]>i.length){i+=-1===e?".":"";for(var n=arguments[1]-i.length+1,o=0;o<n;o++)i+="0"}else i=i.substring(0,arguments[1]+1);return r+i}function o(){return parseFloat(arguments[0])>0?"+"+arguments[0].toString():arguments[0].toString()}function s(){return parseFloat(arguments[0])>0?" "+arguments[0].toString():arguments[0].toString()}var a=t("../core/core");a.prototype.join=function(t,e){return t.join(e)},a.prototype.match=function(t,e){return t.match(e)},a.prototype.matchAll=function(t,e){for(var i=new RegExp(e,"g"),r=i.exec(t),n=[];null!==r;)n.push(r),r=i.exec(t);return n},a.prototype.nf=function(){if(arguments[0]instanceof Array){var t=arguments[1],e=arguments[2];return arguments[0].map(function(i){return r(i,t,e)})}return"[object Arguments]"===Object.prototype.toString.call(arguments[0])?3===arguments[0].length?this.nf(arguments[0][0],arguments[0][1],arguments[0][2]):2===arguments[0].length?this.nf(arguments[0][0],arguments[0][1]):this.nf(arguments[0][0]):r.apply(this,arguments)},a.prototype.nfc=function(){if(arguments[0]instanceof Array){var t=arguments[1];return arguments[0].map(function(e){return n(e,t)})}return n.apply(this,arguments)},a.prototype.nfp=function(){var t=this.nf.apply(this,arguments);return t instanceof Array?t.map(o):o(t)},a.prototype.nfs=function(){var t=this.nf.apply(this,arguments);return t instanceof Array?t.map(s):s(t)},a.prototype.split=function(t,e){return t.split(e)},a.prototype.splitTokens=function(){var t,e,i,r;return r=arguments[1],arguments.length>1?(i=/\]/g.exec(r),e=/\[/g.exec(r),e&&i?(r=r.slice(0,i.index)+r.slice(i.index+1),e=/\[/g.exec(r),r=r.slice(0,e.index)+r.slice(e.index+1),t=new RegExp("[\\["+r+"\\]]","g")):i?(r=r.slice(0,i.index)+r.slice(i.index+1),t=new RegExp("["+r+"\\]]","g")):e?(r=r.slice(0,e.index)+r.slice(e.index+1),t=new RegExp("["+r+"\\[]","g")):t=new RegExp("["+r+"]","g")):t=/\s/g,arguments[0].split(t).filter(function(t){return t})},a.prototype.trim=function(t){return t instanceof Array?t.map(this.trim):t.trim()},e.exports=a},{"../core/core":54}],95:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.day=function(){return(new Date).getDate()},r.prototype.hour=function(){return(new Date).getHours()},r.prototype.minute=function(){return(new Date).getMinutes()},r.prototype.millis=function(){return window.performance.now()},r.prototype.month=function(){return(new Date).getMonth()+1},r.prototype.second=function(){return(new Date).getSeconds()},r.prototype.year=function(){return(new Date).getFullYear()},e.exports=r},{"../core/core":54}],96:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.camera=function(t,e,i){this._renderer.translate(-t,-e,-i)},r.prototype.perspective=function(t,e,i,n){t=t||60/180*this.PI,e=e||this.width/this.height,i=i||this.height/2/this.tan(t/2)*.1,n=n||this.height/2/this.tan(t/2)*10,this._renderer.uPMatrix=r.Matrix.identity(),this._renderer.uPMatrix.perspective(t,e,i,n),this._renderer._curCamera="custom"},r.prototype.ortho=function(t,e,i,n,o,s){t=t||-this.width/2,e=e||this.width/2,i=i||-this.height/2,n=n||this.height/2,o=o||0,s=s||Math.max(this.width,this.height),this._renderer.uPMatrix=r.Matrix.identity(),this._renderer.uPMatrix.ortho(t,e,i,n,o,s),this._renderer._curCamera="custom"},e.exports=r},{"../core/core":54}],97:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.orbitControl=function(){return this.mouseIsPressed&&(this.rotateY((this.mouseX-this.width/2)/(this.width/2)),this.rotateX((this.mouseY-this.height/2)/(this.width/2))),this},e.exports=r},{"../core/core":54}],98:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.ambientLight=function(t,e,i,r){var n=this._renderer.GL,o=this._renderer._getShader("lightVert","lightTextureFrag");n.useProgram(o),o.uAmbientColor=n.getUniformLocation(o,"uAmbientColor["+this._renderer.ambientLightCount+"]");var s=this._renderer._pInst.color.apply(this._renderer._pInst,arguments),a=s._array;return n.uniform3f(o.uAmbientColor,a[0],a[1],a[2]),o.uMaterialColor=n.getUniformLocation(o,"uMaterialColor"),n.uniform4f(o.uMaterialColor,1,1,1,1),this._renderer.ambientLightCount++,o.uAmbientLightCount=n.getUniformLocation(o,"uAmbientLightCount"),n.uniform1i(o.uAmbientLightCount,this._renderer.ambientLightCount),this},r.prototype.directionalLight=function(t,e,i,r,n,o,s){var a=this._renderer.GL,h=this._renderer._getShader("lightVert","lightTextureFrag");a.useProgram(h),h.uDirectionalColor=a.getUniformLocation(h,"uDirectionalColor["+this._renderer.directionalLightCount+"]");var l=this._renderer._pInst.color.apply(this._renderer._pInst,[t,e,i]),u=l._array;a.uniform3f(h.uDirectionalColor,u[0],u[1],u[2]);for(var p,c,f,d=new Array(arguments.length),y=0;y<d.length;++y)d[y]=arguments[y];if("number"==typeof d[d.length-1])p=d[d.length-3],c=d[d.length-2],f=d[d.length-1];else try{p=d[d.length-1].x,c=d[d.length-1].y,f=d[d.length-1].z}catch(t){throw t}return h.uLightingDirection=a.getUniformLocation(h,"uLightingDirection["+this._renderer.directionalLightCount+"]"),a.uniform3f(h.uLightingDirection,p,c,f),h.uMaterialColor=a.getUniformLocation(h,"uMaterialColor"),a.uniform4f(h.uMaterialColor,1,1,1,1),this._renderer.directionalLightCount++,h.uDirectionalLightCount=a.getUniformLocation(h,"uDirectionalLightCount"),a.uniform1i(h.uDirectionalLightCount,this._renderer.directionalLightCount),this},r.prototype.pointLight=function(t,e,i,r,n,o,s){var a=this._renderer.GL,h=this._renderer._getShader("lightVert","lightTextureFrag");a.useProgram(h),h.uPointLightColor=a.getUniformLocation(h,"uPointLightColor["+this._renderer.pointLightCount+"]");var l=this._renderer._pInst.color.apply(this._renderer._pInst,[t,e,i]),u=l._array;a.uniform3f(h.uPointLightColor,u[0],u[1],u[2]);for(var p,c,f,d=new Array(arguments.length),y=0;y<d.length;++y)d[y]=arguments[y];if("number"==typeof d[d.length-1])p=d[d.length-3],c=d[d.length-2],f=d[d.length-1];else try{p=d[d.length-1].x,c=d[d.length-1].y,f=d[d.length-1].z}catch(t){throw t}return h.uPointLightLocation=a.getUniformLocation(h,"uPointLightLocation["+this._renderer.pointLightCount+"]"),a.uniform3f(h.uPointLightLocation,p,c,f),h.uMaterialColor=a.getUniformLocation(h,"uMaterialColor"),a.uniform4f(h.uMaterialColor,1,1,1,1),this._renderer.pointLightCount++,h.uPointLightCount=a.getUniformLocation(h,"uPointLightCount"),a.uniform1i(h.uPointLightCount,this._renderer.pointLightCount),this},e.exports=r},{"../core/core":54}],99:[function(t,e,i){"use strict";function r(t,e){for(var i={v:[],vt:[],vn:[]},r={},o=0;o<e.length;++o){var s=e[o].trim().split(/\b\s+/);if(s.length>0)if("v"===s[0]||"vn"===s[0]){var a=new n.Vector(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));i[s[0]].push(a)}else if("vt"===s[0]){var h=[parseFloat(s[1]),parseFloat(s[2])];i[s[0]].push(h)}else if("f"===s[0])for(var l=3;l<s.length;++l){for(var u=[],p=[1,l-1,l],c=0;c<p.length;++c){var f=s[p[c]],d=0;if(void 0!==r[f])d=r[f];else{for(var y=f.split("/"),m=0;m<y.length;m++)y[m]=parseInt(y[m])-1;d=r[f]=t.vertices.length,t.vertices.push(i.v[y[0]].copy()),i.vt[y[1]]?t.uvs.push(i.vt[y[1]].slice()):t.uvs.push([0,0]),i.vn[y[2]]&&t.vertexNormals.push(i.vn[y[2]].copy())}u.push(d)}t.faces.push(u)}}return 0===t.vertexNormals.length&&t.computeNormals(),t}var n=t("../core/core");t("./p5.Geometry"),n.prototype.loadModel=function(){var t,e,i,o=arguments[0];"boolean"==typeof arguments[1]?(t=arguments[1],e=arguments[2],i=arguments[3]):(t=!1,e=arguments[1],i=arguments[2]);var s=new n.Geometry;return s.gid=o+"|"+t,this.loadStrings(o,function(i){r(s,i),t&&s.normalize(),"function"==typeof e&&e(s)}.bind(this),i),s},n.prototype.model=function(t){t.vertices.length>0&&(this._renderer.geometryInHash(t.gid)||this._renderer.createBuffers(t.gid,t),this._renderer.drawBuffers(t.gid))},e.exports=n},{"../core/core":54,"./p5.Geometry":101}],100:[function(t,e,i){"use strict";var r=t("../core/core");r.prototype.normalMaterial=function(){return this._renderer._getShader("normalVert","normalFrag"),this},r.prototype.texture=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i=this._renderer.GL;i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),this._renderer.drawMode="texture";var n=this._renderer._getShader("lightVert","lightTextureFrag");i.useProgram(n);var o;if(t[0].isTexture)t[0]instanceof r.Graphics||void 0!==r.MediaElement&&t[0]instanceof r.MediaElement?o=t[0].elt:t[0]instanceof r.Image&&(o=t[0].canvas),this._renderer._bind.call(this,t[0].tex,o);else{if(t[0]instanceof r.Image)o=t[0].canvas;else if(void 0!==r.MediaElement&&t[0]instanceof r.MediaElement){if(!t[0].loadedmetadata)return;o=t[0].elt}else t[0]instanceof r.Graphics&&(o=t[0].elt);var s=i.createTexture();t[0]._setProperty("tex",s),t[0]._setProperty("isTexture",!0),this._renderer._bind.call(this,s,o)}return i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t[0].tex),i.uniform1i(i.getUniformLocation(n,"isTexture"),!0),i.uniform1i(i.getUniformLocation(n,"uSampler"),0),this},r.RendererGL.prototype._bind=function(t,e){var i=this._renderer.GL;i.bindTexture(i.TEXTURE_2D,t),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!0),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.bindTexture(i.TEXTURE_2D,null)},r.prototype.ambientMaterial=function(t,e,i,r){var n=this._renderer.GL,o=this._renderer._getShader("lightVert","lightTextureFrag");n.useProgram(o),o.uMaterialColor=n.getUniformLocation(o,"uMaterialColor");var s=this._renderer._applyColorBlend.apply(this._renderer,arguments);return n.uniform4f(o.uMaterialColor,s[0],s[1],s[2],s[3]),o.uSpecular=n.getUniformLocation(o,"uSpecular"),n.uniform1i(o.uSpecular,!1),n.uniform1i(n.getUniformLocation(o,"isTexture"),!1),this},r.prototype.specularMaterial=function(t,e,i,r){var n=this._renderer.GL,o=this._renderer._getShader("lightVert","lightTextureFrag");n.useProgram(o),n.uniform1i(n.getUniformLocation(o,"isTexture"),!1),o.uMaterialColor=n.getUniformLocation(o,"uMaterialColor");var s=this._renderer._applyColorBlend.apply(this._renderer,arguments);return n.uniform4f(o.uMaterialColor,s[0],s[1],s[2],s[3]),o.uSpecular=n.getUniformLocation(o,"uSpecular"),n.uniform1i(o.uSpecular,!0),this},r.RendererGL.prototype._applyColorBlend=function(t,e,i,r){var n=this.GL,o=this._pInst.color.apply(this._pInst,arguments),s=o._array;return s[s.length-1]<1?(n.depthMask(!1),n.enable(n.BLEND),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA)):(n.depthMask(!0),n.disable(n.BLEND)),s},e.exports=r},{"../core/core":54}],101:[function(t,e,i){"use strict";var r=t("../core/core");r.Geometry=function(t,e,i){return this.vertices=[],this.vertexNormals=[],this.faces=[],this.uvs=[],this.detailX=void 0!==t?t:1,this.detailY=void 0!==e?e:1,i instanceof Function&&i.call(this),this},r.Geometry.prototype.computeFaces=function(){for(var t,e,i,r,n=this.detailX+1,o=0;o<this.detailY;o++)for(var s=0;s<this.detailX;s++)t=o*n+s,e=o*n+s+1,i=(o+1)*n+s+1,r=(o+1)*n+s,this.faces.push([t,e,r]),this.faces.push([r,e,i]);return this},r.Geometry.prototype._getFaceNormal=function(t,e){var i=this.faces[t],n=this.vertices[i[e%3]],o=this.vertices[i[(e+1)%3]],s=this.vertices[i[(e+2)%3]],a=r.Vector.cross(r.Vector.sub(o,n),r.Vector.sub(s,n)),h=r.Vector.mag(a)/(r.Vector.mag(r.Vector.sub(o,n))*r.Vector.mag(r.Vector.sub(s,n)));return a=a.normalize(),a.mult(Math.asin(h))},r.Geometry.prototype.computeNormals=function(){for(var t=0;t<this.vertices.length;t++){for(var e=new r.Vector,i=0;i<this.faces.length;i++)this.faces[i][0]!==t&&this.faces[i][1]!==t&&this.faces[i][2]!==t||(e=e.add(this._getFaceNormal(i,t)));e=e.normalize(),this.vertexNormals.push(e)}return this},r.Geometry.prototype.averageNormals=function(){for(var t=0;t<=this.detailY;t++){var e=this.detailX+1,i=r.Vector.add(this.vertexNormals[t*e],this.vertexNormals[t*e+this.detailX]);i=r.Vector.div(i,2),this.vertexNormals[t*e]=i,this.vertexNormals[t*e+this.detailX]=i}return this},r.Geometry.prototype.averagePoleNormals=function(){for(var t=new r.Vector(0,0,0),e=0;e<this.detailX;e++)t.add(this.vertexNormals[e]);for(t=r.Vector.div(t,this.detailX),e=0;e<this.detailX;e++)this.vertexNormals[e]=t;for(t=new r.Vector(0,0,0),e=this.vertices.length-1;e>this.vertices.length-1-this.detailX;e--)t.add(this.vertexNormals[e]);for(t=r.Vector.div(t,this.detailX),e=this.vertices.length-1;e>this.vertices.length-1-this.detailX;e--)this.vertexNormals[e]=t;return this},r.Geometry.prototype.normalize=function(){if(this.vertices.length>0){for(var t=this.vertices[0].copy(),e=this.vertices[0].copy(),i=0;i<this.vertices.length;i++)t.x=Math.max(t.x,this.vertices[i].x),e.x=Math.min(e.x,this.vertices[i].x),t.y=Math.max(t.y,this.vertices[i].y),e.y=Math.min(e.y,this.vertices[i].y),t.z=Math.max(t.z,this.vertices[i].z),e.z=Math.min(e.z,this.vertices[i].z);var n=r.Vector.lerp(t,e,.5),o=r.Vector.sub(t,e),s=Math.max(Math.max(o.x,o.y),o.z),a=200/s;for(i=0;i<this.vertices.length;i++)this.vertices[i].sub(n),this.vertices[i].mult(a)}return this},e.exports=r.Geometry},{"../core/core":54}],102:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("../math/polargeometry"),o=t("../core/constants"),s="undefined"!=typeof Float32Array?Float32Array:Array;r.Matrix=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];return t[0]instanceof r?(this.p5=t[0],"mat3"===t[1]?this.mat3=t[2]||new s([1,0,0,0,1,0,0,0,1]):this.mat4=t[1]||new s([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])):"mat3"===t[0]?this.mat3=t[1]||new s([1,0,0,0,1,0,0,0,1]):this.mat4=t[0]||new s([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this},r.Matrix.prototype.set=function(t){return t instanceof r.Matrix?(this.mat4=t.mat4,this):t instanceof s?(this.mat4=t,this):this},r.Matrix.prototype.get=function(){return new r.Matrix(this.mat4)},r.Matrix.prototype.copy=function(){var t=new r.Matrix;return t.mat4[0]=this.mat4[0],t.mat4[1]=this.mat4[1],t.mat4[2]=this.mat4[2],t.mat4[3]=this.mat4[3],t.mat4[4]=this.mat4[4],t.mat4[5]=this.mat4[5],t.mat4[6]=this.mat4[6],t.mat4[7]=this.mat4[7],t.mat4[8]=this.mat4[8],t.mat4[9]=this.mat4[9],t.mat4[10]=this.mat4[10],t.mat4[11]=this.mat4[11],t.mat4[12]=this.mat4[12],t.mat4[13]=this.mat4[13],t.mat4[14]=this.mat4[14],t.mat4[15]=this.mat4[15],t},r.Matrix.identity=function(){return new r.Matrix},r.Matrix.prototype.transpose=function(t){var e,i,n,o,a,h;return t instanceof r.Matrix?(e=t.mat4[1],i=t.mat4[2],n=t.mat4[3],o=t.mat4[6],a=t.mat4[7],h=t.mat4[11],this.mat4[0]=t.mat4[0],this.mat4[1]=t.mat4[4],this.mat4[2]=t.mat4[8],this.mat4[3]=t.mat4[12],this.mat4[4]=e,this.mat4[5]=t.mat4[5],this.mat4[6]=t.mat4[9],this.mat4[7]=t.mat4[13],this.mat4[8]=i,this.mat4[9]=o,this.mat4[10]=t.mat4[10],this.mat4[11]=t.mat4[14],this.mat4[12]=n,this.mat4[13]=a,this.mat4[14]=h,this.mat4[15]=t.mat4[15]):t instanceof s&&(e=t[1],i=t[2],n=t[3],o=t[6],a=t[7],h=t[11],this.mat4[0]=t[0],this.mat4[1]=t[4],this.mat4[2]=t[8],this.mat4[3]=t[12],this.mat4[4]=e,this.mat4[5]=t[5],this.mat4[6]=t[9],this.mat4[7]=t[13],this.mat4[8]=i,this.mat4[9]=o,this.mat4[10]=t[10],this.mat4[11]=t[14],this.mat4[12]=n,this.mat4[13]=a,this.mat4[14]=h,this.mat4[15]=t[15]),this},r.Matrix.prototype.invert=function(t){var e,i,n,o,a,h,l,u,p,c,f,d,y,m,g,v;t instanceof r.Matrix?(e=t.mat4[0],i=t.mat4[1],n=t.mat4[2],o=t.mat4[3],a=t.mat4[4],h=t.mat4[5],l=t.mat4[6],u=t.mat4[7],p=t.mat4[8],c=t.mat4[9],f=t.mat4[10],d=t.mat4[11],y=t.mat4[12],m=t.mat4[13],g=t.mat4[14],v=t.mat4[15]):t instanceof s&&(e=t[0],i=t[1],n=t[2],o=t[3],a=t[4],h=t[5],l=t[6],u=t[7],p=t[8],c=t[9],f=t[10],d=t[11],y=t[12],m=t[13],g=t[14],v=t[15]);var _=e*h-i*a,b=e*l-n*a,w=e*u-o*a,x=i*l-n*h,S=i*u-o*h,T=n*u-o*l,E=p*m-c*y,P=p*g-f*y,O=p*v-d*y,M=c*g-f*m,A=c*v-d*m,R=f*v-d*g,C=_*R-b*A+w*M+x*O-S*P+T*E;return C?(C=1/C,this.mat4[0]=(h*R-l*A+u*M)*C,this.mat4[1]=(n*A-i*R-o*M)*C,this.mat4[2]=(m*T-g*S+v*x)*C,this.mat4[3]=(f*S-c*T-d*x)*C,this.mat4[4]=(l*O-a*R-u*P)*C,this.mat4[5]=(e*R-n*O+o*P)*C,this.mat4[6]=(g*w-y*T-v*b)*C,this.mat4[7]=(p*T-f*w+d*b)*C,this.mat4[8]=(a*A-h*O+u*E)*C,this.mat4[9]=(i*O-e*A-o*E)*C,this.mat4[10]=(y*S-m*w+v*_)*C,this.mat4[11]=(c*w-p*S-d*_)*C,this.mat4[12]=(h*P-a*M-l*E)*C,this.mat4[13]=(e*M-i*P+n*E)*C,this.mat4[14]=(m*b-y*x-g*_)*C,this.mat4[15]=(p*x-c*b+f*_)*C,this):null},r.Matrix.prototype.invert3x3=function(){var t=this.mat3[0],e=this.mat3[1],i=this.mat3[2],r=this.mat3[3],n=this.mat3[4],o=this.mat3[5],s=this.mat3[6],a=this.mat3[7],h=this.mat3[8],l=h*n-o*a,u=-h*r+o*s,p=a*r-n*s,c=t*l+e*u+i*p;return c?(c=1/c,this.mat3[0]=l*c,this.mat3[1]=(-h*e+i*a)*c,this.mat3[2]=(o*e-i*n)*c,this.mat3[3]=u*c,this.mat3[4]=(h*t-i*s)*c,this.mat3[5]=(-o*t+i*r)*c,this.mat3[6]=p*c,this.mat3[7]=(-a*t+e*s)*c,this.mat3[8]=(n*t-e*r)*c,this):null},r.Matrix.prototype.transpose3x3=function(t){var e=t[1],i=t[2],r=t[5];return this.mat3[1]=t[3],this.mat3[2]=t[6],this.mat3[3]=e,this.mat3[5]=t[7],this.mat3[6]=i,this.mat3[7]=r,this},r.Matrix.prototype.inverseTranspose=function(t){return void 0===this.mat3?console.error("sorry, this function only works with mat3"):(this.mat3[0]=t.mat4[0],this.mat3[1]=t.mat4[1],this.mat3[2]=t.mat4[2],this.mat3[3]=t.mat4[4],this.mat3[4]=t.mat4[5],this.mat3[5]=t.mat4[6],this.mat3[6]=t.mat4[8],this.mat3[7]=t.mat4[9],this.mat3[8]=t.mat4[10]),this.invert3x3().transpose3x3(this.mat3),this},r.Matrix.prototype.determinant=function(){var t=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],e=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],i=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],r=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],n=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],o=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],s=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],a=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],h=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],l=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],u=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13];return t*(this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14])-e*u+i*l+r*h-n*a+o*s},r.Matrix.prototype.mult=function(t){var e=new s(16),i=new s(16);t instanceof r.Matrix?i=t.mat4:t instanceof s&&(i=t);var n=this.mat4[0],o=this.mat4[1],a=this.mat4[2],h=this.mat4[3];return e[0]=n*i[0]+o*i[4]+a*i[8]+h*i[12],e[1]=n*i[1]+o*i[5]+a*i[9]+h*i[13],e[2]=n*i[2]+o*i[6]+a*i[10]+h*i[14],e[3]=n*i[3]+o*i[7]+a*i[11]+h*i[15],n=this.mat4[4],o=this.mat4[5],a=this.mat4[6],h=this.mat4[7],e[4]=n*i[0]+o*i[4]+a*i[8]+h*i[12],e[5]=n*i[1]+o*i[5]+a*i[9]+h*i[13],e[6]=n*i[2]+o*i[6]+a*i[10]+h*i[14],e[7]=n*i[3]+o*i[7]+a*i[11]+h*i[15],n=this.mat4[8],o=this.mat4[9],a=this.mat4[10],h=this.mat4[11],e[8]=n*i[0]+o*i[4]+a*i[8]+h*i[12],e[9]=n*i[1]+o*i[5]+a*i[9]+h*i[13],e[10]=n*i[2]+o*i[6]+a*i[10]+h*i[14],e[11]=n*i[3]+o*i[7]+a*i[11]+h*i[15],n=this.mat4[12],o=this.mat4[13],a=this.mat4[14],h=this.mat4[15],e[12]=n*i[0]+o*i[4]+a*i[8]+h*i[12],e[13]=n*i[1]+o*i[5]+a*i[9]+h*i[13],e[14]=n*i[2]+o*i[6]+a*i[10]+h*i[14],e[15]=n*i[3]+o*i[7]+a*i[11]+h*i[15],this.mat4=e,this},r.Matrix.prototype.scale=function(){for(var t,e,i,n=new Array(arguments.length),o=0;o<n.length;++o)n[o]=arguments[o];n[0]instanceof r.Vector?(t=n[0].x,e=n[0].y,i=n[0].z):n[0]instanceof Array&&(t=n[0][0],e=n[0][1],i=n[0][2]);var a=new s(16);return a[0]=this.mat4[0]*t,a[1]=this.mat4[1]*t,a[2]=this.mat4[2]*t,a[3]=this.mat4[3]*t,a[4]=this.mat4[4]*e,a[5]=this.mat4[5]*e,a[6]=this.mat4[6]*e,a[7]=this.mat4[7]*e,a[8]=this.mat4[8]*i,a[9]=this.mat4[9]*i,a[10]=this.mat4[10]*i,a[11]=this.mat4[11]*i,a[12]=this.mat4[12],a[13]=this.mat4[13],a[14]=this.mat4[14],a[15]=this.mat4[15],this.mat4=a,this},r.Matrix.prototype.rotate=function(t,e){var i,s,a,h,l;this.p5?this.p5._angleMode===o.DEGREES&&(h=n.degreesToRadians(t)):h=t,e instanceof r.Vector?(i=e.x,s=e.y,a=e.z):e instanceof Array&&(i=e[0],s=e[1],a=e[2]),l=Math.sqrt(i*i+s*s+a*a),i*=1/l,s*=1/l,a*=1/l;var u=this.mat4[0],p=this.mat4[1],c=this.mat4[2],f=this.mat4[3],d=this.mat4[4],y=this.mat4[5],m=this.mat4[6],g=this.mat4[7],v=this.mat4[8],_=this.mat4[9],b=this.mat4[10],w=this.mat4[11],x=Math.sin(h),S=Math.cos(h),T=1-S,E=i*i*T+S,P=s*i*T+a*x,O=a*i*T-s*x,M=i*s*T-a*x,A=s*s*T+S,R=a*s*T+i*x,C=i*a*T+s*x,k=s*a*T-i*x,F=a*a*T+S;return this.mat4[0]=u*E+d*P+v*O,this.mat4[1]=p*E+y*P+_*O,this.mat4[2]=c*E+m*P+b*O,this.mat4[3]=f*E+g*P+w*O,this.mat4[4]=u*M+d*A+v*R,this.mat4[5]=p*M+y*A+_*R,this.mat4[6]=c*M+m*A+b*R,this.mat4[7]=f*M+g*A+w*R,this.mat4[8]=u*C+d*k+v*F,this.mat4[9]=p*C+y*k+_*F,this.mat4[10]=c*C+m*k+b*F,this.mat4[11]=f*C+g*k+w*F,this},r.Matrix.prototype.translate=function(t){var e=t[0],i=t[1],r=t[2]||0;this.mat4[12]=this.mat4[0]*e+this.mat4[4]*i+this.mat4[8]*r+this.mat4[12],this.mat4[13]=this.mat4[1]*e+this.mat4[5]*i+this.mat4[9]*r+this.mat4[13],this.mat4[14]=this.mat4[2]*e+this.mat4[6]*i+this.mat4[10]*r+this.mat4[14],this.mat4[15]=this.mat4[3]*e+this.mat4[7]*i+this.mat4[11]*r+this.mat4[15]},r.Matrix.prototype.rotateX=function(t){this.rotate(t,[1,0,0])},r.Matrix.prototype.rotateY=function(t){this.rotate(t,[0,1,0])},r.Matrix.prototype.rotateZ=function(t){this.rotate(t,[0,0,1])},r.Matrix.prototype.perspective=function(t,e,i,r){var n=1/Math.tan(t/2),o=1/(i-r);return this.mat4[0]=n/e,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=n,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=(r+i)*o,this.mat4[11]=-1,this.mat4[12]=0,this.mat4[13]=0,this.mat4[14]=2*r*i*o,this.mat4[15]=0,this},r.Matrix.prototype.ortho=function(t,e,i,r,n,o){var s=1/(t-e),a=1/(i-r),h=1/(n-o);return this.mat4[0]=-2*s,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=-2*a,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=2*h,this.mat4[11]=0,this.mat4[12]=(t+e)*s,this.mat4[13]=(r+i)*a,this.mat4[14]=(o+n)*h,this.mat4[15]=1,this},e.exports=r.Matrix},{"../core/constants":53,"../core/core":54,"../math/polargeometry":86}],103:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("../core/constants");r.RendererGL.prototype.beginShape=function(t){return this.immediateMode.shapeMode=void 0!==t?t:n.LINE_STRIP,void 0===this.immediateMode.vertexPositions?(this.immediateMode.vertexPositions=[],this.immediateMode.vertexColors=[],this.immediateMode.vertexBuffer=this.GL.createBuffer(),this.immediateMode.colorBuffer=this.GL.createBuffer()):(this.immediateMode.vertexPositions.length=0,this.immediateMode.vertexColors.length=0),this.isImmediateDrawing=!0,this},r.RendererGL.prototype.vertex=function(t,e,i){this.immediateMode.vertexPositions.push(t,e,i);var r=this.curFillColor||[.5,.5,.5,1];return this.immediateMode.vertexColors.push(r[0],r[1],r[2],r[3]),this},r.RendererGL.prototype.endShape=function(t,e,i,r,o,s){var a=this.GL;if(this._bindImmediateBuffers(this.immediateMode.vertexPositions,this.immediateMode.vertexColors),t)if("fill"===this.drawMode||"texture"===this.drawMode)switch(this.immediateMode.shapeMode){case n.LINE_STRIP:case n.LINES:case n.TRIANGLES:this.immediateMode.shapeMode=n.TRIANGLE_FAN}else switch(this.immediateMode.shapeMode){case n.LINE_STRIP:case n.LINES:this.immediateMode.shapeMode=n.LINE_LOOP}if(this.immediateMode.shapeMode===n.QUADS||this.immediateMode.shapeMode===n.QUAD_STRIP)throw new Error("sorry, "+this.immediateMode.shapeMode+" not yet implemented in webgl mode.");return a.enable(a.BLEND),a.drawArrays(this.immediateMode.shapeMode,0,this.immediateMode.vertexPositions.length/3),this.immediateMode.vertexPositions.length=0,this.immediateMode.vertexColors.length=0,this.isImmediateDrawing=!1,this},r.RendererGL.prototype._bindImmediateBuffers=function(t,e){this._setDefaultCamera();var i=this.GL,r=this._getCurShaderId(),n=this.mHash[r];return n.vertexPositionAttribute=i.getAttribLocation(n,"aPosition"),i.enableVertexAttribArray(n.vertexPositionAttribute),i.bindBuffer(i.ARRAY_BUFFER,this.immediateMode.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(t),i.DYNAMIC_DRAW),i.vertexAttribPointer(n.vertexPositionAttribute,3,i.FLOAT,!1,0,0),n.vertexColorAttribute=i.getAttribLocation(n,"aVertexColor"),i.enableVertexAttribArray(n.vertexColorAttribute),i.bindBuffer(i.ARRAY_BUFFER,this.immediateMode.colorBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(e),i.DYNAMIC_DRAW),i.vertexAttribPointer(n.vertexColorAttribute,4,i.FLOAT,!1,0,0),this._setMatrixUniforms(r),this},r.RendererGL.prototype._getColorVertexShader=function(){var t,e=this.GL,i="immediateVert|vertexColorFrag";return this.materialInHash(i)?t=this.mHash[i]:(t=this._initShaders("immediateVert","vertexColorFrag",!0),this.mHash[i]=t,t.vertexColorAttribute=e.getAttribLocation(t,"aVertexColor"),e.enableVertexAttribArray(t.vertexColorAttribute)),t},e.exports=r.RendererGL},{"../core/constants":53,"../core/core":54}],104:[function(t,e,i){"use strict";function r(t){return t.length>0?t.reduce(function(t,e){return t.concat(e)}):[]}function n(t){return r(t.map(function(t){return[t.x,t.y,t.z]}))}var o=t("../core/core"),s=0;o.RendererGL.prototype._initBufferDefaults=function(t){if(++s>1e3){var e=Object.keys(this.gHash)[0];delete this.gHash[e],s--}var i=this.GL;this.gHash[t]={},this.gHash[t].vertexBuffer=i.createBuffer(),this.gHash[t].normalBuffer=i.createBuffer(),this.gHash[t].uvBuffer=i.createBuffer(),this.gHash[t].indexBuffer=i.createBuffer()},o.RendererGL.prototype.createBuffers=function(t,e){var i=this.GL;this._setDefaultCamera(),this._initBufferDefaults(t);var o=this.mHash[this._getCurShaderId()];this.gHash[t].numberOfItems=3*e.faces.length,i.bindBuffer(i.ARRAY_BUFFER,this.gHash[t].vertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(n(e.vertices)),i.STATIC_DRAW),o.vertexPositionAttribute=i.getAttribLocation(o,"aPosition"),i.enableVertexAttribArray(o.vertexPositionAttribute),i.vertexAttribPointer(o.vertexPositionAttribute,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this.gHash[t].normalBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(n(e.vertexNormals)),i.STATIC_DRAW),o.vertexNormalAttribute=i.getAttribLocation(o,"aNormal"),i.enableVertexAttribArray(o.vertexNormalAttribute),i.vertexAttribPointer(o.vertexNormalAttribute,3,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this.gHash[t].uvBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(r(e.uvs)),i.STATIC_DRAW),o.textureCoordAttribute=i.getAttribLocation(o,"aTexCoord"),i.enableVertexAttribArray(o.textureCoordAttribute),i.vertexAttribPointer(o.textureCoordAttribute,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.gHash[t].indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(r(e.faces)),i.STATIC_DRAW)},o.RendererGL.prototype.drawBuffers=function(t){this._setDefaultCamera();var e=this.GL,i=this._getCurShaderId(),r=this.mHash[i];return e.bindBuffer(e.ARRAY_BUFFER,this.gHash[t].vertexBuffer),e.vertexAttribPointer(r.vertexPositionAttribute,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.gHash[t].normalBuffer),e.vertexAttribPointer(r.vertexNormalAttribute,3,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.gHash[t].uvBuffer),e.vertexAttribPointer(r.textureCoordAttribute,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.gHash[t].indexBuffer),this._setMatrixUniforms(i),e.drawElements(e.TRIANGLES,this.gHash[t].numberOfItems,e.UNSIGNED_SHORT,0),this},e.exports=o.RendererGL},{"../core/core":54}],105:[function(t,e,i){"use strict";var r=t("../core/core"),n=t("./shader");t("../core/p5.Renderer"),t("./p5.Matrix");var o=[],s={alpha:!0,depth:!0,stencil:!0,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1};r.RendererGL=function(t,e,i){return r.Renderer.call(this,t,e,i),this._initContext(),this.isP3D=!0,this.GL=this.drawingContext,this.ambientLightCount=0,this.directionalLightCount=0,this.pointLightCount=0,this._curCamera=null,this.uMVMatrix=new r.Matrix,this.uPMatrix=new r.Matrix,this.uNMatrix=new r.Matrix("mat3"),this.gHash={},this.mHash={},this.isImmediateDrawing=!1,this.immediateMode={},this.curFillColor=[.5,.5,.5,1],this.curStrokeColor=[.5,.5,.5,1],this.pointSize=5,this},r.RendererGL.prototype=Object.create(r.Renderer.prototype),r.RendererGL.prototype._initContext=function(){try{if(this.drawingContext=this.canvas.getContext("webgl",s)||this.canvas.getContext("experimental-webgl",s),null===this.drawingContext)throw new Error("Error creating webgl context");console.log("p5.RendererGL: enabled webgl context");var t=this.drawingContext;t.enable(t.DEPTH_TEST),t.depthFunc(t.LEQUAL),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)}catch(t){throw new Error(t)}},r.RendererGL.prototype._setDefaultCamera=function(){if(null===this._curCamera){var t=this.width,e=this.height;this.uPMatrix=r.Matrix.identity();var i=this.height/2/Math.tan(30*Math.PI/180);this.uPMatrix.perspective(60/180*Math.PI,t/e,.1*i,10*i),this._curCamera="default"}},r.RendererGL.prototype._update=function(){this.uMVMatrix=r.Matrix.identity(),this.translate(0,0,-this.height/2/Math.tan(30*Math.PI/180)),this.ambientLightCount=0,this.directionalLightCount=0,this.pointLightCount=0},r.RendererGL.prototype.background=function(){var t=this.GL,e=this._pInst.color.apply(this._pInst,arguments),i=e.levels[0]/255,r=e.levels[1]/255,n=e.levels[2]/255,o=e.levels[3]/255;t.clearColor(i,r,n,o),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},r.RendererGL.prototype._initShaders=function(t,e,i){var r=this.GL,o=r.createShader(r.VERTEX_SHADER);if(r.shaderSource(o,n[t]),r.compileShader(o),!r.getShaderParameter(o,r.COMPILE_STATUS))return alert("Yikes! An error occurred compiling the shaders:"+r.getShaderInfoLog(o)),null;var s=r.createShader(r.FRAGMENT_SHADER);if(r.shaderSource(s,n[e]),r.compileShader(s),!r.getShaderParameter(s,r.COMPILE_STATUS))return alert("Darn! An error occurred compiling the shaders:"+r.getShaderInfoLog(s)),null;var a=r.createProgram();return r.attachShader(a,o),r.attachShader(a,s),r.linkProgram(a),r.getProgramParameter(a,r.LINK_STATUS)||alert("Snap! Error linking shader program"),this._getLocation(a,i),a},r.RendererGL.prototype._getLocation=function(t,e){var i=this.GL;i.useProgram(t),t.uPMatrixUniform=i.getUniformLocation(t,"uProjectionMatrix"),t.uMVMatrixUniform=i.getUniformLocation(t,"uModelViewMatrix"),void 0===e&&(t.uNMatrixUniform=i.getUniformLocation(t,"uNormalMatrix"),t.samplerUniform=i.getUniformLocation(t,"uSampler"))},r.RendererGL.prototype._setUniform1f=function(t,e,i){var r=this.GL,n=this.mHash[t];return r.useProgram(n),n[e]=r.getUniformLocation(n,e),r.uniform1f(n[e],i),this},r.RendererGL.prototype._setMatrixUniforms=function(t){var e=this.GL,i=this.mHash[t];e.useProgram(i),e.uniformMatrix4fv(i.uPMatrixUniform,!1,this.uPMatrix.mat4),e.uniformMatrix4fv(i.uMVMatrixUniform,!1,this.uMVMatrix.mat4),this.uNMatrix.inverseTranspose(this.uMVMatrix),e.uniformMatrix3fv(i.uNMatrixUniform,!1,this.uNMatrix.mat3)},r.RendererGL.prototype._getShader=function(t,e,i){var r=t+"|"+e;if(!this.materialInHash(r)){var n=this._initShaders(t,e,i);this.mHash[r]=n}return this.curShaderId=r,this.mHash[this.curShaderId]},r.RendererGL.prototype._getCurShaderId=function(){if("fill"!==this.drawMode&&void 0===this.curShaderId){var t="normalVert|normalFrag",e=this._initShaders("normalVert","normalFrag");this.mHash[t]=e,this.curShaderId=t}else this.isImmediateDrawing&&"fill"===this.drawMode&&this._getShader("immediateVert","vertexColorFrag",!0);return this.curShaderId},r.RendererGL.prototype.fill=function(t,e,i,r){var n,o=this.GL,s=this._applyColorBlend.apply(this,arguments);return this.curFillColor=s,this.drawMode="fill",this.isImmediateDrawing?(n=this._getShader("immediateVert","vertexColorFrag"),o.useProgram(n)):(n=this._getShader("normalVert","basicFrag"),o.useProgram(n),n.uMaterialColor=o.getUniformLocation(n,"uMaterialColor"),o.uniform4f(n.uMaterialColor,s[0],s[1],s[2],s[3])),this},r.RendererGL.prototype.stroke=function(t,e,i,r){var n=this._pInst.color.apply(this._pInst,arguments),o=n._array;return this.curStrokeColor=o,this.drawMode="stroke",this},r.RendererGL.prototype._strokeCheck=function(){if("stroke"===this.drawMode)throw new Error("stroke for shapes in 3D not yet implemented, use fill for now :(")},r.RendererGL.prototype.strokeWeight=function(t){return this.pointSize=t,this},r.RendererGL.prototype.geometryInHash=function(t){return void 0!==this.gHash[t]},r.RendererGL.prototype.materialInHash=function(t){return void 0!==this.mHash[t]},r.RendererGL.prototype.resize=function(t,e){var i=this.GL;r.Renderer.prototype.resize.call(this,t,e),i.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),"default"===this._curCamera&&(this._curCamera=null,this._setDefaultCamera())},r.RendererGL.prototype.clear=function(){var t=this.GL;t.clearColor(arguments[0],arguments[1],arguments[2],arguments[3]),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},r.RendererGL.prototype.translate=function(t,e,i){return this.uMVMatrix.translate([t,-e,i]),this},r.RendererGL.prototype.scale=function(t,e,i){return this.uMVMatrix.scale([t,e,i]),this},r.RendererGL.prototype.rotate=function(t,e){return this.uMVMatrix.rotate(t,e),this},r.RendererGL.prototype.rotateX=function(t){return this.rotate(t,[1,0,0]),this},r.RendererGL.prototype.rotateY=function(t){return this.rotate(t,[0,1,0]),this},r.RendererGL.prototype.rotateZ=function(t){return this.rotate(t,[0,0,1]),this},r.RendererGL.prototype.push=function(){o.push(this.uMVMatrix.copy())},r.RendererGL.prototype.pop=function(){if(0===o.length)throw new Error("Invalid popMatrix!");this.uMVMatrix=o.pop()},r.RendererGL.prototype.resetMatrix=function(){return this.uMVMatrix=r.Matrix.identity(),this.translate(0,0,-800),this},r.RendererGL.prototype._applyTextProperties=function(){console.error("text commands not yet implemented in webgl")},e.exports=r.RendererGL},{"../core/core":54,"../core/p5.Renderer":61,"./p5.Matrix":102,"./shader":107}],106:[function(t,e,i){"use strict";var r=t("../core/core");t("./p5.Geometry"),r.prototype.plane=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i=t[0]||50,n=t[1]||i,o="number"==typeof t[2]?t[2]:1,s="number"==typeof t[3]?t[3]:1,a="plane|"+i+"|"+n+"|"+o+"|"+s;if(!this._renderer.geometryInHash(a)){var h=function(){for(var t,e,o,s=0;s<=this.detailY;s++){e=s/this.detailY;for(var a=0;a<=this.detailX;a++)t=a/this.detailX,o=new r.Vector(i*t-i/2,n*e-n/2,0),this.vertices.push(o),this.uvs.push([t,e])}},l=new r.Geometry(o,s,h);l.computeFaces().computeNormals(),this._renderer.createBuffers(a,l)}this._renderer.drawBuffers(a)},r.prototype.box=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i=t[0]||50,n=t[1]||i,o=t[2]||i,s="number"==typeof t[3]?t[3]:4,a="number"==typeof t[4]?t[4]:4,h="box|"+i+"|"+n+"|"+o+"|"+s+"|"+a;if(!this._renderer.geometryInHash(h)){var l=function(){for(var t=[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]],e=0,s=0;s<t.length;s++){for(var a=t[s],h=4*s,l=0;l<4;l++){var u=a[l],p=new r.Vector((2*(1&u)-1)*i/2,((2&u)-1)*n/2,((4&u)/2-1)*o/2);this.vertices.push(p),this.uvs.push([1&l,(2&l)/2]),e++}this.faces.push([h,h+1,h+2]),this.faces.push([h+2,h+1,h+3])}},u=new r.Geometry(s,a,l);u.computeNormals(),this._renderer.createBuffers(h,u)}return this._renderer.drawBuffers(h),this},r.prototype.sphere=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i=t[0]||50,n="number"==typeof t[1]?t[1]:24,o="number"==typeof t[2]?t[2]:16,s="sphere|"+i+"|"+n+"|"+o;if(!this._renderer.geometryInHash(s)){var a=function(){for(var t,e,n,o=0;o<=this.detailY;o++){e=o/this.detailY;for(var s=0;s<=this.detailX;s++){t=s/this.detailX;var a=2*Math.PI*t,h=Math.PI*e-Math.PI/2;n=new r.Vector(i*Math.cos(h)*Math.sin(a),i*Math.sin(h),i*Math.cos(h)*Math.cos(a)),this.vertices.push(n),this.uvs.push([t,e])}}},h=new r.Geometry(n,o,a);h.computeFaces().computeNormals().averageNormals().averagePoleNormals(),this._renderer.createBuffers(s,h)}return this._renderer.drawBuffers(s),this};var n=function(t,e,i,n,o,s,a){n=n<3?3:n,o=o<1?1:o,s=void 0===s||s,a=void 0===a||a;var h,l,u=(s?2:0)+(a?2:0),p=n+1,c=Math.atan2(t-e,i),f=s?-2:0,d=o+(a?2:0);for(h=f;h<=d;++h){var y,m=h/o,g=i*m;for(h<0?(g=0,m=1,y=t):h>o?(g=i,m=1,y=e):y=t+h/o*(e-t),-2!==h&&h!==o+2||(y=0,m=0),g-=i/2,l=0;l<p;++l)this.vertices.push(new r.Vector(Math.sin(l*Math.PI*2/n)*y,g,Math.cos(l*Math.PI*2/n)*y)),this.vertexNormals.push(new r.Vector(h<0||h>o?0:Math.sin(l*Math.PI*2/n)*Math.cos(c),h<0?-1:h>o?1:Math.sin(c),h<0||h>o?0:Math.cos(l*Math.PI*2/n)*Math.cos(c))),this.uvs.push([l/n,m])}for(h=0;h<o+u;++h)for(l=0;l<n;++l)this.faces.push([p*(h+0)+0+l,p*(h+0)+1+l,p*(h+1)+1+l]),this.faces.push([p*(h+0)+0+l,p*(h+1)+1+l,p*(h+1)+0+l])};r.prototype.cylinder=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i=t[0]||50,o=t[1]||i,s="number"==typeof t[2]?t[2]:24,a="number"==typeof t[3]?t[3]:16,h="cylinder|"+i+"|"+o+"|"+s+"|"+a;if(!this._renderer.geometryInHash(h)){var l=new r.Geometry(s,a);n.call(l,i,i,o,s,a,!0,!0),l.computeNormals(),this._renderer.createBuffers(h,l)}return this._renderer.drawBuffers(h),this},r.prototype.cone=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i=t[0]||50,o=t[1]||i,s="number"==typeof t[2]?t[2]:24,a="number"==typeof t[3]?t[3]:16,h="cone|"+i+"|"+o+"|"+s+"|"+a;if(!this._renderer.geometryInHash(h)){var l=new r.Geometry(s,a);n.call(l,i,0,o,s,a,!0,!0),l.computeNormals(),this._renderer.createBuffers(h,l)}return this._renderer.drawBuffers(h),this},r.prototype.ellipsoid=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i="number"==typeof t[3]?t[3]:24,n="number"==typeof t[4]?t[4]:24,o=t[0]||50,s=t[1]||o,a=t[2]||o,h="ellipsoid|"+o+"|"+s+"|"+a+"|"+i+"|"+n;if(!this._renderer.geometryInHash(h)){var l=function(){for(var t,e,i,n=0;n<=this.detailY;n++){e=n/this.detailY;for(var h=0;h<=this.detailX;h++){t=h/this.detailX;var l=2*Math.PI*t,u=Math.PI*e-Math.PI/2;i=new r.Vector(o*Math.cos(u)*Math.sin(l),s*Math.sin(u),a*Math.cos(u)*Math.cos(l)),this.vertices.push(i),this.uvs.push([t,e])}}},u=new r.Geometry(i,n,l);u.computeFaces().computeNormals(),this._renderer.createBuffers(h,u)}return this._renderer.drawBuffers(h),this},r.prototype.torus=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i="number"==typeof t[2]?t[2]:24,n="number"==typeof t[3]?t[3]:16,o=t[0]||50,s=t[1]||10,a="torus|"+o+"|"+s+"|"+i+"|"+n;if(!this._renderer.geometryInHash(a)){var h=function(){for(var t,e,i,n=0;n<=this.detailY;n++){e=n/this.detailY;for(var a=0;a<=this.detailX;a++){t=a/this.detailX;var h=2*Math.PI*t,l=2*Math.PI*e;i=new r.Vector((o+s*Math.cos(l))*Math.cos(h),(o+s*Math.cos(l))*Math.sin(h),s*Math.sin(l)),this.vertices.push(i),this.uvs.push([t,e])}}},l=new r.Geometry(i,n,h);l.computeFaces().computeNormals().averageNormals(),this._renderer.createBuffers(a,l)}return this._renderer.drawBuffers(a),this},r.RendererGL.prototype.point=function(t,e,i){return console.log("point not yet implemented in webgl"),this},r.RendererGL.prototype.triangle=function(t){var e=t[0],i=t[1],n=t[2],o=t[3],s=t[4],a=t[5],h="tri|"+e+"|"+i+"|"+n+"|"+o+"|"+s+"|"+a;if(!this.geometryInHash(h)){var l=function(){var t=[];t.push(new r.Vector(e,i,0)),t.push(new r.Vector(n,o,0)),t.push(new r.Vector(s,a,0)),this.vertices=t,this.faces=[[0,1,2]],this.uvs=[[0,0],[0,1],[1,1]]},u=new r.Geometry(1,1,l);u.computeNormals(),this.createBuffers(h,u)}return this.drawBuffers(h),this},r.RendererGL.prototype.ellipse=function(t){var e=t[0],i=t[1],n=t[2],o=t[3],s=t[4]||24,a=t[5]||16,h="ellipse|"+t[0]+"|"+t[1]+"|"+t[2]+"|"+t[3];if(!this.geometryInHash(h)){var l=function(){for(var t,s,a,h=e+.5*n,l=i+.5*o,u=0;u<=this.detailY;u++){s=u/this.detailY;for(var p=0;p<=this.detailX;p++){t=p/this.detailX;var c=2*Math.PI*t;if(0===s)a=new r.Vector(h,l,0);else{var f=h+.5*n*Math.cos(c),d=l+.5*o*Math.sin(c);a=new r.Vector(f,d,0)}this.vertices.push(a),this.uvs.push([t,s])}}},u=new r.Geometry(s,a,l);u.computeFaces().computeNormals(),this.createBuffers(h,u)}return this.drawBuffers(h),this},r.RendererGL.prototype.rect=function(t){var e="rect|"+t[0]+"|"+t[1]+"|"+t[2]+"|"+t[3],i=t[0],n=t[1],o=t[2],s=t[3],a=t[4]||24,h=t[5]||16;if(!this.geometryInHash(e)){var l=function(){for(var t,e,a,h=0;h<=this.detailY;h++){e=h/this.detailY;for(var l=0;l<=this.detailX;l++)t=l/this.detailX,a=new r.Vector(i+o*t,n+s*e,0),this.vertices.push(a),this.uvs.push([t,e])}},u=new r.Geometry(a,h,l);u.computeFaces().computeNormals(),this.createBuffers(e,u)}return this.drawBuffers(e),this},r.RendererGL.prototype.quad=function(){for(var t=new Array(arguments.length),e=0;e<t.length;++e)t[e]=arguments[e];var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],l=t[6],u=t[7],p="quad|"+i+"|"+n+"|"+o+"|"+s+"|"+a+"|"+h+"|"+l+"|"+u;if(!this.geometryInHash(p)){var c=function(){this.vertices.push(new r.Vector(i,n,0)),this.vertices.push(new r.Vector(o,s,0)),this.vertices.push(new r.Vector(a,h,0)),this.vertices.push(new r.Vector(l,u,0)),this.uvs.push([0,0],[1,0],[1,1],[0,1])},f=new r.Geometry(2,2,c);f.computeNormals(),f.faces=[[0,1,2],[2,3,0]],this.createBuffers(p,f)}return this.drawBuffers(p),this},r.RendererGL.prototype.bezier=function(t){var e=t[12]||20;this.beginShape();for(var i=[0,0,0,0],r=[0,0,0],n=0;n<=e;n++)i[0]=Math.pow(1-n/e,3),i[1]=n/e*3*Math.pow(1-n/e,2),i[2]=3*Math.pow(n/e,2)*(1-n/e),i[3]=Math.pow(n/e,3),r[0]=t[0]*i[0]+t[3]*i[1]+t[6]*i[2]+t[9]*i[3],r[1]=t[1]*i[0]+t[4]*i[1]+t[7]*i[2]+t[10]*i[3],r[2]=t[2]*i[0]+t[5]*i[1]+t[8]*i[2]+t[11]*i[3],this.vertex(r[0],r[1],r[2]);return this.endShape(),this},r.RendererGL.prototype.curve=function(t){var e=t[12];this.beginShape();for(var i=[0,0,0,0],r=[0,0,0],n=0;n<=e;n++)i[0]=.5*Math.pow(n/e,3),i[1]=.5*Math.pow(n/e,2),i[2]=n/e*.5,i[3]=.5,r[0]=i[0]*(-t[0]+3*t[3]-3*t[6]+t[9])+i[1]*(2*t[0]-5*t[3]+4*t[6]-t[9])+i[2]*(-t[0]+t[6])+i[3]*(2*t[3]),r[1]=i[0]*(-t[1]+3*t[4]-3*t[7]+t[10])+i[1]*(2*t[1]-5*t[4]+4*t[7]-t[10])+i[2]*(-t[1]+t[7])+i[3]*(2*t[4]),r[2]=i[0]*(-t[2]+3*t[5]-3*t[8]+t[11])+i[1]*(2*t[2]-5*t[5]+4*t[8]-t[11])+i[2]*(-t[2]+t[8])+i[3]*(2*t[5]),this.vertex(r[0],r[1],r[2]);return this.endShape(),this},r.RendererGL.prototype.line=function(t,e,i,r,n,o){return void 0===t&&void 0===e&&void 0===i&&void 0===r&&void 0===n&&void 0===o||(this.beginShape(),this.vertex(t,e,i),this.vertex(r,n,o),this.endShape()),this},e.exports=r},{"../core/core":54,"./p5.Geometry":101}],107:[function(t,e,i){e.exports={immediateVert:"attribute vec3 aPosition;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uResolution;\nuniform float uPointSize;\n\nvarying vec4 vColor;\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition * vec3(1.0, -1.0, 1.0), 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n  gl_PointSize = uPointSize;\n}\n",vertexColorVert:"attribute vec3 aPosition;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition * vec3(1.0, -1.0, 1.0), 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n}\n",vertexColorFrag:"precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n  gl_FragColor = vColor;\n}",normalVert:"attribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nvarying vec3 vVertexNormal;\nvarying highp vec2 vVertTexCoord;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition * vec3(1.0, -1.0, 1.0), 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vVertexNormal = vec3( uNormalMatrix * aNormal );\n  vVertTexCoord = aTexCoord;\n}\n",normalFrag:"precision mediump float;\nvarying vec3 vVertexNormal;\nvoid main(void) {\n  gl_FragColor = vec4(vVertexNormal, 1.0);\n}",basicFrag:"precision mediump float;\nvarying vec3 vVertexNormal;\nuniform vec4 uMaterialColor;\nvoid main(void) {\n  gl_FragColor = uMaterialColor;\n}",lightVert:"attribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform int uAmbientLightCount;\nuniform int uDirectionalLightCount;\nuniform int uPointLightCount;\n\nuniform vec3 uAmbientColor[8];\nuniform vec3 uLightingDirection[8];\nuniform vec3 uDirectionalColor[8];\nuniform vec3 uPointLightLocation[8];\nuniform vec3 uPointLightColor[8];\nuniform bool uSpecular;\n\nvarying vec3 vVertexNormal;\nvarying vec2 vVertTexCoord;\nvarying vec3 vLightWeighting;\n\nvec3 ambientLightFactor = vec3(0.0, 0.0, 0.0);\nvec3 directionalLightFactor = vec3(0.0, 0.0, 0.0);\nvec3 pointLightFactor = vec3(0.0, 0.0, 0.0);\nvec3 pointLightFactor2 = vec3(0.0, 0.0, 0.0);\n\nvoid main(void){\n\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n\n  vec3 vertexNormal = vec3( uNormalMatrix * aNormal );\n  vVertexNormal = vertexNormal;\n  vVertTexCoord = aTexCoord;\n\n  vec4 mvPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n  vec3 eyeDirection = normalize(-mvPosition.xyz);\n\n  float shininess = 32.0;\n  float specularFactor = 2.0;\n  float diffuseFactor = 0.3;\n\n  for(int i = 0; i < 8; i++){\n    if(uAmbientLightCount == i) break;\n    ambientLightFactor += uAmbientColor[i];\n  }\n\n  for(int j = 0; j < 8; j++){\n    if(uDirectionalLightCount == j) break;\n    vec3 dir = uLightingDirection[j];\n    float directionalLightWeighting = max(dot(vertexNormal, dir), 0.0);\n    directionalLightFactor += uDirectionalColor[j] * directionalLightWeighting;\n  }\n\n  for(int k = 0; k < 8; k++){\n    if(uPointLightCount == k) break;\n    vec3 loc = uPointLightLocation[k];\n    vec3 lightDirection = normalize(loc - mvPosition.xyz);\n\n    float directionalLightWeighting = max(dot(vertexNormal, lightDirection), 0.0);\n    pointLightFactor += uPointLightColor[k] * directionalLightWeighting;\n\n    //factor2 for specular\n    vec3 reflectionDirection = reflect(-lightDirection, vertexNormal);\n    float specularLightWeighting = pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);\n\n    pointLightFactor2 += uPointLightColor[k] * (specularFactor * specularLightWeighting\n      +  directionalLightWeighting * diffuseFactor);\n  }\n\n  if(!uSpecular){\n    vLightWeighting =  ambientLightFactor + directionalLightFactor + pointLightFactor;\n  }else{\n    vLightWeighting = ambientLightFactor + directionalLightFactor + pointLightFactor2;\n  }\n\n}\n",lightTextureFrag:"precision mediump float;\n\nuniform vec4 uMaterialColor;\nuniform sampler2D uSampler;\nuniform bool isTexture;\n\nvarying vec3 vLightWeighting;\nvarying highp vec2 vVertTexCoord;\n\nvoid main(void) {\n  if(!isTexture){\n    gl_FragColor = vec4(vec3(uMaterialColor.rgb * vLightWeighting), uMaterialColor.a);\n  }else{\n    vec4 textureColor = texture2D(uSampler, vVertTexCoord);\n    if(vLightWeighting == vec3(0., 0., 0.)){\n      gl_FragColor = textureColor;\n    }else{\n      gl_FragColor = vec4(vec3(textureColor.rgb * vLightWeighting), textureColor.a);\n    }\n  }\n}"}},{}]},{},[45])(45)})}).call(e,i(2))},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var r;!function(n,o){void 0!==(r=function(){return o()}.call(e,i,e,t))&&(t.exports=r)}(0,function(){"use strict";function t(t){t(e)}var e;/**
	 *  Tone.js
	 *  @author Yotam Mann
	 *  @license http://opensource.org/licenses/MIT MIT License
	 *  @copyright 2014-2017 Yotam Mann
	 */
return function(t){e=t()}(function(){var t=function(t,e){this.isUndef(t)||1===t?this.input=this.context.createGain():t>1&&(this.input=new Array(t)),this.isUndef(e)||1===e?this.output=this.context.createGain():e>1&&(this.output=new Array(t))};t.prototype.set=function(e,i,r){if(this.isObject(e))r=i;else if(this.isString(e)){var n={};n[e]=i,e=n}t:for(var o in e){i=e[o];var s=this;if(-1!==o.indexOf(".")){for(var a=o.split("."),h=0;h<a.length-1;h++)if((s=s[a[h]])instanceof t){a.splice(0,h+1);var l=a.join(".");s.set(l,i);continue t}o=a[a.length-1]}var u=s[o];this.isUndef(u)||(t.Signal&&u instanceof t.Signal||t.Param&&u instanceof t.Param?u.value!==i&&(this.isUndef(r)?u.value=i:u.rampTo(i,r)):u instanceof AudioParam?u.value!==i&&(u.value=i):u instanceof t?u.set(i):u!==i&&(s[o]=i))}return this},t.prototype.get=function(e){this.isUndef(e)?e=this._collectDefaults(this.constructor):this.isString(e)&&(e=[e]);for(var i={},r=0;r<e.length;r++){var n=e[r],o=this,s=i;if(-1!==n.indexOf(".")){for(var a=n.split("."),h=0;h<a.length-1;h++){var l=a[h];s[l]=s[l]||{},s=s[l],o=o[l]}n=a[a.length-1]}var u=o[n];this.isObject(e[n])?s[n]=u.get():t.Signal&&u instanceof t.Signal?s[n]=u.value:t.Param&&u instanceof t.Param?s[n]=u.value:u instanceof AudioParam?s[n]=u.value:u instanceof t?s[n]=u.get():this.isFunction(u)||this.isUndef(u)||(s[n]=u)}return i},t.prototype._collectDefaults=function(t){var e=[];if(this.isUndef(t.defaults)||(e=Object.keys(t.defaults)),!this.isUndef(t._super))for(var i=this._collectDefaults(t._super),r=0;r<i.length;r++)-1===e.indexOf(i[r])&&e.push(i[r]);return e},t.prototype.toString=function(){for(var e in t){var i=e[0].match(/^[A-Z]$/),r=t[e]===this.constructor;if(this.isFunction(t[e])&&i&&r)return e}return"Tone"},Object.defineProperty(t.prototype,"numberOfInputs",{get:function(){return this.input?this.isArray(this.input)?this.input.length:1:0}}),Object.defineProperty(t.prototype,"numberOfOutputs",{get:function(){return this.output?this.isArray(this.output)?this.output.length:1:0}}),t.prototype.dispose=function(){return this.isUndef(this.input)||(this.input instanceof AudioNode&&this.input.disconnect(),this.input=null),this.isUndef(this.output)||(this.output instanceof AudioNode&&this.output.disconnect(),this.output=null),this},t.prototype.connect=function(t,e,i){return Array.isArray(this.output)?(e=this.defaultArg(e,0),this.output[e].connect(t,0,i)):this.output.connect(t,e,i),this},t.prototype.disconnect=function(t,e,i){this.isArray(this.output)?this.isNumber(t)?this.output[t].disconnect():(e=this.defaultArg(e,0),this.output[e].disconnect(t,0,i)):this.output.disconnect.apply(this.output,arguments)},t.prototype.connectSeries=function(){if(arguments.length>1)for(var t=arguments[0],e=1;e<arguments.length;e++){var i=arguments[e];t.connect(i),t=i}return this},t.prototype.chain=function(){if(arguments.length>0)for(var t=this,e=0;e<arguments.length;e++){var i=arguments[e];t.connect(i),t=i}return this},t.prototype.fan=function(){if(arguments.length>0)for(var t=0;t<arguments.length;t++)this.connect(arguments[t]);return this},AudioNode.prototype.chain=t.prototype.chain,AudioNode.prototype.fan=t.prototype.fan,t.prototype.defaultArg=function(t,e){if(this.isObject(t)&&this.isObject(e)){var i={};for(var r in t)i[r]=this.defaultArg(e[r],t[r]);for(var n in e)i[n]=this.defaultArg(t[n],e[n]);return i}return this.isUndef(t)?e:t},t.prototype.optionsObject=function(t,e,i){var r={};if(1===t.length&&this.isObject(t[0]))r=t[0];else for(var n=0;n<e.length;n++)r[e[n]]=t[n];return this.isUndef(i)?r:this.defaultArg(r,i)},t.prototype.isUndef=function(t){return void 0===t},t.prototype.isFunction=function(t){return"function"==typeof t},t.prototype.isNumber=function(t){return"number"==typeof t},t.prototype.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object},t.prototype.isBoolean=function(t){return"boolean"==typeof t},t.prototype.isArray=function(t){return Array.isArray(t)},t.prototype.isString=function(t){return"string"==typeof t},t.noOp=function(){},t.prototype._readOnly=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._readOnly(t[e]);else Object.defineProperty(this,t,{writable:!1,enumerable:!0})},t.prototype._writable=function(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this._writable(t[e]);else Object.defineProperty(this,t,{writable:!0})},t.State={Started:"started",Stopped:"stopped",Paused:"paused"},t.prototype.equalPowerScale=function(t){var e=.5*Math.PI;return Math.sin(t*e)},t.prototype.dbToGain=function(t){return Math.pow(2,t/6)},t.prototype.gainToDb=function(t){return Math.log(t)/Math.LN10*20},t.prototype.intervalToFrequencyRatio=function(t){return Math.pow(2,t/12)},t.prototype.now=function(){return t.context.now()},t.now=function(){return t.context.now()},t.extend=function(e,i){function r(){}t.prototype.isUndef(i)&&(i=t),r.prototype=i.prototype,e.prototype=new r,e.prototype.constructor=e,e._super=i};var e;return Object.defineProperty(t,"context",{get:function(){return e},set:function(i){e=t.Context&&i instanceof t.Context?i:new t.Context(i),t.Context&&t.Context.emit("init",e)}}),Object.defineProperty(t.prototype,"context",{get:function(){return t.context}}),t.setContext=function(e){t.context=e},Object.defineProperty(t.prototype,"blockTime",{get:function(){return 128/this.context.sampleRate}}),Object.defineProperty(t.prototype,"sampleTime",{get:function(){return 1/this.context.sampleRate}}),Object.defineProperty(t,"supported",{get:function(){var t=window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"),e=window.hasOwnProperty("Promise"),i=window.hasOwnProperty("Worker");return t&&e&&i}}),t.version="r10",window.TONE_SILENCE_VERSION_LOGGING||console.log("%c * Tone.js "+t.version+" * ","background: #000; color: #fff"),t}),t(function(t){return t.SignalBase=function(){},t.extend(t.SignalBase),t.SignalBase.prototype.connect=function(e,i,r){return t.Signal&&t.Signal===e.constructor||t.Param&&t.Param===e.constructor||t.TimelineSignal&&t.TimelineSignal===e.constructor?(e._param.cancelScheduledValues(0),e._param.value=0,e.overridden=!0):e instanceof AudioParam&&(e.cancelScheduledValues(0),e.value=0),t.prototype.connect.call(this,e,i,r),this},t.SignalBase}),t(function(t){return t.WaveShaper=function(t,e){this._shaper=this.input=this.output=this.context.createWaveShaper(),this._curve=null,Array.isArray(t)?this.curve=t:isFinite(t)||this.isUndef(t)?this._curve=new Float32Array(this.defaultArg(t,1024)):this.isFunction(t)&&(this._curve=new Float32Array(this.defaultArg(e,1024)),this.setMap(t))},t.extend(t.WaveShaper,t.SignalBase),t.WaveShaper.prototype.setMap=function(t){for(var e=0,i=this._curve.length;e<i;e++){var r=e/(i-1)*2-1;this._curve[e]=t(r,e)}return this._shaper.curve=this._curve,this},Object.defineProperty(t.WaveShaper.prototype,"curve",{get:function(){return this._shaper.curve},set:function(t){this._curve=new Float32Array(t),this._shaper.curve=this._curve}}),Object.defineProperty(t.WaveShaper.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){if(-1===["none","2x","4x"].indexOf(t))throw new RangeError("Tone.WaveShaper: oversampling must be either 'none', '2x', or '4x'");this._shaper.oversample=t}}),t.WaveShaper.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.disconnect(),this._shaper=null,this._curve=null,this},t.WaveShaper}),t(function(t){return t.TimeBase=function(e,i){if(!(this instanceof t.TimeBase))return new t.TimeBase(e,i);if(this._expr=this._noOp,e instanceof t.TimeBase)this.copy(e);else if(!this.isUndef(i)||this.isNumber(e)){i=this.defaultArg(i,this._defaultUnits);var r=this._primaryExpressions[i].method;this._expr=r.bind(this,e)}else this.isString(e)?this.set(e):this.isUndef(e)&&(this._expr=this._defaultExpr())},t.extend(t.TimeBase),t.TimeBase.prototype.set=function(t){return this._expr=this._parseExprString(t),this},t.TimeBase.prototype.clone=function(){var t=new this.constructor;return t.copy(this),t},t.TimeBase.prototype.copy=function(t){var e=t._expr();return this.set(e)},t.TimeBase.prototype._primaryExpressions={n:{regexp:/^(\d+)n/i,method:function(t){return t=parseInt(t),1===t?this._beatsToUnits(this._timeSignature()):this._beatsToUnits(4/t)}},t:{regexp:/^(\d+)t/i,method:function(t){return t=parseInt(t),this._beatsToUnits(8/(3*parseInt(t)))}},m:{regexp:/^(\d+)m/i,method:function(t){return this._beatsToUnits(parseInt(t)*this._timeSignature())}},i:{regexp:/^(\d+)i/i,method:function(t){return this._ticksToUnits(parseInt(t))}},hz:{regexp:/^(\d+(?:\.\d+)?)hz/i,method:function(t){return this._frequencyToUnits(parseFloat(t))}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,i){var r=0;return t&&"0"!==t&&(r+=this._beatsToUnits(this._timeSignature()*parseFloat(t))),e&&"0"!==e&&(r+=this._beatsToUnits(parseFloat(e))),i&&"0"!==i&&(r+=this._beatsToUnits(parseFloat(i)/4)),r}},s:{regexp:/^(\d+(?:\.\d+)?s)/,method:function(t){return this._secondsToUnits(parseFloat(t))}},samples:{regexp:/^(\d+)samples/,method:function(t){return parseInt(t)/this.context.sampleRate}},default:{regexp:/^(\d+(?:\.\d+)?)/,method:function(t){return this._primaryExpressions[this._defaultUnits].method.call(this,t)}}},t.TimeBase.prototype._binaryExpressions={"+":{regexp:/^\+/,precedence:2,method:function(t,e){return t()+e()}},"-":{regexp:/^\-/,precedence:2,method:function(t,e){return t()-e()}},"*":{regexp:/^\*/,precedence:1,method:function(t,e){return t()*e()}},"/":{regexp:/^\//,precedence:1,method:function(t,e){return t()/e()}}},t.TimeBase.prototype._unaryExpressions={neg:{regexp:/^\-/,method:function(t){return-t()}}},t.TimeBase.prototype._syntaxGlue={"(":{regexp:/^\(/},")":{regexp:/^\)/}},t.TimeBase.prototype._tokenize=function(t){for(var e=-1,i=[];t.length>0;){t=t.trim();var r=function(t,e){for(var i=["_binaryExpressions","_unaryExpressions","_primaryExpressions","_syntaxGlue"],r=0;r<i.length;r++){var n=e[i[r]];for(var o in n){var s=n[o],a=s.regexp,h=t.match(a);if(null!==h)return{method:s.method,precedence:s.precedence,regexp:s.regexp,value:h[0]}}}throw new SyntaxError("Tone.TimeBase: Unexpected token "+t)}(t,this);i.push(r),t=t.substr(r.value.length)}return{next:function(){return i[++e]},peek:function(){return i[e+1]}}},t.TimeBase.prototype._matchGroup=function(t,e,i){if(!this.isUndef(t))for(var r in e){var n=e[r];if(n.regexp.test(t.value)){if(this.isUndef(i))return n;if(n.precedence===i)return n}}return!1},t.TimeBase.prototype._parseBinary=function(t,e){this.isUndef(e)&&(e=2);var i;i=e<0?this._parseUnary(t):this._parseBinary(t,e-1);for(var r=t.peek();r&&this._matchGroup(r,this._binaryExpressions,e);)r=t.next(),i=r.method.bind(this,i,this._parseBinary(t,e-1)),r=t.peek();return i},t.TimeBase.prototype._parseUnary=function(t){var e,i;e=t.peek();var r=this._matchGroup(e,this._unaryExpressions);return r?(e=t.next(),i=this._parseUnary(t),r.method.bind(this,i)):this._parsePrimary(t)},t.TimeBase.prototype._parsePrimary=function(t){var e,i;if(e=t.peek(),this.isUndef(e))throw new SyntaxError("Tone.TimeBase: Unexpected end of expression");if(this._matchGroup(e,this._primaryExpressions)){e=t.next();var r=e.value.match(e.regexp);return e.method.bind(this,r[1],r[2],r[3])}if(e&&"("===e.value){if(t.next(),i=this._parseBinary(t),!(e=t.next())||")"!==e.value)throw new SyntaxError("Expected )");return i}throw new SyntaxError("Tone.TimeBase: Cannot process token "+e.value)},t.TimeBase.prototype._parseExprString=function(t){this.isString(t)||(t=t.toString());var e=this._tokenize(t);return this._parseBinary(e)},t.TimeBase.prototype._noOp=function(){return 0},t.TimeBase.prototype._defaultExpr=function(){return this._noOp},t.TimeBase.prototype._defaultUnits="s",t.TimeBase.prototype._frequencyToUnits=function(t){return 1/t},t.TimeBase.prototype._beatsToUnits=function(e){return 60/t.Transport.bpm.value*e},t.TimeBase.prototype._secondsToUnits=function(t){return t},t.TimeBase.prototype._ticksToUnits=function(e){return e*(this._beatsToUnits(1)/t.Transport.PPQ)},t.TimeBase.prototype._timeSignature=function(){return t.Transport.timeSignature},t.TimeBase.prototype._pushExpr=function(e,i,r){return e instanceof t.TimeBase||(e=new this.constructor(e,r)),this._expr=this._binaryExpressions[i].method.bind(this,this._expr,e._expr),this},t.TimeBase.prototype.add=function(t,e){return this._pushExpr(t,"+",e)},t.TimeBase.prototype.sub=function(t,e){return this._pushExpr(t,"-",e)},t.TimeBase.prototype.mult=function(t,e){return this._pushExpr(t,"*",e)},t.TimeBase.prototype.div=function(t,e){return this._pushExpr(t,"/",e)},t.TimeBase.prototype.valueOf=function(){return this._expr()},t.TimeBase.prototype.dispose=function(){this._expr=null},t.TimeBase}),t(function(t){return t.Time=function(e,i){if(!(this instanceof t.Time))return new t.Time(e,i);this._plusNow=!1,t.TimeBase.call(this,e,i)},t.extend(t.Time,t.TimeBase),t.Time.prototype._unaryExpressions=Object.create(t.TimeBase.prototype._unaryExpressions),t.Time.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(e){return t.Transport.nextSubdivision(e())}},t.Time.prototype._unaryExpressions.now={regexp:/^\+/,method:function(t){return this._plusNow=!0,t()}},t.Time.prototype.quantize=function(t,e){return e=this.defaultArg(e,1),this._expr=function(t,e,i){return t=t(),e=e.toSeconds(),t+(Math.round(t/e)*e-t)*i}.bind(this,this._expr,new this.constructor(t),e),this},t.Time.prototype.addNow=function(){return this._plusNow=!0,this},t.Time.prototype._defaultExpr=function(){return this._plusNow=!0,this._noOp},t.Time.prototype.copy=function(e){return t.TimeBase.prototype.copy.call(this,e),this._plusNow=e._plusNow,this},t.Time.prototype.toNotation=function(){var t=this.toSeconds(),e=["1m","2n","4n","8n","16n","32n","64n","128n"],i=this._toNotationHelper(t,e),r=["1m","2n","2t","4n","4t","8n","8t","16n","16t","32n","32t","64n","64t","128n"],n=this._toNotationHelper(t,r);return n.split("+").length<i.split("+").length?n:i},t.Time.prototype._toNotationHelper=function(t,e){for(var i=this._notationToUnits(e[e.length-1]),r="",n=0;n<e.length;n++){var o=this._notationToUnits(e[n]),s=t/o;if(1-s%1<1e-6&&(s+=1e-6),(s=Math.floor(s))>0){if(r+=1===s?e[n]:s.toString()+"*"+e[n],(t-=s*o)<i)break;r+=" + "}}return""===r&&(r="0"),r},t.Time.prototype._notationToUnits=function(t){for(var e=this._primaryExpressions,i=[e.n,e.t,e.m],r=0;r<i.length;r++){var n=i[r],o=t.match(n.regexp);if(o)return n.method.call(this,o[1])}},t.Time.prototype.toBarsBeatsSixteenths=function(){var t=this._beatsToUnits(1),e=this.toSeconds()/t,i=Math.floor(e/this._timeSignature()),r=e%1*4;return e=Math.floor(e)%this._timeSignature(),r=r.toString(),r.length>3&&(r=parseFloat(r).toFixed(3)),[i,e,r].join(":")},t.Time.prototype.toTicks=function(){var e=this._beatsToUnits(1),i=this.valueOf()/e;return Math.floor(i*t.Transport.PPQ)},t.Time.prototype.toSamples=function(){return this.toSeconds()*this.context.sampleRate},t.Time.prototype.toFrequency=function(){return 1/this.toSeconds()},t.Time.prototype.toSeconds=function(){return this.valueOf()},t.Time.prototype.toMilliseconds=function(){return 1e3*this.toSeconds()},t.Time.prototype.valueOf=function(){return this._expr()+(this._plusNow?this.now():0)},t.Time}),t(function(t){t.Frequency=function(e,i){if(!(this instanceof t.Frequency))return new t.Frequency(e,i);t.TimeBase.call(this,e,i)},t.extend(t.Frequency,t.TimeBase),t.Frequency.prototype._primaryExpressions=Object.create(t.TimeBase.prototype._primaryExpressions),t.Frequency.prototype._primaryExpressions.midi={regexp:/^(\d+(?:\.\d+)?midi)/,method:function(t){return this.midiToFrequency(t)}},t.Frequency.prototype._primaryExpressions.note={regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(t,i){var r=e[t.toLowerCase()],n=r+12*(parseInt(i)+1);return this.midiToFrequency(n)}},t.Frequency.prototype._primaryExpressions.tr={regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(t,e,i){var r=1;return t&&"0"!==t&&(r*=this._beatsToUnits(this._timeSignature()*parseFloat(t))),e&&"0"!==e&&(r*=this._beatsToUnits(parseFloat(e))),i&&"0"!==i&&(r*=this._beatsToUnits(parseFloat(i)/4)),r}},t.Frequency.prototype.transpose=function(t){return this._expr=function(t,e){return t()*this.intervalToFrequencyRatio(e)}.bind(this,this._expr,t),this},t.Frequency.prototype.harmonize=function(t){return this._expr=function(t,e){for(var i=t(),r=[],n=0;n<e.length;n++)r[n]=i*this.intervalToFrequencyRatio(e[n]);return r}.bind(this,this._expr,t),this},t.Frequency.prototype.toMidi=function(){return this.frequencyToMidi(this.valueOf())},t.Frequency.prototype.toNote=function(){var e=this.valueOf(),r=Math.log(e/t.Frequency.A4)/Math.LN2,n=Math.round(12*r)+57,o=Math.floor(n/12);return o<0&&(n+=-12*o),i[n%12]+o.toString()},t.Frequency.prototype.toSeconds=function(){return 1/this.valueOf()},t.Frequency.prototype.toFrequency=function(){return this.valueOf()},t.Frequency.prototype.toTicks=function(){var e=this._beatsToUnits(1),i=this.valueOf()/e;return Math.floor(i*t.Transport.PPQ)},t.Frequency.prototype._frequencyToUnits=function(t){return t},t.Frequency.prototype._ticksToUnits=function(e){return 1/(60*e/(t.Transport.bpm.value*t.Transport.PPQ))},t.Frequency.prototype._beatsToUnits=function(e){return 1/t.TimeBase.prototype._beatsToUnits.call(this,e)},t.Frequency.prototype._secondsToUnits=function(t){return 1/t},t.Frequency.prototype._defaultUnits="hz";var e={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},i=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return t.Frequency.A4=440,t.Frequency.prototype.midiToFrequency=function(e){return t.Frequency.A4*Math.pow(2,(e-69)/12)},t.Frequency.prototype.frequencyToMidi=function(e){return 69+12*Math.log(e/t.Frequency.A4)/Math.LN2},t.Frequency}),t(function(t){return t.TransportTime=function(e,i){if(!(this instanceof t.TransportTime))return new t.TransportTime(e,i);t.Time.call(this,e,i)},t.extend(t.TransportTime,t.Time),t.TransportTime.prototype._unaryExpressions=Object.create(t.Time.prototype._unaryExpressions),t.TransportTime.prototype._unaryExpressions.quantize={regexp:/^@/,method:function(e){var i=this._secondsToTicks(e()),r=Math.ceil(t.Transport.ticks/i);return this._ticksToUnits(r*i)}},t.TransportTime.prototype._secondsToTicks=function(e){var i=this._beatsToUnits(1),r=e/i;return Math.round(r*t.Transport.PPQ)},t.TransportTime.prototype.valueOf=function(){return this._secondsToTicks(this._expr())+(this._plusNow?t.Transport.ticks:0)},t.TransportTime.prototype.toTicks=function(){return this.valueOf()},t.TransportTime.prototype.toSeconds=function(){return this._expr()+(this._plusNow?t.Transport.seconds:0)},t.TransportTime.prototype.toFrequency=function(){return 1/this.toSeconds()},t.TransportTime}),t(function(t){return t.Emitter=function(){this._events={}},t.extend(t.Emitter),t.Emitter.prototype.on=function(t,e){for(var i=t.split(/\W+/),r=0;r<i.length;r++){var n=i[r];this._events.hasOwnProperty(n)||(this._events[n]=[]),this._events[n].push(e)}return this},t.Emitter.prototype.off=function(e,i){for(var r=e.split(/\W+/),n=0;n<r.length;n++)if(e=r[n],this._events.hasOwnProperty(e))if(t.prototype.isUndef(i))this._events[e]=[];else for(var o=this._events[e],s=0;s<o.length;s++)o[s]===i&&o.splice(s,1);return this},t.Emitter.prototype.emit=function(t){if(this._events){var e=Array.apply(null,arguments).slice(1);if(this._events.hasOwnProperty(t))for(var i=this._events[t],r=0,n=i.length;r<n;r++)i[r].apply(this,e)}return this},t.Emitter.mixin=function(e){var i=["on","off","emit"];e._events={};for(var r=0;r<i.length;r++){var n=i[r],o=t.Emitter.prototype[n];e[n]=o}},t.Emitter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._events=null,this},t.Emitter}),t(function(t){return!window.hasOwnProperty("AudioContext")&&window.hasOwnProperty("webkitAudioContext")&&(window.AudioContext=window.webkitAudioContext),t.Context=function(e){t.Emitter.call(this),e||(e=new window.AudioContext),this._context=e;for(var i in this._context)this._defineProperty(this._context,i);this._latencyHint="interactive",this._lookAhead=.1,this._updateInterval=this._lookAhead/3,this._computedUpdateInterval=0,this._worker=this._createWorker(),this._constants={}},t.extend(t.Context,t.Emitter),t.Emitter.mixin(t.Context),t.Context.prototype._defineProperty=function(t,e){this.isUndef(this[e])&&Object.defineProperty(this,e,{get:function(){return"function"==typeof t[e]?t[e].bind(t):t[e]},set:function(i){t[e]=i}})},t.Context.prototype.now=function(){return this._context.currentTime},t.Context.prototype._createWorker=function(){window.URL=window.URL||window.webkitURL;var t=new Blob(["var timeoutTime = "+(1e3*this._updateInterval).toFixed(1)+";self.onmessage = function(msg){\ttimeoutTime = parseInt(msg.data);};function tick(){\tsetTimeout(tick, timeoutTime);\tself.postMessage('tick');}tick();"]),e=URL.createObjectURL(t),i=new Worker(e);return i.addEventListener("message",function(){this.emit("tick")}.bind(this)),i.addEventListener("message",function(){var t=this.now();if(this.isNumber(this._lastUpdate)){var e=t-this._lastUpdate;this._computedUpdateInterval=Math.max(e,.97*this._computedUpdateInterval)}this._lastUpdate=t}.bind(this)),i},t.Context.prototype.getConstant=function(t){if(this._constants[t])return this._constants[t];for(var e=this._context.createBuffer(1,128,this._context.sampleRate),i=e.getChannelData(0),r=0;r<i.length;r++)i[r]=t;var n=this._context.createBufferSource();return n.channelCount=1,n.channelCountMode="explicit",n.buffer=e,n.loop=!0,n.start(0),this._constants[t]=n,n},Object.defineProperty(t.Context.prototype,"lag",{get:function(){var t=this._computedUpdateInterval-this._updateInterval;return t=Math.max(t,0)}}),Object.defineProperty(t.Context.prototype,"lookAhead",{get:function(){return this._lookAhead},set:function(t){this._lookAhead=t}}),Object.defineProperty(t.Context.prototype,"updateInterval",{get:function(){return this._updateInterval},set:function(e){this._updateInterval=Math.max(e,t.prototype.blockTime),this._worker.postMessage(Math.max(1e3*e,1))}}),Object.defineProperty(t.Context.prototype,"latencyHint",{get:function(){return this._latencyHint},set:function(t){var e=t;if(this._latencyHint=t,this.isString(t))switch(t){case"interactive":e=.1,this._context.latencyHint=t;break;case"playback":e=.8,this._context.latencyHint=t;break;case"balanced":e=.25,this._context.latencyHint=t;break;case"fastest":e=.01}this.lookAhead=e,this.updateInterval=e/3}}),t.supported?(!function(){function e(e,i,n){if(e.input)Array.isArray(e.input)?(t.prototype.isUndef(n)&&(n=0),this.connect(e.input[n])):this.connect(e.input,i,n);else try{e instanceof AudioNode?r.call(this,e,i,n):r.call(this,e,i)}catch(t){throw new Error("error connecting to node: "+e+"\n"+t)}}function i(e,i,r){if(e&&e.input&&Array.isArray(e.input))t.prototype.isUndef(r)&&(r=0),this.disconnect(e.input[r],i,r);else if(e&&e.input)this.disconnect(e.input,i,r);else try{n.apply(this,arguments)}catch(t){throw new Error("error disconnecting node: "+e+"\n"+t)}}var r=AudioNode.prototype.connect,n=AudioNode.prototype.disconnect;AudioNode.prototype.connect!==e&&(AudioNode.prototype.connect=e,AudioNode.prototype.disconnect=i)}(),t.context=new t.Context):console.warn("This browser does not support Tone.js"),t.Context}),t(function(t){return t.Type={Default:"number",Time:"time",Frequency:"frequency",TransportTime:"transportTime",Ticks:"ticks",NormalRange:"normalRange",AudioRange:"audioRange",Decibels:"db",Interval:"interval",BPM:"bpm",Positive:"positive",Cents:"cents",Degrees:"degrees",MIDI:"midi",BarsBeatsSixteenths:"barsBeatsSixteenths",Samples:"samples",Hertz:"hertz",Note:"note",Milliseconds:"milliseconds",Seconds:"seconds",Notation:"notation"},t.prototype.toSeconds=function(e){return this.isNumber(e)?e:this.isUndef(e)?this.now():this.isString(e)?new t.Time(e).toSeconds():e instanceof t.TimeBase?e.toSeconds():void 0},t.prototype.toFrequency=function(e){return this.isNumber(e)?e:this.isString(e)||this.isUndef(e)?new t.Frequency(e).valueOf():e instanceof t.TimeBase?e.toFrequency():void 0},t.prototype.toTicks=function(e){return this.isNumber(e)||this.isString(e)?new t.TransportTime(e).toTicks():this.isUndef(e)?t.Transport.ticks:e instanceof t.TimeBase?e.toTicks():void 0},t}),t(function(t){return t.Param=function(){var e=this.optionsObject(arguments,["param","units","convert"],t.Param.defaults);this._param=this.input=e.param,this.units=e.units,this.convert=e.convert,this.overridden=!1,this._lfo=null,this.isObject(e.lfo)?this.value=e.lfo:this.isUndef(e.value)||(this.value=e.value)},t.extend(t.Param),t.Param.defaults={units:t.Type.Default,convert:!0,param:void 0},Object.defineProperty(t.Param.prototype,"value",{get:function(){return this._toUnits(this._param.value)},set:function(e){if(this.isObject(e)){if(this.isUndef(t.LFO))throw new Error("Include 'Tone.LFO' to use an LFO as a Param value.");this._lfo&&this._lfo.dispose(),this._lfo=new t.LFO(e).start(),this._lfo.connect(this.input)}else{var i=this._fromUnits(e);this._param.cancelScheduledValues(0),this._param.value=i}}}),t.Param.prototype._fromUnits=function(e){if(!this.convert&&!this.isUndef(this.convert))return e;switch(this.units){case t.Type.Time:return this.toSeconds(e);case t.Type.Frequency:return this.toFrequency(e);case t.Type.Decibels:return this.dbToGain(e);case t.Type.NormalRange:return Math.min(Math.max(e,0),1);case t.Type.AudioRange:return Math.min(Math.max(e,-1),1);case t.Type.Positive:return Math.max(e,0);default:return e}},t.Param.prototype._toUnits=function(e){if(!this.convert&&!this.isUndef(this.convert))return e;switch(this.units){case t.Type.Decibels:return this.gainToDb(e);default:return e}},t.Param.prototype._minOutput=1e-5,t.Param.prototype.setValueAtTime=function(t,e){return t=this._fromUnits(t),e=this.toSeconds(e),e<=this.now()+this.blockTime?this._param.value=t:this._param.setValueAtTime(t,e),this},t.Param.prototype.setRampPoint=function(t){t=this.defaultArg(t,this.now());var e=this._param.value;return 0===e&&(e=this._minOutput),this._param.setValueAtTime(e,t),this},t.Param.prototype.linearRampToValueAtTime=function(t,e){return t=this._fromUnits(t),this._param.linearRampToValueAtTime(t,this.toSeconds(e)),this},t.Param.prototype.exponentialRampToValueAtTime=function(t,e){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),this._param.exponentialRampToValueAtTime(t,this.toSeconds(e)),this},t.Param.prototype.exponentialRampToValue=function(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(t,i+this.toSeconds(e)),this},t.Param.prototype.linearRampToValue=function(t,e,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(t,i+this.toSeconds(e)),this},t.Param.prototype.setTargetAtTime=function(t,e,i){return t=this._fromUnits(t),t=Math.max(this._minOutput,t),i=Math.max(this._minOutput,i),this._param.setTargetAtTime(t,this.toSeconds(e),i),this},t.Param.prototype.setValueCurveAtTime=function(t,e,i){for(var r=0;r<t.length;r++)t[r]=this._fromUnits(t[r]);return this._param.setValueCurveAtTime(t,this.toSeconds(e),this.toSeconds(i)),this},t.Param.prototype.cancelScheduledValues=function(t){return this._param.cancelScheduledValues(this.toSeconds(t)),this},t.Param.prototype.rampTo=function(e,i,r){return i=this.defaultArg(i,0),this.units===t.Type.Frequency||this.units===t.Type.BPM||this.units===t.Type.Decibels?this.exponentialRampToValue(e,i,r):this.linearRampToValue(e,i,r),this},Object.defineProperty(t.Param.prototype,"lfo",{get:function(){return this._lfo}}),t.Param.prototype.dispose=function(){return t.prototype.dispose.call(this),this._param=null,this._lfo&&(this._lfo.dispose(),this._lfo=null),this},t.Param}),t(function(t){return window.GainNode&&!AudioContext.prototype.createGain&&(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),t.Gain=function(){var e=this.optionsObject(arguments,["gain","units"],t.Gain.defaults);this.input=this.output=this._gainNode=this.context.createGain(),this.gain=new t.Param({param:this._gainNode.gain,units:e.units,value:e.gain,convert:e.convert}),this._readOnly("gain")},t.extend(t.Gain),t.Gain.defaults={gain:1,convert:!0},t.Gain.prototype.dispose=function(){t.Param.prototype.dispose.call(this),this._gainNode.disconnect(),this._gainNode=null,this._writable("gain"),this.gain.dispose(),this.gain=null},t.prototype.createInsOuts=function(e,i){1===e?this.input=new t.Gain:e>1&&(this.input=new Array(e)),1===i?this.output=new t.Gain:i>1&&(this.output=new Array(e))},t.Gain}),t(function(t){return t.Signal=function(){var e=this.optionsObject(arguments,["value","units"],t.Signal.defaults);this.output=this._gain=this.context.createGain(),e.param=this._gain.gain,t.Param.call(this,e),this.input=this._param=this._gain.gain,this.context.getConstant(1).chain(this._gain)},t.extend(t.Signal,t.Param),t.Signal.defaults={value:0,units:t.Type.Default,convert:!0},t.Signal.prototype.connect=t.SignalBase.prototype.connect,t.Signal.prototype.dispose=function(){return t.Param.prototype.dispose.call(this),this._param=null,this._gain.disconnect(),this._gain=null,this},t.Signal}),t(function(t){return t.Timeline=function(){var e=this.optionsObject(arguments,["memory"],t.Timeline.defaults);this._timeline=[],this._toRemove=[],this._iterating=!1,this.memory=e.memory},t.extend(t.Timeline),t.Timeline.defaults={memory:1/0},Object.defineProperty(t.Timeline.prototype,"length",{get:function(){return this._timeline.length}}),t.Timeline.prototype.add=function(t){if(this.isUndef(t.time))throw new Error("Tone.Timeline: events must have a time attribute");if(this._timeline.length){var e=this._search(t.time);this._timeline.splice(e+1,0,t)}else this._timeline.push(t);if(this.length>this.memory){var i=this.length-this.memory;this._timeline.splice(0,i)}return this},t.Timeline.prototype.remove=function(t){if(this._iterating)this._toRemove.push(t);else{var e=this._timeline.indexOf(t);-1!==e&&this._timeline.splice(e,1)}return this},t.Timeline.prototype.get=function(t){var e=this._search(t);return-1!==e?this._timeline[e]:null},t.Timeline.prototype.peek=function(){return this._timeline[0]},t.Timeline.prototype.shift=function(){return this._timeline.shift()},t.Timeline.prototype.getAfter=function(t){var e=this._search(t);return e+1<this._timeline.length?this._timeline[e+1]:null},t.Timeline.prototype.getBefore=function(t){var e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];var i=this._search(t);return i-1>=0?this._timeline[i-1]:null},t.Timeline.prototype.cancel=function(t){if(this._timeline.length>1){var e=this._search(t);if(e>=0)if(this._timeline[e].time===t){for(var i=e;i>=0&&this._timeline[i].time===t;i--)e=i;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&this._timeline[0].time>=t&&(this._timeline=[]);return this},t.Timeline.prototype.cancelBefore=function(t){if(this._timeline.length){var e=this._search(t);e>=0&&(this._timeline=this._timeline.slice(e+1))}return this},t.Timeline.prototype._search=function(t){var e=0,i=this._timeline.length,r=i;if(i>0&&this._timeline[i-1].time<=t)return i-1;for(;e<r;){var n=Math.floor(e+(r-e)/2),o=this._timeline[n],s=this._timeline[n+1];if(o.time===t){for(var a=n;a<this._timeline.length;a++){this._timeline[a].time===t&&(n=a)}return n}if(o.time<t&&s.time>t)return n;o.time>t?r=n:o.time<t&&(e=n+1)}return-1},t.Timeline.prototype._iterate=function(t,e,i){this._iterating=!0,e=this.defaultArg(e,0),i=this.defaultArg(i,this._timeline.length-1);for(var r=e;r<=i;r++)t(this._timeline[r]);if(this._iterating=!1,this._toRemove.length>0){for(var n=0;n<this._toRemove.length;n++){var o=this._timeline.indexOf(this._toRemove[n]);-1!==o&&this._timeline.splice(o,1)}this._toRemove=[]}},t.Timeline.prototype.forEach=function(t){return this._iterate(t),this},t.Timeline.prototype.forEachBefore=function(t,e){var i=this._search(t);return-1!==i&&this._iterate(e,0,i),this},t.Timeline.prototype.forEachAfter=function(t,e){var i=this._search(t);return this._iterate(e,i+1),this},t.Timeline.prototype.forEachFrom=function(t,e){for(var i=this._search(t);i>=0&&this._timeline[i].time>=t;)i--;return this._iterate(e,i+1),this},t.Timeline.prototype.forEachAtTime=function(t,e){var i=this._search(t);return-1!==i&&this._iterate(function(i){i.time===t&&e(i)},0,i),this},t.Timeline.prototype.dispose=function(){t.prototype.dispose.call(this),this._timeline=null,this._toRemove=null},t.Timeline}),t(function(t){return t.TimelineSignal=function(){var e=this.optionsObject(arguments,["value","units"],t.Signal.defaults);this._events=new t.Timeline(10),t.Signal.apply(this,e),e.param=this._param,t.Param.call(this,e),this._initial=this._fromUnits(this._param.value)},t.extend(t.TimelineSignal,t.Param),t.TimelineSignal.Type={Linear:"linear",Exponential:"exponential",Target:"target",Curve:"curve",Set:"set"},Object.defineProperty(t.TimelineSignal.prototype,"value",{get:function(){var t=this.now(),e=this.getValueAtTime(t);return this._toUnits(e)},set:function(t){var e=this._fromUnits(t);this._initial=e,this.cancelScheduledValues(),this._param.value=e}}),t.TimelineSignal.prototype.setValueAtTime=function(e,i){return e=this._fromUnits(e),i=this.toSeconds(i),this._events.add({type:t.TimelineSignal.Type.Set,value:e,time:i}),this._param.setValueAtTime(e,i),this},t.TimelineSignal.prototype.linearRampToValueAtTime=function(e,i){return e=this._fromUnits(e),i=this.toSeconds(i),this._events.add({type:t.TimelineSignal.Type.Linear,value:e,time:i}),this._param.linearRampToValueAtTime(e,i),this},t.TimelineSignal.prototype.exponentialRampToValueAtTime=function(e,i){i=this.toSeconds(i);var r=this._searchBefore(i);r&&0===r.value&&this.setValueAtTime(this._minOutput,r.time),e=this._fromUnits(e);var n=Math.max(e,this._minOutput);return this._events.add({type:t.TimelineSignal.Type.Exponential,value:n,time:i}),e<this._minOutput?(this._param.exponentialRampToValueAtTime(this._minOutput,i-this.sampleTime),this.setValueAtTime(0,i)):this._param.exponentialRampToValueAtTime(e,i),this},t.TimelineSignal.prototype.setTargetAtTime=function(e,i,r){return e=this._fromUnits(e),e=Math.max(this._minOutput,e),r=Math.max(this._minOutput,r),i=this.toSeconds(i),this._events.add({type:t.TimelineSignal.Type.Target,value:e,time:i,constant:r}),this._param.setTargetAtTime(e,i,r),this},t.TimelineSignal.prototype.setValueCurveAtTime=function(e,i,r,n){n=this.defaultArg(n,1);for(var o=new Array(e.length),s=0;s<o.length;s++)o[s]=this._fromUnits(e[s])*n;i=this.toSeconds(i),r=this.toSeconds(r),this._events.add({type:t.TimelineSignal.Type.Curve,value:o,time:i,duration:r}),this._param.setValueAtTime(o[0],i);for(var a=1;a<o.length;a++){var h=i+a/(o.length-1)*r;this._param.linearRampToValueAtTime(o[a],h)}return this},t.TimelineSignal.prototype.cancelScheduledValues=function(t){return t=this.toSeconds(t),this._events.cancel(t),this._param.cancelScheduledValues(t),this},t.TimelineSignal.prototype.setRampPoint=function(e){e=this.toSeconds(e);var i=this._toUnits(this.getValueAtTime(e)),r=this._searchBefore(e);if(r&&r.time===e)this.cancelScheduledValues(e+this.sampleTime);else if(r&&r.type===t.TimelineSignal.Type.Curve&&r.time+r.duration>e)this.cancelScheduledValues(e),this.linearRampToValueAtTime(i,e);else{var n=this._searchAfter(e);n&&(this.cancelScheduledValues(e),n.type===t.TimelineSignal.Type.Linear?this.linearRampToValueAtTime(i,e):n.type===t.TimelineSignal.Type.Exponential&&this.exponentialRampToValueAtTime(i,e)),this.setValueAtTime(i,e)}return this},t.TimelineSignal.prototype.linearRampToValueBetween=function(t,e,i){return this.setRampPoint(e),this.linearRampToValueAtTime(t,i),this},t.TimelineSignal.prototype.exponentialRampToValueBetween=function(t,e,i){return this.setRampPoint(e),this.exponentialRampToValueAtTime(t,i),this},t.TimelineSignal.prototype._searchBefore=function(t){return this._events.get(t)},t.TimelineSignal.prototype._searchAfter=function(t){return this._events.getAfter(t)},t.TimelineSignal.prototype.getValueAtTime=function(e){e=this.toSeconds(e);var i=this._searchAfter(e),r=this._searchBefore(e),n=this._initial;if(null===r)n=this._initial;else if(r.type===t.TimelineSignal.Type.Target){var o,s=this._events.getBefore(r.time);o=null===s?this._initial:s.value,n=this._exponentialApproach(r.time,o,r.value,r.constant,e)}else n=r.type===t.TimelineSignal.Type.Curve?this._curveInterpolate(r.time,r.value,r.duration,e):null===i?r.value:i.type===t.TimelineSignal.Type.Linear?this._linearInterpolate(r.time,r.value,i.time,i.value,e):i.type===t.TimelineSignal.Type.Exponential?this._exponentialInterpolate(r.time,r.value,i.time,i.value,e):r.value;return n},t.TimelineSignal.prototype.connect=t.SignalBase.prototype.connect,t.TimelineSignal.prototype._exponentialApproach=function(t,e,i,r,n){return i+(e-i)*Math.exp(-(n-t)/r)},t.TimelineSignal.prototype._linearInterpolate=function(t,e,i,r,n){return e+(n-t)/(i-t)*(r-e)},t.TimelineSignal.prototype._exponentialInterpolate=function(t,e,i,r,n){return(e=Math.max(this._minOutput,e))*Math.pow(r/e,(n-t)/(i-t))},t.TimelineSignal.prototype._curveInterpolate=function(t,e,i,r){var n=e.length;if(r>=t+i)return e[n-1];if(r<=t)return e[0];var o=(r-t)/i,s=Math.floor((n-1)*o),a=Math.ceil((n-1)*o),h=e[s],l=e[a];return a===s?h:this._linearInterpolate(s,h,a,l,o*(n-1))},t.TimelineSignal.prototype.dispose=function(){t.Signal.prototype.dispose.call(this),t.Param.prototype.dispose.call(this),this._events.dispose(),this._events=null},t.TimelineSignal}),t(function(t){return t.Pow=function(e){this._exp=this.defaultArg(e,1),this._expScaler=this.input=this.output=new t.WaveShaper(this._expFunc(this._exp),8192)},t.extend(t.Pow,t.SignalBase),Object.defineProperty(t.Pow.prototype,"value",{get:function(){return this._exp},set:function(t){this._exp=t,this._expScaler.setMap(this._expFunc(this._exp))}}),t.Pow.prototype._expFunc=function(t){return function(e){return Math.pow(Math.abs(e),t)}},t.Pow.prototype.dispose=function(){return t.prototype.dispose.call(this),this._expScaler.dispose(),this._expScaler=null,this},t.Pow}),t(function(t){return t.Envelope=function(){var e=this.optionsObject(arguments,["attack","decay","sustain","release"],t.Envelope.defaults);this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this._attackCurve="linear",this._releaseCurve="exponential",this._sig=this.output=new t.TimelineSignal,this._sig.setValueAtTime(0,0),this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve},t.extend(t.Envelope),t.Envelope.defaults={attack:.01,decay:.1,sustain:.5,release:1,attackCurve:"linear",releaseCurve:"exponential"},Object.defineProperty(t.Envelope.prototype,"value",{get:function(){return this.getValueAtTime(this.now())}}),Object.defineProperty(t.Envelope.prototype,"attackCurve",{get:function(){if(this.isString(this._attackCurve))return this._attackCurve;if(this.isArray(this._attackCurve)){for(var e in t.Envelope.Type)if(t.Envelope.Type[e].In===this._attackCurve)return e;return this._attackCurve}},set:function(e){if(t.Envelope.Type.hasOwnProperty(e)){var i=t.Envelope.Type[e];this.isObject(i)?this._attackCurve=i.In:this._attackCurve=i}else{if(!this.isArray(e))throw new Error("Tone.Envelope: invalid curve: "+e);this._attackCurve=e}}}),Object.defineProperty(t.Envelope.prototype,"releaseCurve",{get:function(){if(this.isString(this._releaseCurve))return this._releaseCurve;if(this.isArray(this._releaseCurve)){for(var e in t.Envelope.Type)if(t.Envelope.Type[e].Out===this._releaseCurve)return e;return this._releaseCurve}},set:function(e){if(t.Envelope.Type.hasOwnProperty(e)){var i=t.Envelope.Type[e];this.isObject(i)?this._releaseCurve=i.Out:this._releaseCurve=i}else{if(!this.isArray(e))throw new Error("Tone.Envelope: invalid curve: "+e);this._releaseCurve=e}}}),t.Envelope.prototype.triggerAttack=function(t,e){t=this.toSeconds(t);var i=this.toSeconds(this.attack),r=i,n=this.toSeconds(this.decay);e=this.defaultArg(e,1);var o=this.getValueAtTime(t);if(o>0){r=(1-o)/(1/r)}if("linear"===this._attackCurve)this._sig.linearRampToValue(e,r,t);else if("exponential"===this._attackCurve)this._sig.exponentialRampToValue(e,r,t);else if(r>0){this._sig.setRampPoint(t);var s=this._attackCurve;if(r<i){var a=1-r/i,h=Math.floor(a*this._attackCurve.length);s=this._attackCurve.slice(h),s[0]=o}this._sig.setValueCurveAtTime(s,t,r,e)}return this._sig.exponentialRampToValue(e*this.sustain,n,r+t),this},t.Envelope.prototype.triggerRelease=function(t){t=this.toSeconds(t);var e=this.getValueAtTime(t);if(e>0){var i=this.toSeconds(this.release);if("linear"===this._releaseCurve)this._sig.linearRampToValue(0,i,t);else if("exponential"===this._releaseCurve)this._sig.exponentialRampToValue(0,i,t);else{var r=this._releaseCurve;this.isArray(r)&&(this._sig.setRampPoint(t),this._sig.setValueCurveAtTime(r,t,i,e))}}return this},t.Envelope.prototype.getValueAtTime=function(t){return this._sig.getValueAtTime(t)},t.Envelope.prototype.triggerAttackRelease=function(t,e,i){return e=this.toSeconds(e),this.triggerAttack(e,i),this.triggerRelease(e+this.toSeconds(t)),this},t.Envelope.prototype.cancel=function(t){return this._sig.cancelScheduledValues(t),this},t.Envelope.prototype.connect=t.Signal.prototype.connect,function(){function e(t){for(var e=new Array(t.length),i=0;i<t.length;i++)e[i]=1-t[i];return e}var i,r,n=[];for(i=0;i<128;i++)n[i]=Math.sin(i/127*(Math.PI/2));var o=[];for(i=0;i<127;i++){r=i/127;var s=Math.sin(r*(2*Math.PI)*6.4-Math.PI/2)+1;o[i]=s/10+.83*r}o[127]=1;var a=[];for(i=0;i<128;i++)a[i]=Math.ceil(i/127*5)/5;var h=[];for(i=0;i<128;i++)r=i/127,h[i]=.5*(1-Math.cos(Math.PI*r));var l=[];for(i=0;i<128;i++){r=i/127;var u=4*Math.pow(r,3)+.2,p=Math.cos(u*Math.PI*2*r);l[i]=Math.abs(p*(1-r))}t.Envelope.Type={linear:"linear",exponential:"exponential",bounce:{In:e(l),Out:l},cosine:{In:n,Out:function(t){return t.slice(0).reverse()}(n)},step:{In:a,Out:e(a)},ripple:{In:o,Out:e(o)},sine:{In:h,Out:e(h)}}}(),t.Envelope.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sig.dispose(),this._sig=null,this._attackCurve=null,this._releaseCurve=null,this},t.Envelope}),t(function(t){return t.AmplitudeEnvelope=function(){t.Envelope.apply(this,arguments),this.input=this.output=new t.Gain,this._sig.connect(this.output.gain)},t.extend(t.AmplitudeEnvelope,t.Envelope),t.AmplitudeEnvelope.prototype.dispose=function(){return this.input.dispose(),this.input=null,t.Envelope.prototype.dispose.call(this),this},t.AmplitudeEnvelope}),t(function(t){return window.AnalyserNode&&!AnalyserNode.prototype.getFloatTimeDomainData&&(AnalyserNode.prototype.getFloatTimeDomainData=function(t){var e=new Uint8Array(t.length);this.getByteTimeDomainData(e);for(var i=0;i<e.length;i++)t[i]=(e[i]-128)/128}),t.Analyser=function(){var e=this.optionsObject(arguments,["type","size"],t.Analyser.defaults);this._analyser=this.input=this.output=this.context.createAnalyser(),this._type=e.type,this._returnType=e.returnType,this._buffer=null,this.size=e.size,this.type=e.type,this.returnType=e.returnType,this.minDecibels=e.minDecibels,this.maxDecibels=e.maxDecibels},t.extend(t.Analyser),t.Analyser.defaults={size:1024,returnType:"byte",type:"fft",smoothing:.8,maxDecibels:-30,minDecibels:-100},t.Analyser.Type={Waveform:"waveform",FFT:"fft"},t.Analyser.ReturnType={Byte:"byte",Float:"float"},t.Analyser.prototype.analyse=function(){return this._type===t.Analyser.Type.FFT?this._returnType===t.Analyser.ReturnType.Byte?this._analyser.getByteFrequencyData(this._buffer):this._analyser.getFloatFrequencyData(this._buffer):this._type===t.Analyser.Type.Waveform&&(this._returnType===t.Analyser.ReturnType.Byte?this._analyser.getByteTimeDomainData(this._buffer):this._analyser.getFloatTimeDomainData(this._buffer)),this._buffer},Object.defineProperty(t.Analyser.prototype,"size",{get:function(){return this._analyser.frequencyBinCount},set:function(t){this._analyser.fftSize=2*t,this.type=this._type}}),Object.defineProperty(t.Analyser.prototype,"returnType",{get:function(){return this._returnType},set:function(e){if(e===t.Analyser.ReturnType.Byte)this._buffer=new Uint8Array(this._analyser.frequencyBinCount);else{if(e!==t.Analyser.ReturnType.Float)throw new TypeError("Tone.Analayser: invalid return type: "+e);this._buffer=new Float32Array(this._analyser.frequencyBinCount)}this._returnType=e}}),Object.defineProperty(t.Analyser.prototype,"type",{get:function(){return this._type},set:function(e){if(e!==t.Analyser.Type.Waveform&&e!==t.Analyser.Type.FFT)throw new TypeError("Tone.Analyser: invalid type: "+e);this._type=e}}),Object.defineProperty(t.Analyser.prototype,"smoothing",{get:function(){return this._analyser.smoothingTimeConstant},set:function(t){this._analyser.smoothingTimeConstant=t}}),Object.defineProperty(t.Analyser.prototype,"minDecibels",{get:function(){return this._analyser.minDecibels},set:function(t){this._analyser.minDecibels=t}}),Object.defineProperty(t.Analyser.prototype,"maxDecibels",{get:function(){return this._analyser.maxDecibels},set:function(t){this._analyser.maxDecibels=t}}),t.Analyser.prototype.dispose=function(){t.prototype.dispose.call(this),this._analyser.disconnect(),this._analyser=null,this._buffer=null},t.Analyser}),t(function(t){return t.Compressor=function(){var e=this.optionsObject(arguments,["threshold","ratio"],t.Compressor.defaults);this._compressor=this.input=this.output=this.context.createDynamicsCompressor(),this.threshold=new t.Param({param:this._compressor.threshold,units:t.Type.Decibels,convert:!1}),this.attack=new t.Param(this._compressor.attack,t.Type.Time),this.release=new t.Param(this._compressor.release,t.Type.Time),this.knee=new t.Param({param:this._compressor.knee,units:t.Type.Decibels,convert:!1}),this.ratio=new t.Param({param:this._compressor.ratio,convert:!1}),this._readOnly(["knee","release","attack","ratio","threshold"]),this.set(e)},t.extend(t.Compressor),t.Compressor.defaults={ratio:12,threshold:-24,release:.25,attack:.003,knee:30},t.Compressor.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["knee","release","attack","ratio","threshold"]),this._compressor.disconnect(),this._compressor=null,this.attack.dispose(),this.attack=null,this.release.dispose(),this.release=null,this.threshold.dispose(),this.threshold=null,this.ratio.dispose(),this.ratio=null,this.knee.dispose(),this.knee=null,this},t.Compressor}),t(function(t){return t.Add=function(e){this.createInsOuts(2,0),this._sum=this.input[0]=this.input[1]=this.output=new t.Gain,this._param=this.input[1]=new t.Signal(e),this._param.connect(this._sum)},t.extend(t.Add,t.Signal),t.Add.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sum.dispose(),this._sum=null,this._param.dispose(),this._param=null,this},t.Add}),t(function(t){return t.Multiply=function(e){this.createInsOuts(2,0),this._mult=this.input[0]=this.output=new t.Gain,this._param=this.input[1]=this.output.gain,this._param.value=this.defaultArg(e,0)},t.extend(t.Multiply,t.Signal),t.Multiply.prototype.dispose=function(){return t.prototype.dispose.call(this),this._mult.dispose(),this._mult=null,this._param=null,this},t.Multiply}),t(function(t){return t.Negate=function(){this._multiply=this.input=this.output=new t.Multiply(-1)},t.extend(t.Negate,t.SignalBase),t.Negate.prototype.dispose=function(){return t.prototype.dispose.call(this),this._multiply.dispose(),this._multiply=null,this},t.Negate}),t(function(t){return t.Subtract=function(e){this.createInsOuts(2,0),this._sum=this.input[0]=this.output=new t.Gain,this._neg=new t.Negate,this._param=this.input[1]=new t.Signal(e),this._param.chain(this._neg,this._sum)},t.extend(t.Subtract,t.Signal),t.Subtract.prototype.dispose=function(){return t.prototype.dispose.call(this),this._neg.dispose(),this._neg=null,this._sum.disconnect(),this._sum=null,this._param.dispose(),this._param=null,this},t.Subtract}),t(function(t){return t.GreaterThanZero=function(){this._thresh=this.output=new t.WaveShaper(function(t){return t<=0?0:1},127),this._scale=this.input=new t.Multiply(1e4),this._scale.connect(this._thresh)},t.extend(t.GreaterThanZero,t.SignalBase),t.GreaterThanZero.prototype.dispose=function(){return t.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._thresh.dispose(),this._thresh=null,this},t.GreaterThanZero}),t(function(t){return t.GreaterThan=function(e){this.createInsOuts(2,0),this._param=this.input[0]=new t.Subtract(e),this.input[1]=this._param.input[1],this._gtz=this.output=new t.GreaterThanZero,this._param.connect(this._gtz)},t.extend(t.GreaterThan,t.Signal),t.GreaterThan.prototype.dispose=function(){return t.prototype.dispose.call(this),this._param.dispose(),this._param=null,this._gtz.dispose(),this._gtz=null,this},t.GreaterThan}),t(function(t){return t.Abs=function(){this._abs=this.input=this.output=new t.WaveShaper(function(t){return 0===t?0:Math.abs(t)},127)},t.extend(t.Abs,t.SignalBase),t.Abs.prototype.dispose=function(){return t.prototype.dispose.call(this),this._abs.dispose(),this._abs=null,this},t.Abs}),t(function(t){return t.Modulo=function(e){this.createInsOuts(1,0),this._shaper=new t.WaveShaper(Math.pow(2,16)),this._multiply=new t.Multiply,this._subtract=this.output=new t.Subtract,this._modSignal=new t.Signal(e),this.input.fan(this._shaper,this._subtract),this._modSignal.connect(this._multiply,0,0),this._shaper.connect(this._multiply,0,1),this._multiply.connect(this._subtract,0,1),this._setWaveShaper(e)},t.extend(t.Modulo,t.SignalBase),t.Modulo.prototype._setWaveShaper=function(t){this._shaper.setMap(function(e){return Math.floor((e+1e-4)/t)})},Object.defineProperty(t.Modulo.prototype,"value",{get:function(){return this._modSignal.value},set:function(t){this._modSignal.value=t,this._setWaveShaper(t)}}),t.Modulo.prototype.dispose=function(){return t.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this._multiply.dispose(),this._multiply=null,this._subtract.dispose(),this._subtract=null,this._modSignal.dispose(),this._modSignal=null,this},t.Modulo}),t(function(t){return t.AudioToGain=function(){this._norm=this.input=this.output=new t.WaveShaper(function(t){return(t+1)/2})},t.extend(t.AudioToGain,t.SignalBase),t.AudioToGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},t.AudioToGain}),t(function(t){function e(t,e,i){var r=new t;return i._eval(e[0]).connect(r,0,0),i._eval(e[1]).connect(r,0,1),r}function i(t,e,i){var r=new t;return i._eval(e[0]).connect(r,0,0),r}function r(t){return t?parseFloat(t):void 0}function n(t){return t&&t.args?parseFloat(t.args):void 0}return t.Expr=function(){var t=this._replacements(Array.prototype.slice.call(arguments)),e=this._parseInputs(t);this._nodes=[],this.input=new Array(e);for(var i=0;i<e;i++)this.input[i]=this.context.createGain();var r,n=this._parseTree(t);try{r=this._eval(n)}catch(e){throw this._disposeNodes(),new Error("Tone.Expr: Could evaluate expression: "+t)}this.output=r},t.extend(t.Expr,t.SignalBase),t.Expr._Expressions={value:{signal:{regexp:/^\d+\.\d+|^\d+/,method:function(e){return new t.Signal(r(e))}},input:{regexp:/^\$\d/,method:function(t,e){return e.input[r(t.substr(1))]}}},glue:{"(":{regexp:/^\(/},")":{regexp:/^\)/},",":{regexp:/^,/}},func:{abs:{regexp:/^abs/,method:i.bind(this,t.Abs)},mod:{regexp:/^mod/,method:function(e,i){var r=n(e[1]),o=new t.Modulo(r);return i._eval(e[0]).connect(o),o}},pow:{regexp:/^pow/,method:function(e,i){var r=n(e[1]),o=new t.Pow(r);return i._eval(e[0]).connect(o),o}},a2g:{regexp:/^a2g/,method:function(e,i){var r=new t.AudioToGain;return i._eval(e[0]).connect(r),r}}},binary:{"+":{regexp:/^\+/,precedence:1,method:e.bind(this,t.Add)},"-":{regexp:/^\-/,precedence:1,method:function(r,n){return 1===r.length?i(t.Negate,r,n):e(t.Subtract,r,n)}},"*":{regexp:/^\*/,precedence:0,method:e.bind(this,t.Multiply)}},unary:{"-":{regexp:/^\-/,method:i.bind(this,t.Negate)},"!":{regexp:/^\!/,method:i.bind(this,t.NOT)}}},t.Expr.prototype._parseInputs=function(t){var e=t.match(/\$\d/g),i=0;if(null!==e)for(var r=0;r<e.length;r++){var n=parseInt(e[r].substr(1))+1;i=Math.max(i,n)}return i},t.Expr.prototype._replacements=function(t){for(var e=t.shift(),i=0;i<t.length;i++)e=e.replace(/\%/i,t[i]);return e},t.Expr.prototype._tokenize=function(e){for(var i=-1,r=[];e.length>0;){e=e.trim();var n=function(e){for(var i in t.Expr._Expressions){var r=t.Expr._Expressions[i];for(var n in r){var o=r[n],s=o.regexp,a=e.match(s);if(null!==a)return{type:i,value:a[0],method:o.method}}}throw new SyntaxError("Tone.Expr: Unexpected token "+e)}(e);r.push(n),e=e.substr(n.value.length)}return{next:function(){return r[++i]},peek:function(){return r[i+1]}}},t.Expr.prototype._parseTree=function(e){function i(t,e){return!u(t)&&"glue"===t.type&&t.value===e}function r(e,i,r){var n=t.Expr._Expressions[i];if(!u(e))for(var o in n){var s=n[o];if(s.regexp.test(e.value)){if(u(r))return!0;if(s.precedence===r)return!0}}return!1}function n(t){u(t)&&(t=5);var e;e=t<0?o():n(t-1);for(var i=l.peek();r(i,"binary",t);)i=l.next(),e={operator:i.value,method:i.method,args:[e,n(t-1)]},i=l.peek();return e}function o(){var t,e;return t=l.peek(),r(t,"unary")?(t=l.next(),e=o(),{operator:t.value,method:t.method,args:[e]}):s()}function s(){var t,e;if(t=l.peek(),u(t))throw new SyntaxError("Tone.Expr: Unexpected termination of expression");if("func"===t.type)return t=l.next(),a(t);if("value"===t.type)return t=l.next(),{method:t.method,args:t.value};if(i(t,"(")){if(l.next(),e=n(),t=l.next(),!i(t,")"))throw new SyntaxError("Expected )");return e}throw new SyntaxError("Tone.Expr: Parse error, cannot process token "+t.value)}function a(t){var e,r=[];if(e=l.next(),!i(e,"("))throw new SyntaxError('Tone.Expr: Expected ( in a function call "'+t.value+'"');if(e=l.peek(),i(e,")")||(r=h()),e=l.next(),!i(e,")"))throw new SyntaxError('Tone.Expr: Expected ) in a function call "'+t.value+'"');return{method:t.method,args:r,name:name}}function h(){for(var t,e,r=[];;){if(e=n(),u(e))break;if(r.push(e),t=l.peek(),!i(t,","))break;l.next()}return r}var l=this._tokenize(e),u=this.isUndef.bind(this);return n()},t.Expr.prototype._eval=function(t){if(!this.isUndef(t)){var e=t.method(t.args,this);return this._nodes.push(e),e}},t.Expr.prototype._disposeNodes=function(){for(var t=0;t<this._nodes.length;t++){var e=this._nodes[t];this.isFunction(e.dispose)?e.dispose():this.isFunction(e.disconnect)&&e.disconnect(),e=null,this._nodes[t]=null}this._nodes=null},t.Expr.prototype.dispose=function(){t.prototype.dispose.call(this),this._disposeNodes()},t.Expr}),t(function(t){return t.EqualPowerGain=function(){this._eqPower=this.input=this.output=new t.WaveShaper(function(t){return Math.abs(t)<.001?0:this.equalPowerScale(t)}.bind(this),4096)},t.extend(t.EqualPowerGain,t.SignalBase),t.EqualPowerGain.prototype.dispose=function(){return t.prototype.dispose.call(this),this._eqPower.dispose(),this._eqPower=null,this},t.EqualPowerGain}),t(function(t){return t.CrossFade=function(e){this.createInsOuts(2,1),this.a=this.input[0]=new t.Gain,this.b=this.input[1]=new t.Gain,this.fade=new t.Signal(this.defaultArg(e,.5),t.Type.NormalRange),this._equalPowerA=new t.EqualPowerGain,this._equalPowerB=new t.EqualPowerGain,this._invert=new t.Expr("1 - $0"),this.a.connect(this.output),this.b.connect(this.output),this.fade.chain(this._equalPowerB,this.b.gain),this.fade.chain(this._invert,this._equalPowerA,this.a.gain),this._readOnly("fade")},t.extend(t.CrossFade),t.CrossFade.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("fade"),this._equalPowerA.dispose(),this._equalPowerA=null,this._equalPowerB.dispose(),this._equalPowerB=null,this.fade.dispose(),this.fade=null,this._invert.dispose(),this._invert=null,this.a.dispose(),this.a=null,this.b.dispose(),this.b=null,this},t.CrossFade}),t(function(t){return t.Filter=function(){this.createInsOuts(1,1);var e=this.optionsObject(arguments,["frequency","type","rolloff"],t.Filter.defaults);this._filters=[],this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=new t.Signal(0,t.Type.Cents),this.gain=new t.Signal({value:e.gain,convert:!1}),this.Q=new t.Signal(e.Q),this._type=e.type,this._rolloff=e.rolloff,this.rolloff=e.rolloff,this._readOnly(["detune","frequency","gain","Q"])},t.extend(t.Filter),t.Filter.defaults={type:"lowpass",frequency:350,rolloff:-12,Q:1,gain:0},Object.defineProperty(t.Filter.prototype,"type",{get:function(){return this._type},set:function(t){if(-1===["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t))throw new TypeError("Tone.Filter: invalid type "+t);this._type=t;for(var e=0;e<this._filters.length;e++)this._filters[e].type=t}}),Object.defineProperty(t.Filter.prototype,"rolloff",{get:function(){return this._rolloff},set:function(t){t=parseInt(t,10);var e=[-12,-24,-48,-96],i=e.indexOf(t);if(-1===i)throw new RangeError("Tone.Filter: rolloff can only be -12, -24, -48 or -96");i+=1,this._rolloff=t,this.input.disconnect();for(var r=0;r<this._filters.length;r++)this._filters[r].disconnect(),this._filters[r]=null;this._filters=new Array(i);for(var n=0;n<i;n++){var o=this.context.createBiquadFilter();o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[n]=o}var s=[this.input].concat(this._filters).concat([this.output]);this.connectSeries.apply(this,s)}}),t.Filter.prototype.dispose=function(){t.prototype.dispose.call(this);for(var e=0;e<this._filters.length;e++)this._filters[e].disconnect(),this._filters[e]=null;return this._filters=null,this._writable(["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.frequency=null,this.Q=null,this.detune.dispose(),this.detune=null,this.gain.dispose(),this.gain=null,this},t.Filter}),t(function(t){return t.MultibandSplit=function(){var e=this.optionsObject(arguments,["lowFrequency","highFrequency"],t.MultibandSplit.defaults);this.input=new t.Gain,this.output=new Array(3),this.low=this.output[0]=new t.Filter(0,"lowpass"),this._lowMidFilter=new t.Filter(0,"highpass"),this.mid=this.output[1]=new t.Filter(0,"lowpass"),this.high=this.output[2]=new t.Filter(0,"highpass"),this.lowFrequency=new t.Signal(e.lowFrequency,t.Type.Frequency),this.highFrequency=new t.Signal(e.highFrequency,t.Type.Frequency),this.Q=new t.Signal(e.Q),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.connect(this.low.frequency),this.lowFrequency.connect(this._lowMidFilter.frequency),this.highFrequency.connect(this.mid.frequency),this.highFrequency.connect(this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},t.extend(t.MultibandSplit),t.MultibandSplit.defaults={lowFrequency:400,highFrequency:2500,Q:1},t.MultibandSplit.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.low=null,this._lowMidFilter.dispose(),this._lowMidFilter=null,this.mid.dispose(),this.mid=null,this.high.dispose(),this.high=null,this.lowFrequency.dispose(),this.lowFrequency=null,this.highFrequency.dispose(),this.highFrequency=null,this.Q.dispose(),this.Q=null,this},t.MultibandSplit}),t(function(t){return t.EQ3=function(){var e=this.optionsObject(arguments,["low","mid","high"],t.EQ3.defaults);this.output=new t.Gain,this._multibandSplit=this.input=new t.MultibandSplit({lowFrequency:e.lowFrequency,highFrequency:e.highFrequency}),this._lowGain=new t.Gain(e.low,t.Type.Decibels),this._midGain=new t.Gain(e.mid,t.Type.Decibels),this._highGain=new t.Gain(e.high,t.Type.Decibels),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),this._readOnly(["low","mid","high","lowFrequency","highFrequency"])},t.extend(t.EQ3),t.EQ3.defaults={low:0,mid:0,high:0,lowFrequency:400,highFrequency:2500},t.EQ3.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this._multibandSplit=null,this.lowFrequency=null,this.highFrequency=null,this._lowGain.dispose(),this._lowGain=null,this._midGain.dispose(),this._midGain=null,this._highGain.dispose(),this._highGain=null,this.low=null,this.mid=null,this.high=null,this.Q=null,this},t.EQ3}),t(function(t){return t.Scale=function(e,i){this._outputMin=this.defaultArg(e,0),this._outputMax=this.defaultArg(i,1),this._scale=this.input=new t.Multiply(1),this._add=this.output=new t.Add(0),this._scale.connect(this._add),this._setRange()},t.extend(t.Scale,t.SignalBase),Object.defineProperty(t.Scale.prototype,"min",{get:function(){return this._outputMin},set:function(t){this._outputMin=t,this._setRange()}}),Object.defineProperty(t.Scale.prototype,"max",{get:function(){return this._outputMax},set:function(t){this._outputMax=t,this._setRange()}}),t.Scale.prototype._setRange=function(){this._add.value=this._outputMin,this._scale.value=this._outputMax-this._outputMin},t.Scale.prototype.dispose=function(){return t.prototype.dispose.call(this),this._add.dispose(),this._add=null,this._scale.dispose(),this._scale=null,this},t.Scale}),t(function(t){return t.ScaleExp=function(e,i,r){this._scale=this.output=new t.Scale(e,i),this._exp=this.input=new t.Pow(this.defaultArg(r,2)),this._exp.connect(this._scale)},t.extend(t.ScaleExp,t.SignalBase),Object.defineProperty(t.ScaleExp.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),Object.defineProperty(t.ScaleExp.prototype,"min",{get:function(){return this._scale.min},set:function(t){this._scale.min=t}}),Object.defineProperty(t.ScaleExp.prototype,"max",{get:function(){return this._scale.max},set:function(t){this._scale.max=t}}),t.ScaleExp.prototype.dispose=function(){return t.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},t.ScaleExp}),t(function(t){return window.DelayNode&&!AudioContext.prototype.createDelay&&(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),t.Delay=function(){var e=this.optionsObject(arguments,["delayTime","maxDelay"],t.Delay.defaults);this._delayNode=this.input=this.output=this.context.createDelay(this.toSeconds(e.maxDelay)),this.delayTime=new t.Param({param:this._delayNode.delayTime,units:t.Type.Time,value:e.delayTime}),this._readOnly("delayTime")},t.extend(t.Delay),t.Delay.defaults={maxDelay:1,delayTime:0},t.Delay.prototype.dispose=function(){return t.Param.prototype.dispose.call(this),this._delayNode.disconnect(),this._delayNode=null,this._writable("delayTime"),this.delayTime=null,this},t.Delay}),t(function(t){return t.FeedbackCombFilter=function(){var e=this.optionsObject(arguments,["delayTime","resonance"],t.FeedbackCombFilter.defaults);this._delay=this.input=this.output=new t.Delay(e.delayTime),this.delayTime=this._delay.delayTime,this._feedback=new t.Gain(e.resonance,t.Type.NormalRange),this.resonance=this._feedback.gain,this._delay.chain(this._feedback,this._delay),this._readOnly(["resonance","delayTime"])},t.extend(t.FeedbackCombFilter),t.FeedbackCombFilter.defaults={delayTime:.1,resonance:.5},t.FeedbackCombFilter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["resonance","delayTime"]),this._delay.dispose(),this._delay=null,this.delayTime=null,this._feedback.dispose(),this._feedback=null,this.resonance=null,this},t.FeedbackCombFilter}),t(function(t){return t.Follower=function(){this.createInsOuts(1,1);var e=this.optionsObject(arguments,["attack","release"],t.Follower.defaults);this._abs=new t.Abs,this._filter=this.context.createBiquadFilter(),this._filter.type="lowpass",this._filter.frequency.value=0,this._filter.Q.value=-100,this._frequencyValues=new t.WaveShaper,this._sub=new t.Subtract,this._delay=new t.Delay(this.blockTime),this._mult=new t.Multiply(1e4),this._attack=e.attack,this._release=e.release,this.input.chain(this._abs,this._filter,this.output),this._abs.connect(this._sub,0,1),this._filter.chain(this._delay,this._sub),this._sub.chain(this._mult,this._frequencyValues,this._filter.frequency),this._setAttackRelease(this._attack,this._release)},t.extend(t.Follower),t.Follower.defaults={attack:.05,release:.5},t.Follower.prototype._setAttackRelease=function(e,i){var r=this.blockTime;e=t.Time(e).toFrequency(),i=t.Time(i).toFrequency(),e=Math.max(e,r),i=Math.max(i,r),this._frequencyValues.setMap(function(t){return t<=0?e:i})},Object.defineProperty(t.Follower.prototype,"attack",{get:function(){return this._attack},set:function(t){this._attack=t,this._setAttackRelease(this._attack,this._release)}}),Object.defineProperty(t.Follower.prototype,"release",{get:function(){return this._release},set:function(t){this._release=t,this._setAttackRelease(this._attack,this._release)}}),t.Follower.prototype.connect=t.Signal.prototype.connect,t.Follower.prototype.dispose=function(){return t.prototype.dispose.call(this),this._filter.disconnect(),this._filter=null,this._frequencyValues.disconnect(),this._frequencyValues=null,this._delay.dispose(),this._delay=null,this._sub.disconnect(),this._sub=null,this._abs.dispose(),this._abs=null,this._mult.dispose(),this._mult=null,this._curve=null,this},t.Follower}),t(function(t){return t.ScaledEnvelope=function(){var e=this.optionsObject(arguments,["attack","decay","sustain","release"],t.Envelope.defaults);t.Envelope.call(this,e),e=this.defaultArg(e,t.ScaledEnvelope.defaults),this._exp=this.output=new t.Pow(e.exponent),this._scale=this.output=new t.Scale(e.min,e.max),this._sig.chain(this._exp,this._scale)},t.extend(t.ScaledEnvelope,t.Envelope),t.ScaledEnvelope.defaults={min:0,max:1,exponent:1},Object.defineProperty(t.ScaledEnvelope.prototype,"min",{get:function(){return this._scale.min},set:function(t){this._scale.min=t}}),Object.defineProperty(t.ScaledEnvelope.prototype,"max",{get:function(){return this._scale.max},set:function(t){this._scale.max=t}}),Object.defineProperty(t.ScaledEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),t.ScaledEnvelope.prototype.dispose=function(){return t.Envelope.prototype.dispose.call(this),this._scale.dispose(),this._scale=null,this._exp.dispose(),this._exp=null,this},t.ScaledEnvelope}),t(function(t){return t.FrequencyEnvelope=function(){var e=this.optionsObject(arguments,["attack","decay","sustain","release"],t.Envelope.defaults);t.ScaledEnvelope.call(this,e),e=this.defaultArg(e,t.FrequencyEnvelope.defaults),this._octaves=e.octaves,this.baseFrequency=e.baseFrequency,this.octaves=e.octaves},t.extend(t.FrequencyEnvelope,t.Envelope),t.FrequencyEnvelope.defaults={baseFrequency:200,octaves:4,exponent:2},Object.defineProperty(t.FrequencyEnvelope.prototype,"baseFrequency",{get:function(){return this._scale.min},set:function(t){this._scale.min=this.toFrequency(t),this.octaves=this._octaves}}),Object.defineProperty(t.FrequencyEnvelope.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._scale.max=this.baseFrequency*Math.pow(2,t)}}),Object.defineProperty(t.FrequencyEnvelope.prototype,"exponent",{get:function(){return this._exp.value},set:function(t){this._exp.value=t}}),t.FrequencyEnvelope.prototype.dispose=function(){return t.ScaledEnvelope.prototype.dispose.call(this),this},t.FrequencyEnvelope}),t(function(t){return t.Gate=function(){this.createInsOuts(1,1);var e=this.optionsObject(arguments,["threshold","attack","release"],t.Gate.defaults);this._follower=new t.Follower(e.attack,e.release),this._gt=new t.GreaterThan(this.dbToGain(e.threshold)),this.input.connect(this.output),this.input.chain(this._gt,this._follower,this.output.gain)},t.extend(t.Gate),t.Gate.defaults={attack:.1,release:.1,threshold:-40},Object.defineProperty(t.Gate.prototype,"threshold",{get:function(){return this.gainToDb(this._gt.value)},set:function(t){this._gt.value=this.dbToGain(t)}}),Object.defineProperty(t.Gate.prototype,"attack",{get:function(){return this._follower.attack},set:function(t){this._follower.attack=t}}),Object.defineProperty(t.Gate.prototype,"release",{get:function(){return this._follower.release},set:function(t){this._follower.release=t}}),t.Gate.prototype.dispose=function(){return t.prototype.dispose.call(this),this._follower.dispose(),this._gt.dispose(),this._follower=null,this._gt=null,this},t.Gate}),t(function(t){return t.TimelineState=function(e){t.Timeline.call(this),this._initial=e},t.extend(t.TimelineState,t.Timeline),t.TimelineState.prototype.getValueAtTime=function(t){var e=this.get(t);return null!==e?e.state:this._initial},t.TimelineState.prototype.setStateAtTime=function(t,e){this.add({state:t,time:e})},t.TimelineState}),t(function(t){return t.Clock=function(){t.Emitter.call(this);var e=this.optionsObject(arguments,["callback","frequency"],t.Clock.defaults);this.callback=e.callback,this._nextTick=0,this._lastState=t.State.Stopped,this.frequency=new t.TimelineSignal(e.frequency,t.Type.Frequency),this._readOnly("frequency"),this.ticks=0,this._state=new t.TimelineState(t.State.Stopped),this._boundLoop=this._loop.bind(this),this.context.on("tick",this._boundLoop)},t.extend(t.Clock,t.Emitter),t.Clock.defaults={callback:t.noOp,frequency:1,lookAhead:"auto"},Object.defineProperty(t.Clock.prototype,"state",{get:function(){return this._state.getValueAtTime(this.now())}}),t.Clock.prototype.start=function(e,i){return e=this.toSeconds(e),this._state.getValueAtTime(e)!==t.State.Started&&this._state.add({state:t.State.Started,time:e,offset:i}),this},t.Clock.prototype.stop=function(e){return e=this.toSeconds(e),this._state.cancel(e),this._state.setStateAtTime(t.State.Stopped,e),this},t.Clock.prototype.pause=function(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)===t.State.Started&&this._state.setStateAtTime(t.State.Paused,e),this},t.Clock.prototype._loop=function(){for(var e=this.now(),i=this.context.lookAhead,r=this.context.updateInterval,n=2*this.context.lag,o=e+i+r+n;o>this._nextTick&&this._state;){var s=this._state.getValueAtTime(this._nextTick);if(s!==this._lastState){this._lastState=s;var a=this._state.get(this._nextTick);s===t.State.Started?(this._nextTick=a.time,this.isUndef(a.offset)||(this.ticks=a.offset),this.emit("start",a.time,this.ticks)):s===t.State.Stopped?(this.ticks=0,this.emit("stop",a.time)):s===t.State.Paused&&this.emit("pause",a.time)}var h=this._nextTick;this.frequency&&(this._nextTick+=1/this.frequency.getValueAtTime(this._nextTick),s===t.State.Started&&(this.callback(h),this.ticks++))}},t.Clock.prototype.getStateAtTime=function(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)},t.Clock.prototype.dispose=function(){t.Emitter.prototype.dispose.call(this),this.context.off("tick",this._boundLoop),this._writable("frequency"),this.frequency.dispose(),this.frequency=null,this._boundLoop=null,this._nextTick=1/0,this.callback=null,this._state.dispose(),this._state=null},t.Clock}),t(function(t){t.IntervalTimeline=function(){this._root=null,this._length=0},t.extend(t.IntervalTimeline),t.IntervalTimeline.prototype.add=function(t){if(this.isUndef(t.time)||this.isUndef(t.duration))throw new Error("Tone.IntervalTimeline: events must have time and duration parameters");var i=new e(t.time,t.time+t.duration,t);for(null===this._root?this._root=i:this._root.insert(i),this._length++;null!==i;)i.updateHeight(),i.updateMax(),this._rebalance(i),i=i.parent;return this},t.IntervalTimeline.prototype.remove=function(t){if(null!==this._root){var e=[];this._root.search(t.time,e);for(var i=0;i<e.length;i++){var r=e[i];if(r.event===t){this._removeNode(r),this._length--;break}}}return this},Object.defineProperty(t.IntervalTimeline.prototype,"length",{get:function(){return this._length}}),t.IntervalTimeline.prototype.cancel=function(t){return this.forEachAfter(t,function(t){this.remove(t)}.bind(this)),this},t.IntervalTimeline.prototype._setRoot=function(t){this._root=t,null!==this._root&&(this._root.parent=null)},t.IntervalTimeline.prototype._replaceNodeInParent=function(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)},t.IntervalTimeline.prototype._removeNode=function(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{var e,i,r=t.getBalance();if(r>0)if(null===t.left.right)e=t.left,e.right=t.right,i=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent.right=e.left,i=e.parent,e.left=t.left,e.right=t.right}else if(null===t.right.left)e=t.right,e.left=t.left,i=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent=e.parent,e.parent.left=e.right,i=e.parent,e.left=t.left,e.right=t.right}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),this._rebalance(i)}t.dispose()},t.IntervalTimeline.prototype._rotateLeft=function(t){var e=t.parent,i=t.isLeftChild(),r=t.right;t.right=r.left,r.left=t,null!==e?i?e.left=r:e.right=r:this._setRoot(r)},t.IntervalTimeline.prototype._rotateRight=function(t){var e=t.parent,i=t.isLeftChild(),r=t.left;t.left=r.right,r.right=t,null!==e?i?e.left=r:e.right=r:this._setRoot(r)},t.IntervalTimeline.prototype._rebalance=function(t){var e=t.getBalance();e>1?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))},t.IntervalTimeline.prototype.get=function(t){if(null!==this._root){var e=[];if(this._root.search(t,e),e.length>0){for(var i=e[0],r=1;r<e.length;r++)e[r].low>i.low&&(i=e[r]);return i.event}}return null},t.IntervalTimeline.prototype.forEach=function(t){if(null!==this._root){var e=[];null!==this._root&&this._root.traverse(function(t){e.push(t)});for(var i=0;i<e.length;i++){var r=e[i].event;r&&t(r)}}return this},t.IntervalTimeline.prototype.forEachAtTime=function(t,e){if(null!==this._root){var i=[];this._root.search(t,i);for(var r=i.length-1;r>=0;r--){var n=i[r].event;n&&e(n)}}return this},t.IntervalTimeline.prototype.forEachAfter=function(t,e){if(null!==this._root){var i=[];this._root.searchAfter(t,i);for(var r=i.length-1;r>=0;r--){var n=i[r].event;n&&e(n)}}return this},t.IntervalTimeline.prototype.dispose=function(){var t=[];null!==this._root&&this._root.traverse(function(e){t.push(e)});for(var e=0;e<t.length;e++)t[e].dispose();return t=null,this._root=null,this};var e=function(t,e,i){this.event=i,this.low=t,this.high=e,this.max=this.high,this._left=null,this._right=null,this.parent=null,this.height=0};return e.prototype.insert=function(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)},e.prototype.search=function(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))},e.prototype.searchAfter=function(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)},e.prototype.traverse=function(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)},e.prototype.updateHeight=function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0},e.prototype.updateMax=function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))},e.prototype.getBalance=function(){var t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t},e.prototype.isLeftChild=function(){return null!==this.parent&&this.parent.left===this},Object.defineProperty(e.prototype,"left",{get:function(){return this._left},set:function(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}}),Object.defineProperty(e.prototype,"right",{get:function(){return this._right},set:function(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}}),e.prototype.dispose=function(){this.parent=null,this._left=null,this._right=null,this.event=null},t.IntervalTimeline}),t(function(t){t.Transport=function(){t.Emitter.call(this),this.loop=!1,this._loopStart=0,this._loopEnd=0,this._ppq=e.defaults.PPQ,this._clock=new t.Clock({callback:this._processTick.bind(this),frequency:0}),this._bindClockEvents(),this.bpm=this._clock.frequency,this.bpm._toUnits=this._toUnits.bind(this),this.bpm._fromUnits=this._fromUnits.bind(this),this.bpm.units=t.Type.BPM,this.bpm.value=e.defaults.bpm,this._readOnly("bpm"),this._timeSignature=e.defaults.timeSignature,this._scheduledEvents={},this._eventID=0,this._timeline=new t.Timeline,this._repeatedEvents=new t.IntervalTimeline,this._onceEvents=new t.Timeline,this._syncedSignals=[],this._swingTicks=e.defaults.PPQ/2,this._swingAmount=0},t.extend(t.Transport,t.Emitter),t.Transport.defaults={bpm:120,swing:0,swingSubdivision:"8n",timeSignature:4,loopStart:0,loopEnd:"4m",PPQ:192},t.Transport.prototype._processTick=function(e){var i=this._clock.ticks;if(this._swingAmount>0&&i%this._ppq!=0&&i%(2*this._swingTicks)!=0){var r=i%(2*this._swingTicks)/(2*this._swingTicks),n=Math.sin(r*Math.PI)*this._swingAmount;e+=t.Time(2*this._swingTicks/3,"i")*n}this.loop&&i===this._loopEnd&&(this.emit("loopEnd",e),this._clock.ticks=this._loopStart,i=this._loopStart,this.emit("loopStart",e,this.seconds),this.emit("loop",e)),this._onceEvents.forEachBefore(i,function(t){t.callback(e),delete this._scheduledEvents[t.id.toString()]}.bind(this)),this._onceEvents.cancelBefore(i),this._timeline.forEachAtTime(i,function(t){t.callback(e)}),this._repeatedEvents.forEachAtTime(i,function(t){(i-t.time)%t.interval==0&&t.callback(e)})},t.Transport.prototype.schedule=function(t,e){var i={time:this.toTicks(e),callback:t},r=this._eventID++;return this._scheduledEvents[r.toString()]={event:i,timeline:this._timeline},this._timeline.add(i),r},t.Transport.prototype.scheduleRepeat=function(t,e,i,r){if(e<=0)throw new Error("Tone.Transport: repeat events must have an interval larger than 0");var n={time:this.toTicks(i),duration:this.toTicks(this.defaultArg(r,1/0)),interval:this.toTicks(e),callback:t},o=this._eventID++;return this._scheduledEvents[o.toString()]={event:n,timeline:this._repeatedEvents},this._repeatedEvents.add(n),o},t.Transport.prototype.scheduleOnce=function(t,e){var i=this._eventID++,r={time:this.toTicks(e),callback:t,id:i};return this._scheduledEvents[i.toString()]={event:r,timeline:this._onceEvents},this._onceEvents.add(r),i},t.Transport.prototype.clear=function(t){if(this._scheduledEvents.hasOwnProperty(t)){var e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),delete this._scheduledEvents[t.toString()]}return this},t.Transport.prototype.cancel=function(t){return t=this.defaultArg(t,0),t=this.toTicks(t),this._timeline.cancel(t),this._onceEvents.cancel(t),this._repeatedEvents.cancel(t),this},t.Transport.prototype._bindClockEvents=function(){this._clock.on("start",function(e,i){i=t.Time(this._clock.ticks,"i").toSeconds(),this.emit("start",e,i)}.bind(this)),this._clock.on("stop",function(t){this.emit("stop",t)}.bind(this)),this._clock.on("pause",function(t){this.emit("pause",t)}.bind(this))},Object.defineProperty(t.Transport.prototype,"state",{get:function(){return this._clock.getStateAtTime(this.now())}}),t.Transport.prototype.start=function(t,e){return this.isUndef(e)||(e=this.toTicks(e)),this._clock.start(t,e),this},t.Transport.prototype.stop=function(t){return this._clock.stop(t),this},t.Transport.prototype.pause=function(t){return this._clock.pause(t),this},Object.defineProperty(t.Transport.prototype,"timeSignature",{get:function(){return this._timeSignature},set:function(t){this.isArray(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}}),Object.defineProperty(t.Transport.prototype,"loopStart",{get:function(){return t.TransportTime(this._loopStart,"i").toSeconds()},set:function(t){this._loopStart=this.toTicks(t)}}),Object.defineProperty(t.Transport.prototype,"loopEnd",{get:function(){return t.TransportTime(this._loopEnd,"i").toSeconds()},set:function(t){this._loopEnd=this.toTicks(t)}}),t.Transport.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(t.Transport.prototype,"swing",{get:function(){return this._swingAmount},set:function(t){this._swingAmount=t}}),Object.defineProperty(t.Transport.prototype,"swingSubdivision",{get:function(){return t.Time(this._swingTicks,"i").toNotation()},set:function(t){this._swingTicks=this.toTicks(t)}}),Object.defineProperty(t.Transport.prototype,"position",{get:function(){return t.TransportTime(this.ticks,"i").toBarsBeatsSixteenths()},set:function(t){var e=this.toTicks(t);this.ticks=e}}),Object.defineProperty(t.Transport.prototype,"seconds",{get:function(){return t.TransportTime(this.ticks,"i").toSeconds()},set:function(t){var e=this.toTicks(t);this.ticks=e}}),Object.defineProperty(t.Transport.prototype,"progress",{get:function(){return this.loop?(this.ticks-this._loopStart)/(this._loopEnd-this._loopStart):0}}),Object.defineProperty(t.Transport.prototype,"ticks",{get:function(){return this._clock.ticks},set:function(e){if(this._clock.ticks!==e){var i=this.now();this.state===t.State.Started?(this.emit("stop",i),this._clock.ticks=e,this.emit("start",i,this.seconds)):this._clock.ticks=e}}}),Object.defineProperty(t.Transport.prototype,"PPQ",{get:function(){return this._ppq},set:function(t){var e=this.bpm.value;this._ppq=t,this.bpm.value=e}}),Object.defineProperty(t.Transport.prototype,"latencyHint",{get:function(){return t.Clock.latencyHint},set:function(e){t.Clock.latencyHint=e}}),t.Transport.prototype._fromUnits=function(t){return 1/(60/t/this.PPQ)},t.Transport.prototype._toUnits=function(t){return t/this.PPQ*60},t.Transport.prototype.nextSubdivision=function(e){e=this.toSeconds(e);var i;if(this.state!==t.State.Started)return 0;i=this._clock._nextTick;var r=t.Time(this.ticks,"i"),n=e-r%e;return 0===n&&(n=e),i+n},t.Transport.prototype.syncSignal=function(e,i){i||(i=0!==e._param.value?e._param.value/this.bpm._param.value:0);var r=new t.Gain(i);return this.bpm.chain(r,e._param),this._syncedSignals.push({ratio:r,signal:e,initial:e._param.value}),e._param.value=0,this},t.Transport.prototype.unsyncSignal=function(t){for(var e=this._syncedSignals.length-1;e>=0;e--){var i=this._syncedSignals[e];i.signal===t&&(i.ratio.dispose(),i.signal._param.value=i.initial,this._syncedSignals.splice(e,1))}return this},t.Transport.prototype.dispose=function(){return t.Emitter.prototype.dispose.call(this),this._clock.dispose(),this._clock=null,this._writable("bpm"),this.bpm=null,this._timeline.dispose(),this._timeline=null,this._onceEvents.dispose(),this._onceEvents=null,this._repeatedEvents.dispose(),this._repeatedEvents=null,this};var e=t.Transport;return t.Transport=new e,t.Context.on("init",function(i){i.Transport instanceof e?t.Transport=i.Transport:(t.Transport=new e,i.Transport=t.Transport)}),t.Transport}),t(function(t){return t.Volume=function(){var e=this.optionsObject(arguments,["volume"],t.Volume.defaults);this.output=this.input=new t.Gain(e.volume,t.Type.Decibels),this._unmutedVolume=e.volume,this.volume=this.output.gain,this._readOnly("volume"),this.mute=e.mute},t.extend(t.Volume),t.Volume.defaults={volume:0,mute:!1},Object.defineProperty(t.Volume.prototype,"mute",{get:function(){return this.volume.value===-1/0},set:function(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}}),t.Volume.prototype.dispose=function(){return this.input.dispose(),t.prototype.dispose.call(this),this._writable("volume"),this.volume.dispose(),this.volume=null,this},t.Volume}),t(function(t){t.Master=function(){this.createInsOuts(1,1),this._volume=this.output=new t.Volume,this.volume=this._volume.volume,this._readOnly("volume"),this.input.chain(this.output,this.context.destination)},t.extend(t.Master),t.Master.defaults={volume:0,mute:!1},Object.defineProperty(t.Master.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),t.Master.prototype.chain=function(){this.input.disconnect(),this.input.chain.apply(this.input,arguments),arguments[arguments.length-1].connect(this.output)},t.Master.prototype.dispose=function(){t.prototype.dispose.call(this),this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null},t.prototype.toMaster=function(){return this.connect(t.Master),this},AudioNode.prototype.toMaster=function(){return this.connect(t.Master),this};var e=t.Master;return t.Master=new e,t.Context.on("init",function(i){i.Master instanceof e?t.Master=i.Master:t.Master=new e,i.Master=t.Master}),t.Master}),t(function(t){return t.Source=function(e){e=this.defaultArg(e,t.Source.defaults),this._volume=this.output=new t.Volume(e.volume),this.volume=this._volume.volume,this._readOnly("volume"),this._state=new t.TimelineState(t.State.Stopped),this._state.memory=10,this._synced=!1,this._scheduled=[],this._volume.output.output.channelCount=2,this._volume.output.output.channelCountMode="explicit",this.mute=e.mute},t.extend(t.Source),t.Source.defaults={volume:0,mute:!1},Object.defineProperty(t.Source.prototype,"state",{get:function(){return this._synced?t.Transport.state===t.State.Started?this._state.getValueAtTime(t.Transport.seconds):t.State.Stopped:this._state.getValueAtTime(this.now())}}),Object.defineProperty(t.Source.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),t.Source.prototype._start=t.noOp,t.Source.prototype._stop=t.noOp,t.Source.prototype.start=function(e,i,r){if(e=this.isUndef(e)&&this._synced?t.Transport.seconds:this.toSeconds(e),this.retrigger||this._state.getValueAtTime(e)!==t.State.Started||this.stop(e),this._state.setStateAtTime(t.State.Started,e),this._synced){var n=this._state.get(e);n.offset=this.defaultArg(i,0),n.duration=r;var o=t.Transport.schedule(function(t){this._start(t,i,r)}.bind(this),e);this._scheduled.push(o)}else this._start.apply(this,arguments);return this},t.Source.prototype.stop=function(e){if(e=this.isUndef(e)&&this._synced?t.Transport.seconds:this.toSeconds(e),this._state.cancel(e),this._state.setStateAtTime(t.State.Stopped,e),this._synced){var i=t.Transport.schedule(this._stop.bind(this),e);this._scheduled.push(i)}else this._stop.apply(this,arguments);return this},t.Source.prototype.sync=function(){return this._synced=!0,t.Transport.on("start loopStart",function(e,i){if(i>0){var r=this._state.get(i);if(r&&r.state===t.State.Started&&r.time!==i){var n,o=i-this.toSeconds(r.time);r.duration&&(n=this.toSeconds(r.duration)-o),this._start(e,this.toSeconds(r.offset)+o,n)}}}.bind(this)),t.Transport.on("stop pause loopEnd",function(e){this._state.getValueAtTime(t.Transport.seconds)===t.State.Started&&this._stop(e)}.bind(this)),this},t.Source.prototype.unsync=function(){this._synced=!1,t.Transport.off("start stop pause loopEnd loopStart");for(var e=0;e<this._scheduled.length;e++){var i=this._scheduled[e];t.Transport.clear(i)}return this._scheduled=[],this._state.cancel(0),this},t.Source.prototype.dispose=function(){t.prototype.dispose.call(this),this.unsync(),this._scheduled=null,this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null,this._state.dispose(),this._state=null},t.Source}),t(function(t){return window.OscillatorNode&&!OscillatorNode.prototype.start&&(OscillatorNode.prototype.start=OscillatorNode.prototype.noteOn,OscillatorNode.prototype.stop=OscillatorNode.prototype.noteOff,OscillatorNode.prototype.setPeriodicWave||(OscillatorNode.prototype.setPeriodicWave=OscillatorNode.prototype.setWaveTable),AudioContext.prototype.createPeriodicWave||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable)),t.Oscillator=function(){var e=this.optionsObject(arguments,["frequency","type"],t.Oscillator.defaults);t.Source.call(this,e),this._oscillator=null,this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=new t.Signal(e.detune,t.Type.Cents),this._wave=null,this._partials=this.defaultArg(e.partials,[1]),this._phase=e.phase,this._type=null,this.type=e.type,this.phase=this._phase,this._readOnly(["frequency","detune"])},t.extend(t.Oscillator,t.Source),t.Oscillator.defaults={type:"sine",frequency:440,detune:0,phase:0,partials:[]},t.Oscillator.Type={Sine:"sine",Triangle:"triangle",Sawtooth:"sawtooth",Square:"square",Custom:"custom"},t.Oscillator.prototype._start=function(t){this._oscillator=this.context.createOscillator(),this._oscillator.setPeriodicWave(this._wave),this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(this.toSeconds(t))},t.Oscillator.prototype._stop=function(t){return this._oscillator&&(this._oscillator.stop(this.toSeconds(t)),this._oscillator=null),this},t.Oscillator.prototype.syncFrequency=function(){return t.Transport.syncSignal(this.frequency),this},t.Oscillator.prototype.unsyncFrequency=function(){return t.Transport.unsyncSignal(this.frequency),this},Object.defineProperty(t.Oscillator.prototype,"type",{get:function(){return this._type},set:function(t){var e=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e[0],e[1]);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),this._type=t}}),t.Oscillator.prototype._getRealImaginary=function(e,i){var r=2048,n=new Float32Array(r),o=new Float32Array(r),s=1;if(e===t.Oscillator.Type.Custom)s=this._partials.length+1,r=s;else{var a=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);a&&(s=parseInt(a[2])+1,e=a[1],s=Math.max(s,2),r=s)}for(var h=1;h<r;++h){var l,u=2/(h*Math.PI);switch(e){case t.Oscillator.Type.Sine:l=h<=s?1:0;break;case t.Oscillator.Type.Square:l=1&h?2*u:0;break;case t.Oscillator.Type.Sawtooth:l=u*(1&h?1:-1);break;case t.Oscillator.Type.Triangle:l=1&h?u*u*2*(h-1>>1&1?-1:1):0;break;case t.Oscillator.Type.Custom:l=this._partials[h-1];break;default:throw new TypeError("Tone.Oscillator: invalid type: "+e)}0!==l?(n[h]=-l*Math.sin(i*h),o[h]=l*Math.cos(i*h)):(n[h]=0,o[h]=0)}return[n,o]},t.Oscillator.prototype._inverseFFT=function(t,e,i){for(var r=0,n=t.length,o=0;o<n;o++)r+=t[o]*Math.cos(o*i)+e[o]*Math.sin(o*i);return r},t.Oscillator.prototype._getInitialValue=function(){for(var t=this._getRealImaginary(this._type,0),e=t[0],i=t[1],r=0,n=2*Math.PI,o=0;o<8;o++)r=Math.max(this._inverseFFT(e,i,o/8*n),r);return-this._inverseFFT(e,i,this._phase)/r},Object.defineProperty(t.Oscillator.prototype,"partials",{get:function(){return this._type!==t.Oscillator.Type.Custom?[]:this._partials},set:function(e){this._partials=e,this.type=t.Oscillator.Type.Custom}}),Object.defineProperty(t.Oscillator.prototype,"phase",{get:function(){return this._phase*(180/Math.PI)},set:function(t){this._phase=t*Math.PI/180,this.type=this._type}}),t.Oscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),null!==this._oscillator&&(this._oscillator.disconnect(),this._oscillator=null),this._wave=null,this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this._partials=null,this},t.Oscillator}),t(function(t){return t.Zero=function(){this._gain=this.input=this.output=new t.Gain,this.context.getConstant(0).connect(this._gain)},t.extend(t.Zero),t.Zero.prototype.dispose=function(){return t.prototype.dispose.call(this),this._gain.dispose(),this._gain=null,this},t.Zero}),t(function(t){return t.LFO=function(){var e=this.optionsObject(arguments,["frequency","min","max"],t.LFO.defaults);this._oscillator=new t.Oscillator({frequency:e.frequency,type:e.type}),this.frequency=this._oscillator.frequency,this.amplitude=this._oscillator.volume,this.amplitude.units=t.Type.NormalRange,this.amplitude.value=e.amplitude,this._stoppedSignal=new t.Signal(0,t.Type.AudioRange),this._zeros=new t.Zero,this._stoppedValue=0,this._a2g=new t.AudioToGain,this._scaler=this.output=new t.Scale(e.min,e.max),this._units=t.Type.Default,this.units=e.units,this._oscillator.chain(this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),this._readOnly(["amplitude","frequency"]),this.phase=e.phase},t.extend(t.LFO,t.Oscillator),t.LFO.defaults={type:"sine",min:0,max:1,phase:0,frequency:"4n",amplitude:1,units:t.Type.Default},t.LFO.prototype.start=function(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this},t.LFO.prototype.stop=function(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this},t.LFO.prototype.sync=function(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this},t.LFO.prototype.unsync=function(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this},Object.defineProperty(t.LFO.prototype,"min",{get:function(){return this._toUnits(this._scaler.min)},set:function(t){t=this._fromUnits(t),this._scaler.min=t}}),Object.defineProperty(t.LFO.prototype,"max",{get:function(){return this._toUnits(this._scaler.max)},set:function(t){t=this._fromUnits(t),this._scaler.max=t}}),Object.defineProperty(t.LFO.prototype,"type",{get:function(){return this._oscillator.type},set:function(t){this._oscillator.type=t,this._stoppedValue=this._oscillator._getInitialValue(),this._stoppedSignal.value=this._stoppedValue}}),Object.defineProperty(t.LFO.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t,this._stoppedValue=this._oscillator._getInitialValue(),this._stoppedSignal.value=this._stoppedValue}}),Object.defineProperty(t.LFO.prototype,"units",{get:function(){return this._units},set:function(t){var e=this.min,i=this.max;this._units=t,this.min=e,this.max=i}}),Object.defineProperty(t.LFO.prototype,"mute",{get:function(){return this._oscillator.mute},set:function(t){this._oscillator.mute=t}}),Object.defineProperty(t.LFO.prototype,"state",{get:function(){return this._oscillator.state}}),t.LFO.prototype.connect=function(e){return e.constructor!==t.Signal&&e.constructor!==t.Param&&e.constructor!==t.TimelineSignal||(this.convert=e.convert,this.units=e.units),t.Signal.prototype.connect.apply(this,arguments),this},t.LFO.prototype._fromUnits=t.Param.prototype._fromUnits,t.LFO.prototype._toUnits=t.Param.prototype._toUnits,t.LFO.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["amplitude","frequency"]),this._oscillator.dispose(),this._oscillator=null,this._stoppedSignal.dispose(),this._stoppedSignal=null,this._zeros.dispose(),this._zeros=null,this._scaler.dispose(),this._scaler=null,this._a2g.dispose(),this._a2g=null,this.frequency=null,this.amplitude=null,this},t.LFO}),t(function(t){return t.Limiter=function(){var e=this.optionsObject(arguments,["threshold"],t.Limiter.defaults);this._compressor=this.input=this.output=new t.Compressor({attack:.001,decay:.001,threshold:e.threshold}),this.threshold=this._compressor.threshold,this._readOnly("threshold")},t.extend(t.Limiter),t.Limiter.defaults={threshold:-12},t.Limiter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._compressor.dispose(),this._compressor=null,this._writable("threshold"),this.threshold=null,this},t.Limiter}),t(function(t){return t.LowpassCombFilter=function(){this.createInsOuts(1,1);var e=this.optionsObject(arguments,["delayTime","resonance","dampening"],t.LowpassCombFilter.defaults);this._delay=this.input=new t.Delay(e.delayTime),this.delayTime=this._delay.delayTime,this._lowpass=this.output=this.context.createBiquadFilter(),this._lowpass.Q.value=-3.0102999566398125,this._lowpass.type="lowpass",this.dampening=new t.Param({param:this._lowpass.frequency,units:t.Type.Frequency,value:e.dampening}),this._feedback=new t.Gain(e.resonance,t.Type.NormalRange),this.resonance=this._feedback.gain,this._delay.chain(this._lowpass,this._feedback,this._delay),this._readOnly(["dampening","resonance","delayTime"])},t.extend(t.LowpassCombFilter),t.LowpassCombFilter.defaults={delayTime:.1,resonance:.5,dampening:3e3},t.LowpassCombFilter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["dampening","resonance","delayTime"]),this.dampening.dispose(),this.dampening=null,this.resonance.dispose(),this.resonance=null,this._delay.dispose(),this._delay=null,this.delayTime=null,this._lowpass.disconnect(),this._lowpass=null,this._feedback.disconnect(),this._feedback=null,this},t.LowpassCombFilter}),t(function(t){return t.Merge=function(){this.createInsOuts(2,0),this.left=this.input[0]=new t.Gain,this.right=this.input[1]=new t.Gain,this._merger=this.output=this.context.createChannelMerger(2),this.left.connect(this._merger,0,0),this.right.connect(this._merger,0,1),this.left.channelCount=1,this.right.channelCount=1,this.left.channelCountMode="explicit",this.right.channelCountMode="explicit"},t.extend(t.Merge),t.Merge.prototype.dispose=function(){return t.prototype.dispose.call(this),this.left.dispose(),this.left=null,this.right.dispose(),this.right=null,this._merger.disconnect(),this._merger=null,this},t.Merge}),t(function(t){return t.Meter=function(){var e=this.optionsObject(arguments,["type","smoothing"],t.Meter.defaults);this.type=e.type,this.input=this.output=this._analyser=new t.Analyser("waveform",512),this._analyser.returnType="float",this.smoothing=e.smoothing,this._lastValue=0},t.extend(t.Meter),t.Meter.Type={Level:"level",Signal:"signal"},t.Meter.defaults={smoothing:.8,type:t.Meter.Type.Level},Object.defineProperty(t.Meter.prototype,"value",{get:function(){var e=this._analyser.analyse();if(this.type===t.Meter.Type.Level){for(var i=0,r=0;r<e.length;r++)i+=Math.pow(e[r],2);var n=Math.sqrt(i/e.length);n=Math.max(n,this._lastValue*this.smoothing),this._lastValue=n;var o=n/.35;return Math.sqrt(o)}return e[0]}}),t.Meter.prototype.dispose=function(){return t.prototype.dispose.call(this),this._analyser.dispose(),this._analyser=null,this},t.Meter}),t(function(t){return t.Split=function(){this.createInsOuts(0,2),this._splitter=this.input=this.context.createChannelSplitter(2),this.left=this.output[0]=new t.Gain,this.right=this.output[1]=new t.Gain,this._splitter.connect(this.left,0,0),this._splitter.connect(this.right,1,0)},t.extend(t.Split),t.Split.prototype.dispose=function(){return t.prototype.dispose.call(this),this._splitter.disconnect(),this.left.dispose(),this.left=null,this.right.dispose(),this.right=null,this._splitter=null,this},t.Split}),t(function(t){return t.MidSideSplit=function(){this.createInsOuts(0,2),this._split=this.input=new t.Split,this.mid=this.output[0]=new t.Expr("($0 + $1) * $2"),this.side=this.output[1]=new t.Expr("($0 - $1) * $2"),this._split.connect(this.mid,0,0),this._split.connect(this.mid,1,1),this._split.connect(this.side,0,0),this._split.connect(this.side,1,1),this.context.getConstant(Math.SQRT1_2).connect(this.mid,0,2),this.context.getConstant(Math.SQRT1_2).connect(this.side,0,2)},t.extend(t.MidSideSplit),t.MidSideSplit.prototype.dispose=function(){return t.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._split.dispose(),this._split=null,this},t.MidSideSplit}),t(function(t){return t.MidSideMerge=function(){this.createInsOuts(2,0),this.mid=this.input[0]=new t.Gain,this._left=new t.Expr("($0 + $1) * $2"),this.side=this.input[1]=new t.Gain,this._right=new t.Expr("($0 - $1) * $2"),this._merge=this.output=new t.Merge,this.mid.connect(this._left,0,0),this.side.connect(this._left,0,1),this.mid.connect(this._right,0,0),this.side.connect(this._right,0,1),this._left.connect(this._merge,0,0),this._right.connect(this._merge,0,1),this.context.getConstant(Math.SQRT1_2).connect(this._left,0,2),this.context.getConstant(Math.SQRT1_2).connect(this._right,0,2)},t.extend(t.MidSideMerge),t.MidSideMerge.prototype.dispose=function(){return t.prototype.dispose.call(this),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._left.dispose(),this._left=null,this._right.dispose(),this._right=null,this._merge.dispose(),this._merge=null,this},t.MidSideMerge}),t(function(t){return t.MidSideCompressor=function(e){e=this.defaultArg(e,t.MidSideCompressor.defaults),this._midSideSplit=this.input=new t.MidSideSplit,this._midSideMerge=this.output=new t.MidSideMerge,this.mid=new t.Compressor(e.mid),this.side=new t.Compressor(e.side),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),this._readOnly(["mid","side"])},t.extend(t.MidSideCompressor),t.MidSideCompressor.defaults={mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}},t.MidSideCompressor.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["mid","side"]),this.mid.dispose(),this.mid=null,this.side.dispose(),this.side=null,this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this},t.MidSideCompressor}),t(function(t){return t.Mono=function(){this.createInsOuts(1,0),this._merge=this.output=new t.Merge,this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1),this.input.gain.value=this.dbToGain(-10)},t.extend(t.Mono),t.Mono.prototype.dispose=function(){return t.prototype.dispose.call(this),this._merge.dispose(),this._merge=null,this},t.Mono}),t(function(t){return t.MultibandCompressor=function(e){e=this.defaultArg(arguments,t.MultibandCompressor.defaults),this._splitter=this.input=new t.MultibandSplit({lowFrequency:e.lowFrequency,highFrequency:e.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new t.Gain,this.low=new t.Compressor(e.low),this.mid=new t.Compressor(e.mid),this.high=new t.Compressor(e.high),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),this._readOnly(["high","mid","low","highFrequency","lowFrequency"])},t.extend(t.MultibandCompressor),t.MultibandCompressor.defaults={low:t.Compressor.defaults,mid:t.Compressor.defaults,high:t.Compressor.defaults,lowFrequency:250,highFrequency:2e3},t.MultibandCompressor.prototype.dispose=function(){return t.prototype.dispose.call(this),this._splitter.dispose(),this._writable(["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this._splitter=null,this.low=null,this.mid=null,this.high=null,this.lowFrequency=null,this.highFrequency=null,this},t.MultibandCompressor}),t(function(t){return t.Panner=function(e){this._hasStereoPanner?(this._panner=this.input=this.output=this.context.createStereoPanner(),this.pan=this._panner.pan):(this._crossFade=new t.CrossFade,this._merger=this.output=new t.Merge,this._splitter=this.input=new t.Split,this.pan=new t.Signal(0,t.Type.AudioRange),this._zero=new t.Zero,this._a2g=new t.AudioToGain,this._zero.connect(this._a2g),this.pan.chain(this._a2g,this._crossFade.fade),this._splitter.connect(this._crossFade,0,0),this._splitter.connect(this._crossFade,1,1),this._crossFade.a.connect(this._merger,0,0),this._crossFade.b.connect(this._merger,0,1)),this.pan.value=this.defaultArg(e,0),this._readOnly("pan")},t.extend(t.Panner),t.Panner.prototype._hasStereoPanner=t.prototype.isFunction(t.context.createStereoPanner),t.Panner.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable("pan"),this._hasStereoPanner?(this._panner.disconnect(),this._panner=null,this.pan=null):(this._zero.dispose(),this._zero=null,this._crossFade.dispose(),this._crossFade=null,this._splitter.dispose(),this._splitter=null,this._merger.dispose(),this._merger=null,this.pan.dispose(),this.pan=null,this._a2g.dispose(),this._a2g=null),this},t.Panner}),t(function(t){return t.Panner3D=function(){var e=this.optionsObject(arguments,["positionX","positionY","positionZ"],t.Panner3D.defaults);this._panner=this.input=this.output=this.context.createPanner(),this._panner.panningModel=e.panningModel,this._panner.maxDistance=e.maxDistance,this._panner.distanceModel=e.distanceModel,this._panner.coneOuterGain=e.coneOuterGain,this._panner.coneOuterAngle=e.coneOuterAngle,this._panner.coneInnerAngle=e.coneInnerAngle,this._panner.refDistance=e.refDistance,this._panner.rolloffFactor=e.rolloffFactor,this._orientation=[e.orientationX,e.orientationY,e.orientationZ],this._position=[e.positionX,e.positionY,e.positionZ],this.orientationX=e.orientationX,this.orientationY=e.orientationY,this.orientationZ=e.orientationZ,this.positionX=e.positionX,this.positionY=e.positionY,this.positionZ=e.positionZ},t.extend(t.Panner3D),t.Panner3D.defaults={positionX:0,positionY:0,positionZ:0,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",maxDistance:1e4,distanceModel:"inverse",coneOuterGain:0,coneOuterAngle:360,coneInnerAngle:360,refDistance:1,rolloffFactor:1},t.Panner3D.prototype._rampTimeConstant=.01,t.Panner3D.prototype.setPosition=function(t,e,i){if(this._panner.positionX){var r=this.now();this._panner.positionX.setTargetAtTime(t,r,this._rampTimeConstant),this._panner.positionY.setTargetAtTime(e,r,this._rampTimeConstant),this._panner.positionZ.setTargetAtTime(i,r,this._rampTimeConstant)}else this._panner.setPosition(t,e,i);return this._position=Array.prototype.slice.call(arguments),this},t.Panner3D.prototype.setOrientation=function(t,e,i){if(this._panner.orientationX){var r=this.now();this._panner.orientationX.setTargetAtTime(t,r,this._rampTimeConstant),this._panner.orientationY.setTargetAtTime(e,r,this._rampTimeConstant),this._panner.orientationZ.setTargetAtTime(i,r,this._rampTimeConstant)}else this._panner.setOrientation(t,e,i);return this._orientation=Array.prototype.slice.call(arguments),this},Object.defineProperty(t.Panner3D.prototype,"positionX",{set:function(t){this._position[0]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}}),Object.defineProperty(t.Panner3D.prototype,"positionY",{set:function(t){this._position[1]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}}),Object.defineProperty(t.Panner3D.prototype,"positionZ",{set:function(t){this._position[2]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}}),Object.defineProperty(t.Panner3D.prototype,"orientationX",{set:function(t){this._orientation[0]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}}),Object.defineProperty(t.Panner3D.prototype,"orientationY",{set:function(t){this._orientation[1]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}}),Object.defineProperty(t.Panner3D.prototype,"orientationZ",{set:function(t){this._orientation[2]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}}),t.Panner3D._aliasProperty=function(e){Object.defineProperty(t.Panner3D.prototype,e,{set:function(t){this._panner[e]=t},get:function(){return this._panner[e]}})},t.Panner3D._aliasProperty("panningModel"),t.Panner3D._aliasProperty("refDistance"),t.Panner3D._aliasProperty("rolloffFactor"),t.Panner3D._aliasProperty("distanceModel"),t.Panner3D._aliasProperty("coneInnerAngle"),t.Panner3D._aliasProperty("coneOuterAngle"),t.Panner3D._aliasProperty("coneOuterGain"),t.Panner3D._aliasProperty("maxDistance"),t.Panner3D.prototype.dispose=function(){return this._panner.disconnect(),this._panner=null,this._orientation=null,this._position=null,this},t.Panner3D}),t(function(t){return t.PanVol=function(){var e=this.optionsObject(arguments,["pan","volume"],t.PanVol.defaults);this._panner=this.input=new t.Panner(e.pan),this.pan=this._panner.pan,this._volume=this.output=new t.Volume(e.volume),this.volume=this._volume.volume,this._panner.connect(this._volume),this._readOnly(["pan","volume"])},t.extend(t.PanVol),t.PanVol.defaults={pan:.5,volume:0},t.PanVol.prototype.dispose=function(){return t.prototype.dispose.call(this),this._writable(["pan","volume"]),this._panner.dispose(),this._panner=null,this.pan=null,this._volume.dispose(),this._volume=null,this.volume=null,this},t.PanVol}),t(function(t){return t.CtrlInterpolate=function(){var e=this.optionsObject(arguments,["values","index"],t.CtrlInterpolate.defaults);this.values=e.values,this.index=e.index},t.extend(t.CtrlInterpolate),t.CtrlInterpolate.defaults={index:0,values:[]},Object.defineProperty(t.CtrlInterpolate.prototype,"value",{get:function(){var t=this.index;t=Math.min(t,this.values.length-1);var e=Math.floor(t),i=this.values[e],r=this.values[Math.ceil(t)];return this._interpolate(t-e,i,r)}}),t.CtrlInterpolate.prototype._interpolate=function(t,e,i){if(this.isArray(e)){for(var r=[],n=0;n<e.length;n++)r[n]=this._interpolate(t,e[n],i[n]);return r}if(this.isObject(e)){var o={};for(var s in e)o[s]=this._interpolate(t,e[s],i[s]);return o}return e=this._toNumber(e),i=this._toNumber(i),(1-t)*e+t*i},t.CtrlInterpolate.prototype._toNumber=function(t){return this.isNumber(t)?t:this.toSeconds(t)},t.CtrlInterpolate.prototype.dispose=function(){this.values=null},t.CtrlInterpolate}),t(function(t){return t.CtrlMarkov=function(t,e){this.values=this.defaultArg(t,{}),this.value=this.defaultArg(e,Object.keys(this.values)[0])},t.extend(t.CtrlMarkov),t.CtrlMarkov.prototype.next=function(){if(this.values.hasOwnProperty(this.value)){var t=this.values[this.value];if(this.isArray(t))for(var e=this._getProbDistribution(t),i=Math.random(),r=0,n=0;n<e.length;n++){var o=e[n];if(i>r&&i<r+o){var s=t[n];this.isObject(s)?this.value=s.value:this.value=s}r+=o}else this.value=t}return this.value},t.CtrlMarkov.prototype._getProbDistribution=function(t){for(var e=[],i=0,r=!1,n=0;n<t.length;n++){var o=t[n];this.isObject(o)?(r=!0,e[n]=o.probability):e[n]=1/t.length,i+=e[n]}if(r)for(var s=0;s<e.length;s++)e[s]=e[s]/i;return e},t.CtrlMarkov.prototype.dispose=function(){this.values=null},t.CtrlMarkov}),t(function(t){return t.CtrlPattern=function(){var e=this.optionsObject(arguments,["values","type"],t.CtrlPattern.defaults);this.values=e.values,this.index=0,this._type=null,this._shuffled=null,this._direction=null,this.type=e.type},t.extend(t.CtrlPattern),t.CtrlPattern.Type={Up:"up",Down:"down",UpDown:"upDown",DownUp:"downUp",AlternateUp:"alternateUp",AlternateDown:"alternateDown",Random:"random",RandomWalk:"randomWalk",RandomOnce:"randomOnce"},t.CtrlPattern.defaults={type:t.CtrlPattern.Type.Up,values:[]},Object.defineProperty(t.CtrlPattern.prototype,"value",{get:function(){if(0!==this.values.length){if(1===this.values.length)return this.values[0];this.index=Math.min(this.index,this.values.length-1);var e=this.values[this.index];return this.type===t.CtrlPattern.Type.RandomOnce&&(this.values.length!==this._shuffled.length&&this._shuffleValues(),e=this.values[this._shuffled[this.index]]),e}}}),Object.defineProperty(t.CtrlPattern.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,this._shuffled=null,this._type===t.CtrlPattern.Type.Up||this._type===t.CtrlPattern.Type.UpDown||this._type===t.CtrlPattern.Type.RandomOnce||this._type===t.CtrlPattern.Type.AlternateUp?this.index=0:this._type!==t.CtrlPattern.Type.Down&&this._type!==t.CtrlPattern.Type.DownUp&&this._type!==t.CtrlPattern.Type.AlternateDown||(this.index=this.values.length-1),this._type===t.CtrlPattern.Type.UpDown||this._type===t.CtrlPattern.Type.AlternateUp?this._direction=t.CtrlPattern.Type.Up:this._type!==t.CtrlPattern.Type.DownUp&&this._type!==t.CtrlPattern.Type.AlternateDown||(this._direction=t.CtrlPattern.Type.Down),this._type===t.CtrlPattern.Type.RandomOnce?this._shuffleValues():this._type===t.CtrlPattern.Random&&(this.index=Math.floor(Math.random()*this.values.length))}}),t.CtrlPattern.prototype.next=function(){var e=this.type;return e===t.CtrlPattern.Type.Up?++this.index>=this.values.length&&(this.index=0):e===t.CtrlPattern.Type.Down?--this.index<0&&(this.index=this.values.length-1):e===t.CtrlPattern.Type.UpDown||e===t.CtrlPattern.Type.DownUp?(this._direction===t.CtrlPattern.Type.Up?this.index++:this.index--,this.index<0?(this.index=1,this._direction=t.CtrlPattern.Type.Up):this.index>=this.values.length&&(this.index=this.values.length-2,this._direction=t.CtrlPattern.Type.Down)):e===t.CtrlPattern.Type.Random?this.index=Math.floor(Math.random()*this.values.length):e===t.CtrlPattern.Type.RandomWalk?Math.random()<.5?(this.index--,this.index=Math.max(this.index,0)):(this.index++,this.index=Math.min(this.index,this.values.length-1)):e===t.CtrlPattern.Type.RandomOnce?++this.index>=this.values.length&&(this.index=0,this._shuffleValues()):e===t.CtrlPattern.Type.AlternateUp?(this._direction===t.CtrlPattern.Type.Up?(this.index+=2,this._direction=t.CtrlPattern.Type.Down):(this.index-=1,this._direction=t.CtrlPattern.Type.Up),this.index>=this.values.length&&(this.index=0,this._direction=t.CtrlPattern.Type.Up)):e===t.CtrlPattern.Type.AlternateDown&&(this._direction===t.CtrlPattern.Type.Up?(this.index+=1,this._direction=t.CtrlPattern.Type.Down):(this.index-=2,this._direction=t.CtrlPattern.Type.Up),this.index<0&&(this.index=this.values.length-1,this._direction=t.CtrlPattern.Type.Down)),this.value},t.CtrlPattern.prototype._shuffleValues=function(){var t=[];this._shuffled=[];for(var e=0;e<this.values.length;e++)t[e]=e;for(;t.length>0;){var i=t.splice(Math.floor(t.length*Math.random()),1);this._shuffled.push(i[0])}},t.CtrlPattern.prototype.dispose=function(){this._shuffled=null,this.values=null},t.CtrlPattern}),t(function(t){return t.CtrlRandom=function(){var e=this.optionsObject(arguments,["min","max"],t.CtrlRandom.defaults);this.min=e.min,this.max=e.max,this.integer=e.integer},t.extend(t.CtrlRandom),t.CtrlRandom.defaults={min:0,max:1,integer:!1},Object.defineProperty(t.CtrlRandom.prototype,"value",{get:function(){var t=this.toSeconds(this.min),e=this.toSeconds(this.max),i=Math.random(),r=i*t+(1-i)*e;return this.integer&&(r=Math.floor(r)),r}}),t.CtrlRandom}),t(function(t){return window.AudioBuffer&&!AudioBuffer.prototype.copyToChannel&&(AudioBuffer.prototype.copyToChannel=function(t,e,i){var r=this.getChannelData(e);i=i||0;for(var n=0;n<r.length;n++)r[n+i]=t[n]},AudioBuffer.prototype.copyFromChannel=function(t,e,i){var r=this.getChannelData(e);i=i||0;for(var n=0;n<r.length;n++)t[n]=r[n+i]}),t.Buffer=function(){var e=this.optionsObject(arguments,["url","onload","onerror"],t.Buffer.defaults);this._buffer=null,this._reversed=e.reverse,this._xhr=null,e.url instanceof AudioBuffer||e.url instanceof t.Buffer?(this.set(e.url),e.onload&&e.onload(this)):this.isString(e.url)&&this.load(e.url,e.onload,e.onerror)},t.extend(t.Buffer),t.Buffer.defaults={url:void 0,reverse:!1},t.Buffer.prototype.set=function(e){return e instanceof t.Buffer?this._buffer=e.get():this._buffer=e,this},t.Buffer.prototype.get=function(){return this._buffer},t.Buffer.prototype.load=function(e,i,r){return new Promise(function(n,o){this._xhr=t.Buffer.load(e,function(t){this._xhr=null,this.set(t),n(this),i&&i(this)}.bind(this),function(t){this._xhr=null,o(t),r&&r(t)}.bind(this))}.bind(this))},t.Buffer.prototype.dispose=function(){return t.Emitter.prototype.dispose.call(this),this._buffer=null,this._xhr&&(t.Buffer._currentDownloads--,this._xhr.abort(),this._xhr=null),this},Object.defineProperty(t.Buffer.prototype,"loaded",{get:function(){return this.length>0}}),Object.defineProperty(t.Buffer.prototype,"duration",{get:function(){return this._buffer?this._buffer.duration:0}}),Object.defineProperty(t.Buffer.prototype,"length",{get:function(){return this._buffer?this._buffer.length:0}}),Object.defineProperty(t.Buffer.prototype,"numberOfChannels",{get:function(){return this._buffer?this._buffer.numberOfChannels:0}}),t.Buffer.prototype.fromArray=function(t){var e=t[0].length>0,i=e?t.length:1,r=e?t[0].length:t.length,n=this.context.createBuffer(i,r,this.context.sampleRate);e||1!==i||(t=[t]);for(var o=0;o<i;o++)n.copyToChannel(t[o],o);return this._buffer=n,this},t.Buffer.prototype.toMono=function(t){if(this.isNumber(t))this.fromArray(this.toArray(t));else{for(var e=new Float32Array(this.length),i=this.numberOfChannels,r=0;r<i;r++)for(var n=this.toArray(r),o=0;o<n.length;o++)e[o]+=n[o];e=e.map(function(t){return t/i}),this.fromArray(e)}return this},t.Buffer.prototype.toArray=function(t){if(this.isNumber(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);for(var e=[],i=0;i<this.numberOfChannels;i++)e[i]=this.getChannelData(i);return e},t.Buffer.prototype.getChannelData=function(t){return this._buffer.getChannelData(t)},t.Buffer.prototype.slice=function(e,i){i=this.defaultArg(i,this.duration);for(var r=Math.floor(this.context.sampleRate*this.toSeconds(e)),n=Math.floor(this.context.sampleRate*this.toSeconds(i)),o=[],s=0;s<this.numberOfChannels;s++)o[s]=this.toArray(s).slice(r,n);return(new t.Buffer).fromArray(o)},t.Buffer.prototype._reverse=function(){if(this.loaded)for(var t=0;t<this.numberOfChannels;t++)Array.prototype.reverse.call(this.getChannelData(t));return this},Object.defineProperty(t.Buffer.prototype,"reverse",{get:function(){return this._reversed},set:function(t){this._reversed!==t&&(this._reversed=t,this._reverse())}}),t.Emitter.mixin(t.Buffer),t.Buffer._downloadQueue=[],t.Buffer._currentDownloads=0,t.Buffer.baseUrl="",t.Buffer.load=function(e,i,r){function n(e){if(!r)throw new Error(e);r(e),t.Buffer.emit("error",e)}function o(){for(var e=0,i=0;i<t.Buffer._downloadQueue.length;i++)e+=t.Buffer._downloadQueue[i].progress;t.Buffer.emit("progress",e/t.Buffer._downloadQueue.length)}i=i||t.noOp;var s=new XMLHttpRequest;return s.open("GET",t.Buffer.baseUrl+e,!0),s.responseType="arraybuffer",s.progress=0,t.Buffer._currentDownloads++,t.Buffer._downloadQueue.push(s),s.addEventListener("load",function(){200===s.status?t.context.decodeAudioData(s.response,function(e){s.progress=1,o(),i(e),0===--t.Buffer._currentDownloads&&(t.Buffer._downloadQueue=[],t.Buffer.emit("load"))},function(){n("Tone.Buffer: could not decode audio data: "+e)}):n("Tone.Buffer: could not locate file: "+e)}),s.addEventListener("error",n),s.addEventListener("progress",function(t){t.lengthComputable&&(s.progress=t.loaded/t.total*.95,o())}),s.send(),s},t.Buffer.cancelDownloads=function(){return t.Buffer._downloadQueue.forEach(function(t){t.abort()}),t.Buffer._currentDownloads=0,t.Buffer},t.Buffer.supportsType=function(t){var e=t.split(".");return e=e[e.length-1],""!==document.createElement("audio").canPlayType("audio/"+e)},t.loaded=function(){function e(){t.Buffer.off("load",i),t.Buffer.off("error",r)}var i,r;return new Promise(function(e,n){i=function(){e()},r=function(){n()},t.Buffer.on("load",i),t.Buffer.on("error",r)}).then(e).catch(function(t){throw e(),new Error(t)})},t.Buffer}),t(function(t){return t.Buffers=function(t,e,i){this._buffers={},this.baseUrl=this.defaultArg(i,""),t=this._flattenUrls(t),this._loadingCount=0;for(var r in t)this._loadingCount++,this.add(r,t[r],this._bufferLoaded.bind(this,e))},t.extend(t.Buffers),t.Buffers.prototype.has=function(t){return this._buffers.hasOwnProperty(t)},t.Buffers.prototype.get=function(t){if(this.has(t))return this._buffers[t];throw new Error("Tone.Buffers: no buffer named "+t)},t.Buffers.prototype._bufferLoaded=function(t){0===--this._loadingCount&&t&&t(this)},Object.defineProperty(t.Buffers.prototype,"loaded",{get:function(){var t=!0;for(var e in this._buffers){var i=this.get(e);t=t&&i.loaded}return t}}),t.Buffers.prototype.add=function(e,i,r){return r=this.defaultArg(r,t.noOp),i instanceof t.Buffer?(this._buffers[e]=i,r(this)):i instanceof AudioBuffer?(this._buffers[e]=new t.Buffer(i),r(this)):this.isString(i)&&(this._buffers[e]=new t.Buffer(this.baseUrl+i,r)),this},t.Buffers.prototype._flattenUrls=function(t){var e={};for(var i in t)if(t.hasOwnProperty(i))if(this.isObject(t[i])){var r=this._flattenUrls(t[i]);for(var n in r)r.hasOwnProperty(n)&&(e[i+"."+n]=r[n])}else e[i]=t[i];return e},t.Buffers.prototype.dispose=function(){for(var t in this._buffers)this._buffers[t].dispose();return this._buffers=null,this},t.Buffers}),t(function(t){var e={};return t.prototype.send=function(i,r){e.hasOwnProperty(i)||(e[i]=this.context.createGain()),r=this.defaultArg(r,0);var n=new t.Gain(r,t.Type.Decibels);return this.output.chain(n,e[i]),n},t.prototype.receive=function(t,i){return e.hasOwnProperty(t)||(e[t]=this.context.createGain()),this.isUndef(i)&&(i=this.input),e[t].connect(i),this},t.Context.on("init",function(t){t.Buses?e=t.Buses:(e={},t.Buses=e)}),t}),t(function(t){return t.Draw=function(){this._events=new t.Timeline,this.expiration=.25,this.anticipation=.008,this._boundDrawLoop=this._drawLoop.bind(this)},t.extend(t.Draw),t.Draw.prototype.schedule=function(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&requestAnimationFrame(this._boundDrawLoop),this},t.Draw.prototype.cancel=function(t){return this._events.cancel(this.toSeconds(t)),this},t.Draw.prototype._drawLoop=function(){for(var e=t.now();this._events.length&&this._events.peek().time-this.anticipation<=e;){var i=this._events.shift();e-i.time<=this.expiration&&i.callback()}this._events.length>0&&requestAnimationFrame(this._boundDrawLoop)},t.Draw=new t.Draw,t.Draw}),t(function(t){t.Listener=function(){var t=this.optionsObject(arguments,["positionX","positionY","positionZ"],e.defaults);this._orientation=[t.forwardX,t.forwardY,t.forwardZ,t.upX,t.upY,t.upZ],this._position=[t.positionX,t.positionY,t.positionZ],this.forwardX=t.forwardX,this.forwardY=t.forwardY,this.forwardZ=t.forwardZ,this.upX=t.upX,this.upY=t.upY,this.upZ=t.upZ,this.positionX=t.positionX,this.positionY=t.positionY,this.positionZ=t.positionZ},t.extend(t.Listener),t.Listener.defaults={positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:1,upX:0,upY:1,upZ:0},t.Listener.prototype._rampTimeConstant=.01,t.Listener.prototype.setPosition=function(t,e,i){if(this.context.listener.positionX){var r=this.now();this.context.listener.positionX.setTargetAtTime(t,r,this._rampTimeConstant),this.context.listener.positionY.setTargetAtTime(e,r,this._rampTimeConstant),this.context.listener.positionZ.setTargetAtTime(i,r,this._rampTimeConstant)}else this.context.listener.setPosition(t,e,i);return this._position=Array.prototype.slice.call(arguments),this},t.Listener.prototype.setOrientation=function(t,e,i,r,n,o){if(this.context.listener.forwardX){var s=this.now();this.context.listener.forwardX.setTargetAtTime(t,s,this._rampTimeConstant),this.context.listener.forwardY.setTargetAtTime(e,s,this._rampTimeConstant),this.context.listener.forwardZ.setTargetAtTime(i,s,this._rampTimeConstant),this.context.listener.upX.setTargetAtTime(r,s,this._rampTimeConstant),this.context.listener.upY.setTargetAtTime(n,s,this._rampTimeConstant),this.context.listener.upZ.setTargetAtTime(o,s,this._rampTimeConstant)}else this.context.listener.setOrientation(t,e,i,r,n,o);return this._orientation=Array.prototype.slice.call(arguments),this},Object.defineProperty(t.Listener.prototype,"positionX",{set:function(t){this._position[0]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[0]}}),Object.defineProperty(t.Listener.prototype,"positionY",{set:function(t){this._position[1]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[1]}}),Object.defineProperty(t.Listener.prototype,"positionZ",{set:function(t){this._position[2]=t,this.setPosition.apply(this,this._position)},get:function(){return this._position[2]}}),Object.defineProperty(t.Listener.prototype,"forwardX",{set:function(t){this._orientation[0]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[0]}}),Object.defineProperty(t.Listener.prototype,"forwardY",{set:function(t){this._orientation[1]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[1]}}),Object.defineProperty(t.Listener.prototype,"forwardZ",{set:function(t){this._orientation[2]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[2]}}),Object.defineProperty(t.Listener.prototype,"upX",{set:function(t){this._orientation[3]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[3]}}),Object.defineProperty(t.Listener.prototype,"upY",{set:function(t){this._orientation[4]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[4]}}),Object.defineProperty(t.Listener.prototype,"upZ",{set:function(t){this._orientation[5]=t,this.setOrientation.apply(this,this._orientation)},get:function(){return this._orientation[5]}}),t.Listener.prototype.dispose=function(){return this._orientation=null,this._position=null,this};var e=t.Listener;return t.Listener=new e,t.Context.on("init",function(i){i.Listener instanceof e?t.Listener=i.Listener:t.Listener=new e,i.Listener=t.Listener}),t.Listener}),t(function(t){return!window.hasOwnProperty("OfflineAudioContext")&&window.hasOwnProperty("webkitOfflineAudioContext")&&(window.OfflineAudioContext=window.webkitOfflineAudioContext),t.OfflineContext=function(e,i,r){var n=new OfflineAudioContext(e,i*r,r);t.Context.call(this,n),this._duration=i,this._currentTime=0,this.lookAhead=this.blockTime,this.updateInterval=this.blockTime},t.extend(t.OfflineContext,t.Context),t.OfflineContext.prototype.now=function(){return this._currentTime},t.OfflineContext.prototype._createWorker=function(){return{postMessage:function(){}}},t.OfflineContext.prototype.render=function(){for(;this._duration-this._currentTime>=0;)this.emit("tick"),this._currentTime+=t.prototype.blockTime;return new Promise(function(t){this._context.oncomplete=function(e){t(e.renderedBuffer)},this._context.startRendering()}.bind(this))},t.OfflineContext}),t(function(t){return t.Offline=function(e,i){var r=t.context.sampleRate,n=t.context,o=new t.OfflineContext(2,i,r);t.context=o,e(t.Transport);var s=o.render();return t.context=n,s.then(function(e){return new t.Buffer(e)})},t.Offline}),t(function(t){return t.Effect=function(){this.createInsOuts(1,1);var e=this.optionsObject(arguments,["wet"],t.Effect.defaults);this._dryWet=new t.CrossFade(e.wet),this.wet=this._dryWet.fade,this.effectSend=new t.Gain,this.effectReturn=new t.Gain,this.input.connect(this._dryWet.a),this.input.connect(this.effectSend),this.effectReturn.connect(this._dryWet.b),this._dryWet.connect(this.output),this._readOnly(["wet"])},t.extend(t.Effect),t.Effect.defaults={wet:1},t.Effect.prototype.connectEffect=function(t){return this.effectSend.chain(t,this.effectReturn),this},t.Effect.prototype.dispose=function(){return t.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this.effectSend.dispose(),this.effectSend=null,this.effectReturn.dispose(),this.effectReturn=null,this._writable(["wet"]),this.wet=null,this},t.Effect}),t(function(t){return t.AutoFilter=function(){var e=this.optionsObject(arguments,["frequency","baseFrequency","octaves"],t.AutoFilter.defaults);t.Effect.call(this,e),this._lfo=new t.LFO({frequency:e.frequency,amplitude:e.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.filter=new t.Filter(e.filter),this._octaves=0,this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.type=e.type,this._readOnly(["frequency","depth"]),this.octaves=e.octaves,this.baseFrequency=e.baseFrequency},t.extend(t.AutoFilter,t.Effect),t.AutoFilter.defaults={frequency:1,type:"sine",depth:1,baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}},t.AutoFilter.prototype.start=function(t){return this._lfo.start(t),this},t.AutoFilter.prototype.stop=function(t){return this._lfo.stop(t),this},t.AutoFilter.prototype.sync=function(t){return this._lfo.sync(t),this},t.AutoFilter.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(t.AutoFilter.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),Object.defineProperty(t.AutoFilter.prototype,"baseFrequency",{get:function(){return this._lfo.min},set:function(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}}),Object.defineProperty(t.AutoFilter.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._lfo.max=this.baseFrequency*Math.pow(2,t)}}),t.AutoFilter.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this.filter.dispose(),this.filter=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null,this},t.AutoFilter}),t(function(t){return t.AutoPanner=function(){var e=this.optionsObject(arguments,["frequency"],t.AutoPanner.defaults);t.Effect.call(this,e),this._lfo=new t.LFO({frequency:e.frequency,amplitude:e.depth,min:-1,max:1}),this.depth=this._lfo.amplitude,this._panner=new t.Panner,this.frequency=this._lfo.frequency,this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this.type=e.type,this._readOnly(["depth","frequency"])},t.extend(t.AutoPanner,t.Effect),t.AutoPanner.defaults={frequency:1,type:"sine",depth:1},t.AutoPanner.prototype.start=function(t){return this._lfo.start(t),this},t.AutoPanner.prototype.stop=function(t){return this._lfo.stop(t),this},t.AutoPanner.prototype.sync=function(t){return this._lfo.sync(t),this},t.AutoPanner.prototype.unsync=function(){return this._lfo.unsync(),this},Object.defineProperty(t.AutoPanner.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),t.AutoPanner.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._lfo.dispose(),this._lfo=null,this._panner.dispose(),this._panner=null,this._writable(["depth","frequency"]),this.frequency=null,this.depth=null,this},t.AutoPanner}),t(function(t){return t.AutoWah=function(){var e=this.optionsObject(arguments,["baseFrequency","octaves","sensitivity"],t.AutoWah.defaults);t.Effect.call(this,e),this.follower=new t.Follower(e.follower),this._sweepRange=new t.ScaleExp(0,1,.5),this._baseFrequency=e.baseFrequency,this._octaves=e.octaves,this._inputBoost=new t.Gain,this._bandpass=new t.Filter({rolloff:-48,frequency:0,Q:e.Q}),this._peaking=new t.Filter(0,"peaking"),this._peaking.gain.value=e.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this.follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=e.sensitivity,this._readOnly(["gain","Q"])},t.extend(t.AutoWah,t.Effect),t.AutoWah.defaults={baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:{attack:.3,release:.5}},Object.defineProperty(t.AutoWah.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._setSweepRange()}}),Object.defineProperty(t.AutoWah.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=t,this._setSweepRange()}}),Object.defineProperty(t.AutoWah.prototype,"sensitivity",{get:function(){return this.gainToDb(1/this._inputBoost.gain.value)},set:function(t){this._inputBoost.gain.value=1/this.dbToGain(t)}}),t.AutoWah.prototype._setSweepRange=function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)},t.AutoWah.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this.follower.dispose(),this.follower=null,this._sweepRange.dispose(),this._sweepRange=null,this._bandpass.dispose(),this._bandpass=null,this._peaking.dispose(),this._peaking=null,this._inputBoost.dispose(),this._inputBoost=null,this._writable(["gain","Q"]),this.gain=null,this.Q=null,this},t.AutoWah}),t(function(t){return t.BitCrusher=function(){var e=this.optionsObject(arguments,["bits"],t.BitCrusher.defaults);t.Effect.call(this,e);var i=1/Math.pow(2,e.bits-1);this._subtract=new t.Subtract,this._modulo=new t.Modulo(i),this._bits=e.bits,this.effectSend.fan(this._subtract,this._modulo),this._modulo.connect(this._subtract,0,1),this._subtract.connect(this.effectReturn)},t.extend(t.BitCrusher,t.Effect),t.BitCrusher.defaults={bits:4},Object.defineProperty(t.BitCrusher.prototype,"bits",{get:function(){return this._bits},set:function(t){this._bits=t;var e=1/Math.pow(2,t-1);this._modulo.value=e}}),t.BitCrusher.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._subtract.dispose(),this._subtract=null,this._modulo.dispose(),this._modulo=null,this},t.BitCrusher}),t(function(t){return t.Chebyshev=function(){var e=this.optionsObject(arguments,["order"],t.Chebyshev.defaults);t.Effect.call(this,e),this._shaper=new t.WaveShaper(4096),this._order=e.order,this.connectEffect(this._shaper),this.order=e.order,this.oversample=e.oversample},t.extend(t.Chebyshev,t.Effect),t.Chebyshev.defaults={order:1,oversample:"none"},t.Chebyshev.prototype._getCoefficient=function(t,e,i){return i.hasOwnProperty(e)?i[e]:(i[e]=0===e?0:1===e?t:2*t*this._getCoefficient(t,e-1,i)-this._getCoefficient(t,e-2,i),i[e])},Object.defineProperty(t.Chebyshev.prototype,"order",{get:function(){return this._order},set:function(t){this._order=t;for(var e=new Array(4096),i=e.length,r=0;r<i;++r){var n=2*r/i-1;e[r]=0===n?0:this._getCoefficient(n,t,{})}this._shaper.curve=e}}),Object.defineProperty(t.Chebyshev.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}}),t.Chebyshev.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},t.Chebyshev}),t(function(t){return t.StereoEffect=function(){this.createInsOuts(1,1);var e=this.optionsObject(arguments,["wet"],t.Effect.defaults);this._dryWet=new t.CrossFade(e.wet),this.wet=this._dryWet.fade,this._split=new t.Split,this.effectSendL=this._split.left,this.effectSendR=this._split.right,this._merge=new t.Merge,this.effectReturnL=this._merge.left,this.effectReturnR=this._merge.right,this.input.connect(this._split),this.input.connect(this._dryWet,0,0),this._merge.connect(this._dryWet,0,1),this._dryWet.connect(this.output),this._readOnly(["wet"])},t.extend(t.StereoEffect,t.Effect),t.StereoEffect.prototype.dispose=function(){return t.prototype.dispose.call(this),this._dryWet.dispose(),this._dryWet=null,this._split.dispose(),this._split=null,this._merge.dispose(),this._merge=null,this.effectSendL=null,this.effectSendR=null,this.effectReturnL=null,this.effectReturnR=null,this._writable(["wet"]),this.wet=null,this},t.StereoEffect}),t(function(t){return t.FeedbackEffect=function(){var e=this.optionsObject(arguments,["feedback"]);e=this.defaultArg(e,t.FeedbackEffect.defaults),t.Effect.call(this,e),this._feedbackGain=new t.Gain(e.feedback,t.Type.NormalRange),this.feedback=this._feedbackGain.gain,this.effectReturn.chain(this._feedbackGain,this.effectSend),this._readOnly(["feedback"])},t.extend(t.FeedbackEffect,t.Effect),t.FeedbackEffect.defaults={feedback:.125},t.FeedbackEffect.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._writable(["feedback"]),this._feedbackGain.dispose(),this._feedbackGain=null,this.feedback=null,this},t.FeedbackEffect}),t(function(t){return t.StereoXFeedbackEffect=function(){var e=this.optionsObject(arguments,["feedback"],t.FeedbackEffect.defaults);t.StereoEffect.call(this,e),this.feedback=new t.Signal(e.feedback,t.Type.NormalRange),this._feedbackLR=new t.Gain,this._feedbackRL=new t.Gain,this.effectReturnL.chain(this._feedbackLR,this.effectSendR),this.effectReturnR.chain(this._feedbackRL,this.effectSendL),this.feedback.fan(this._feedbackLR.gain,this._feedbackRL.gain),this._readOnly(["feedback"])},t.extend(t.StereoXFeedbackEffect,t.FeedbackEffect),t.StereoXFeedbackEffect.prototype.dispose=function(){return t.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackLR.dispose(),this._feedbackLR=null,this._feedbackRL.dispose(),this._feedbackRL=null,this},t.StereoXFeedbackEffect}),t(function(t){return t.Chorus=function(){var e=this.optionsObject(arguments,["frequency","delayTime","depth"],t.Chorus.defaults);t.StereoXFeedbackEffect.call(this,e),this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new t.LFO({frequency:e.frequency,min:0,max:1}),this._lfoR=new t.LFO({frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new t.Delay,this._delayNodeR=new t.Delay,this.frequency=this._lfoL.frequency,this.effectSendL.chain(this._delayNodeL,this.effectReturnL),this.effectSendR.chain(this._delayNodeR,this.effectReturnR),this.effectSendL.connect(this.effectReturnL),this.effectSendR.connect(this.effectReturnR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this._lfoL.start(),this._lfoR.start(),this._lfoL.frequency.connect(this._lfoR.frequency),this.depth=this._depth,this.frequency.value=e.frequency,this.type=e.type,this._readOnly(["frequency"]),this.spread=e.spread},t.extend(t.Chorus,t.StereoXFeedbackEffect),t.Chorus.defaults={frequency:1.5,delayTime:3.5,depth:.7,feedback:.1,type:"sine",spread:180},Object.defineProperty(t.Chorus.prototype,"depth",{get:function(){return this._depth},set:function(t){this._depth=t;var e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}}),Object.defineProperty(t.Chorus.prototype,"delayTime",{get:function(){return 1e3*this._delayTime},set:function(t){this._delayTime=t/1e3,this.depth=this._depth}}),Object.defineProperty(t.Chorus.prototype,"type",{get:function(){return this._lfoL.type},set:function(t){this._lfoL.type=t,this._lfoR.type=t}}),Object.defineProperty(t.Chorus.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}}),t.Chorus.prototype.dispose=function(){return t.StereoXFeedbackEffect.prototype.dispose.call(this),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._delayNodeL.dispose(),this._delayNodeL=null,this._delayNodeR.dispose(),this._delayNodeR=null,this._writable("frequency"),this.frequency=null,this},t.Chorus}),t(function(t){return t.Convolver=function(){var e=this.optionsObject(arguments,["url","onload"],t.Convolver.defaults);t.Effect.call(this,e),this._convolver=this.context.createConvolver(),this._buffer=new t.Buffer,this.isString(e.url)?this._buffer.load(e.url,function(t){this.buffer=t,e.onload()}.bind(this)):e.url&&(this.buffer=e.url,e.onload()),this.connectEffect(this._convolver)},t.extend(t.Convolver,t.Effect),t.Convolver.defaults={onload:t.noOp},Object.defineProperty(t.Convolver.prototype,"buffer",{get:function(){return this._buffer.get()},set:function(t){this._buffer.set(t),this._convolver.buffer=this._buffer.get()}}),t.Convolver.prototype.load=function(t,e){return this._buffer.load(t,function(t){this.buffer=t,e&&e()}.bind(this))},t.Convolver.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._convolver.disconnect(),this._convolver=null,this._buffer.dispose(),this._buffer=null,this},t.Convolver}),t(function(t){return t.Distortion=function(){var e=this.optionsObject(arguments,["distortion"],t.Distortion.defaults);t.Effect.call(this,e),this._shaper=new t.WaveShaper(4096),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample},t.extend(t.Distortion,t.Effect),t.Distortion.defaults={distortion:.4,oversample:"none"},Object.defineProperty(t.Distortion.prototype,"distortion",{get:function(){return this._distortion},set:function(t){this._distortion=t;var e=100*t,i=Math.PI/180;this._shaper.setMap(function(t){return Math.abs(t)<.001?0:(3+e)*t*20*i/(Math.PI+e*Math.abs(t))})}}),Object.defineProperty(t.Distortion.prototype,"oversample",{get:function(){return this._shaper.oversample},set:function(t){this._shaper.oversample=t}}),t.Distortion.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._shaper.dispose(),this._shaper=null,this},t.Distortion}),t(function(t){return t.FeedbackDelay=function(){var e=this.optionsObject(arguments,["delayTime","feedback"],t.FeedbackDelay.defaults);t.FeedbackEffect.call(this,e),this._delayNode=new t.Delay(e.delayTime),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),this._readOnly(["delayTime"])},t.extend(t.FeedbackDelay,t.FeedbackEffect),t.FeedbackDelay.defaults={delayTime:.25},t.FeedbackDelay.prototype.dispose=function(){return t.FeedbackEffect.prototype.dispose.call(this),this._delayNode.dispose(),this._delayNode=null,this._writable(["delayTime"]),this.delayTime=null,this},t.FeedbackDelay}),t(function(t){var e=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],i=[225,556,441,341];return t.Freeverb=function(){var r=this.optionsObject(arguments,["roomSize","dampening"],t.Freeverb.defaults);t.StereoEffect.call(this,r),this.roomSize=new t.Signal(r.roomSize,t.Type.NormalRange),this.dampening=new t.Signal(r.dampening,t.Type.Frequency),this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];for(var n=0;n<i.length;n++){var o=this.context.createBiquadFilter();o.type="allpass",o.frequency.value=i[n],this._allpassFiltersL.push(o)}for(var s=0;s<i.length;s++){var a=this.context.createBiquadFilter();a.type="allpass",a.frequency.value=i[s],this._allpassFiltersR.push(a)}for(var h=0;h<e.length;h++){var l=new t.LowpassCombFilter(e[h]);h<e.length/2?this.effectSendL.chain(l,this._allpassFiltersL[0]):this.effectSendR.chain(l,this._allpassFiltersR[0]),this.roomSize.connect(l.resonance),this.dampening.connect(l.dampening),this._combFilters.push(l)}this.connectSeries.apply(this,this._allpassFiltersL),this.connectSeries.apply(this,this._allpassFiltersR),this._allpassFiltersL[this._allpassFiltersL.length-1].connect(this.effectReturnL),this._allpassFiltersR[this._allpassFiltersR.length-1].connect(this.effectReturnR),this._readOnly(["roomSize","dampening"])},t.extend(t.Freeverb,t.StereoEffect),t.Freeverb.defaults={roomSize:.7,dampening:3e3},t.Freeverb.prototype.dispose=function(){t.StereoEffect.prototype.dispose.call(this);for(var e=0;e<this._allpassFiltersL.length;e++)this._allpassFiltersL[e].disconnect(),this._allpassFiltersL[e]=null;this._allpassFiltersL=null;for(var i=0;i<this._allpassFiltersR.length;i++)this._allpassFiltersR[i].disconnect(),this._allpassFiltersR[i]=null;this._allpassFiltersR=null;for(var r=0;r<this._combFilters.length;r++)this._combFilters[r].dispose(),this._combFilters[r]=null;return this._combFilters=null,this._writable(["roomSize","dampening"]),this.roomSize.dispose(),this.roomSize=null,this.dampening.dispose(),this.dampening=null,this},t.Freeverb}),t(function(t){var e=[.06748,.06404,.08212,.09004],i=[.773,.802,.753,.733],r=[347,113,37];return t.JCReverb=function(){var n=this.optionsObject(arguments,["roomSize"],t.JCReverb.defaults);t.StereoEffect.call(this,n),this.roomSize=new t.Signal(n.roomSize,t.Type.NormalRange),this._scaleRoomSize=new t.Scale(-.733,.197),this._allpassFilters=[],this._feedbackCombFilters=[];for(var o=0;o<r.length;o++){var s=this.context.createBiquadFilter();s.type="allpass",s.frequency.value=r[o],this._allpassFilters.push(s)}for(var a=0;a<e.length;a++){var h=new t.FeedbackCombFilter(e[a],.1);this._scaleRoomSize.connect(h.resonance),h.resonance.value=i[a],this._allpassFilters[this._allpassFilters.length-1].connect(h),a<e.length/2?h.connect(this.effectReturnL):h.connect(this.effectReturnR),this._feedbackCombFilters.push(h)}this.roomSize.connect(this._scaleRoomSize),this.connectSeries.apply(this,this._allpassFilters),this.effectSendL.connect(this._allpassFilters[0]),this.effectSendR.connect(this._allpassFilters[0]),this._readOnly(["roomSize"])},t.extend(t.JCReverb,t.StereoEffect),t.JCReverb.defaults={roomSize:.5},t.JCReverb.prototype.dispose=function(){t.StereoEffect.prototype.dispose.call(this);for(var e=0;e<this._allpassFilters.length;e++)this._allpassFilters[e].disconnect(),this._allpassFilters[e]=null;this._allpassFilters=null;for(var i=0;i<this._feedbackCombFilters.length;i++)this._feedbackCombFilters[i].dispose(),this._feedbackCombFilters[i]=null;return this._feedbackCombFilters=null,this._writable(["roomSize"]),this.roomSize.dispose(),this.roomSize=null,this._scaleRoomSize.dispose(),this._scaleRoomSize=null,this},t.JCReverb}),t(function(t){return t.MidSideEffect=function(){t.Effect.apply(this,arguments),this._midSideSplit=new t.MidSideSplit,this._midSideMerge=new t.MidSideMerge,this.midSend=this._midSideSplit.mid,this.sideSend=this._midSideSplit.side,this.midReturn=this._midSideMerge.mid,this.sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)},t.extend(t.MidSideEffect,t.Effect),t.MidSideEffect.prototype.dispose=function(){return t.Effect.prototype.dispose.call(this),this._midSideSplit.dispose(),this._midSideSplit=null,this._midSideMerge.dispose(),this._midSideMerge=null,this.midSend=null,this.sideSend=null,this.midReturn=null,this.sideReturn=null,this},t.MidSideEffect}),t(function(t){return t.Phaser=function(){var e=this.optionsObject(arguments,["frequency","octaves","baseFrequency"],t.Phaser.defaults);t.StereoEffect.call(this,e),this._lfoL=new t.LFO(e.frequency,0,1),this._lfoR=new t.LFO(e.frequency,0,1),this._lfoR.phase=180,this._baseFrequency=e.baseFrequency,this._octaves=e.octaves,this.Q=new t.Signal(e.Q,t.Type.Positive),this._filtersL=this._makeFilters(e.stages,this._lfoL,this.Q),this._filtersR=this._makeFilters(e.stages,this._lfoR,this.Q),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.effectSendL.connect(this._filtersL[0]),this.effectSendR.connect(this._filtersR[0]),this._filtersL[e.stages-1].connect(this.effectReturnL),this._filtersR[e.stages-1].connect(this.effectReturnR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),this._readOnly(["frequency","Q"])},t.extend(t.Phaser,t.StereoEffect),t.Phaser.defaults={frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350},t.Phaser.prototype._makeFilters=function(t,e,i){for(var r=new Array(t),n=0;n<t;n++){var o=this.context.createBiquadFilter();o.type="allpass",i.connect(o.Q),e.connect(o.frequency),r[n]=o}return this.connectSeries.apply(this,r),r},Object.defineProperty(t.Phaser.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t;var e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}}),Object.defineProperty(t.Phaser.prototype,"baseFrequency",{get:function(){return this._baseFrequency},set:function(t){this._baseFrequency=t,this._lfoL.min=t,this._lfoR.min=t,this.octaves=this._octaves}}),t.Phaser.prototype.dispose=function(){t.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","Q"]),this.Q.dispose(),this.Q=null,this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null;for(var e=0;e<this._filtersL.length;e++)this._filtersL[e].disconnect(),this._filtersL[e]=null;this._filtersL=null;for(var i=0;i<this._filtersR.length;i++)this._filtersR[i].disconnect(),this._filtersR[i]=null;return this._filtersR=null,this.frequency=null,this},t.Phaser}),t(function(t){return t.PingPongDelay=function(){var e=this.optionsObject(arguments,["delayTime","feedback"],t.PingPongDelay.defaults);t.StereoXFeedbackEffect.call(this,e),this._leftDelay=new t.Delay(0,e.maxDelayTime),this._rightDelay=new t.Delay(0,e.maxDelayTime),this._rightPreDelay=new t.Delay(0,e.maxDelayTime),this.delayTime=new t.Signal(e.delayTime,t.Type.Time),this.effectSendL.chain(this._leftDelay,this.effectReturnL),this.effectSendR.chain(this._rightPreDelay,this._rightDelay,this.effectReturnR),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackLR.disconnect(),this._feedbackLR.connect(this._rightDelay),this._readOnly(["delayTime"])},t.extend(t.PingPongDelay,t.StereoXFeedbackEffect),t.PingPongDelay.defaults={delayTime:.25,maxDelayTime:1},t.PingPongDelay.prototype.dispose=function(){return t.StereoXFeedbackEffect.prototype.dispose.call(this),this._leftDelay.dispose(),this._leftDelay=null,this._rightDelay.dispose(),this._rightDelay=null,this._rightPreDelay.dispose(),this._rightPreDelay=null,this._writable(["delayTime"]),this.delayTime.dispose(),this.delayTime=null,this},t.PingPongDelay}),t(function(t){return t.PitchShift=function(){var e=this.optionsObject(arguments,["pitch"],t.PitchShift.defaults);t.FeedbackEffect.call(this,e),this._frequency=new t.Signal(0),this._delayA=new t.Delay(0,1),this._lfoA=new t.LFO({min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new t.Delay(0,1),this._lfoB=new t.LFO({min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new t.CrossFade,this._crossFadeLFO=new t.LFO({min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new t.Delay(e.delayTime),this.delayTime=this._feedbackDelay.delayTime,this._readOnly("delayTime"),this._pitch=e.pitch,this._windowSize=e.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);var i=this.now();this._lfoA.start(i),this._lfoB.start(i),this._crossFadeLFO.start(i),this.windowSize=this._windowSize},t.extend(t.PitchShift,t.FeedbackEffect),t.PitchShift.defaults={pitch:0,windowSize:.1,delayTime:0,feedback:0},Object.defineProperty(t.PitchShift.prototype,"pitch",{get:function(){return this._pitch},set:function(t){this._pitch=t;var e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=this.intervalToFrequencyRatio(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=this.intervalToFrequencyRatio(t)-1),this._frequency.value=e*(1.2/this._windowSize)}}),Object.defineProperty(t.PitchShift.prototype,"windowSize",{get:function(){return this._windowSize},set:function(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}}),t.PitchShift.prototype.dispose=function(){return t.FeedbackEffect.prototype.dispose.call(this),this._frequency.dispose(),this._frequency=null,this._delayA.disconnect(),this._delayA=null,this._delayB.disconnect(),this._delayB=null,this._lfoA.dispose(),this._lfoA=null,this._lfoB.dispose(),this._lfoB=null,this._crossFade.dispose(),this._crossFade=null,this._crossFadeLFO.dispose(),this._crossFadeLFO=null,this._writable("delayTime"),this._feedbackDelay.dispose(),this._feedbackDelay=null,this.delayTime=null,this},t.PitchShift}),t(function(t){return t.StereoFeedbackEffect=function(){var e=this.optionsObject(arguments,["feedback"],t.FeedbackEffect.defaults);t.StereoEffect.call(this,e),this.feedback=new t.Signal(e.feedback,t.Type.NormalRange),this._feedbackL=new t.Gain,this._feedbackR=new t.Gain,this.effectReturnL.chain(this._feedbackL,this.effectSendL),this.effectReturnR.chain(this._feedbackR,this.effectSendR),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),this._readOnly(["feedback"])},t.extend(t.StereoFeedbackEffect,t.FeedbackEffect),t.StereoFeedbackEffect.prototype.dispose=function(){return t.StereoEffect.prototype.dispose.call(this),this._writable(["feedback"]),this.feedback.dispose(),this.feedback=null,this._feedbackL.dispose(),this._feedbackL=null,this._feedbackR.dispose(),this._feedbackR=null,this},t.StereoFeedbackEffect}),t(function(t){return t.StereoWidener=function(){var e=this.optionsObject(arguments,["width"],t.StereoWidener.defaults);t.MidSideEffect.call(this,e),this.width=new t.Signal(e.width,t.Type.NormalRange),this._midMult=new t.Expr("$0 * ($1 * (1 - $2))"),this._sideMult=new t.Expr("$0 * ($1 * $2)"),this._two=new t.Signal(2),this._two.connect(this._midMult,0,1),this.width.connect(this._midMult,0,2),this._two.connect(this._sideMult,0,1),this.width.connect(this._sideMult,0,2),this.midSend.chain(this._midMult,this.midReturn),this.sideSend.chain(this._sideMult,this.sideReturn),this._readOnly(["width"])},t.extend(t.StereoWidener,t.MidSideEffect),t.StereoWidener.defaults={width:.5},t.StereoWidener.prototype.dispose=function(){return t.MidSideEffect.prototype.dispose.call(this),this._writable(["width"]),this.width.dispose(),this.width=null,this._midMult.dispose(),this._midMult=null,this._sideMult.dispose(),this._sideMult=null,this._two.dispose(),this._two=null,this},t.StereoWidener}),t(function(t){return t.Tremolo=function(){var e=this.optionsObject(arguments,["frequency","depth"],t.Tremolo.defaults);t.StereoEffect.call(this,e),this._lfoL=new t.LFO({phase:e.spread,min:1,max:0}),this._lfoR=new t.LFO({phase:e.spread,min:1,max:0}),this._amplitudeL=new t.Gain,this._amplitudeR=new t.Gain,this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.depth=new t.Signal(e.depth,t.Type.NormalRange),this._readOnly(["frequency","depth"]),this.effectSendL.chain(this._amplitudeL,this.effectReturnL),this.effectSendR.chain(this._amplitudeR,this.effectReturnR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.type=e.type,this.spread=e.spread},t.extend(t.Tremolo,t.StereoEffect),t.Tremolo.defaults={frequency:10,type:"sine",depth:.5,spread:180},t.Tremolo.prototype.start=function(t){return this._lfoL.start(t),this._lfoR.start(t),this},t.Tremolo.prototype.stop=function(t){return this._lfoL.stop(t),this._lfoR.stop(t),this},t.Tremolo.prototype.sync=function(t){return this._lfoL.sync(t),this._lfoR.sync(t),this},t.Tremolo.prototype.unsync=function(){return this._lfoL.unsync(),this._lfoR.unsync(),this},Object.defineProperty(t.Tremolo.prototype,"type",{get:function(){return this._lfoL.type},set:function(t){this._lfoL.type=t,this._lfoR.type=t}}),Object.defineProperty(t.Tremolo.prototype,"spread",{get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}}),t.Tremolo.prototype.dispose=function(){return t.StereoEffect.prototype.dispose.call(this),this._writable(["frequency","depth"]),this._lfoL.dispose(),this._lfoL=null,this._lfoR.dispose(),this._lfoR=null,this._amplitudeL.dispose(),this._amplitudeL=null,this._amplitudeR.dispose(),this._amplitudeR=null,this.frequency=null,this.depth=null,this},t.Tremolo}),t(function(t){return t.Vibrato=function(){var e=this.optionsObject(arguments,["frequency","depth"],t.Vibrato.defaults);t.Effect.call(this,e),this._delayNode=new t.Delay(0,e.maxDelay),this._lfo=new t.LFO({type:e.type,min:0,max:e.maxDelay,frequency:e.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=e.depth,this._readOnly(["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)},t.extend(t.Vibrato,t.Effect),t.Vibrato.defaults={maxDelay:.005,frequency:5,depth:.1,type:"sine"},Object.defineProperty(t.Vibrato.prototype,"type",{get:function(){return this._lfo.type},set:function(t){this._lfo.type=t}}),t.Vibrato.prototype.dispose=function(){t.Effect.prototype.dispose.call(this),this._delayNode.dispose(),this._delayNode=null,this._lfo.dispose(),this._lfo=null,this._writable(["frequency","depth"]),this.frequency=null,this.depth=null},t.Vibrato}),t(function(t){return t.Event=function(){var e=this.optionsObject(arguments,["callback","value"],t.Event.defaults);this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._state=new t.TimelineState(t.State.Stopped),this._playbackRate=1,this._startOffset=0,this.probability=e.probability,this.humanize=e.humanize,this.mute=e.mute,this.playbackRate=e.playbackRate},t.extend(t.Event),t.Event.defaults={callback:t.noOp,loop:!1,loopEnd:"1m",loopStart:0,playbackRate:1,value:null,probability:1,mute:!1,humanize:!1},t.Event.prototype._rescheduleEvents=function(e){return e=this.defaultArg(e,-1),this._state.forEachFrom(e,function(e){var i;if(e.state===t.State.Started){this.isUndef(e.id)||t.Transport.clear(e.id);var r=e.time+Math.round(this.startOffset/this._playbackRate);if(this._loop){i=1/0,this.isNumber(this._loop)&&(i=this._loop*this._getLoopDuration());var n=this._state.getAfter(r);null!==n&&(i=Math.min(i,n.time-r)),i!==1/0&&(this._state.setStateAtTime(t.State.Stopped,r+i+1),i=t.Time(i,"i"));var o=t.Time(this._getLoopDuration(),"i");e.id=t.Transport.scheduleRepeat(this._tick.bind(this),o,t.TransportTime(r,"i"),i)}else e.id=t.Transport.schedule(this._tick.bind(this),r+"i")}}.bind(this)),this},Object.defineProperty(t.Event.prototype,"state",{get:function(){return this._state.getValueAtTime(t.Transport.ticks)}}),Object.defineProperty(t.Event.prototype,"startOffset",{get:function(){return this._startOffset},set:function(t){this._startOffset=t}}),t.Event.prototype.start=function(e){return e=this.toTicks(e),this._state.getValueAtTime(e)===t.State.Stopped&&(this._state.add({state:t.State.Started,time:e,id:void 0}),this._rescheduleEvents(e)),this},t.Event.prototype.stop=function(e){if(this.cancel(e),e=this.toTicks(e),this._state.getValueAtTime(e)===t.State.Started){this._state.setStateAtTime(t.State.Stopped,e);var i=this._state.getBefore(e),r=e;null!==i&&(r=i.time),this._rescheduleEvents(r)}return this},t.Event.prototype.cancel=function(e){return e=this.defaultArg(e,-1/0),e=this.toTicks(e),this._state.forEachFrom(e,function(e){t.Transport.clear(e.id)}),this._state.cancel(e),this},t.Event.prototype._tick=function(e){if(!this.mute&&this._state.getValueAtTime(t.Transport.ticks)===t.State.Started){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){var i=.02;this.isBoolean(this.humanize)||(i=this.toSeconds(this.humanize)),e+=(2*Math.random()-1)*i}this.callback(e,this.value)}},t.Event.prototype._getLoopDuration=function(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)},Object.defineProperty(t.Event.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._rescheduleEvents()}}),Object.defineProperty(t.Event.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._rescheduleEvents()}}),Object.defineProperty(t.Event.prototype,"loopEnd",{get:function(){return t.TransportTime(this._loopEnd,"i").toNotation()},set:function(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}}),Object.defineProperty(t.Event.prototype,"loopStart",{get:function(){return t.TransportTime(this._loopStart,"i").toNotation()},set:function(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}}),Object.defineProperty(t.Event.prototype,"progress",{get:function(){if(this._loop){var e=t.Transport.ticks,i=this._state.get(e);if(null!==i&&i.state===t.State.Started){var r=this._getLoopDuration();return(e-i.time)%r/r}return 0}return 0}}),t.Event.prototype.dispose=function(){this.cancel(),this._state.dispose(),this._state=null,this.callback=null,this.value=null},t.Event}),t(function(t){return t.Loop=function(){var e=this.optionsObject(arguments,["callback","interval"],t.Loop.defaults);this._event=new t.Event({callback:this._tick.bind(this),loop:!0,loopEnd:e.interval,playbackRate:e.playbackRate,probability:e.probability}),this.callback=e.callback,this.iterations=e.iterations},t.extend(t.Loop),t.Loop.defaults={interval:"4n",callback:t.noOp,playbackRate:1,iterations:1/0,probability:!0,mute:!1},t.Loop.prototype.start=function(t){return this._event.start(t),this},t.Loop.prototype.stop=function(t){return this._event.stop(t),this},t.Loop.prototype.cancel=function(t){return this._event.cancel(t),this},t.Loop.prototype._tick=function(t){this.callback(t)},Object.defineProperty(t.Loop.prototype,"state",{get:function(){return this._event.state}}),Object.defineProperty(t.Loop.prototype,"progress",{get:function(){return this._event.progress}}),Object.defineProperty(t.Loop.prototype,"interval",{get:function(){return this._event.loopEnd},set:function(t){this._event.loopEnd=t}}),Object.defineProperty(t.Loop.prototype,"playbackRate",{get:function(){return this._event.playbackRate},set:function(t){this._event.playbackRate=t}}),Object.defineProperty(t.Loop.prototype,"humanize",{get:function(){return this._event.humanize},set:function(t){this._event.humanize=t}}),Object.defineProperty(t.Loop.prototype,"probability",{get:function(){return this._event.probability},set:function(t){this._event.probability=t}}),Object.defineProperty(t.Loop.prototype,"mute",{get:function(){return this._event.mute},set:function(t){this._event.mute=t}}),Object.defineProperty(t.Loop.prototype,"iterations",{get:function(){return!0===this._event.loop?1/0:this._event.loop},set:function(t){this._event.loop=t===1/0||t}}),t.Loop.prototype.dispose=function(){this._event.dispose(),this._event=null,this.callback=null},t.Loop}),t(function(t){return t.Part=function(){var e=this.optionsObject(arguments,["callback","events"],t.Part.defaults);this._loop=e.loop,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this._startOffset=0,this._state=new t.TimelineState(t.State.Stopped),this._events=[],this.callback=e.callback,this.mute=e.mute;var i=this.defaultArg(e.events,[]);if(!this.isUndef(e.events))for(var r=0;r<i.length;r++)Array.isArray(i[r])?this.add(i[r][0],i[r][1]):this.add(i[r])},t.extend(t.Part,t.Event),t.Part.defaults={callback:t.noOp,loop:!1,loopEnd:"1m",loopStart:0,playbackRate:1,probability:1,humanize:!1,mute:!1},t.Part.prototype.start=function(e,i){var r=this.toTicks(e);return this._state.getValueAtTime(r)!==t.State.Started&&(i=this._loop?this.defaultArg(i,this._loopStart):this.defaultArg(i,0),i=this.toTicks(i),this._state.add({state:t.State.Started,time:r,offset:i}),this._forEach(function(t){this._startNote(t,r,i)})),this},t.Part.prototype._startNote=function(e,i,r){i-=r,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<r&&(i+=this._getLoopDuration()),e.start(t.TransportTime(i,"i"))):e.startOffset<this._loopStart&&e.startOffset>=r&&(e.loop=!1,e.start(t.TransportTime(i,"i"))):e.startOffset>=r&&e.start(t.TransportTime(i,"i"))},Object.defineProperty(t.Part.prototype,"startOffset",{get:function(){return this._startOffset},set:function(t){this._startOffset=t,this._forEach(function(t){t.startOffset+=this._startOffset})}}),t.Part.prototype.stop=function(e){var i=this.toTicks(e);return this._state.cancel(i),this._state.setStateAtTime(t.State.Stopped,i),this._forEach(function(t){t.stop(e)}),this},t.Part.prototype.at=function(e,i){e=t.TransportTime(e);for(var r=t.Time(1,"i").toSeconds(),n=0;n<this._events.length;n++){var o=this._events[n];if(Math.abs(e.toTicks()-o.startOffset)<r)return this.isUndef(i)||(o.value=i),o}return this.isUndef(i)?null:(this.add(e,i),this._events[this._events.length-1])},t.Part.prototype.add=function(e,i){e.hasOwnProperty("time")&&(i=e,e=i.time),e=this.toTicks(e);var r;return i instanceof t.Event?(r=i,r.callback=this._tick.bind(this)):r=new t.Event({callback:this._tick.bind(this),value:i}),r.startOffset=e,r.set({loopEnd:this.loopEnd,loopStart:this.loopStart,loop:this.loop,humanize:this.humanize,playbackRate:this.playbackRate,probability:this.probability}),this._events.push(r),this._restartEvent(r),this},t.Part.prototype._restartEvent=function(e){this._state.forEach(function(i){i.state===t.State.Started?this._startNote(e,i.time,i.offset):e.stop(t.TransportTime(i.time,"i"))}.bind(this))},t.Part.prototype.remove=function(e,i){e.hasOwnProperty("time")&&(i=e,e=i.time),e=this.toTicks(e);for(var r=this._events.length-1;r>=0;r--){var n=this._events[r];n instanceof t.Part?n.remove(e,i):n.startOffset===e&&(this.isUndef(i)||!this.isUndef(i)&&n.value===i)&&(this._events.splice(r,1),n.dispose())}return this},t.Part.prototype.removeAll=function(){return this._forEach(function(t){t.dispose()}),this._events=[],this},t.Part.prototype.cancel=function(t){return t=this.toTicks(t),this._forEach(function(e){e.cancel(t)}),this._state.cancel(t),this},t.Part.prototype._forEach=function(e,i){i=this.defaultArg(i,this);for(var r=this._events.length-1;r>=0;r--){var n=this._events[r];n instanceof t.Part?n._forEach(e,i):e.call(i,n)}return this},t.Part.prototype._setAll=function(t,e){this._forEach(function(i){i[t]=e})},t.Part.prototype._tick=function(t,e){this.mute||this.callback(t,e)},t.Part.prototype._testLoopBoundries=function(e){e.startOffset<this._loopStart||e.startOffset>=this._loopEnd?e.cancel(0):e.state===t.State.Stopped&&this._restartEvent(e)},Object.defineProperty(t.Part.prototype,"probability",{get:function(){return this._probability},set:function(t){this._probability=t,this._setAll("probability",t)}}),Object.defineProperty(t.Part.prototype,"humanize",{get:function(){return this._humanize},set:function(t){this._humanize=t,this._setAll("humanize",t)}}),Object.defineProperty(t.Part.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._forEach(function(e){e._loopStart=this._loopStart,e._loopEnd=this._loopEnd,e.loop=t,this._testLoopBoundries(e)})}}),Object.defineProperty(t.Part.prototype,"loopEnd",{get:function(){return t.TransportTime(this._loopEnd,"i").toNotation()},set:function(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach(function(e){e.loopEnd=t,this._testLoopBoundries(e)})}}),Object.defineProperty(t.Part.prototype,"loopStart",{get:function(){return t.TransportTime(this._loopStart,"i").toNotation()},set:function(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach(function(t){t.loopStart=this.loopStart,this._testLoopBoundries(t)})}}),Object.defineProperty(t.Part.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._setAll("playbackRate",t)}}),Object.defineProperty(t.Part.prototype,"length",{get:function(){return this._events.length}}),t.Part.prototype.dispose=function(){return this.removeAll(),this._state.dispose(),this._state=null,this.callback=null,this._events=null,this},t.Part}),t(function(t){return t.Pattern=function(){var e=this.optionsObject(arguments,["callback","values","pattern"],t.Pattern.defaults);t.Loop.call(this,e),this._pattern=new t.CtrlPattern({values:e.values,type:e.pattern,index:e.index})},t.extend(t.Pattern,t.Loop),t.Pattern.defaults={pattern:t.CtrlPattern.Type.Up,values:[]},t.Pattern.prototype._tick=function(t){this.callback(t,this._pattern.value),this._pattern.next()},Object.defineProperty(t.Pattern.prototype,"index",{get:function(){return this._pattern.index},set:function(t){this._pattern.index=t}}),Object.defineProperty(t.Pattern.prototype,"values",{get:function(){return this._pattern.values},set:function(t){this._pattern.values=t}}),Object.defineProperty(t.Pattern.prototype,"value",{get:function(){return this._pattern.value}}),Object.defineProperty(t.Pattern.prototype,"pattern",{get:function(){return this._pattern.type},set:function(t){this._pattern.type=t}}),t.Pattern.prototype.dispose=function(){t.Loop.prototype.dispose.call(this),this._pattern.dispose(),this._pattern=null},t.Pattern}),t(function(t){return t.Sequence=function(){var e=this.optionsObject(arguments,["callback","events","subdivision"],t.Sequence.defaults),i=e.events;if(delete e.events,t.Part.call(this,e),this._subdivision=this.toTicks(e.subdivision),this.isUndef(e.loopEnd)&&!this.isUndef(i)&&(this._loopEnd=i.length*this._subdivision),this._loop=!0,!this.isUndef(i))for(var r=0;r<i.length;r++)this.add(r,i[r])},t.extend(t.Sequence,t.Part),t.Sequence.defaults={subdivision:"4n"},Object.defineProperty(t.Sequence.prototype,"subdivision",{get:function(){return t.Time(this._subdivision,"i").toNotation()}}),t.Sequence.prototype.at=function(e,i){return this.isArray(i)&&this.remove(e),t.Part.prototype.at.call(this,this._indexTime(e),i)},t.Sequence.prototype.add=function(e,i){if(null===i)return this;if(this.isArray(i)){var r=Math.round(this._subdivision/i.length);i=new t.Sequence(this._tick.bind(this),i,t.Time(r,"i"))}return t.Part.prototype.add.call(this,this._indexTime(e),i),this},t.Sequence.prototype.remove=function(e,i){return t.Part.prototype.remove.call(this,this._indexTime(e),i),this},t.Sequence.prototype._indexTime=function(e){return e instanceof t.TransportTime?e:t.TransportTime(e*this._subdivision+this.startOffset,"i")},t.Sequence.prototype.dispose=function(){return t.Part.prototype.dispose.call(this),this},t.Sequence}),t(function(t){return t.PulseOscillator=function(){var e=this.optionsObject(arguments,["frequency","width"],t.Oscillator.defaults);t.Source.call(this,e),this.width=new t.Signal(e.width,t.Type.NormalRange),this._widthGate=new t.Gain,this._sawtooth=new t.Oscillator({frequency:e.frequency,detune:e.detune,type:"sawtooth",phase:e.phase}),this.frequency=this._sawtooth.frequency,this.detune=this._sawtooth.detune,this._thresh=new t.WaveShaper(function(t){return t<0?-1:1}),this._sawtooth.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),this._readOnly(["width","frequency","detune"])},t.extend(t.PulseOscillator,t.Oscillator),t.PulseOscillator.defaults={frequency:440,detune:0,phase:0,width:.2},t.PulseOscillator.prototype._start=function(t){t=this.toSeconds(t),this._sawtooth.start(t),this._widthGate.gain.setValueAtTime(1,t)},t.PulseOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._sawtooth.stop(t),this._widthGate.gain.setValueAtTime(0,t)},Object.defineProperty(t.PulseOscillator.prototype,"phase",{get:function(){return this._sawtooth.phase},set:function(t){this._sawtooth.phase=t}}),Object.defineProperty(t.PulseOscillator.prototype,"type",{get:function(){return"pulse"}}),Object.defineProperty(t.PulseOscillator.prototype,"partials",{get:function(){return[]}}),t.PulseOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._sawtooth.dispose(),this._sawtooth=null,this._writable(["width","frequency","detune"]),this.width.dispose(),this.width=null,this._widthGate.dispose(),this._widthGate=null,this._thresh.dispose(),this._thresh=null,this.frequency=null,this.detune=null,this},t.PulseOscillator}),t(function(t){return t.PWMOscillator=function(){var e=this.optionsObject(arguments,["frequency","modulationFrequency"],t.PWMOscillator.defaults);t.Source.call(this,e),this._pulse=new t.PulseOscillator(e.modulationFrequency),this._pulse._sawtooth.type="sine",this._modulator=new t.Oscillator({frequency:e.frequency,detune:e.detune,phase:e.phase}),this._scale=new t.Multiply(2),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this.modulationFrequency=this._pulse.frequency,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),this._readOnly(["modulationFrequency","frequency","detune"])},t.extend(t.PWMOscillator,t.Oscillator),t.PWMOscillator.defaults={frequency:440,detune:0,phase:0,modulationFrequency:.4},t.PWMOscillator.prototype._start=function(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)},t.PWMOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)},Object.defineProperty(t.PWMOscillator.prototype,"type",{get:function(){return"pwm"}}),Object.defineProperty(t.PWMOscillator.prototype,"partials",{get:function(){return[]}}),Object.defineProperty(t.PWMOscillator.prototype,"phase",{get:function(){return this._modulator.phase},set:function(t){this._modulator.phase=t}}),t.PWMOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._pulse.dispose(),this._pulse=null,this._scale.dispose(),this._scale=null,this._modulator.dispose(),this._modulator=null,this._writable(["modulationFrequency","frequency","detune"]),this.frequency=null,this.detune=null,this.modulationFrequency=null,this},t.PWMOscillator}),t(function(t){return t.FMOscillator=function(){var e=this.optionsObject(arguments,["frequency","type","modulationType"],t.FMOscillator.defaults);t.Source.call(this,e),this._carrier=new t.Oscillator(e.frequency,e.type),this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=this._carrier.detune,this.detune.value=e.detune,this.modulationIndex=new t.Multiply(e.modulationIndex),this.modulationIndex.units=t.Type.Positive,this._modulator=new t.Oscillator(e.frequency,e.modulationType),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this._modulationNode=new t.Gain(0),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),this.phase=e.phase,this._readOnly(["modulationIndex","frequency","detune","harmonicity"])},t.extend(t.FMOscillator,t.Oscillator),t.FMOscillator.defaults={frequency:440,detune:0,phase:0,modulationIndex:2,modulationType:"square",harmonicity:1},t.FMOscillator.prototype._start=function(t){t=this.toSeconds(t),this._modulator.start(t),this._carrier.start(t)},t.FMOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._modulator.stop(t),this._carrier.stop(t)},Object.defineProperty(t.FMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}}),Object.defineProperty(t.FMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}}),Object.defineProperty(t.FMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}}),Object.defineProperty(t.FMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}}),t.FMOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._writable(["modulationIndex","frequency","detune","harmonicity"]),this.frequency.dispose(),this.frequency=null,this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this._modulationNode.dispose(),this._modulationNode=null,this.modulationIndex.dispose(),this.modulationIndex=null,this},t.FMOscillator}),t(function(t){return t.AMOscillator=function(){var e=this.optionsObject(arguments,["frequency","type","modulationType"],t.AMOscillator.defaults);t.Source.call(this,e),this._carrier=new t.Oscillator(e.frequency,e.type),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this.detune.value=e.detune,this._modulator=new t.Oscillator(e.frequency,e.modulationType),this._modulationScale=new t.AudioToGain,this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this._modulationNode=new t.Gain(0),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.connect(this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),this.phase=e.phase,this._readOnly(["frequency","detune","harmonicity"])},t.extend(t.AMOscillator,t.Oscillator),t.AMOscillator.defaults={frequency:440,detune:0,phase:0,modulationType:"square",harmonicity:1},t.AMOscillator.prototype._start=function(t){t=this.toSeconds(t),this._modulator.start(t),this._carrier.start(t)},t.AMOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._modulator.stop(t),this._carrier.stop(t)},Object.defineProperty(t.AMOscillator.prototype,"type",{get:function(){return this._carrier.type},set:function(t){this._carrier.type=t}}),Object.defineProperty(t.AMOscillator.prototype,"modulationType",{get:function(){return this._modulator.type},set:function(t){this._modulator.type=t}}),Object.defineProperty(t.AMOscillator.prototype,"phase",{get:function(){return this._carrier.phase},set:function(t){this._carrier.phase=t,this._modulator.phase=t}}),Object.defineProperty(t.AMOscillator.prototype,"partials",{get:function(){return this._carrier.partials},set:function(t){this._carrier.partials=t}}),t.AMOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._writable(["frequency","detune","harmonicity"]),this.frequency=null,this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this._modulationNode.dispose(),this._modulationNode=null,this._modulationScale.dispose(),this._modulationScale=null,this},t.AMOscillator}),t(function(t){return t.FatOscillator=function(){var e=this.optionsObject(arguments,["frequency","type","spread"],t.FatOscillator.defaults);t.Source.call(this,e),this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=new t.Signal(e.detune,t.Type.Cents),this._oscillators=[],this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=this.defaultArg(e.partials,[]),this.count=e.count,this._readOnly(["frequency","detune"])},t.extend(t.FatOscillator,t.Oscillator),t.FatOscillator.defaults={frequency:440,detune:0,phase:0,spread:20,count:3,type:"sawtooth"},t.FatOscillator.prototype._start=function(t){t=this.toSeconds(t),this._forEach(function(e){e.start(t)})},t.FatOscillator.prototype._stop=function(t){t=this.toSeconds(t),this._forEach(function(e){e.stop(t)})},t.FatOscillator.prototype._forEach=function(t){for(var e=0;e<this._oscillators.length;e++)t.call(this,this._oscillators[e],e)},Object.defineProperty(t.FatOscillator.prototype,"type",{get:function(){return this._type},set:function(t){this._type=t,this._forEach(function(e){e.type=t})}}),Object.defineProperty(t.FatOscillator.prototype,"spread",{get:function(){return this._spread},set:function(t){if(this._spread=t,this._oscillators.length>1){var e=-t/2,i=t/(this._oscillators.length-1);this._forEach(function(t,r){t.detune.value=e+i*r})}}}),Object.defineProperty(t.FatOscillator.prototype,"count",{get:function(){return this._oscillators.length},set:function(e){if(e=Math.max(e,1),this._oscillators.length!==e){this._forEach(function(t){t.dispose()}),this._oscillators=[];for(var i=0;i<e;i++){var r=new t.Oscillator;this.type===t.Oscillator.Type.Custom?r.partials=this._partials:r.type=this._type,r.phase=this._phase,r.volume.value=-6-e,this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.connect(this.output),this._oscillators[i]=r}this.spread=this._spread,this.state===t.State.Started&&this._forEach(function(t){t.start()})}}}),Object.defineProperty(t.FatOscillator.prototype,"phase",{get:function(){return this._phase},set:function(t){this._phase=t,this._forEach(function(e){e.phase=t})}}),Object.defineProperty(t.FatOscillator.prototype,"partials",{get:function(){return this._partials},set:function(e){this._partials=e,this._type=t.Oscillator.Type.Custom,this._forEach(function(t){t.partials=e})}}),t.FatOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this._forEach(function(t){t.dispose()}),this._oscillators=null,this._partials=null,this},t.FatOscillator}),t(function(t){t.OmniOscillator=function(){var e=this.optionsObject(arguments,["frequency","type"],t.OmniOscillator.defaults);t.Source.call(this,e),this.frequency=new t.Signal(e.frequency,t.Type.Frequency),this.detune=new t.Signal(e.detune,t.Type.Cents),this._sourceType=void 0,this._oscillator=null,this.type=e.type,this._readOnly(["frequency","detune"]),this.set(e)},t.extend(t.OmniOscillator,t.Oscillator),t.OmniOscillator.defaults={frequency:440,detune:0,type:"sine",phase:0};var e={Pulse:"PulseOscillator",PWM:"PWMOscillator",Osc:"Oscillator",FM:"FMOscillator",AM:"AMOscillator",Fat:"FatOscillator"};return t.OmniOscillator.prototype._start=function(t){this._oscillator.start(t)},t.OmniOscillator.prototype._stop=function(t){this._oscillator.stop(t)},Object.defineProperty(t.OmniOscillator.prototype,"type",{get:function(){var t="";return this._sourceType===e.FM?t="fm":this._sourceType===e.AM?t="am":this._sourceType===e.Fat&&(t="fat"),t+this._oscillator.type},set:function(t){"fm"===t.substr(0,2)?(this._createNewOscillator(e.FM),this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator(e.AM),this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator(e.Fat),this._oscillator.type=t.substr(3)):"pwm"===t?this._createNewOscillator(e.PWM):"pulse"===t?this._createNewOscillator(e.Pulse):(this._createNewOscillator(e.Osc),this._oscillator.type=t)}}),Object.defineProperty(t.OmniOscillator.prototype,"partials",{get:function(){return this._oscillator.partials},set:function(t){this._oscillator.partials=t}}),t.OmniOscillator.prototype.set=function(e,i){return"type"===e?this.type=i:this.isObject(e)&&e.hasOwnProperty("type")&&(this.type=e.type),t.prototype.set.apply(this,arguments),this},t.OmniOscillator.prototype._createNewOscillator=function(e){if(e!==this._sourceType){this._sourceType=e;var i=t[e],r=this.now()+this.blockTime;if(null!==this._oscillator){var n=this._oscillator;n.stop(r),setTimeout(function(){n.dispose(),n=null},1e3*this.blockTime)}this._oscillator=new i,this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this.state===t.State.Started&&this._oscillator.start(r)}},Object.defineProperty(t.OmniOscillator.prototype,"phase",{get:function(){return this._oscillator.phase},set:function(t){this._oscillator.phase=t}}),Object.defineProperty(t.OmniOscillator.prototype,"width",{get:function(){if(this._sourceType===e.Pulse)return this._oscillator.width}}),Object.defineProperty(t.OmniOscillator.prototype,"count",{get:function(){if(this._sourceType===e.Fat)return this._oscillator.count},set:function(t){this._sourceType===e.Fat&&(this._oscillator.count=t)}}),Object.defineProperty(t.OmniOscillator.prototype,"spread",{get:function(){if(this._sourceType===e.Fat)return this._oscillator.spread},set:function(t){this._sourceType===e.Fat&&(this._oscillator.spread=t)}}),Object.defineProperty(t.OmniOscillator.prototype,"modulationType",{get:function(){if(this._sourceType===e.FM||this._sourceType===e.AM)return this._oscillator.modulationType},set:function(t){this._sourceType!==e.FM&&this._sourceType!==e.AM||(this._oscillator.modulationType=t)}}),Object.defineProperty(t.OmniOscillator.prototype,"modulationIndex",{get:function(){if(this._sourceType===e.FM)return this._oscillator.modulationIndex}}),Object.defineProperty(t.OmniOscillator.prototype,"harmonicity",{get:function(){if(this._sourceType===e.FM||this._sourceType===e.AM)return this._oscillator.harmonicity}}),Object.defineProperty(t.OmniOscillator.prototype,"modulationFrequency",{get:function(){if(this._sourceType===e.PWM)return this._oscillator.modulationFrequency}}),t.OmniOscillator.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this._writable(["frequency","detune"]),this.detune.dispose(),this.detune=null,this.frequency.dispose(),this.frequency=null,this._oscillator.dispose(),this._oscillator=null,this._sourceType=null,this},t.OmniOscillator}),t(function(t){return t.Instrument=function(e){e=this.defaultArg(e,t.Instrument.defaults),this._volume=this.output=new t.Volume(e.volume),this.volume=this._volume.volume,this._readOnly("volume")},t.extend(t.Instrument),t.Instrument.defaults={volume:0},t.Instrument.prototype.triggerAttack=t.noOp,t.Instrument.prototype.triggerRelease=t.noOp,t.Instrument.prototype.triggerAttackRelease=function(t,e,i,r){return i=this.isUndef(i)?this.now()+this.blockTime:this.toSeconds(i),e=this.toSeconds(e),this.triggerAttack(t,i,r),this.triggerRelease(i+e),this},t.Instrument.prototype.dispose=function(){return t.prototype.dispose.call(this),this._volume.dispose(),this._volume=null,this._writable(["volume"]),this.volume=null,this},t.Instrument}),t(function(t){return t.Monophonic=function(e){e=this.defaultArg(e,t.Monophonic.defaults),t.Instrument.call(this,e),this.portamento=e.portamento},t.extend(t.Monophonic,t.Instrument),t.Monophonic.defaults={portamento:0},t.Monophonic.prototype.triggerAttack=function(t,e,i){return e=this.isUndef(e)?this.now()+this.blockTime:this.toSeconds(e),this._triggerEnvelopeAttack(e,i),this.setNote(t,e),this},t.Monophonic.prototype.triggerRelease=function(t){return t=this.isUndef(t)?this.now()+this.blockTime:this.toSeconds(t),this._triggerEnvelopeRelease(t),this},t.Monophonic.prototype._triggerEnvelopeAttack=function(){},t.Monophonic.prototype._triggerEnvelopeRelease=function(){},t.Monophonic.prototype.setNote=function(t,e){if(e=this.toSeconds(e),this.portamento>0){var i=this.frequency.value;this.frequency.setValueAtTime(i,e);var r=this.toSeconds(this.portamento);this.frequency.exponentialRampToValueAtTime(t,e+r)}else this.frequency.setValueAtTime(t,e);return this},t.Monophonic}),t(function(t){return t.Synth=function(e){e=this.defaultArg(e,t.Synth.defaults),t.Monophonic.call(this,e),this.oscillator=new t.OmniOscillator(e.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new t.AmplitudeEnvelope(e.envelope),this.oscillator.chain(this.envelope,this.output),this.oscillator.start(),this._readOnly(["oscillator","frequency","detune","envelope"])},t.extend(t.Synth,t.Monophonic),t.Synth.defaults={oscillator:{type:"triangle"},envelope:{attack:.005,decay:.1,sustain:.3,release:1}},t.Synth.prototype._triggerEnvelopeAttack=function(t,e){return this.envelope.triggerAttack(t,e),this},t.Synth.prototype._triggerEnvelopeRelease=function(t){return this.envelope.triggerRelease(t),this},t.Synth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.frequency=null,this.detune=null,this},t.Synth}),t(function(t){return t.AMSynth=function(e){e=this.defaultArg(e,t.AMSynth.defaults),t.Monophonic.call(this,e),this._carrier=new t.Synth,this._carrier.volume.value=-10,this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope.set(e.envelope),this._modulator=new t.Synth,this._modulator.volume.value=-10,this.modulation=this._modulator.oscillator.set(e.modulation),this.modulationEnvelope=this._modulator.envelope.set(e.modulationEnvelope),this.frequency=new t.Signal(440,t.Type.Frequency),this.detune=new t.Signal(e.detune,t.Type.Cents),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this._modulationScale=new t.AudioToGain,this._modulationNode=new t.Gain,this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),this._readOnly(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])},t.extend(t.AMSynth,t.Monophonic),t.AMSynth.defaults={harmonicity:3,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}},t.AMSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.modulationEnvelope.triggerAttack(t,e),this},t.AMSynth.prototype._triggerEnvelopeRelease=function(t){return this.envelope.triggerRelease(t),this.modulationEnvelope.triggerRelease(t),this},t.AMSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"]),this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationScale.dispose(),this._modulationScale=null,this._modulationNode.dispose(),this._modulationNode=null,this.oscillator=null,this.envelope=null,this.modulationEnvelope=null,this.modulation=null,this},t.AMSynth}),t(function(t){return t.MonoSynth=function(e){e=this.defaultArg(e,t.MonoSynth.defaults),t.Monophonic.call(this,e),this.oscillator=new t.OmniOscillator(e.oscillator),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new t.Filter(e.filter),this.filterEnvelope=new t.FrequencyEnvelope(e.filterEnvelope),this.envelope=new t.AmplitudeEnvelope(e.envelope),this.oscillator.chain(this.filter,this.envelope,this.output),this.oscillator.start(),this.filterEnvelope.connect(this.filter.frequency),this._readOnly(["oscillator","frequency","detune","filter","filterEnvelope","envelope"])},t.extend(t.MonoSynth,t.Monophonic),t.MonoSynth.defaults={frequency:"C4",detune:0,oscillator:{type:"square"},filter:{Q:6,type:"lowpass",rolloff:-24},envelope:{attack:.005,decay:.1,sustain:.9,release:1},filterEnvelope:{attack:.06,decay:.2,sustain:.5,release:2,baseFrequency:200,octaves:7,exponent:2}},t.MonoSynth.prototype._triggerEnvelopeAttack=function(t,e){return this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this},t.MonoSynth.prototype._triggerEnvelopeRelease=function(t){return this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this},t.MonoSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this.filterEnvelope.dispose(),this.filterEnvelope=null,this.filter.dispose(),this.filter=null,this.frequency=null,this.detune=null,this},t.MonoSynth}),t(function(t){return t.DuoSynth=function(e){e=this.defaultArg(e,t.DuoSynth.defaults),t.Monophonic.call(this,e),this.voice0=new t.MonoSynth(e.voice0),this.voice0.volume.value=-10,this.voice1=new t.MonoSynth(e.voice1),this.voice1.volume.value=-10,this._vibrato=new t.LFO(e.vibratoRate,-50,50),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new t.Gain(e.vibratoAmount,t.Type.Positive),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new t.Signal(440,t.Type.Frequency),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),this._readOnly(["voice0","voice1","frequency","vibratoAmount","vibratoRate"])},t.extend(t.DuoSynth,t.Monophonic),t.DuoSynth.defaults={vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}},voice1:{volume:-10,portamento:0,oscillator:{type:"sine"},filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}},t.DuoSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.voice0.envelope.triggerAttack(t,e),this.voice1.envelope.triggerAttack(t,e),this.voice0.filterEnvelope.triggerAttack(t),this.voice1.filterEnvelope.triggerAttack(t),this},t.DuoSynth.prototype._triggerEnvelopeRelease=function(t){return this.voice0.triggerRelease(t),this.voice1.triggerRelease(t),this},t.DuoSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),this.voice0.dispose(),this.voice0=null,this.voice1.dispose(),this.voice1=null,this.frequency.dispose(),this.frequency=null,this._vibratoGain.dispose(),this._vibratoGain=null,this._vibrato=null,this.harmonicity.dispose(),this.harmonicity=null,this.vibratoAmount.dispose(),this.vibratoAmount=null,this.vibratoRate=null,this},t.DuoSynth}),t(function(t){return t.FMSynth=function(e){e=this.defaultArg(e,t.FMSynth.defaults),t.Monophonic.call(this,e),this._carrier=new t.Synth(e.carrier),this._carrier.volume.value=-10,this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope.set(e.envelope),this._modulator=new t.Synth(e.modulator),this._modulator.volume.value=-10,this.modulation=this._modulator.oscillator.set(e.modulation),this.modulationEnvelope=this._modulator.envelope.set(e.modulationEnvelope),this.frequency=new t.Signal(440,t.Type.Frequency),this.detune=new t.Signal(e.detune,t.Type.Cents),this.harmonicity=new t.Multiply(e.harmonicity),this.harmonicity.units=t.Type.Positive,this.modulationIndex=new t.Multiply(e.modulationIndex),this.modulationIndex.units=t.Type.Positive,this._modulationNode=new t.Gain(0),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this._readOnly(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"])},t.extend(t.FMSynth,t.Monophonic),t.FMSynth.defaults={harmonicity:3,modulationIndex:10,detune:0,oscillator:{type:"sine"},envelope:{attack:.01,decay:.01,sustain:1,release:.5},modulation:{type:"square"},modulationEnvelope:{attack:.5,decay:0,sustain:1,release:.5}},t.FMSynth.prototype._triggerEnvelopeAttack=function(t,e){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.modulationEnvelope.triggerAttack(t),this},t.FMSynth.prototype._triggerEnvelopeRelease=function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.modulationEnvelope.triggerRelease(t),this},t.FMSynth.prototype.dispose=function(){return t.Monophonic.prototype.dispose.call(this),this._writable(["frequency","harmonicity","modulationIndex","oscillator","envelope","modulation","modulationEnvelope","detune"]),this._carrier.dispose(),this._carrier=null,this._modulator.dispose(),this._modulator=null,this.frequency.dispose(),this.frequency=null,this.detune.dispose(),this.detune=null,this.modulationIndex.dispose(),this.modulationIndex=null,this.harmonicity.dispose(),this.harmonicity=null,this._modulationNode.dispose(),this._modulationNode=null,this.oscillator=null,this.envelope=null,this.modulationEnvelope=null,this.modulation=null,this},t.FMSynth}),t(function(t){return t.MembraneSynth=function(e){e=this.defaultArg(e,t.MembraneSynth.defaults),t.Instrument.call(this,e),this.oscillator=new t.OmniOscillator(e.oscillator).start(),this.envelope=new t.AmplitudeEnvelope(e.envelope),this.octaves=e.octaves,this.pitchDecay=e.pitchDecay,this.oscillator.chain(this.envelope,this.output),this._readOnly(["oscillator","envelope"])},t.extend(t.MembraneSynth,t.Instrument),t.MembraneSynth.defaults={pitchDecay:.05,octaves:10,oscillator:{type:"sine"},envelope:{attack:.001,decay:.4,sustain:.01,release:1.4,attackCurve:"exponential"}},t.MembraneSynth.prototype.triggerAttack=function(t,e,i){e=this.toSeconds(e),t=this.toFrequency(t);var r=t*this.octaves;return this.oscillator.frequency.setValueAtTime(r,e),this.oscillator.frequency.exponentialRampToValueAtTime(t,e+this.toSeconds(this.pitchDecay)),this.envelope.triggerAttack(e,i),this},t.MembraneSynth.prototype.triggerRelease=function(t){return this.envelope.triggerRelease(t),this},t.MembraneSynth.prototype.dispose=function(){return t.Instrument.prototype.dispose.call(this),this._writable(["oscillator","envelope"]),this.oscillator.dispose(),this.oscillator=null,this.envelope.dispose(),this.envelope=null,this},t.MembraneSynth}),t(function(t){var e=[1,1.483,1.932,2.546,2.63,3.897];return t.MetalSynth=function(i){i=this.defaultArg(i,t.MetalSynth.defaults),t.Instrument.call(this,i),this.frequency=new t.Signal(i.frequency,t.Type.Frequency),this._oscillators=[],this._freqMultipliers=[],this._amplitue=new t.Gain(0).connect(this.output),this._highpass=new t.Filter({type:"highpass",Q:-3.0102999566398125}).connect(this._amplitue),this._octaves=i.octaves,this._filterFreqScaler=new t.Scale(i.resonance,7e3),this.envelope=new t.Envelope({attack:i.envelope.attack,attackCurve:"linear",decay:i.envelope.decay,sustain:0,release:i.envelope.release}).chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitue.gain);for(var r=0;r<e.length;r++){var n=new t.FMOscillator({type:"square",modulationType:"square",harmonicity:i.harmonicity,modulationIndex:i.modulationIndex});n.connect(this._highpass).start(0),this._oscillators[r]=n;var o=new t.Multiply(e[r]);this._freqMultipliers[r]=o,this.frequency.chain(o,n.frequency)}this.octaves=i.octaves},t.extend(t.MetalSynth,t.Instrument),t.MetalSynth.defaults={frequency:200,envelope:{attack:.001,decay:1.4,release:.2},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5},t.MetalSynth.prototype.triggerAttack=function(t,e){return t=this.toSeconds(t),e=this.defaultArg(e,1),this.envelope.triggerAttack(t,e),this},t.MetalSynth.prototype.triggerRelease=function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this},t.MetalSynth.prototype.triggerAttackRelease=function(t,e,i){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,i),this.triggerRelease(e+t),this},Object.defineProperty(t.MetalSynth.prototype,"modulationIndex",{get:function(){return this._oscillators[0].modulationIndex.value},set:function(t){for(var e=0;e<this._oscillators.length;e++)this._oscillators[e].modulationIndex.value=t}}),Object.defineProperty(t.MetalSynth.prototype,"harmonicity",{get:function(){return this._oscillators[0].harmonicity.value},set:function(t){for(var e=0;e<this._oscillators.length;e++)this._oscillators[e].harmonicity.value=t}}),Object.defineProperty(t.MetalSynth.prototype,"resonance",{get:function(){return this._filterFreqScaler.min},set:function(t){this._filterFreqScaler.min=t,this.octaves=this._octaves}}),Object.defineProperty(t.MetalSynth.prototype,"octaves",{get:function(){return this._octaves},set:function(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}}),t.MetalSynth.prototype.dispose=function(){t.Instrument.prototype.dispose.call(this);for(var e=0;e<this._oscillators.length;e++)this._oscillators[e].dispose(),this._freqMultipliers[e].dispose();this._oscillators=null,this._freqMultipliers=null,this.frequency.dispose(),this.frequency=null,this._filterFreqScaler.dispose(),this._filterFreqScaler=null,this._amplitue.dispose(),this._amplitue=null,this.envelope.dispose(),this.envelope=null,this._highpass.dispose(),this._highpass=null},t.MetalSynth}),t(function(t){return window.AudioBufferSourceNode&&!AudioBufferSourceNode.prototype.start&&(AudioBufferSourceNode.prototype.start=AudioBufferSourceNode.prototype.noteGrainOn,AudioBufferSourceNode.prototype.stop=AudioBufferSourceNode.prototype.noteOff),t.BufferSource=function(){var e=this.optionsObject(arguments,["buffer","onended"],t.BufferSource.defaults);this.onended=e.onended,this._startTime=-1,this._stopTime=-1,this._gainNode=this.output=new t.Gain,this._source=this.context.createBufferSource(),this._source.connect(this._gainNode),this.playbackRate=new t.Param(this._source.playbackRate,t.Type.Positive),this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut,this._gain=1,this._onendedTimeout=-1,this.isUndef(e.buffer)||(this.buffer=e.buffer),this.loop=e.loop},t.extend(t.BufferSource),t.BufferSource.defaults={onended:t.noOp,fadeIn:0,fadeOut:0},Object.defineProperty(t.BufferSource.prototype,"state",{get:function(){var e=this.now();return-1!==this._startTime&&e>=this._startTime&&e<this._stopTime?t.State.Started:t.State.Stopped}}),t.BufferSource.prototype.start=function(t,e,i,r,n){if(-1!==this._startTime)throw new Error("Tone.BufferSource: can only be started once.");return this.buffer&&(t=this.toSeconds(t),e=this.loop?this.defaultArg(e,this.loopStart):this.defaultArg(e,0),e=this.toSeconds(e),t=this.toSeconds(t),this._source.start(t,e),r=this.defaultArg(r,1),this._gain=r,n=this.isUndef(n)?this.toSeconds(this.fadeIn):this.toSeconds(n),n>0?(this._gainNode.gain.setValueAtTime(0,t),this._gainNode.gain.linearRampToValueAtTime(this._gain,t+n)):this._gainNode.gain.setValueAtTime(r,t),this._startTime=t+n,this.isUndef(i)||(i=this.defaultArg(i,this.buffer.duration-e),i=this.toSeconds(i),this.stop(t+i+n,n))),this},t.BufferSource.prototype.stop=function(t,e){return this.buffer&&(t=this.toSeconds(t),e=this.isUndef(e)?this.toSeconds(this.fadeOut):this.toSeconds(e),this._stopTime=t+e,this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),e>0?(this._gainNode.gain.setValueAtTime(this._gain,t),this._gainNode.gain.linearRampToValueAtTime(0,t+e),t+=e):this._gainNode.gain.setValueAtTime(0,t),this.isNumber(this._source.playbackState)&&2!==this._source.playbackState||this._source.stop(t),clearTimeout(this._onendedTimeout),this._onendedTimeout=setTimeout(this._onended.bind(this),1e3*(this._stopTime-this.now()))),this},t.BufferSource.prototype._onended=function(){this.onended(this),this.dispose()},Object.defineProperty(t.BufferSource.prototype,"loopStart",{get:function(){return this._source.loopStart},set:function(t){this._source.loopStart=this.toSeconds(t)}}),Object.defineProperty(t.BufferSource.prototype,"loopEnd",{get:function(){return this._source.loopEnd},set:function(t){this._source.loopEnd=this.toSeconds(t)}}),Object.defineProperty(t.BufferSource.prototype,"buffer",{get:function(){return this._source?this._source.buffer:null},set:function(e){e instanceof t.Buffer?this._source.buffer=e.get():this._source.buffer=e}}),Object.defineProperty(t.BufferSource.prototype,"loop",{get:function(){return this._source.loop},set:function(t){this._source.loop=t}}),t.BufferSource.prototype.dispose=function(){return this.onended=null,this._source&&(this._source.disconnect(),this._source=null),this._gainNode&&(this._gainNode.dispose(),this._gainNode=null),this._startTime=-1,this.playbackRate=null,this.output=null,clearTimeout(this._onendedTimeout),this},t.BufferSource}),t(function(t){function e(){for(var e in i)r[e]=(new t.Buffer).fromArray(i[e])}t.Noise=function(){var e=this.optionsObject(arguments,["type"],t.Noise.defaults);t.Source.call(this,e),this._source=null,this._type=e.type,this._playbackRate=e.playbackRate},t.extend(t.Noise,t.Source),t.Noise.defaults={type:"white",playbackRate:1},Object.defineProperty(t.Noise.prototype,"type",{get:function(){return this._type},set:function(e){if(this._type!==e){if(!(e in r))throw new TypeError("Tone.Noise: invalid type: "+e);if(this._type=e,this.state===t.State.Started){var i=this.now()+this.blockTime;this._stop(i),this._start(i)}}}}),Object.defineProperty(t.Noise.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}}),t.Noise.prototype._start=function(e){var i=r[this._type];this._source=new t.BufferSource(i).connect(this.output),this._source.loop=!0,this._source.playbackRate.value=this._playbackRate,this._source.start(this.toSeconds(e),Math.random()*(i.duration-.001))},t.Noise.prototype._stop=function(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)},t.Noise.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer=null,this};var i={pink:function(){for(var t=[],e=0;e<2;e++){var i=new Float32Array(220500);t[e]=i;var r,n,o,s,a,h,l;r=n=o=s=a=h=l=0;for(var u=0;u<220500;u++){var p=2*Math.random()-1;r=.99886*r+.0555179*p,n=.99332*n+.0750759*p,o=.969*o+.153852*p,s=.8665*s+.3104856*p,a=.55*a+.5329522*p,h=-.7616*h-.016898*p,i[u]=r+n+o+s+a+h+l+.5362*p,i[u]*=.11,l=.115926*p}}return t}(),brown:function(){for(var t=[],e=0;e<2;e++){var i=new Float32Array(220500);t[e]=i;for(var r=0,n=0;n<220500;n++){var o=2*Math.random()-1;i[n]=(r+.02*o)/1.02,r=i[n],i[n]*=3.5}}return t}(),white:function(){for(var t=[],e=0;e<2;e++){var i=new Float32Array(220500);t[e]=i;for(var r=0;r<220500;r++)i[r]=2*Math.random()-1}return t}()},r={};return e(),t.Context.on("init",e),t.Noise}),t(function(t){return t.NoiseSynth=function(e){e=this.defaultArg(e,t.NoiseSynth.defaults),t.Instrument.call(this,e),this.noise=new t.Noise,this.envelope=new t.AmplitudeEnvelope(e.envelope),this.noise.chain(this.envelope,this.output),this.noise.start(),this._readOnly(["noise","envelope"])},t.extend(t.NoiseSynth,t.Instrument),t.NoiseSynth.defaults={noise:{type:"white"},envelope:{attack:.005,decay:.1,sustain:0}},t.NoiseSynth.prototype.triggerAttack=function(t,e){return this.envelope.triggerAttack(t,e),this},t.NoiseSynth.prototype.triggerRelease=function(t){return this.envelope.triggerRelease(t),this},t.NoiseSynth.prototype.triggerAttackRelease=function(t,e,i){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,i),this.triggerRelease(e+t),this},t.NoiseSynth.prototype.dispose=function(){return t.Instrument.prototype.dispose.call(this),this._writable(["noise","envelope"]),this.noise.dispose(),this.noise=null,this.envelope.dispose(),this.envelope=null,this},t.NoiseSynth}),t(function(t){return t.PluckSynth=function(e){e=this.defaultArg(e,t.PluckSynth.defaults),t.Instrument.call(this,e),this._noise=new t.Noise("pink"),this.attackNoise=e.attackNoise,this._lfcf=new t.LowpassCombFilter({resonance:e.resonance,dampening:e.dampening}),this.resonance=this._lfcf.resonance,this.dampening=this._lfcf.dampening,this._noise.connect(this._lfcf),this._lfcf.connect(this.output),this._readOnly(["resonance","dampening"])},t.extend(t.PluckSynth,t.Instrument),t.PluckSynth.defaults={attackNoise:1,dampening:4e3,resonance:.9},t.PluckSynth.prototype.triggerAttack=function(t,e){t=this.toFrequency(t),e=this.toSeconds(e);var i=1/t;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this},t.PluckSynth.prototype.dispose=function(){return t.Instrument.prototype.dispose.call(this),this._noise.dispose(),this._lfcf.dispose(),this._noise=null,this._lfcf=null,this._writable(["resonance","dampening"]),this.dampening=null,this.resonance=null,this},t.PluckSynth}),t(function(t){return t.PolySynth=function(){t.Instrument.call(this);var e=this.optionsObject(arguments,["polyphony","voice"],t.PolySynth.defaults);e=this.defaultArg(e,t.Instrument.defaults),e.polyphony=Math.min(t.PolySynth.MAX_POLYPHONY,e.polyphony),this.voices=new Array(e.polyphony),this._triggers=new Array(e.polyphony),this.detune=new t.Signal(e.detune,t.Type.Cents),this._readOnly("detune");for(var i=0;i<e.polyphony;i++){var r=new e.voice(arguments[2],arguments[3]);this.voices[i]=r,r.connect(this.output),r.hasOwnProperty("detune")&&this.detune.connect(r.detune),this._triggers[i]={release:-1,note:null,voice:r}}this.volume.value=e.volume},t.extend(t.PolySynth,t.Instrument),t.PolySynth.defaults={polyphony:4,volume:0,detune:0,voice:t.Synth},t.PolySynth.prototype.triggerAttack=function(t,e,i){Array.isArray(t)||(t=[t]),e=this.toSeconds(e);for(var r=0;r<t.length;r++){for(var n=t[r],o=this._triggers[0],s=1;s<this._triggers.length;s++)this._triggers[s].release<o.release&&(o=this._triggers[s],s);o.release=1/0,o.note=JSON.stringify(n),o.voice.triggerAttack(n,e,i)}return this},t.PolySynth.prototype.triggerAttackRelease=function(t,e,i,r){if(i=this.toSeconds(i),this.triggerAttack(t,i,r),this.isArray(e)&&this.isArray(t))for(var n=0;n<t.length;n++){var o=e[Math.min(n,e.length-1)];this.triggerRelease(t[n],i+this.toSeconds(o))}else this.triggerRelease(t,i+this.toSeconds(e));return this},t.PolySynth.prototype.triggerRelease=function(t,e){Array.isArray(t)||(t=[t]),e=this.toSeconds(e);for(var i=0;i<t.length;i++)for(var r=JSON.stringify(t[i]),n=0;n<this._triggers.length;n++){var o=this._triggers[n];o.note===r&&o.release>e&&(o.voice.triggerRelease(e),o.release=e)}return this},t.PolySynth.prototype.set=function(t,e,i){for(var r=0;r<this.voices.length;r++)this.voices[r].set(t,e,i);return this},t.PolySynth.prototype.get=function(t){return this.voices[0].get(t)},t.PolySynth.prototype.releaseAll=function(t){t=this.toSeconds(t);for(var e=0;e<this._triggers.length;e++){var i=this._triggers[e];i.release>t&&(i.release=t,i.voice.triggerRelease(t))}return this},t.PolySynth.prototype.dispose=function(){t.Instrument.prototype.dispose.call(this);for(var e=0;e<this.voices.length;e++)this.voices[e].dispose(),this.voices[e]=null;return this._writable("detune"),this.detune.dispose(),this.detune=null,this.voices=null,this._triggers=null,this},t.PolySynth.MAX_POLYPHONY=20,t.PolySynth}),t(function(t){return t.Player=function(e){var i;e instanceof t.Buffer?(e=e.get(),i=t.Player.defaults):i=this.optionsObject(arguments,["url","onload"],t.Player.defaults),t.Source.call(this,i),this._source=null,this.autostart=i.autostart,this._buffer=new t.Buffer({url:i.url,onload:this._onload.bind(this,i.onload),reverse:i.reverse}),e instanceof AudioBuffer&&this._buffer.set(e),this._loop=i.loop,this._loopStart=i.loopStart,this._loopEnd=i.loopEnd,this._playbackRate=i.playbackRate,this.retrigger=i.retrigger},t.extend(t.Player,t.Source),t.Player.defaults={onload:t.noOp,playbackRate:1,loop:!1,autostart:!1,loopStart:0,loopEnd:0,retrigger:!1,reverse:!1},t.Player.prototype.load=function(t,e){return this._buffer.load(t,this._onload.bind(this,e))},t.Player.prototype._onload=function(e){e=this.defaultArg(e,t.noOp),e(this),this.autostart&&this.start()},t.Player.prototype._start=function(e,i,r){if(!this._buffer.loaded)throw Error("Tone.Player: tried to start Player before the buffer was loaded");if(i=this._loop?this.defaultArg(i,this._loopStart):this.defaultArg(i,0),i=this.toSeconds(i),r=this.defaultArg(r,Math.max(this._buffer.duration-i,0)),r=this.toSeconds(r),e=this.toSeconds(e),this._source=this.context.createBufferSource(),this._source.buffer=this._buffer.get(),this._loop?(this._source.loop=this._loop,this._source.loopStart=this.toSeconds(this._loopStart),this._source.loopEnd=this.toSeconds(this._loopEnd)):this._synced||this._state.setStateAtTime(t.State.Stopped,e+r),this._source.playbackRate.value=this._playbackRate,this._source.connect(this.output),this._loop){var n=this._source.loopEnd||this._buffer.duration,o=this._source.loopStart,s=n-o;if(i>n)for(;i>n;)i-=s;this._source.start(e,i)}else this._source.start(e,i,r);return this},t.Player.prototype._stop=function(t){return this._source&&(this._source.stop(this.toSeconds(t)),this._source=null),this},t.Player.prototype.seek=function(e,i){return i=this.toSeconds(i),this._state.getValueAtTime(i)===t.State.Started&&(e=this.toSeconds(e),this._stop(i),this._start(i,e)),this},t.Player.prototype.setLoopPoints=function(t,e){return this.loopStart=t,this.loopEnd=e,this},Object.defineProperty(t.Player.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=t,this._source&&(this._source.loopStart=this.toSeconds(t))}}),Object.defineProperty(t.Player.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(t){this._loopEnd=t,this._source&&(this._source.loopEnd=this.toSeconds(t))}}),Object.defineProperty(t.Player.prototype,"buffer",{get:function(){return this._buffer},set:function(t){this._buffer.set(t)}}),Object.defineProperty(t.Player.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this._source&&(this._source.loop=t)}}),Object.defineProperty(t.Player.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}}),Object.defineProperty(t.Player.prototype,"reverse",{get:function(){return this._buffer.reverse},set:function(t){this._buffer.reverse=t}}),t.Player.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),null!==this._source&&(this._source.disconnect(),this._source=null),this._buffer.dispose(),this._buffer=null,this},t.Player}),t(function(t){return t.Sampler=function(){var e=this.optionsObject(arguments,["url","onload"],t.Sampler.defaults);t.Instrument.call(this,e),this.player=new t.Player(e.url,e.onload),this.player.retrigger=!0,this.envelope=new t.AmplitudeEnvelope(e.envelope),this.player.chain(this.envelope,this.output),this._readOnly(["player","envelope"]),this.loop=e.loop,this.reverse=e.reverse},t.extend(t.Sampler,t.Instrument),t.Sampler.defaults={onload:t.noOp,loop:!1,reverse:!1,envelope:{attack:.001,decay:0,sustain:1,release:.1}},t.Sampler.prototype.triggerAttack=function(t,e,i){return e=this.toSeconds(e),t=this.defaultArg(t,0),this.player.playbackRate=this.intervalToFrequencyRatio(t),this.player.start(e),this.envelope.triggerAttack(e,i),this},t.Sampler.prototype.triggerRelease=function(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.player.stop(this.toSeconds(this.envelope.release)+t),this},Object.defineProperty(t.Sampler.prototype,"loop",{get:function(){return this.player.loop},set:function(t){this.player.loop=t}}),Object.defineProperty(t.Sampler.prototype,"reverse",{get:function(){return this.player.reverse},set:function(t){this.player.reverse=t}}),Object.defineProperty(t.Sampler.prototype,"buffer",{get:function(){return this.player.buffer},set:function(t){this.player.buffer=t}}),t.Sampler.prototype.dispose=function(){return t.Instrument.prototype.dispose.call(this),this._writable(["player","envelope"]),this.player.dispose(),this.player=null,this.envelope.dispose(),this.envelope=null,this},t.Sampler}),t(function(t){return t.GainToAudio=function(){this._norm=this.input=this.output=new t.WaveShaper(function(t){return 2*Math.abs(t)-1})},t.extend(t.GainToAudio,t.SignalBase),t.GainToAudio.prototype.dispose=function(){return t.prototype.dispose.call(this),this._norm.dispose(),this._norm=null,this},t.GainToAudio}),t(function(t){return t.Normalize=function(e,i){this._inputMin=this.defaultArg(e,0),this._inputMax=this.defaultArg(i,1),this._sub=this.input=new t.Add(0),this._div=this.output=new t.Multiply(1),this._sub.connect(this._div),this._setRange()},t.extend(t.Normalize,t.SignalBase),Object.defineProperty(t.Normalize.prototype,"min",{get:function(){return this._inputMin},set:function(t){this._inputMin=t,this._setRange()}}),Object.defineProperty(t.Normalize.prototype,"max",{get:function(){return this._inputMax},set:function(t){this._inputMax=t,this._setRange()}}),t.Normalize.prototype._setRange=function(){this._sub.value=-this._inputMin,this._div.value=1/(this._inputMax-this._inputMin)},t.Normalize.prototype.dispose=function(){return t.prototype.dispose.call(this),this._sub.dispose(),this._sub=null,this._div.dispose(),this._div=null,this},t.Normalize}),t(function(t){return t.MultiPlayer=function(){var e=this.optionsObject(arguments,["urls","onload"],t.MultiPlayer.defaults);e.urls instanceof t.Buffers?this.buffers=e.urls:this.buffers=new t.Buffers(e.urls,e.onload),this._activeSources={},this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut,this._volume=this.output=new t.Volume(e.volume),this.volume=this._volume.volume,this._readOnly("volume"),this._volume.output.output.channelCount=2,this._volume.output.output.channelCountMode="explicit",this.mute=e.mute},t.extend(t.MultiPlayer,t.Source),t.MultiPlayer.defaults={onload:t.noOp,fadeIn:0,fadeOut:0},t.MultiPlayer.prototype._makeSource=function(e){var i;this.isString(e)||this.isNumber(e)?i=this.buffers.get(e).get():e instanceof t.Buffer?i=e.get():e instanceof AudioBuffer&&(i=e);var r=new t.BufferSource(i).connect(this.output);return this._activeSources.hasOwnProperty(e)||(this._activeSources[e]=[]),this._activeSources[e].push(r),r},t.MultiPlayer.prototype.start=function(t,e,i,r,n,o){e=this.toSeconds(e);var s=this._makeSource(t);return s.start(e,i,r,this.defaultArg(o,1),this.fadeIn),r&&s.stop(e+this.toSeconds(r),this.fadeOut),n=this.defaultArg(n,0),s.playbackRate.value=this.intervalToFrequencyRatio(n),this},t.MultiPlayer.prototype.startLoop=function(t,e,i,r,n,o,s){e=this.toSeconds(e);var a=this._makeSource(t);return a.loop=!0,a.loopStart=this.toSeconds(this.defaultArg(r,0)),a.loopEnd=this.toSeconds(this.defaultArg(n,0)),a.start(e,i,void 0,this.defaultArg(s,1),this.fadeIn),o=this.defaultArg(o,0),a.playbackRate.value=this.intervalToFrequencyRatio(o),this},t.MultiPlayer.prototype.stop=function(t,e){if(!this._activeSources[t]||!this._activeSources[t].length)throw new Error("Tone.MultiPlayer: cannot stop a buffer that hasn't been started or is already stopped");return e=this.toSeconds(e),this._activeSources[t].shift().stop(e,this.fadeOut),this},t.MultiPlayer.prototype.stopAll=function(t){t=this.toSeconds(t);for(var e in this._activeSources)for(var i=this._activeSources[e],r=0;r<i.length;r++)i[r].stop(t);return this},t.MultiPlayer.prototype.add=function(t,e,i){return this.buffers.add(t,e,i),this},Object.defineProperty(t.MultiPlayer.prototype,"state",{get:function(){return this._activeSources.length>0?t.State.Started:t.State.Stopped}}),Object.defineProperty(t.MultiPlayer.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),t.MultiPlayer.prototype.dispose=function(){t.prototype.dispose.call(this),this._volume.dispose(),this._volume=null,this._writable("volume"),this.volume=null;for(var e in this._activeSources)this._activeSources[e].forEach(function(t){t.dispose()});return this.buffers.dispose(),this.buffers=null,this._activeSources=null,this},t.MultiPlayer}),t(function(t){return t.GrainPlayer=function(){var e=this.optionsObject(arguments,["url","onload"],t.GrainPlayer.defaults);t.Source.call(this),this.buffer=new t.Buffer(e.url,e.onload),this._player=(new t.MultiPlayer).connect(this.output),this._clock=new t.Clock(this._tick.bind(this),1),this._loopStart=0,this._loopEnd=0,this._playbackRate=e.playbackRate,this._grainSize=e.grainSize,this._overlap=e.overlap,this.detune=e.detune,this.drift=e.drift,this.overlap=e.overlap,this.loop=e.loop,this.playbackRate=e.playbackRate,this.grainSize=e.grainSize,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.reverse=e.reverse},t.extend(t.GrainPlayer,t.Source),t.GrainPlayer.defaults={onload:t.noOp,overlap:.1,grainSize:.2,drift:0,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1},t.GrainPlayer.prototype._start=function(t,e,i){e=this.defaultArg(e,0),e=this.toSeconds(e),t=this.toSeconds(t),this._offset=e,this._clock.start(t),this._player.volume.setValueAtTime(0,t),i&&this._stop(t+this.toSeconds(i))},t.GrainPlayer.prototype._stop=function(t){this._clock.stop(t),this._player.volume.cancelScheduledValues(t),this._player.volume.setValueAtTime(-1/0,t)},t.GrainPlayer.prototype._tick=function(t){var e=this.buffer.duration;this.loop&&this._loopEnd>0&&(e=this._loopEnd);var i=(2*Math.random()-1)*this.drift,r=this._offset-this._overlap+i,n=this.detune/100;r=Math.max(r,0),r=Math.min(r,e);var o=this._player.fadeIn;if(this.loop&&this._offset>e){var s=this._offset-e;this._player.start(this.buffer,t,r,s+this._overlap,n),r=this._offset%e,this._offset=this._loopStart,this._player.fadeIn=0,this._player.start(this.buffer,t+s,this._offset,r+this._overlap,n)}else this._offset>e?this.stop(t):(0===r&&(this._player.fadeIn=0),this._player.start(this.buffer,t,r,this.grainSize+this._overlap,n));this._player.fadeIn=o;var a=this._clock._nextTick-t;this._offset+=a*this._playbackRate},t.GrainPlayer.prototype.scrub=function(t,e){return this._offset=this.toSeconds(t),this._tick(this.toSeconds(e)),this},Object.defineProperty(t.GrainPlayer.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(t){this._playbackRate=t,this.grainSize=this._grainSize}}),Object.defineProperty(t.GrainPlayer.prototype,"loopStart",{get:function(){return this._loopStart},set:function(t){this._loopStart=this.toSeconds(t)}}),Object.defineProperty(t.GrainPlayer.prototype,"loopEnd",{get:function(){return this._loopEnd},set:function(t){this._loopEnd=this.toSeconds(t)}}),Object.defineProperty(t.GrainPlayer.prototype,"reverse",{get:function(){return this.buffer.reverse},set:function(t){this.buffer.reverse=t}}),Object.defineProperty(t.GrainPlayer.prototype,"grainSize",{get:function(){return this._grainSize},set:function(t){this._grainSize=this.toSeconds(t),this._clock.frequency.value=this._playbackRate/this._grainSize}}),Object.defineProperty(t.GrainPlayer.prototype,"overlap",{get:function(){return this._overlap},set:function(t){t=this.toSeconds(t),this._overlap=t,this._overlap<0?(this._player.fadeIn=.01,this._player.fadeOut=.01):(this._player.fadeIn=t,this._player.fadeOut=t)}}),t.GrainPlayer.prototype.dispose=function(){return t.Source.prototype.dispose.call(this),this.buffer.dispose(),this.buffer=null,this._player.dispose(),this._player=null,this._clock.dispose(),this._clock=null,this},t.GrainPlayer}),t(function(t){return t.UserMedia=function(){var e=this.optionsObject(arguments,["volume"],t.UserMedia.defaults);this._mediaStream=null,this._stream=null,this._device=null,this._volume=this.output=new t.Volume(e.volume),this.volume=this._volume.volume,this._readOnly("volume"),this.mute=e.mute},t.extend(t.UserMedia),t.UserMedia.defaults={volume:0,mute:!1},t.UserMedia.prototype.open=function(t){return t=this.defaultArg(t,"default"),this.enumerateDevices().then(function(e){var i;if(this.isNumber(t)?i=e[t]:(i=e.find(function(e){return e.label===t||e.deviceId===t}))||(i=e[0]),!i)throw new Error("Tone.UserMedia: no matching audio inputs.");this._device=i;var r={audio:{deviceId:i.deviceId,echoCancellation:!1,sampleRate:this.context.sampleRate}};return navigator.mediaDevices.getUserMedia(r).then(function(t){return this._stream||(this._stream=t,this._mediaStream=this.context.createMediaStreamSource(t),this._mediaStream.connect(this.output)),this}.bind(this))}.bind(this))},t.UserMedia.prototype.close=function(){return this._stream&&(this._stream.getAudioTracks().forEach(function(t){t.stop()}),this._stream=null,this._mediaStream.disconnect(),this._mediaStream=null),this._device=null,this},t.UserMedia.prototype.enumerateDevices=function(){return navigator.mediaDevices.enumerateDevices().then(function(t){return t.filter(function(t){return"audioinput"===t.kind})})},Object.defineProperty(t.UserMedia.prototype,"state",{get:function(){return this._stream&&this._stream.active?t.State.Started:t.State.Stopped}}),Object.defineProperty(t.UserMedia.prototype,"deviceId",{get:function(){if(this._device)return this._device.deviceId}}),Object.defineProperty(t.UserMedia.prototype,"groupId",{get:function(){if(this._device)return this._device.groupId}}),Object.defineProperty(t.UserMedia.prototype,"label",{get:function(){if(this._device)return this._device.label}}),Object.defineProperty(t.UserMedia.prototype,"mute",{get:function(){return this._volume.mute},set:function(t){this._volume.mute=t}}),t.UserMedia.prototype.dispose=function(){return t.prototype.dispose.call(this),this.close(),this._writable("volume"),this._volume.dispose(),this._volume=null,this.volume=null,this},Object.defineProperty(t.UserMedia,"supported",{get:function(){return!t.prototype.isUndef(navigator.mediaDevices)&&t.prototype.isFunction(navigator.mediaDevices.getUserMedia)}}),t.UserMedia}),e})}]);